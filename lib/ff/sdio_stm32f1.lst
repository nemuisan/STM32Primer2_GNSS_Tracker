   1              		.syntax unified
   2              		.cpu cortex-m3
   3              		.fpu softvfp
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 4
  11              		.eabi_attribute 34, 0
  12              		.eabi_attribute 18, 4
  13              		.thumb
  14              		.file	"sdio_stm32f1.c"
  15              		.text
  16              	.Ltext0:
  17              		.cfi_sections	.debug_frame
  18              		.section	.text.CmdResp2Error,"ax",%progbits
  19              		.align	1
  20              		.thumb
  21              		.thumb_func
  23              	CmdResp2Error:
  24              	.LFB82:
  25              		.file 1 "lib/ff/sdio_stm32f1.c"
   1:lib/ff/sdio_stm32f1.c **** /********************************************************************************/
   2:lib/ff/sdio_stm32f1.c **** /*!
   3:lib/ff/sdio_stm32f1.c **** 	@file			sdio_stm32f1.c
   4:lib/ff/sdio_stm32f1.c **** 	@author         Nemui Trinomius (http://nemuisan.blog.bai.ne.jp)
   5:lib/ff/sdio_stm32f1.c ****     @version        6.00
   6:lib/ff/sdio_stm32f1.c ****     @date           2013.07.06
   7:lib/ff/sdio_stm32f1.c **** 	@brief          SDIO Driver For STM32 HighDensity Devices				@n
   8:lib/ff/sdio_stm32f1.c **** 					Based on STM32F10x_StdPeriph_Driver V3.4.0.				@n
   9:lib/ff/sdio_stm32f1.c **** 
  10:lib/ff/sdio_stm32f1.c ****     @section HISTORY
  11:lib/ff/sdio_stm32f1.c **** 		2011.01.20	V1.00 Start Here.
  12:lib/ff/sdio_stm32f1.c **** 		2011.03.10	V2.00 C++ Ready.
  13:lib/ff/sdio_stm32f1.c **** 		2012.04.17	V3.00 Added SD_GetCardStatus().
  14:lib/ff/sdio_stm32f1.c **** 		2012.09.22  V4.00 Updated Support grater than 32GB Cards.
  15:lib/ff/sdio_stm32f1.c **** 		2012.10.05  V5.00 Fixed ACMD41 Argument for SDXC(Not UHS-1 mode).
  16:lib/ff/sdio_stm32f1.c **** 		2013.07.06  V6.00 Fixed over 4GB R/W Problem.
  17:lib/ff/sdio_stm32f1.c **** 
  18:lib/ff/sdio_stm32f1.c ****     @section LICENSE
  19:lib/ff/sdio_stm32f1.c **** 		BSD License. See Copyright.txt
  20:lib/ff/sdio_stm32f1.c **** */
  21:lib/ff/sdio_stm32f1.c **** /********************************************************************************/
  22:lib/ff/sdio_stm32f1.c **** 
  23:lib/ff/sdio_stm32f1.c **** /* Includes ------------------------------------------------------------------*/
  24:lib/ff/sdio_stm32f1.c **** #include "sdio_stm32f1.h"
  25:lib/ff/sdio_stm32f1.c **** 
  26:lib/ff/sdio_stm32f1.c **** /* Defines -------------------------------------------------------------------*/
  27:lib/ff/sdio_stm32f1.c **** /** 
  28:lib/ff/sdio_stm32f1.c ****   * @brief  SDIO Static flags, TimeOut, FIFO Address  
  29:lib/ff/sdio_stm32f1.c ****   */
  30:lib/ff/sdio_stm32f1.c **** #define NULL 0
  31:lib/ff/sdio_stm32f1.c **** #define SDIO_STATIC_FLAGS               ((uint32_t)0x000005FF)
  32:lib/ff/sdio_stm32f1.c **** #define SDIO_CMD0TIMEOUT                ((uint32_t)0x00010000)
  33:lib/ff/sdio_stm32f1.c **** 
  34:lib/ff/sdio_stm32f1.c **** /** 
  35:lib/ff/sdio_stm32f1.c ****   * @brief  Mask for errors Card Status R1 (OCR Register) 
  36:lib/ff/sdio_stm32f1.c ****   */
  37:lib/ff/sdio_stm32f1.c **** #define SD_OCR_ADDR_OUT_OF_RANGE        ((uint32_t)0x80000000)
  38:lib/ff/sdio_stm32f1.c **** #define SD_OCR_ADDR_MISALIGNED          ((uint32_t)0x40000000)
  39:lib/ff/sdio_stm32f1.c **** #define SD_OCR_BLOCK_LEN_ERR            ((uint32_t)0x20000000)
  40:lib/ff/sdio_stm32f1.c **** #define SD_OCR_ERASE_SEQ_ERR            ((uint32_t)0x10000000)
  41:lib/ff/sdio_stm32f1.c **** #define SD_OCR_BAD_ERASE_PARAM          ((uint32_t)0x08000000)
  42:lib/ff/sdio_stm32f1.c **** #define SD_OCR_WRITE_PROT_VIOLATION     ((uint32_t)0x04000000)
  43:lib/ff/sdio_stm32f1.c **** #define SD_OCR_LOCK_UNLOCK_FAILED       ((uint32_t)0x01000000)
  44:lib/ff/sdio_stm32f1.c **** #define SD_OCR_COM_CRC_FAILED           ((uint32_t)0x00800000)
  45:lib/ff/sdio_stm32f1.c **** #define SD_OCR_ILLEGAL_CMD              ((uint32_t)0x00400000)
  46:lib/ff/sdio_stm32f1.c **** #define SD_OCR_CARD_ECC_FAILED          ((uint32_t)0x00200000)
  47:lib/ff/sdio_stm32f1.c **** #define SD_OCR_CC_ERROR                 ((uint32_t)0x00100000)
  48:lib/ff/sdio_stm32f1.c **** #define SD_OCR_GENERAL_UNKNOWN_ERROR    ((uint32_t)0x00080000)
  49:lib/ff/sdio_stm32f1.c **** #define SD_OCR_STREAM_READ_UNDERRUN     ((uint32_t)0x00040000)
  50:lib/ff/sdio_stm32f1.c **** #define SD_OCR_STREAM_WRITE_OVERRUN     ((uint32_t)0x00020000)
  51:lib/ff/sdio_stm32f1.c **** #define SD_OCR_CID_CSD_OVERWRIETE       ((uint32_t)0x00010000)
  52:lib/ff/sdio_stm32f1.c **** #define SD_OCR_WP_ERASE_SKIP            ((uint32_t)0x00008000)
  53:lib/ff/sdio_stm32f1.c **** #define SD_OCR_CARD_ECC_DISABLED        ((uint32_t)0x00004000)
  54:lib/ff/sdio_stm32f1.c **** #define SD_OCR_ERASE_RESET              ((uint32_t)0x00002000)
  55:lib/ff/sdio_stm32f1.c **** #define SD_OCR_AKE_SEQ_ERROR            ((uint32_t)0x00000008)
  56:lib/ff/sdio_stm32f1.c **** #define SD_OCR_ERRORBITS                ((uint32_t)0xFDFFE008)
  57:lib/ff/sdio_stm32f1.c **** 
  58:lib/ff/sdio_stm32f1.c **** /** 
  59:lib/ff/sdio_stm32f1.c ****   * @brief  Masks for R6 Response 
  60:lib/ff/sdio_stm32f1.c ****   */
  61:lib/ff/sdio_stm32f1.c **** #define SD_R6_GENERAL_UNKNOWN_ERROR     ((uint32_t)0x00002000)
  62:lib/ff/sdio_stm32f1.c **** #define SD_R6_ILLEGAL_CMD               ((uint32_t)0x00004000)
  63:lib/ff/sdio_stm32f1.c **** #define SD_R6_COM_CRC_FAILED            ((uint32_t)0x00008000)
  64:lib/ff/sdio_stm32f1.c **** 
  65:lib/ff/sdio_stm32f1.c **** #define SD_VOLTAGE_WINDOW_SD            ((uint32_t)0x80100000)
  66:lib/ff/sdio_stm32f1.c **** #define SD_SDXC_XPC_FULLPOWER         	((uint32_t)0x10000000)	/* Nemui added SDXC MAXIMUM Power   *
  67:lib/ff/sdio_stm32f1.c **** #define SD_SDXC_S18R_REGULAR_VOLT       ((uint32_t)0x00000000)	/* Nemui added SDXC "NO-1.8V" Drive 
  68:lib/ff/sdio_stm32f1.c **** #define SD_HIGH_CAPACITY                ((uint32_t)0x40000000)
  69:lib/ff/sdio_stm32f1.c **** #define SD_STD_CAPACITY                 ((uint32_t)0x00000000)
  70:lib/ff/sdio_stm32f1.c **** #define SD_CHECK_PATTERN                ((uint32_t)0x000001AA)
  71:lib/ff/sdio_stm32f1.c **** 
  72:lib/ff/sdio_stm32f1.c **** #define SD_MAX_VOLT_TRIAL               ((uint32_t)0x0000FFFF)
  73:lib/ff/sdio_stm32f1.c **** #define SD_ALLZERO                      ((uint32_t)0x00000000)
  74:lib/ff/sdio_stm32f1.c **** 
  75:lib/ff/sdio_stm32f1.c **** #define SD_WIDE_BUS_SUPPORT             ((uint32_t)0x00040000)
  76:lib/ff/sdio_stm32f1.c **** #define SD_SINGLE_BUS_SUPPORT           ((uint32_t)0x00010000)
  77:lib/ff/sdio_stm32f1.c **** #define SD_CARD_LOCKED                  ((uint32_t)0x02000000)
  78:lib/ff/sdio_stm32f1.c **** 
  79:lib/ff/sdio_stm32f1.c **** #define SD_DATATIMEOUT                  ((uint32_t)0x000FFFFF)
  80:lib/ff/sdio_stm32f1.c **** #define SD_0TO7BITS                     ((uint32_t)0x000000FF)
  81:lib/ff/sdio_stm32f1.c **** #define SD_8TO15BITS                    ((uint32_t)0x0000FF00)
  82:lib/ff/sdio_stm32f1.c **** #define SD_16TO23BITS                   ((uint32_t)0x00FF0000)
  83:lib/ff/sdio_stm32f1.c **** #define SD_24TO31BITS                   ((uint32_t)0xFF000000)
  84:lib/ff/sdio_stm32f1.c **** #define SD_MAX_DATA_LENGTH              ((uint32_t)0x01FFFFFF)
  85:lib/ff/sdio_stm32f1.c **** 
  86:lib/ff/sdio_stm32f1.c **** #define SD_HALFFIFO                     ((uint32_t)0x00000008)
  87:lib/ff/sdio_stm32f1.c **** #define SD_HALFFIFOBYTES                ((uint32_t)0x00000020)
  88:lib/ff/sdio_stm32f1.c **** 
  89:lib/ff/sdio_stm32f1.c **** /** 
  90:lib/ff/sdio_stm32f1.c ****   * @brief  Command Class Supported 
  91:lib/ff/sdio_stm32f1.c ****   */
  92:lib/ff/sdio_stm32f1.c **** #define SD_CCCC_LOCK_UNLOCK             ((uint32_t)0x00000080)
  93:lib/ff/sdio_stm32f1.c **** #define SD_CCCC_WRITE_PROT              ((uint32_t)0x00000040)
  94:lib/ff/sdio_stm32f1.c **** #define SD_CCCC_ERASE                   ((uint32_t)0x00000020)
  95:lib/ff/sdio_stm32f1.c **** 
  96:lib/ff/sdio_stm32f1.c **** /** 
  97:lib/ff/sdio_stm32f1.c ****   * @brief  Following commands are SD Card Specific commands.
  98:lib/ff/sdio_stm32f1.c ****   *         SDIO_APP_CMD should be sent before sending these commands. 
  99:lib/ff/sdio_stm32f1.c ****   */
 100:lib/ff/sdio_stm32f1.c **** #define SDIO_SEND_IF_COND               ((uint32_t)0x00000008)
 101:lib/ff/sdio_stm32f1.c **** 
 102:lib/ff/sdio_stm32f1.c **** 
 103:lib/ff/sdio_stm32f1.c **** /* Variables -----------------------------------------------------------------*/
 104:lib/ff/sdio_stm32f1.c **** static uint32_t CardType =  SDIO_STD_CAPACITY_SD_CARD_V1_1;
 105:lib/ff/sdio_stm32f1.c **** static uint32_t CSD_Tab[4], CID_Tab[4], RCA = 0;
 106:lib/ff/sdio_stm32f1.c **** static uint8_t SDSTATUS_Tab[16];
 107:lib/ff/sdio_stm32f1.c **** static uint32_t DeviceMode = SD_POLLING_MODE;
 108:lib/ff/sdio_stm32f1.c **** static uint32_t TotalNumberOfBytes = 0, StopCondition = 0;
 109:lib/ff/sdio_stm32f1.c **** uint32_t *SrcBuffer, *DestBuffer;
 110:lib/ff/sdio_stm32f1.c **** __IO SD_Error TransferError = SD_OK;
 111:lib/ff/sdio_stm32f1.c **** __IO uint32_t TransferEnd = 0;
 112:lib/ff/sdio_stm32f1.c **** __IO uint32_t NumberOfBytes = 0;
 113:lib/ff/sdio_stm32f1.c **** SD_CardInfo SDCardInfo;
 114:lib/ff/sdio_stm32f1.c **** SDIO_InitTypeDef SDIO_InitStructure;
 115:lib/ff/sdio_stm32f1.c **** SDIO_CmdInitTypeDef SDIO_CmdInitStructure;
 116:lib/ff/sdio_stm32f1.c **** SDIO_DataInitTypeDef SDIO_DataInitStructure;   
 117:lib/ff/sdio_stm32f1.c **** 
 118:lib/ff/sdio_stm32f1.c **** /* Constants -----------------------------------------------------------------*/
 119:lib/ff/sdio_stm32f1.c **** 
 120:lib/ff/sdio_stm32f1.c **** /* Function prototypes -------------------------------------------------------*/
 121:lib/ff/sdio_stm32f1.c **** static SD_Error CmdError(void);
 122:lib/ff/sdio_stm32f1.c **** static SD_Error CmdResp1Error(uint8_t cmd);
 123:lib/ff/sdio_stm32f1.c **** static SD_Error CmdResp7Error(void);
 124:lib/ff/sdio_stm32f1.c **** static SD_Error CmdResp3Error(void);
 125:lib/ff/sdio_stm32f1.c **** static SD_Error CmdResp2Error(void);
 126:lib/ff/sdio_stm32f1.c **** static SD_Error CmdResp6Error(uint8_t cmd, uint16_t *prca);
 127:lib/ff/sdio_stm32f1.c **** static SD_Error SDEnWideBus(FunctionalState NewState);
 128:lib/ff/sdio_stm32f1.c **** static SD_Error IsCardProgramming(uint8_t *pstatus);
 129:lib/ff/sdio_stm32f1.c **** static SD_Error FindSCR(uint16_t rca, uint32_t *pscr);
 130:lib/ff/sdio_stm32f1.c **** static uint8_t convert_from_bytes_to_power_of_two(uint16_t NumberOfBytes);
 131:lib/ff/sdio_stm32f1.c **** static void SD_LowLevel_DMA_TxConfig(uint32_t *BufferSRC, uint32_t BufferSize);
 132:lib/ff/sdio_stm32f1.c **** static void SD_LowLevel_DMA_RxConfig(uint32_t *BufferDST, uint32_t BufferSize);
 133:lib/ff/sdio_stm32f1.c **** static uint32_t SD_DMAEndOfTransferStatus(void);
 134:lib/ff/sdio_stm32f1.c **** 
 135:lib/ff/sdio_stm32f1.c **** /* Functions -----------------------------------------------------------------*/
 136:lib/ff/sdio_stm32f1.c **** 
 137:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 138:lib/ff/sdio_stm32f1.c **** /*! 
 139:lib/ff/sdio_stm32f1.c ****     @brief DeInitializes the SDIO interface.
 140:lib/ff/sdio_stm32f1.c **** 	@param  None
 141:lib/ff/sdio_stm32f1.c ****     @retval : None
 142:lib/ff/sdio_stm32f1.c **** */
 143:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 144:lib/ff/sdio_stm32f1.c **** void SD_DeInit(void)
 145:lib/ff/sdio_stm32f1.c **** { 
 146:lib/ff/sdio_stm32f1.c ****   GPIO_InitTypeDef  GPIO_InitStructure;
 147:lib/ff/sdio_stm32f1.c ****   
 148:lib/ff/sdio_stm32f1.c ****   /*!< Disable SDIO Clock */
 149:lib/ff/sdio_stm32f1.c ****   SDIO_ClockCmd(DISABLE);
 150:lib/ff/sdio_stm32f1.c ****   
 151:lib/ff/sdio_stm32f1.c ****   /*!< Set Power State to OFF */
 152:lib/ff/sdio_stm32f1.c ****   SDIO_SetPowerState(SDIO_PowerState_OFF);
 153:lib/ff/sdio_stm32f1.c **** 
 154:lib/ff/sdio_stm32f1.c ****   /*!< DeInitializes the SDIO peripheral */
 155:lib/ff/sdio_stm32f1.c ****   SDIO_DeInit();
 156:lib/ff/sdio_stm32f1.c ****   
 157:lib/ff/sdio_stm32f1.c ****   /*!< Disable the SDIO AHB Clock */
 158:lib/ff/sdio_stm32f1.c ****   RCC_AHBPeriphClockCmd(RCC_AHBPeriph_SDIO, DISABLE);
 159:lib/ff/sdio_stm32f1.c **** 
 160:lib/ff/sdio_stm32f1.c ****   /*!< Configure PC.08, PC.09, PC.10, PC.11, PC.12 pin: D0, D1, D2, D3, CLK pin */
 161:lib/ff/sdio_stm32f1.c ****   GPIO_InitStructure.GPIO_Pin = GPIO_Pin_8 | GPIO_Pin_9 | GPIO_Pin_10 | GPIO_Pin_11 | GPIO_Pin_12;
 162:lib/ff/sdio_stm32f1.c ****   GPIO_InitStructure.GPIO_Mode = GPIO_Mode_IN_FLOATING;
 163:lib/ff/sdio_stm32f1.c ****   GPIO_Init(GPIOC, &GPIO_InitStructure);
 164:lib/ff/sdio_stm32f1.c **** 
 165:lib/ff/sdio_stm32f1.c ****   /*!< Configure PD.02 CMD line */
 166:lib/ff/sdio_stm32f1.c ****   GPIO_InitStructure.GPIO_Pin = GPIO_Pin_2;
 167:lib/ff/sdio_stm32f1.c ****   GPIO_Init(GPIOD, &GPIO_InitStructure);
 168:lib/ff/sdio_stm32f1.c **** }
 169:lib/ff/sdio_stm32f1.c **** 
 170:lib/ff/sdio_stm32f1.c **** 
 171:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 172:lib/ff/sdio_stm32f1.c **** /*! 
 173:lib/ff/sdio_stm32f1.c ****     @brief  Initializes the SD Card and put it into StandBy State (Ready for data 
 174:lib/ff/sdio_stm32f1.c ****             transfer).
 175:lib/ff/sdio_stm32f1.c **** 	@param  None
 176:lib/ff/sdio_stm32f1.c ****     @retval SD_Error: SD Card Error code.
 177:lib/ff/sdio_stm32f1.c **** */
 178:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 179:lib/ff/sdio_stm32f1.c **** SD_Error SD_Init(void)
 180:lib/ff/sdio_stm32f1.c **** {
 181:lib/ff/sdio_stm32f1.c ****   GPIO_InitTypeDef  GPIO_InitStructure;
 182:lib/ff/sdio_stm32f1.c ****   NVIC_InitTypeDef NVIC_InitStructure;
 183:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
 184:lib/ff/sdio_stm32f1.c ****  
 185:lib/ff/sdio_stm32f1.c ****   /* SDIO Peripheral Low Level Init */
 186:lib/ff/sdio_stm32f1.c ****   /*!< GPIOC and GPIOD Periph clock enable */
 187:lib/ff/sdio_stm32f1.c ****   RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOC | RCC_APB2Periph_GPIOD | SD_DETECT_GPIO_CLK, ENABLE);
 188:lib/ff/sdio_stm32f1.c **** 
 189:lib/ff/sdio_stm32f1.c ****   /*!< Configure PC.08, PC.09, PC.10, PC.11, PC.12 pin: D0, D1, D2, D3, CLK pin */
 190:lib/ff/sdio_stm32f1.c ****   GPIO_InitStructure.GPIO_Pin = GPIO_Pin_8 | GPIO_Pin_9 | GPIO_Pin_10 | GPIO_Pin_11 | GPIO_Pin_12;
 191:lib/ff/sdio_stm32f1.c ****   GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;
 192:lib/ff/sdio_stm32f1.c ****   GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF_PP;
 193:lib/ff/sdio_stm32f1.c ****   GPIO_Init(GPIOC, &GPIO_InitStructure);
 194:lib/ff/sdio_stm32f1.c **** 
 195:lib/ff/sdio_stm32f1.c ****   /*!< Configure PD.02 CMD line */
 196:lib/ff/sdio_stm32f1.c ****   GPIO_InitStructure.GPIO_Pin = GPIO_Pin_2;
 197:lib/ff/sdio_stm32f1.c ****   GPIO_Init(GPIOD, &GPIO_InitStructure);
 198:lib/ff/sdio_stm32f1.c **** 
 199:lib/ff/sdio_stm32f1.c ****   /*!< Configure SD_SPI_DETECT_PIN pin: SD Card detect pin */
 200:lib/ff/sdio_stm32f1.c ****   GPIO_InitStructure.GPIO_Pin = SD_DETECT_PIN;
 201:lib/ff/sdio_stm32f1.c ****   GPIO_InitStructure.GPIO_Mode = GPIO_Mode_IPU;
 202:lib/ff/sdio_stm32f1.c ****   GPIO_Init(SD_DETECT_GPIO_PORT, &GPIO_InitStructure);
 203:lib/ff/sdio_stm32f1.c ****   
 204:lib/ff/sdio_stm32f1.c ****   /*!< Enable the SDIO AHB Clock */
 205:lib/ff/sdio_stm32f1.c ****   RCC_AHBPeriphClockCmd(RCC_AHBPeriph_SDIO, ENABLE);
 206:lib/ff/sdio_stm32f1.c **** 
 207:lib/ff/sdio_stm32f1.c ****   /*!< Enable the DMA2 Clock */
 208:lib/ff/sdio_stm32f1.c ****   RCC_AHBPeriphClockCmd(RCC_AHBPeriph_DMA2, ENABLE);
 209:lib/ff/sdio_stm32f1.c ****   /* End of LowLevel Init */
 210:lib/ff/sdio_stm32f1.c **** 
 211:lib/ff/sdio_stm32f1.c **** 
 212:lib/ff/sdio_stm32f1.c ****   SDIO_DeInit();
 213:lib/ff/sdio_stm32f1.c **** 
 214:lib/ff/sdio_stm32f1.c ****   errorstatus = SD_PowerON();
 215:lib/ff/sdio_stm32f1.c **** 
 216:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
 217:lib/ff/sdio_stm32f1.c ****   {
 218:lib/ff/sdio_stm32f1.c ****     /*!< CMD Response TimeOut (wait for CMDSENT flag) */
 219:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 220:lib/ff/sdio_stm32f1.c ****   }
 221:lib/ff/sdio_stm32f1.c **** 
 222:lib/ff/sdio_stm32f1.c ****   errorstatus = SD_InitializeCards();
 223:lib/ff/sdio_stm32f1.c **** 
 224:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
 225:lib/ff/sdio_stm32f1.c ****   {
 226:lib/ff/sdio_stm32f1.c ****     /*!< CMD Response TimeOut (wait for CMDSENT flag) */
 227:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 228:lib/ff/sdio_stm32f1.c ****   }
 229:lib/ff/sdio_stm32f1.c **** 
 230:lib/ff/sdio_stm32f1.c ****   /*!< Configure the SDIO peripheral */
 231:lib/ff/sdio_stm32f1.c ****   /*!< SDIOCLK = HCLK, SDIO_CK = HCLK/(2 + SDIO_TRANSFER_CLK_DIV) */ 
 232:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_ClockDiv = SDIO_TRANSFER_CLK_DIV; 
 233:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_ClockEdge = SDIO_ClockEdge_Rising;
 234:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_ClockBypass = SDIO_ClockBypass_Disable;
 235:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_ClockPowerSave = SDIO_ClockPowerSave_Disable;
 236:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_BusWide = SDIO_BusWide_1b;
 237:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_HardwareFlowControl = SDIO_HardwareFlowControl_Disable;
 238:lib/ff/sdio_stm32f1.c ****   SDIO_Init(&SDIO_InitStructure);
 239:lib/ff/sdio_stm32f1.c **** 
 240:lib/ff/sdio_stm32f1.c ****   /*!< Enable the SDIO Interrupt */
 241:lib/ff/sdio_stm32f1.c ****   NVIC_InitStructure.NVIC_IRQChannel = SDIO_IRQn;
 242:lib/ff/sdio_stm32f1.c ****   NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 0;
 243:lib/ff/sdio_stm32f1.c ****   NVIC_InitStructure.NVIC_IRQChannelSubPriority = 0;
 244:lib/ff/sdio_stm32f1.c ****   NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;
 245:lib/ff/sdio_stm32f1.c ****   NVIC_Init(&NVIC_InitStructure);
 246:lib/ff/sdio_stm32f1.c **** 
 247:lib/ff/sdio_stm32f1.c ****   if (errorstatus == SD_OK)
 248:lib/ff/sdio_stm32f1.c ****   {
 249:lib/ff/sdio_stm32f1.c ****     /*----------------- Read CSD/CID MSD registers ------------------*/
 250:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_GetCardInfo(&SDCardInfo);
 251:lib/ff/sdio_stm32f1.c ****   }
 252:lib/ff/sdio_stm32f1.c **** 
 253:lib/ff/sdio_stm32f1.c ****   if (errorstatus == SD_OK)
 254:lib/ff/sdio_stm32f1.c ****   {
 255:lib/ff/sdio_stm32f1.c ****     /*----------------- Select Card --------------------------------*/
 256:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_SelectDeselect((uint32_t) (SDCardInfo.RCA << 16));
 257:lib/ff/sdio_stm32f1.c ****   }
 258:lib/ff/sdio_stm32f1.c **** 
 259:lib/ff/sdio_stm32f1.c ****   if (errorstatus == SD_OK)
 260:lib/ff/sdio_stm32f1.c ****   {
 261:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_EnableWideBusOperation(SDIO_BusWide_4b);
 262:lib/ff/sdio_stm32f1.c ****   }  
 263:lib/ff/sdio_stm32f1.c **** 
 264:lib/ff/sdio_stm32f1.c ****   /* Set Device Transfer Mode to DMA */
 265:lib/ff/sdio_stm32f1.c ****   if (errorstatus == SD_OK)
 266:lib/ff/sdio_stm32f1.c ****   {  
 267:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_SetDeviceMode(SD_DMA_MODE);
 268:lib/ff/sdio_stm32f1.c ****   }
 269:lib/ff/sdio_stm32f1.c **** 
 270:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
 271:lib/ff/sdio_stm32f1.c **** }
 272:lib/ff/sdio_stm32f1.c **** 
 273:lib/ff/sdio_stm32f1.c ****   
 274:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 275:lib/ff/sdio_stm32f1.c **** /*! 
 276:lib/ff/sdio_stm32f1.c ****     @brief  Gets the cuurent sd card data transfer status.
 277:lib/ff/sdio_stm32f1.c **** 	@param  None
 278:lib/ff/sdio_stm32f1.c ****     @retval SDTransferState: Data Transfer state.
 279:lib/ff/sdio_stm32f1.c **** 			This value can be: 
 280:lib/ff/sdio_stm32f1.c **** 			- SD_TRANSFER_OK: No data transfer is acting
 281:lib/ff/sdio_stm32f1.c **** 			- SD_TRANSFER_BUSY: Data transfer is acting
 282:lib/ff/sdio_stm32f1.c **** */
 283:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 284:lib/ff/sdio_stm32f1.c **** SDTransferState SD_GetStatus(void)
 285:lib/ff/sdio_stm32f1.c **** {
 286:lib/ff/sdio_stm32f1.c ****   SDCardState cardstate =  SD_CARD_TRANSFER;
 287:lib/ff/sdio_stm32f1.c **** 
 288:lib/ff/sdio_stm32f1.c ****   cardstate = SD_GetState();
 289:lib/ff/sdio_stm32f1.c ****   
 290:lib/ff/sdio_stm32f1.c ****   if (cardstate == SD_CARD_TRANSFER)
 291:lib/ff/sdio_stm32f1.c ****   {
 292:lib/ff/sdio_stm32f1.c ****     return(SD_TRANSFER_OK);
 293:lib/ff/sdio_stm32f1.c ****   }
 294:lib/ff/sdio_stm32f1.c ****   else if(cardstate == SD_CARD_ERROR)
 295:lib/ff/sdio_stm32f1.c ****   {
 296:lib/ff/sdio_stm32f1.c ****     return (SD_TRANSFER_ERROR);
 297:lib/ff/sdio_stm32f1.c ****   }
 298:lib/ff/sdio_stm32f1.c ****   else
 299:lib/ff/sdio_stm32f1.c ****   {
 300:lib/ff/sdio_stm32f1.c ****     return(SD_TRANSFER_BUSY);
 301:lib/ff/sdio_stm32f1.c ****   }
 302:lib/ff/sdio_stm32f1.c **** }
 303:lib/ff/sdio_stm32f1.c **** 
 304:lib/ff/sdio_stm32f1.c **** 
 305:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 306:lib/ff/sdio_stm32f1.c **** /*! 
 307:lib/ff/sdio_stm32f1.c ****     @brief  Returns the current card's state.
 308:lib/ff/sdio_stm32f1.c **** 	@param  None
 309:lib/ff/sdio_stm32f1.c ****     @retval SDCardState: SD Card Error or SD Card Current State.
 310:lib/ff/sdio_stm32f1.c **** */
 311:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 312:lib/ff/sdio_stm32f1.c **** SDCardState SD_GetState(void)
 313:lib/ff/sdio_stm32f1.c **** {
 314:lib/ff/sdio_stm32f1.c ****   uint32_t resp1 = 0;
 315:lib/ff/sdio_stm32f1.c ****   
 316:lib/ff/sdio_stm32f1.c ****   if(SD_Detect()== SD_PRESENT)
 317:lib/ff/sdio_stm32f1.c ****   {
 318:lib/ff/sdio_stm32f1.c ****     if (SD_SendStatus(&resp1) != SD_OK)
 319:lib/ff/sdio_stm32f1.c ****     {
 320:lib/ff/sdio_stm32f1.c ****       return SD_CARD_ERROR;
 321:lib/ff/sdio_stm32f1.c ****     }
 322:lib/ff/sdio_stm32f1.c ****     else
 323:lib/ff/sdio_stm32f1.c ****     {
 324:lib/ff/sdio_stm32f1.c ****       return (SDCardState)((resp1 >> 9) & 0x0F);
 325:lib/ff/sdio_stm32f1.c ****     }
 326:lib/ff/sdio_stm32f1.c ****   }
 327:lib/ff/sdio_stm32f1.c ****   else
 328:lib/ff/sdio_stm32f1.c ****   {
 329:lib/ff/sdio_stm32f1.c ****     return SD_CARD_ERROR;
 330:lib/ff/sdio_stm32f1.c ****   }
 331:lib/ff/sdio_stm32f1.c **** }
 332:lib/ff/sdio_stm32f1.c **** 
 333:lib/ff/sdio_stm32f1.c **** 
 334:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 335:lib/ff/sdio_stm32f1.c **** /*! 
 336:lib/ff/sdio_stm32f1.c ****     @brief  Detect if SD card is correctly plugged in the memory slot.
 337:lib/ff/sdio_stm32f1.c **** 	@param  None
 338:lib/ff/sdio_stm32f1.c ****     @retval Return if SD is detected or not
 339:lib/ff/sdio_stm32f1.c **** */
 340:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 341:lib/ff/sdio_stm32f1.c **** uint8_t SD_Detect(void)
 342:lib/ff/sdio_stm32f1.c **** {
 343:lib/ff/sdio_stm32f1.c ****   __IO uint8_t status = SD_PRESENT;
 344:lib/ff/sdio_stm32f1.c **** 
 345:lib/ff/sdio_stm32f1.c ****   /*!< Check GPIO to detect SD */
 346:lib/ff/sdio_stm32f1.c ****   /* Nemui added: NO SD_DETECT Pport on@STM32Primer2's MicroSD Card Slot! */
 347:lib/ff/sdio_stm32f1.c ****   /*
 348:lib/ff/sdio_stm32f1.c ****   if (GPIO_ReadInputDataBit(SD_DETECT_GPIO_PORT, SD_DETECT_PIN) != Bit_RESET)
 349:lib/ff/sdio_stm32f1.c ****   {
 350:lib/ff/sdio_stm32f1.c ****     status = SD_NOT_PRESENT;
 351:lib/ff/sdio_stm32f1.c ****   }
 352:lib/ff/sdio_stm32f1.c ****   */
 353:lib/ff/sdio_stm32f1.c ****   return status;
 354:lib/ff/sdio_stm32f1.c **** }
 355:lib/ff/sdio_stm32f1.c **** 
 356:lib/ff/sdio_stm32f1.c **** 
 357:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 358:lib/ff/sdio_stm32f1.c **** /*! 
 359:lib/ff/sdio_stm32f1.c ****     @brief  Enquires cards about their operating voltage and configures 
 360:lib/ff/sdio_stm32f1.c **** 			clock controls.
 361:lib/ff/sdio_stm32f1.c **** 	@param  None
 362:lib/ff/sdio_stm32f1.c ****     @retval SD_Error: SD Card Error code.
 363:lib/ff/sdio_stm32f1.c **** */
 364:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 365:lib/ff/sdio_stm32f1.c **** SD_Error SD_PowerON(void)
 366:lib/ff/sdio_stm32f1.c **** {
 367:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
 368:lib/ff/sdio_stm32f1.c ****   uint32_t response = 0, count = 0, validvoltage = 0;
 369:lib/ff/sdio_stm32f1.c ****   uint32_t SDType = SD_STD_CAPACITY;
 370:lib/ff/sdio_stm32f1.c **** 
 371:lib/ff/sdio_stm32f1.c ****   /*!< Power ON Sequence -----------------------------------------------------*/
 372:lib/ff/sdio_stm32f1.c ****   /*!< Configure the SDIO peripheral */
 373:lib/ff/sdio_stm32f1.c ****   /*!< SDIOCLK = HCLK, SDIO_CK = HCLK/(2 + SDIO_INIT_CLK_DIV) */
 374:lib/ff/sdio_stm32f1.c ****   /*!< SDIO_CK for initialization should not exceed 400 KHz */  
 375:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_ClockDiv = SDIO_INIT_CLK_DIV;
 376:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_ClockEdge = SDIO_ClockEdge_Rising;
 377:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_ClockBypass = SDIO_ClockBypass_Disable;
 378:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_ClockPowerSave = SDIO_ClockPowerSave_Disable;
 379:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_BusWide = SDIO_BusWide_1b;
 380:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_HardwareFlowControl = SDIO_HardwareFlowControl_Disable;
 381:lib/ff/sdio_stm32f1.c ****   SDIO_Init(&SDIO_InitStructure);
 382:lib/ff/sdio_stm32f1.c **** 
 383:lib/ff/sdio_stm32f1.c ****   /*!< Set Power State to ON */
 384:lib/ff/sdio_stm32f1.c ****   SDIO_SetPowerState(SDIO_PowerState_ON);
 385:lib/ff/sdio_stm32f1.c **** 
 386:lib/ff/sdio_stm32f1.c ****   /*!< Enable SDIO Clock */
 387:lib/ff/sdio_stm32f1.c ****   SDIO_ClockCmd(ENABLE);
 388:lib/ff/sdio_stm32f1.c **** 
 389:lib/ff/sdio_stm32f1.c ****   /*!< CMD0: GO_IDLE_STATE ---------------------------------------------------*/
 390:lib/ff/sdio_stm32f1.c ****   /*!< No CMD response required */
 391:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = 0x0;
 392:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_GO_IDLE_STATE;
 393:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_No;
 394:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 395:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 396:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 397:lib/ff/sdio_stm32f1.c **** 
 398:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdError();
 399:lib/ff/sdio_stm32f1.c **** 
 400:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
 401:lib/ff/sdio_stm32f1.c ****   {
 402:lib/ff/sdio_stm32f1.c ****     /*!< CMD Response TimeOut (wait for CMDSENT flag) */
 403:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 404:lib/ff/sdio_stm32f1.c ****   }
 405:lib/ff/sdio_stm32f1.c **** 
 406:lib/ff/sdio_stm32f1.c ****   /*!< CMD8: SEND_IF_COND ----------------------------------------------------*/
 407:lib/ff/sdio_stm32f1.c ****   /*!< Send CMD8 to verify SD card interface operating condition */
 408:lib/ff/sdio_stm32f1.c ****   /*!< Argument: - [31:12]: Reserved (shall be set to '0')
 409:lib/ff/sdio_stm32f1.c ****                - [11:8]: Supply Voltage (VHS) 0x1 (Range: 2.7-3.6 V)
 410:lib/ff/sdio_stm32f1.c ****                - [7:0]: Check Pattern (recommended 0xAA) */
 411:lib/ff/sdio_stm32f1.c ****   /*!< CMD Response: R7 */
 412:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = SD_CHECK_PATTERN;
 413:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SDIO_SEND_IF_COND;
 414:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 415:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 416:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 417:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 418:lib/ff/sdio_stm32f1.c **** 
 419:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp7Error();
 420:lib/ff/sdio_stm32f1.c **** 
 421:lib/ff/sdio_stm32f1.c ****   if (errorstatus == SD_OK)
 422:lib/ff/sdio_stm32f1.c ****   {
 423:lib/ff/sdio_stm32f1.c ****     CardType = SDIO_STD_CAPACITY_SD_CARD_V2_0; /*!< SD Card 2.0 */
 424:lib/ff/sdio_stm32f1.c ****     SDType = SD_HIGH_CAPACITY;
 425:lib/ff/sdio_stm32f1.c ****   }
 426:lib/ff/sdio_stm32f1.c ****   else
 427:lib/ff/sdio_stm32f1.c ****   {
 428:lib/ff/sdio_stm32f1.c ****     /*!< CMD55 */
 429:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Argument = 0x00;
 430:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_CMD;
 431:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 432:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 433:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 434:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
 435:lib/ff/sdio_stm32f1.c ****     errorstatus = CmdResp1Error(SD_CMD_APP_CMD);
 436:lib/ff/sdio_stm32f1.c ****   }
 437:lib/ff/sdio_stm32f1.c ****   /*!< CMD55 */
 438:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = 0x00;
 439:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_CMD;
 440:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 441:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 442:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 443:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 444:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_APP_CMD);
 445:lib/ff/sdio_stm32f1.c **** 
 446:lib/ff/sdio_stm32f1.c ****   /*!< If errorstatus is Command TimeOut, it is a MMC card */
 447:lib/ff/sdio_stm32f1.c ****   /*!< If errorstatus is SD_OK it is a SD card: SD card 2.0 (voltage range mismatch)
 448:lib/ff/sdio_stm32f1.c ****      or SD card 1.x */
 449:lib/ff/sdio_stm32f1.c ****   if (errorstatus == SD_OK)
 450:lib/ff/sdio_stm32f1.c ****   {
 451:lib/ff/sdio_stm32f1.c ****     /*!< SD CARD */
 452:lib/ff/sdio_stm32f1.c ****     /*!< Send ACMD41 SD_APP_OP_COND with Argument 0x80100000 */
 453:lib/ff/sdio_stm32f1.c ****     while ((!validvoltage) && (count < SD_MAX_VOLT_TRIAL))
 454:lib/ff/sdio_stm32f1.c ****     {
 455:lib/ff/sdio_stm32f1.c **** 
 456:lib/ff/sdio_stm32f1.c ****       /*!< SEND CMD55 APP_CMD with RCA as 0 */
 457:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Argument = 0x00;
 458:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_CMD;
 459:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 460:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 461:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 462:lib/ff/sdio_stm32f1.c ****       SDIO_SendCommand(&SDIO_CmdInitStructure);
 463:lib/ff/sdio_stm32f1.c **** 
 464:lib/ff/sdio_stm32f1.c ****       errorstatus = CmdResp1Error(SD_CMD_APP_CMD);
 465:lib/ff/sdio_stm32f1.c **** 
 466:lib/ff/sdio_stm32f1.c ****       if (errorstatus != SD_OK)
 467:lib/ff/sdio_stm32f1.c ****       {
 468:lib/ff/sdio_stm32f1.c ****         return(errorstatus);
 469:lib/ff/sdio_stm32f1.c ****       }
 470:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Argument = SD_VOLTAGE_WINDOW_SD  		| \
 471:lib/ff/sdio_stm32f1.c **** 											SD_SDXC_XPC_FULLPOWER 		| \
 472:lib/ff/sdio_stm32f1.c **** 											SD_SDXC_S18R_REGULAR_VOLT	| \
 473:lib/ff/sdio_stm32f1.c **** 											SDType;
 474:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SD_APP_OP_COND;
 475:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 476:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 477:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 478:lib/ff/sdio_stm32f1.c ****       SDIO_SendCommand(&SDIO_CmdInitStructure);
 479:lib/ff/sdio_stm32f1.c **** 
 480:lib/ff/sdio_stm32f1.c ****       errorstatus = CmdResp3Error();
 481:lib/ff/sdio_stm32f1.c ****       if (errorstatus != SD_OK)
 482:lib/ff/sdio_stm32f1.c ****       {
 483:lib/ff/sdio_stm32f1.c ****         return(errorstatus);
 484:lib/ff/sdio_stm32f1.c ****       }
 485:lib/ff/sdio_stm32f1.c **** 
 486:lib/ff/sdio_stm32f1.c ****       response = SDIO_GetResponse(SDIO_RESP1);
 487:lib/ff/sdio_stm32f1.c ****       validvoltage = (((response >> 31) == 1) ? 1 : 0);
 488:lib/ff/sdio_stm32f1.c ****       count++;
 489:lib/ff/sdio_stm32f1.c ****     }
 490:lib/ff/sdio_stm32f1.c ****     if (count >= SD_MAX_VOLT_TRIAL)
 491:lib/ff/sdio_stm32f1.c ****     {
 492:lib/ff/sdio_stm32f1.c ****       errorstatus = SD_INVALID_VOLTRANGE;
 493:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
 494:lib/ff/sdio_stm32f1.c ****     }
 495:lib/ff/sdio_stm32f1.c **** 
 496:lib/ff/sdio_stm32f1.c ****     if (response &= SD_HIGH_CAPACITY)
 497:lib/ff/sdio_stm32f1.c ****     {
 498:lib/ff/sdio_stm32f1.c ****       CardType = SDIO_HIGH_CAPACITY_SD_CARD;
 499:lib/ff/sdio_stm32f1.c ****     }
 500:lib/ff/sdio_stm32f1.c **** 
 501:lib/ff/sdio_stm32f1.c ****   }/*!< else MMC Card */
 502:lib/ff/sdio_stm32f1.c **** 
 503:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
 504:lib/ff/sdio_stm32f1.c **** }
 505:lib/ff/sdio_stm32f1.c **** 
 506:lib/ff/sdio_stm32f1.c **** 
 507:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 508:lib/ff/sdio_stm32f1.c **** /*! 
 509:lib/ff/sdio_stm32f1.c ****     @brief  Turns the SDIO output signals off.
 510:lib/ff/sdio_stm32f1.c **** 	@param  None
 511:lib/ff/sdio_stm32f1.c ****     @retval SD_Error: SD Card Error code.
 512:lib/ff/sdio_stm32f1.c **** */
 513:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 514:lib/ff/sdio_stm32f1.c **** SD_Error SD_PowerOFF(void)
 515:lib/ff/sdio_stm32f1.c **** {
 516:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
 517:lib/ff/sdio_stm32f1.c **** 
 518:lib/ff/sdio_stm32f1.c ****   /*!< Set Power State to OFF */
 519:lib/ff/sdio_stm32f1.c ****   SDIO_SetPowerState(SDIO_PowerState_OFF);
 520:lib/ff/sdio_stm32f1.c **** 
 521:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
 522:lib/ff/sdio_stm32f1.c **** }
 523:lib/ff/sdio_stm32f1.c **** 
 524:lib/ff/sdio_stm32f1.c **** 
 525:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 526:lib/ff/sdio_stm32f1.c **** /*! 
 527:lib/ff/sdio_stm32f1.c ****     @brief  Intialises all cards or single card as the case may be Card(s) come 
 528:lib/ff/sdio_stm32f1.c **** 			into standby state.
 529:lib/ff/sdio_stm32f1.c **** 	@param  None
 530:lib/ff/sdio_stm32f1.c ****     @retval SD_Error: SD Card Error code.
 531:lib/ff/sdio_stm32f1.c **** */
 532:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 533:lib/ff/sdio_stm32f1.c **** SD_Error SD_InitializeCards(void)
 534:lib/ff/sdio_stm32f1.c **** {
 535:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
 536:lib/ff/sdio_stm32f1.c ****   uint16_t rca = 0x01;
 537:lib/ff/sdio_stm32f1.c **** 
 538:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetPowerState() == SDIO_PowerState_OFF)
 539:lib/ff/sdio_stm32f1.c ****   {
 540:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_REQUEST_NOT_APPLICABLE;
 541:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 542:lib/ff/sdio_stm32f1.c ****   }
 543:lib/ff/sdio_stm32f1.c **** 
 544:lib/ff/sdio_stm32f1.c ****   if (SDIO_SECURE_DIGITAL_IO_CARD != CardType)
 545:lib/ff/sdio_stm32f1.c ****   {
 546:lib/ff/sdio_stm32f1.c ****     /*!< Send CMD2 ALL_SEND_CID */
 547:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Argument = 0x0;
 548:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_ALL_SEND_CID;
 549:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Long;
 550:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 551:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 552:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
 553:lib/ff/sdio_stm32f1.c **** 
 554:lib/ff/sdio_stm32f1.c ****     errorstatus = CmdResp2Error();
 555:lib/ff/sdio_stm32f1.c **** 
 556:lib/ff/sdio_stm32f1.c ****     if (SD_OK != errorstatus)
 557:lib/ff/sdio_stm32f1.c ****     {
 558:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
 559:lib/ff/sdio_stm32f1.c ****     }
 560:lib/ff/sdio_stm32f1.c **** 
 561:lib/ff/sdio_stm32f1.c ****     CID_Tab[0] = SDIO_GetResponse(SDIO_RESP1);
 562:lib/ff/sdio_stm32f1.c ****     CID_Tab[1] = SDIO_GetResponse(SDIO_RESP2);
 563:lib/ff/sdio_stm32f1.c ****     CID_Tab[2] = SDIO_GetResponse(SDIO_RESP3);
 564:lib/ff/sdio_stm32f1.c ****     CID_Tab[3] = SDIO_GetResponse(SDIO_RESP4);
 565:lib/ff/sdio_stm32f1.c ****   }
 566:lib/ff/sdio_stm32f1.c ****   if ((SDIO_STD_CAPACITY_SD_CARD_V1_1 == CardType) ||  (SDIO_STD_CAPACITY_SD_CARD_V2_0 == CardType)
 567:lib/ff/sdio_stm32f1.c ****       ||  (SDIO_HIGH_CAPACITY_SD_CARD == CardType))
 568:lib/ff/sdio_stm32f1.c ****   {
 569:lib/ff/sdio_stm32f1.c ****     /*!< Send CMD3 SET_REL_ADDR with argument 0 */
 570:lib/ff/sdio_stm32f1.c ****     /*!< SD Card publishes its RCA. */
 571:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Argument = 0x00;
 572:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SET_REL_ADDR;
 573:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 574:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 575:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 576:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
 577:lib/ff/sdio_stm32f1.c **** 
 578:lib/ff/sdio_stm32f1.c ****     errorstatus = CmdResp6Error(SD_CMD_SET_REL_ADDR, &rca);
 579:lib/ff/sdio_stm32f1.c **** 
 580:lib/ff/sdio_stm32f1.c ****     if (SD_OK != errorstatus)
 581:lib/ff/sdio_stm32f1.c ****     {
 582:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
 583:lib/ff/sdio_stm32f1.c ****     }
 584:lib/ff/sdio_stm32f1.c ****   }
 585:lib/ff/sdio_stm32f1.c **** 
 586:lib/ff/sdio_stm32f1.c ****   if (SDIO_SECURE_DIGITAL_IO_CARD != CardType)
 587:lib/ff/sdio_stm32f1.c ****   {
 588:lib/ff/sdio_stm32f1.c ****     RCA = rca;
 589:lib/ff/sdio_stm32f1.c **** 
 590:lib/ff/sdio_stm32f1.c ****     /*!< Send CMD9 SEND_CSD with argument as card's RCA */
 591:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Argument = (uint32_t)(rca << 16);
 592:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SEND_CSD;
 593:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Long;
 594:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 595:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 596:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
 597:lib/ff/sdio_stm32f1.c **** 
 598:lib/ff/sdio_stm32f1.c ****     errorstatus = CmdResp2Error();
 599:lib/ff/sdio_stm32f1.c **** 
 600:lib/ff/sdio_stm32f1.c ****     if (SD_OK != errorstatus)
 601:lib/ff/sdio_stm32f1.c ****     {
 602:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
 603:lib/ff/sdio_stm32f1.c ****     }
 604:lib/ff/sdio_stm32f1.c **** 
 605:lib/ff/sdio_stm32f1.c ****     CSD_Tab[0] = SDIO_GetResponse(SDIO_RESP1);
 606:lib/ff/sdio_stm32f1.c ****     CSD_Tab[1] = SDIO_GetResponse(SDIO_RESP2);
 607:lib/ff/sdio_stm32f1.c ****     CSD_Tab[2] = SDIO_GetResponse(SDIO_RESP3);
 608:lib/ff/sdio_stm32f1.c ****     CSD_Tab[3] = SDIO_GetResponse(SDIO_RESP4);
 609:lib/ff/sdio_stm32f1.c ****   }
 610:lib/ff/sdio_stm32f1.c **** 
 611:lib/ff/sdio_stm32f1.c ****   errorstatus = SD_OK; /*!< All cards get intialized */
 612:lib/ff/sdio_stm32f1.c **** 
 613:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
 614:lib/ff/sdio_stm32f1.c **** }
 615:lib/ff/sdio_stm32f1.c **** 
 616:lib/ff/sdio_stm32f1.c **** 
 617:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 618:lib/ff/sdio_stm32f1.c **** /*! 
 619:lib/ff/sdio_stm32f1.c ****     @brief  Returns information about specific card.
 620:lib/ff/sdio_stm32f1.c **** 	@param  cardinfo: pointer to a SD_CardInfo structure that contains all SD card 
 621:lib/ff/sdio_stm32f1.c **** 			information.
 622:lib/ff/sdio_stm32f1.c ****     @retval SD_Error: SD Card Error code.
 623:lib/ff/sdio_stm32f1.c **** */
 624:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 625:lib/ff/sdio_stm32f1.c **** SD_Error SD_GetCardInfo(SD_CardInfo *cardinfo)
 626:lib/ff/sdio_stm32f1.c **** {
 627:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
 628:lib/ff/sdio_stm32f1.c ****   uint8_t tmp = 0;
 629:lib/ff/sdio_stm32f1.c **** 
 630:lib/ff/sdio_stm32f1.c ****   cardinfo->CardType = (uint8_t)CardType;
 631:lib/ff/sdio_stm32f1.c ****   cardinfo->RCA = (uint16_t)RCA;
 632:lib/ff/sdio_stm32f1.c **** 
 633:lib/ff/sdio_stm32f1.c ****   /*!< Byte 0 */
 634:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CSD_Tab[0] & 0xFF000000) >> 24);
 635:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.CSDStruct = (tmp & 0xC0) >> 6;
 636:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.SysSpecVersion = (tmp & 0x3C) >> 2;
 637:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.Reserved1 = tmp & 0x03;
 638:lib/ff/sdio_stm32f1.c **** 
 639:lib/ff/sdio_stm32f1.c ****   /*!< Byte 1 */
 640:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CSD_Tab[0] & 0x00FF0000) >> 16);
 641:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.TAAC = tmp;
 642:lib/ff/sdio_stm32f1.c **** 
 643:lib/ff/sdio_stm32f1.c ****   /*!< Byte 2 */
 644:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CSD_Tab[0] & 0x0000FF00) >> 8);
 645:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.NSAC = tmp;
 646:lib/ff/sdio_stm32f1.c **** 
 647:lib/ff/sdio_stm32f1.c ****   /*!< Byte 3 */
 648:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)(CSD_Tab[0] & 0x000000FF);
 649:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.MaxBusClkFrec = tmp;
 650:lib/ff/sdio_stm32f1.c **** 
 651:lib/ff/sdio_stm32f1.c ****   /*!< Byte 4 */
 652:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CSD_Tab[1] & 0xFF000000) >> 24);
 653:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.CardComdClasses = tmp << 4;
 654:lib/ff/sdio_stm32f1.c **** 
 655:lib/ff/sdio_stm32f1.c ****   /*!< Byte 5 */
 656:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CSD_Tab[1] & 0x00FF0000) >> 16);
 657:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.CardComdClasses |= (tmp & 0xF0) >> 4;
 658:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.RdBlockLen = tmp & 0x0F;
 659:lib/ff/sdio_stm32f1.c **** 
 660:lib/ff/sdio_stm32f1.c ****   /*!< Byte 6 */
 661:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CSD_Tab[1] & 0x0000FF00) >> 8);
 662:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.PartBlockRead = (tmp & 0x80) >> 7;
 663:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.WrBlockMisalign = (tmp & 0x40) >> 6;
 664:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.RdBlockMisalign = (tmp & 0x20) >> 5;
 665:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.DSRImpl = (tmp & 0x10) >> 4;
 666:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.Reserved2 = 0; /*!< Reserved */
 667:lib/ff/sdio_stm32f1.c **** 
 668:lib/ff/sdio_stm32f1.c ****   if ((CardType == SDIO_STD_CAPACITY_SD_CARD_V1_1) || (CardType == SDIO_STD_CAPACITY_SD_CARD_V2_0))
 669:lib/ff/sdio_stm32f1.c ****   {
 670:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.DeviceSize = (tmp & 0x03) << 10;
 671:lib/ff/sdio_stm32f1.c **** 
 672:lib/ff/sdio_stm32f1.c ****     /*!< Byte 7 */
 673:lib/ff/sdio_stm32f1.c ****     tmp = (uint8_t)(CSD_Tab[1] & 0x000000FF);
 674:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.DeviceSize |= (tmp) << 2;
 675:lib/ff/sdio_stm32f1.c **** 
 676:lib/ff/sdio_stm32f1.c ****     /*!< Byte 8 */
 677:lib/ff/sdio_stm32f1.c ****     tmp = (uint8_t)((CSD_Tab[2] & 0xFF000000) >> 24);
 678:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.DeviceSize |= (tmp & 0xC0) >> 6;
 679:lib/ff/sdio_stm32f1.c **** 
 680:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.MaxRdCurrentVDDMin = (tmp & 0x38) >> 3;
 681:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.MaxRdCurrentVDDMax = (tmp & 0x07);
 682:lib/ff/sdio_stm32f1.c **** 
 683:lib/ff/sdio_stm32f1.c ****     /*!< Byte 9 */
 684:lib/ff/sdio_stm32f1.c ****     tmp = (uint8_t)((CSD_Tab[2] & 0x00FF0000) >> 16);
 685:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.MaxWrCurrentVDDMin = (tmp & 0xE0) >> 5;
 686:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.MaxWrCurrentVDDMax = (tmp & 0x1C) >> 2;
 687:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.DeviceSizeMul = (tmp & 0x03) << 1;
 688:lib/ff/sdio_stm32f1.c ****     /*!< Byte 10 */
 689:lib/ff/sdio_stm32f1.c ****     tmp = (uint8_t)((CSD_Tab[2] & 0x0000FF00) >> 8);
 690:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.DeviceSizeMul |= (tmp & 0x80) >> 7;
 691:lib/ff/sdio_stm32f1.c ****     
 692:lib/ff/sdio_stm32f1.c ****     cardinfo->CardCapacity = (cardinfo->SD_csd.DeviceSize + 1) ;
 693:lib/ff/sdio_stm32f1.c ****     cardinfo->CardCapacity *= (1 << (cardinfo->SD_csd.DeviceSizeMul + 2));
 694:lib/ff/sdio_stm32f1.c ****     cardinfo->CardBlockSize = 1 << (cardinfo->SD_csd.RdBlockLen);
 695:lib/ff/sdio_stm32f1.c ****     cardinfo->CardCapacity *= cardinfo->CardBlockSize;
 696:lib/ff/sdio_stm32f1.c ****   }
 697:lib/ff/sdio_stm32f1.c ****   else if (CardType == SDIO_HIGH_CAPACITY_SD_CARD)
 698:lib/ff/sdio_stm32f1.c ****   {
 699:lib/ff/sdio_stm32f1.c ****     /*!< Byte 7 */
 700:lib/ff/sdio_stm32f1.c ****     tmp = (uint8_t)(CSD_Tab[1] & 0x000000FF);
 701:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.DeviceSize = (tmp & 0x3F) << 16;
 702:lib/ff/sdio_stm32f1.c **** 
 703:lib/ff/sdio_stm32f1.c ****     /*!< Byte 8 */
 704:lib/ff/sdio_stm32f1.c ****     tmp = (uint8_t)((CSD_Tab[2] & 0xFF000000) >> 24);
 705:lib/ff/sdio_stm32f1.c **** 
 706:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.DeviceSize |= (tmp << 8);
 707:lib/ff/sdio_stm32f1.c **** 
 708:lib/ff/sdio_stm32f1.c ****     /*!< Byte 9 */
 709:lib/ff/sdio_stm32f1.c ****     tmp = (uint8_t)((CSD_Tab[2] & 0x00FF0000) >> 16);
 710:lib/ff/sdio_stm32f1.c **** 
 711:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.DeviceSize |= (tmp);
 712:lib/ff/sdio_stm32f1.c **** 
 713:lib/ff/sdio_stm32f1.c ****     /*!< Byte 10 */
 714:lib/ff/sdio_stm32f1.c ****     tmp = (uint8_t)((CSD_Tab[2] & 0x0000FF00) >> 8);
 715:lib/ff/sdio_stm32f1.c ****     /* nemui fixed due to SD2.00 Capacity fomula is Size = (C_SIZE+1)~2^19 */
 716:lib/ff/sdio_stm32f1.c ****     cardinfo->CardCapacity = ((uint64_t)cardinfo->SD_csd.DeviceSize + 1) * 512 * 1024;
 717:lib/ff/sdio_stm32f1.c ****     cardinfo->CardBlockSize = 512;    
 718:lib/ff/sdio_stm32f1.c ****   }
 719:lib/ff/sdio_stm32f1.c **** 
 720:lib/ff/sdio_stm32f1.c **** 
 721:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.EraseGrSize = (tmp & 0x40) >> 6;
 722:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.EraseGrMul = (tmp & 0x3F) << 1;
 723:lib/ff/sdio_stm32f1.c **** 
 724:lib/ff/sdio_stm32f1.c ****   /*!< Byte 11 */
 725:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)(CSD_Tab[2] & 0x000000FF);
 726:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.EraseGrMul |= (tmp & 0x80) >> 7;
 727:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.WrProtectGrSize = (tmp & 0x7F);
 728:lib/ff/sdio_stm32f1.c **** 
 729:lib/ff/sdio_stm32f1.c ****   /*!< Byte 12 */
 730:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CSD_Tab[3] & 0xFF000000) >> 24);
 731:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.WrProtectGrEnable = (tmp & 0x80) >> 7;
 732:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.ManDeflECC = (tmp & 0x60) >> 5;
 733:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.WrSpeedFact = (tmp & 0x1C) >> 2;
 734:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.MaxWrBlockLen = (tmp & 0x03) << 2;
 735:lib/ff/sdio_stm32f1.c **** 
 736:lib/ff/sdio_stm32f1.c ****   /*!< Byte 13 */
 737:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CSD_Tab[3] & 0x00FF0000) >> 16);
 738:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.MaxWrBlockLen |= (tmp & 0xC0) >> 6;
 739:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.WriteBlockPaPartial = (tmp & 0x20) >> 5;
 740:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.Reserved3 = 0;
 741:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.ContentProtectAppli = (tmp & 0x01);
 742:lib/ff/sdio_stm32f1.c **** 
 743:lib/ff/sdio_stm32f1.c ****   /*!< Byte 14 */
 744:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CSD_Tab[3] & 0x0000FF00) >> 8);
 745:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.FileFormatGrouop = (tmp & 0x80) >> 7;
 746:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.CopyFlag = (tmp & 0x40) >> 6;
 747:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.PermWrProtect = (tmp & 0x20) >> 5;
 748:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.TempWrProtect = (tmp & 0x10) >> 4;
 749:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.FileFormat = (tmp & 0x0C) >> 2;
 750:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.ECC = (tmp & 0x03);
 751:lib/ff/sdio_stm32f1.c **** 
 752:lib/ff/sdio_stm32f1.c ****   /*!< Byte 15 */
 753:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)(CSD_Tab[3] & 0x000000FF);
 754:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.CSD_CRC = (tmp & 0xFE) >> 1;
 755:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.Reserved4 = 1;
 756:lib/ff/sdio_stm32f1.c **** 
 757:lib/ff/sdio_stm32f1.c **** 
 758:lib/ff/sdio_stm32f1.c ****   /*!< Byte 0 */
 759:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CID_Tab[0] & 0xFF000000) >> 24);
 760:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ManufacturerID = tmp;
 761:lib/ff/sdio_stm32f1.c **** 
 762:lib/ff/sdio_stm32f1.c ****   /*!< Byte 1 */
 763:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CID_Tab[0] & 0x00FF0000) >> 16);
 764:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.OEM_AppliID = tmp << 8;
 765:lib/ff/sdio_stm32f1.c **** 
 766:lib/ff/sdio_stm32f1.c ****   /*!< Byte 2 */
 767:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CID_Tab[0] & 0x000000FF00) >> 8);
 768:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.OEM_AppliID |= tmp;
 769:lib/ff/sdio_stm32f1.c **** 
 770:lib/ff/sdio_stm32f1.c ****   /*!< Byte 3 */
 771:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)(CID_Tab[0] & 0x000000FF);
 772:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdName1 = tmp << 24;
 773:lib/ff/sdio_stm32f1.c **** 
 774:lib/ff/sdio_stm32f1.c ****   /*!< Byte 4 */
 775:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CID_Tab[1] & 0xFF000000) >> 24);
 776:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdName1 |= tmp << 16;
 777:lib/ff/sdio_stm32f1.c **** 
 778:lib/ff/sdio_stm32f1.c ****   /*!< Byte 5 */
 779:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CID_Tab[1] & 0x00FF0000) >> 16);
 780:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdName1 |= tmp << 8;
 781:lib/ff/sdio_stm32f1.c **** 
 782:lib/ff/sdio_stm32f1.c ****   /*!< Byte 6 */
 783:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CID_Tab[1] & 0x0000FF00) >> 8);
 784:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdName1 |= tmp;
 785:lib/ff/sdio_stm32f1.c **** 
 786:lib/ff/sdio_stm32f1.c ****   /*!< Byte 7 */
 787:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)(CID_Tab[1] & 0x000000FF);
 788:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdName2 = tmp;
 789:lib/ff/sdio_stm32f1.c **** 
 790:lib/ff/sdio_stm32f1.c ****   /*!< Byte 8 */
 791:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CID_Tab[2] & 0xFF000000) >> 24);
 792:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdRev = tmp;
 793:lib/ff/sdio_stm32f1.c **** 
 794:lib/ff/sdio_stm32f1.c ****   /*!< Byte 9 */
 795:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CID_Tab[2] & 0x00FF0000) >> 16);
 796:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdSN = tmp << 24;
 797:lib/ff/sdio_stm32f1.c **** 
 798:lib/ff/sdio_stm32f1.c ****   /*!< Byte 10 */
 799:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CID_Tab[2] & 0x0000FF00) >> 8);
 800:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdSN |= tmp << 16;
 801:lib/ff/sdio_stm32f1.c **** 
 802:lib/ff/sdio_stm32f1.c ****   /*!< Byte 11 */
 803:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)(CID_Tab[2] & 0x000000FF);
 804:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdSN |= tmp << 8;
 805:lib/ff/sdio_stm32f1.c **** 
 806:lib/ff/sdio_stm32f1.c ****   /*!< Byte 12 */
 807:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CID_Tab[3] & 0xFF000000) >> 24);
 808:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdSN |= tmp;
 809:lib/ff/sdio_stm32f1.c **** 
 810:lib/ff/sdio_stm32f1.c ****   /*!< Byte 13 */
 811:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CID_Tab[3] & 0x00FF0000) >> 16);
 812:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.Reserved1 |= (tmp & 0xF0) >> 4;
 813:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ManufactDate = (tmp & 0x0F) << 8;
 814:lib/ff/sdio_stm32f1.c **** 
 815:lib/ff/sdio_stm32f1.c ****   /*!< Byte 14 */
 816:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CID_Tab[3] & 0x0000FF00) >> 8);
 817:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ManufactDate |= tmp;
 818:lib/ff/sdio_stm32f1.c **** 
 819:lib/ff/sdio_stm32f1.c ****   /*!< Byte 15 */
 820:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)(CID_Tab[3] & 0x000000FF);
 821:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.CID_CRC = (tmp & 0xFE) >> 1;
 822:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.Reserved2 = 1;
 823:lib/ff/sdio_stm32f1.c ****   
 824:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
 825:lib/ff/sdio_stm32f1.c **** }
 826:lib/ff/sdio_stm32f1.c **** 
 827:lib/ff/sdio_stm32f1.c **** 
 828:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 829:lib/ff/sdio_stm32f1.c **** /*! 
 830:lib/ff/sdio_stm32f1.c **** 	@brief  Enables wide bus opeartion for the requeseted card if supported by 
 831:lib/ff/sdio_stm32f1.c **** 			card.
 832:lib/ff/sdio_stm32f1.c **** 	@param  WideMode: Specifies the SD card wide bus mode. 
 833:lib/ff/sdio_stm32f1.c **** 		This parameter can be one of the following values:
 834:lib/ff/sdio_stm32f1.c **** 		@arg SDIO_BusWide_8b: 8-bit data transfer (Only for MMC)
 835:lib/ff/sdio_stm32f1.c **** 		@arg SDIO_BusWide_4b: 4-bit data transfer
 836:lib/ff/sdio_stm32f1.c **** 		@arg SDIO_BusWide_1b: 1-bit data transfer
 837:lib/ff/sdio_stm32f1.c ****     @retval SD_Error: SD Card Error code.
 838:lib/ff/sdio_stm32f1.c **** */
 839:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 840:lib/ff/sdio_stm32f1.c **** SD_Error SD_EnableWideBusOperation(uint32_t WideMode)
 841:lib/ff/sdio_stm32f1.c **** {
 842:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
 843:lib/ff/sdio_stm32f1.c **** 
 844:lib/ff/sdio_stm32f1.c ****   /*!< MMC Card doesn't support this feature */
 845:lib/ff/sdio_stm32f1.c ****   if (SDIO_MULTIMEDIA_CARD == CardType)
 846:lib/ff/sdio_stm32f1.c ****   {
 847:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_UNSUPPORTED_FEATURE;
 848:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 849:lib/ff/sdio_stm32f1.c ****   }
 850:lib/ff/sdio_stm32f1.c ****   else if ((SDIO_STD_CAPACITY_SD_CARD_V1_1 == CardType) || (SDIO_STD_CAPACITY_SD_CARD_V2_0 == CardT
 851:lib/ff/sdio_stm32f1.c ****   {
 852:lib/ff/sdio_stm32f1.c ****     if (SDIO_BusWide_8b == WideMode)
 853:lib/ff/sdio_stm32f1.c ****     {
 854:lib/ff/sdio_stm32f1.c ****       errorstatus = SD_UNSUPPORTED_FEATURE;
 855:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
 856:lib/ff/sdio_stm32f1.c ****     }
 857:lib/ff/sdio_stm32f1.c ****     else if (SDIO_BusWide_4b == WideMode)
 858:lib/ff/sdio_stm32f1.c ****     {
 859:lib/ff/sdio_stm32f1.c ****       errorstatus = SDEnWideBus(ENABLE);
 860:lib/ff/sdio_stm32f1.c **** 
 861:lib/ff/sdio_stm32f1.c ****       if (SD_OK == errorstatus)
 862:lib/ff/sdio_stm32f1.c ****       {
 863:lib/ff/sdio_stm32f1.c ****         /*!< Configure the SDIO peripheral */
 864:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_ClockDiv = SDIO_TRANSFER_CLK_DIV; 
 865:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_ClockEdge = SDIO_ClockEdge_Rising;
 866:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_ClockBypass = SDIO_ClockBypass_Disable;
 867:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_ClockPowerSave = SDIO_ClockPowerSave_Disable;
 868:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_BusWide = SDIO_BusWide_4b;
 869:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_HardwareFlowControl = SDIO_HardwareFlowControl_Disable;
 870:lib/ff/sdio_stm32f1.c ****         SDIO_Init(&SDIO_InitStructure);
 871:lib/ff/sdio_stm32f1.c ****       }
 872:lib/ff/sdio_stm32f1.c ****     }
 873:lib/ff/sdio_stm32f1.c ****     else
 874:lib/ff/sdio_stm32f1.c ****     {
 875:lib/ff/sdio_stm32f1.c ****       errorstatus = SDEnWideBus(DISABLE);
 876:lib/ff/sdio_stm32f1.c **** 
 877:lib/ff/sdio_stm32f1.c ****       if (SD_OK == errorstatus)
 878:lib/ff/sdio_stm32f1.c ****       {
 879:lib/ff/sdio_stm32f1.c ****         /*!< Configure the SDIO peripheral */
 880:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_ClockDiv = SDIO_TRANSFER_CLK_DIV; 
 881:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_ClockEdge = SDIO_ClockEdge_Rising;
 882:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_ClockBypass = SDIO_ClockBypass_Disable;
 883:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_ClockPowerSave = SDIO_ClockPowerSave_Disable;
 884:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_BusWide = SDIO_BusWide_1b;
 885:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_HardwareFlowControl = SDIO_HardwareFlowControl_Disable;
 886:lib/ff/sdio_stm32f1.c ****         SDIO_Init(&SDIO_InitStructure);
 887:lib/ff/sdio_stm32f1.c ****       }
 888:lib/ff/sdio_stm32f1.c ****     }
 889:lib/ff/sdio_stm32f1.c ****   }
 890:lib/ff/sdio_stm32f1.c **** 
 891:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
 892:lib/ff/sdio_stm32f1.c **** }
 893:lib/ff/sdio_stm32f1.c **** 
 894:lib/ff/sdio_stm32f1.c **** 
 895:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 896:lib/ff/sdio_stm32f1.c **** /*! 
 897:lib/ff/sdio_stm32f1.c **** 	@brief  Sets device mode whether to operate in Polling, Interrupt or DMA mode.
 898:lib/ff/sdio_stm32f1.c **** 	@param  Mode: Specifies the Data Transfer mode.
 899:lib/ff/sdio_stm32f1.c **** 		This parameter can be one of the following values:
 900:lib/ff/sdio_stm32f1.c **** 		@arg SD_DMA_MODE: Data transfer using DMA.
 901:lib/ff/sdio_stm32f1.c **** 		@arg SD_INTERRUPT_MODE: Data transfer using interrupts.
 902:lib/ff/sdio_stm32f1.c **** 		@arg SD_POLLING_MODE: Data transfer using flags.
 903:lib/ff/sdio_stm32f1.c ****     @retval SD_Error: SD Card Error code.
 904:lib/ff/sdio_stm32f1.c **** */
 905:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 906:lib/ff/sdio_stm32f1.c **** SD_Error SD_SetDeviceMode(uint32_t Mode)
 907:lib/ff/sdio_stm32f1.c **** {
 908:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
 909:lib/ff/sdio_stm32f1.c **** 
 910:lib/ff/sdio_stm32f1.c ****   if ((Mode == SD_DMA_MODE) || (Mode == SD_INTERRUPT_MODE) || (Mode == SD_POLLING_MODE))
 911:lib/ff/sdio_stm32f1.c ****   {
 912:lib/ff/sdio_stm32f1.c ****     DeviceMode = Mode;
 913:lib/ff/sdio_stm32f1.c ****   }
 914:lib/ff/sdio_stm32f1.c ****   else
 915:lib/ff/sdio_stm32f1.c ****   {
 916:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_INVALID_PARAMETER;
 917:lib/ff/sdio_stm32f1.c ****   }
 918:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
 919:lib/ff/sdio_stm32f1.c **** 
 920:lib/ff/sdio_stm32f1.c **** }
 921:lib/ff/sdio_stm32f1.c **** 
 922:lib/ff/sdio_stm32f1.c **** 
 923:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 924:lib/ff/sdio_stm32f1.c **** /*! 
 925:lib/ff/sdio_stm32f1.c **** 	@brief  Selects od Deselects the corresponding card.
 926:lib/ff/sdio_stm32f1.c **** 	@param  addr: Address of the Card to be selected.
 927:lib/ff/sdio_stm32f1.c **** 	@retval SD_Error: SD Card Error code.
 928:lib/ff/sdio_stm32f1.c **** */
 929:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 930:lib/ff/sdio_stm32f1.c **** SD_Error SD_SelectDeselect(uint64_t addr)
 931:lib/ff/sdio_stm32f1.c **** {
 932:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
 933:lib/ff/sdio_stm32f1.c **** 
 934:lib/ff/sdio_stm32f1.c ****   /*!< Send CMD7 SDIO_SEL_DESEL_CARD */
 935:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument =  (uint32_t)addr;
 936:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SEL_DESEL_CARD;
 937:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 938:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 939:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 940:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 941:lib/ff/sdio_stm32f1.c **** 
 942:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_SEL_DESEL_CARD);
 943:lib/ff/sdio_stm32f1.c **** 
 944:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
 945:lib/ff/sdio_stm32f1.c **** }
 946:lib/ff/sdio_stm32f1.c **** 
 947:lib/ff/sdio_stm32f1.c **** 
 948:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 949:lib/ff/sdio_stm32f1.c **** /*! 
 950:lib/ff/sdio_stm32f1.c **** 	@brief  Allows to read one block from a specified address in a card.
 951:lib/ff/sdio_stm32f1.c **** 	@param  readbuff: pointer to the buffer that will contain the received data
 952:lib/ff/sdio_stm32f1.c **** 	@param  ReadAddr: Address from where data are to be read.  
 953:lib/ff/sdio_stm32f1.c **** 	@param  BlockSize: the SD card Data block size.
 954:lib/ff/sdio_stm32f1.c **** 	@retval SD_Error: SD Card Error code.
 955:lib/ff/sdio_stm32f1.c **** */
 956:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 957:lib/ff/sdio_stm32f1.c **** SD_Error SD_ReadBlock(uint8_t *readbuff, uint64_t ReadAddr, uint16_t BlockSize)
 958:lib/ff/sdio_stm32f1.c **** {
 959:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
 960:lib/ff/sdio_stm32f1.c ****   uint32_t count = 0, *tempbuff = (uint32_t *)readbuff;
 961:lib/ff/sdio_stm32f1.c ****   uint8_t power = 0;
 962:lib/ff/sdio_stm32f1.c **** 
 963:lib/ff/sdio_stm32f1.c ****   if (NULL == readbuff)
 964:lib/ff/sdio_stm32f1.c ****   {
 965:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_INVALID_PARAMETER;
 966:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 967:lib/ff/sdio_stm32f1.c ****   }
 968:lib/ff/sdio_stm32f1.c **** 
 969:lib/ff/sdio_stm32f1.c ****   TransferError = SD_OK;
 970:lib/ff/sdio_stm32f1.c ****   TransferEnd = 0;
 971:lib/ff/sdio_stm32f1.c ****   TotalNumberOfBytes = 0;
 972:lib/ff/sdio_stm32f1.c **** 
 973:lib/ff/sdio_stm32f1.c ****   /*!< Clear all DPSM configuration */
 974:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataTimeOut = SD_DATATIMEOUT;
 975:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataLength = 0;
 976:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataBlockSize = SDIO_DataBlockSize_1b;
 977:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToCard;
 978:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
 979:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Disable;
 980:lib/ff/sdio_stm32f1.c ****   SDIO_DataConfig(&SDIO_DataInitStructure);
 981:lib/ff/sdio_stm32f1.c ****   SDIO_DMACmd(DISABLE);
 982:lib/ff/sdio_stm32f1.c **** 
 983:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetResponse(SDIO_RESP1) & SD_CARD_LOCKED)
 984:lib/ff/sdio_stm32f1.c ****   {
 985:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_LOCK_UNLOCK_FAILED;
 986:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 987:lib/ff/sdio_stm32f1.c ****   }
 988:lib/ff/sdio_stm32f1.c ****   
 989:lib/ff/sdio_stm32f1.c ****   if (CardType == SDIO_HIGH_CAPACITY_SD_CARD)
 990:lib/ff/sdio_stm32f1.c ****   {
 991:lib/ff/sdio_stm32f1.c ****     BlockSize = 512;
 992:lib/ff/sdio_stm32f1.c ****     ReadAddr /= 512;
 993:lib/ff/sdio_stm32f1.c ****   }
 994:lib/ff/sdio_stm32f1.c ****   if ((BlockSize > 0) && (BlockSize <= 2048) && ((BlockSize & (BlockSize - 1)) == 0))
 995:lib/ff/sdio_stm32f1.c ****   {
 996:lib/ff/sdio_stm32f1.c ****     power = convert_from_bytes_to_power_of_two(BlockSize);
 997:lib/ff/sdio_stm32f1.c **** 
 998:lib/ff/sdio_stm32f1.c ****     /*!< Set Block Size for Card */
 999:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) BlockSize;
1000:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SET_BLOCKLEN;
1001:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
1002:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
1003:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
1004:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
1005:lib/ff/sdio_stm32f1.c **** 
1006:lib/ff/sdio_stm32f1.c ****     errorstatus = CmdResp1Error(SD_CMD_SET_BLOCKLEN);
1007:lib/ff/sdio_stm32f1.c **** 
1008:lib/ff/sdio_stm32f1.c ****     if (SD_OK != errorstatus)
1009:lib/ff/sdio_stm32f1.c ****     {
1010:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
1011:lib/ff/sdio_stm32f1.c ****     }
1012:lib/ff/sdio_stm32f1.c ****   }
1013:lib/ff/sdio_stm32f1.c ****   else
1014:lib/ff/sdio_stm32f1.c ****   {
1015:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_INVALID_PARAMETER;
1016:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
1017:lib/ff/sdio_stm32f1.c ****   }
1018:lib/ff/sdio_stm32f1.c **** 
1019:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataTimeOut = SD_DATATIMEOUT;
1020:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataLength = BlockSize;
1021:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataBlockSize = (uint32_t) power << 4;
1022:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToSDIO;
1023:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
1024:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Enable;
1025:lib/ff/sdio_stm32f1.c ****   SDIO_DataConfig(&SDIO_DataInitStructure);
1026:lib/ff/sdio_stm32f1.c **** 
1027:lib/ff/sdio_stm32f1.c ****   TotalNumberOfBytes = BlockSize;
1028:lib/ff/sdio_stm32f1.c ****   StopCondition = 0;
1029:lib/ff/sdio_stm32f1.c ****   DestBuffer = (uint32_t *)readbuff;
1030:lib/ff/sdio_stm32f1.c **** 
1031:lib/ff/sdio_stm32f1.c ****   /*!< Send CMD17 READ_SINGLE_BLOCK */
1032:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = (uint32_t)ReadAddr;
1033:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_READ_SINGLE_BLOCK;
1034:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
1035:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
1036:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
1037:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
1038:lib/ff/sdio_stm32f1.c **** 
1039:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_READ_SINGLE_BLOCK);
1040:lib/ff/sdio_stm32f1.c **** 
1041:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
1042:lib/ff/sdio_stm32f1.c ****   {
1043:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
1044:lib/ff/sdio_stm32f1.c ****   }
1045:lib/ff/sdio_stm32f1.c ****   /*!< In case of single block transfer, no need of stop transfer at all.*/
1046:lib/ff/sdio_stm32f1.c ****   if (DeviceMode == SD_POLLING_MODE)
1047:lib/ff/sdio_stm32f1.c ****   {
1048:lib/ff/sdio_stm32f1.c ****     /*!< Polling mode */
1049:lib/ff/sdio_stm32f1.c ****     while (!(SDIO->STA &(SDIO_FLAG_RXOVERR | SDIO_FLAG_DCRCFAIL | SDIO_FLAG_DTIMEOUT | SDIO_FLAG_DB
1050:lib/ff/sdio_stm32f1.c ****     {
1051:lib/ff/sdio_stm32f1.c ****       if (SDIO_GetFlagStatus(SDIO_FLAG_RXFIFOHF) != RESET)
1052:lib/ff/sdio_stm32f1.c ****       {
1053:lib/ff/sdio_stm32f1.c ****         for (count = 0; count < 8; count++)
1054:lib/ff/sdio_stm32f1.c ****         {
1055:lib/ff/sdio_stm32f1.c ****           *(tempbuff + count) = SDIO_ReadData();
1056:lib/ff/sdio_stm32f1.c ****         }
1057:lib/ff/sdio_stm32f1.c ****         tempbuff += 8;
1058:lib/ff/sdio_stm32f1.c ****       }
1059:lib/ff/sdio_stm32f1.c ****     }
1060:lib/ff/sdio_stm32f1.c **** 
1061:lib/ff/sdio_stm32f1.c ****     if (SDIO_GetFlagStatus(SDIO_FLAG_DTIMEOUT) != RESET)
1062:lib/ff/sdio_stm32f1.c ****     {
1063:lib/ff/sdio_stm32f1.c ****       SDIO_ClearFlag(SDIO_FLAG_DTIMEOUT);
1064:lib/ff/sdio_stm32f1.c ****       errorstatus = SD_DATA_TIMEOUT;
1065:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
1066:lib/ff/sdio_stm32f1.c ****     }
1067:lib/ff/sdio_stm32f1.c ****     else if (SDIO_GetFlagStatus(SDIO_FLAG_DCRCFAIL) != RESET)
1068:lib/ff/sdio_stm32f1.c ****     {
1069:lib/ff/sdio_stm32f1.c ****       SDIO_ClearFlag(SDIO_FLAG_DCRCFAIL);
1070:lib/ff/sdio_stm32f1.c ****       errorstatus = SD_DATA_CRC_FAIL;
1071:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
1072:lib/ff/sdio_stm32f1.c ****     }
1073:lib/ff/sdio_stm32f1.c ****     else if (SDIO_GetFlagStatus(SDIO_FLAG_RXOVERR) != RESET)
1074:lib/ff/sdio_stm32f1.c ****     {
1075:lib/ff/sdio_stm32f1.c ****       SDIO_ClearFlag(SDIO_FLAG_RXOVERR);
1076:lib/ff/sdio_stm32f1.c ****       errorstatus = SD_RX_OVERRUN;
1077:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
1078:lib/ff/sdio_stm32f1.c ****     }
1079:lib/ff/sdio_stm32f1.c ****     else if (SDIO_GetFlagStatus(SDIO_FLAG_STBITERR) != RESET)
1080:lib/ff/sdio_stm32f1.c ****     {
1081:lib/ff/sdio_stm32f1.c ****       SDIO_ClearFlag(SDIO_FLAG_STBITERR);
1082:lib/ff/sdio_stm32f1.c ****       errorstatus = SD_START_BIT_ERR;
1083:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
1084:lib/ff/sdio_stm32f1.c ****     }
1085:lib/ff/sdio_stm32f1.c ****     while (SDIO_GetFlagStatus(SDIO_FLAG_RXDAVL) != RESET)
1086:lib/ff/sdio_stm32f1.c ****     {
1087:lib/ff/sdio_stm32f1.c ****       *tempbuff = SDIO_ReadData();
1088:lib/ff/sdio_stm32f1.c ****       tempbuff++;
1089:lib/ff/sdio_stm32f1.c ****     }
1090:lib/ff/sdio_stm32f1.c **** 
1091:lib/ff/sdio_stm32f1.c ****     /*!< Clear all the static flags */
1092:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_STATIC_FLAGS);
1093:lib/ff/sdio_stm32f1.c ****   }
1094:lib/ff/sdio_stm32f1.c ****   else if (DeviceMode == SD_INTERRUPT_MODE)
1095:lib/ff/sdio_stm32f1.c ****   {
1096:lib/ff/sdio_stm32f1.c ****     SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND | SDIO_IT_RXOVERR | SDIO_IT
1097:lib/ff/sdio_stm32f1.c ****     while ((TransferEnd == 0) && (TransferError == SD_OK))
1098:lib/ff/sdio_stm32f1.c ****     {}
1099:lib/ff/sdio_stm32f1.c ****     if (TransferError != SD_OK)
1100:lib/ff/sdio_stm32f1.c ****     {
1101:lib/ff/sdio_stm32f1.c ****       return(TransferError);
1102:lib/ff/sdio_stm32f1.c ****     }
1103:lib/ff/sdio_stm32f1.c ****   }
1104:lib/ff/sdio_stm32f1.c ****   else if (DeviceMode == SD_DMA_MODE)
1105:lib/ff/sdio_stm32f1.c ****   {
1106:lib/ff/sdio_stm32f1.c ****     SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND | SDIO_IT_RXOVERR | SDIO_IT
1107:lib/ff/sdio_stm32f1.c ****     SDIO_DMACmd(ENABLE);
1108:lib/ff/sdio_stm32f1.c ****     SD_LowLevel_DMA_RxConfig((uint32_t *)readbuff, BlockSize);
1109:lib/ff/sdio_stm32f1.c ****     while ((SD_DMAEndOfTransferStatus() == RESET) && (TransferEnd == 0) && (TransferError == SD_OK)
1110:lib/ff/sdio_stm32f1.c ****     {}
1111:lib/ff/sdio_stm32f1.c ****     if (TransferError != SD_OK)
1112:lib/ff/sdio_stm32f1.c ****     {
1113:lib/ff/sdio_stm32f1.c ****       return(TransferError);
1114:lib/ff/sdio_stm32f1.c ****     }
1115:lib/ff/sdio_stm32f1.c ****   }
1116:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
1117:lib/ff/sdio_stm32f1.c **** }
1118:lib/ff/sdio_stm32f1.c **** 
1119:lib/ff/sdio_stm32f1.c **** 
1120:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
1121:lib/ff/sdio_stm32f1.c **** /*! 
1122:lib/ff/sdio_stm32f1.c **** 	@brief  Allows to read blocks from a specified address  in a card.
1123:lib/ff/sdio_stm32f1.c **** 	@param  readbuff: pointer to the buffer that will contain the received data.
1124:lib/ff/sdio_stm32f1.c **** 	@param  ReadAddr: Address from where data are to be read.
1125:lib/ff/sdio_stm32f1.c **** 	@param  BlockSize: the SD card Data block size.
1126:lib/ff/sdio_stm32f1.c **** 	@param  NumberOfBlocks: number of blocks to be read.
1127:lib/ff/sdio_stm32f1.c **** 	@retval SD_Error: SD Card Error code.
1128:lib/ff/sdio_stm32f1.c **** */
1129:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
1130:lib/ff/sdio_stm32f1.c **** SD_Error SD_ReadMultiBlocks(uint8_t *readbuff, uint64_t ReadAddr, uint16_t BlockSize, uint32_t Numb
1131:lib/ff/sdio_stm32f1.c **** {
1132:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
1133:lib/ff/sdio_stm32f1.c ****   uint32_t count = 0, *tempbuff = (uint32_t *)readbuff;
1134:lib/ff/sdio_stm32f1.c ****   uint8_t power = 0;
1135:lib/ff/sdio_stm32f1.c **** 
1136:lib/ff/sdio_stm32f1.c ****   if (NULL == readbuff)
1137:lib/ff/sdio_stm32f1.c ****   {
1138:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_INVALID_PARAMETER;
1139:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
1140:lib/ff/sdio_stm32f1.c ****   }
1141:lib/ff/sdio_stm32f1.c **** 
1142:lib/ff/sdio_stm32f1.c ****   TransferError = SD_OK;
1143:lib/ff/sdio_stm32f1.c ****   TransferEnd = 0;
1144:lib/ff/sdio_stm32f1.c ****   TotalNumberOfBytes = 0;
1145:lib/ff/sdio_stm32f1.c **** 
1146:lib/ff/sdio_stm32f1.c ****   /*!< Clear all DPSM configuration */
1147:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataTimeOut = SD_DATATIMEOUT;
1148:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataLength = 0;
1149:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataBlockSize = SDIO_DataBlockSize_1b;
1150:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToCard;
1151:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
1152:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Disable;
1153:lib/ff/sdio_stm32f1.c ****   SDIO_DataConfig(&SDIO_DataInitStructure);
1154:lib/ff/sdio_stm32f1.c ****   SDIO_DMACmd(DISABLE);
1155:lib/ff/sdio_stm32f1.c **** 
1156:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetResponse(SDIO_RESP1) & SD_CARD_LOCKED)
1157:lib/ff/sdio_stm32f1.c ****   {
1158:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_LOCK_UNLOCK_FAILED;
1159:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
1160:lib/ff/sdio_stm32f1.c ****   }
1161:lib/ff/sdio_stm32f1.c **** 
1162:lib/ff/sdio_stm32f1.c ****   if (CardType == SDIO_HIGH_CAPACITY_SD_CARD)
1163:lib/ff/sdio_stm32f1.c ****   {
1164:lib/ff/sdio_stm32f1.c ****     BlockSize = 512;
1165:lib/ff/sdio_stm32f1.c ****     ReadAddr /= 512;
1166:lib/ff/sdio_stm32f1.c ****   }
1167:lib/ff/sdio_stm32f1.c ****   
1168:lib/ff/sdio_stm32f1.c ****   if ((BlockSize > 0) && (BlockSize <= 2048) && (0 == (BlockSize & (BlockSize - 1))))
1169:lib/ff/sdio_stm32f1.c ****   {
1170:lib/ff/sdio_stm32f1.c ****     power = convert_from_bytes_to_power_of_two(BlockSize);
1171:lib/ff/sdio_stm32f1.c **** 
1172:lib/ff/sdio_stm32f1.c ****     /*!< Set Block Size for Card */
1173:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) BlockSize;
1174:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SET_BLOCKLEN;
1175:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
1176:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
1177:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
1178:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
1179:lib/ff/sdio_stm32f1.c **** 
1180:lib/ff/sdio_stm32f1.c ****     errorstatus = CmdResp1Error(SD_CMD_SET_BLOCKLEN);
1181:lib/ff/sdio_stm32f1.c **** 
1182:lib/ff/sdio_stm32f1.c ****     if (SD_OK != errorstatus)
1183:lib/ff/sdio_stm32f1.c ****     {
1184:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
1185:lib/ff/sdio_stm32f1.c ****     }
1186:lib/ff/sdio_stm32f1.c ****   }
1187:lib/ff/sdio_stm32f1.c ****   else
1188:lib/ff/sdio_stm32f1.c ****   {
1189:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_INVALID_PARAMETER;
1190:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
1191:lib/ff/sdio_stm32f1.c ****   }
1192:lib/ff/sdio_stm32f1.c **** 
1193:lib/ff/sdio_stm32f1.c ****   if (NumberOfBlocks > 1)
1194:lib/ff/sdio_stm32f1.c ****   {
1195:lib/ff/sdio_stm32f1.c ****     /*!< Common to all modes */
1196:lib/ff/sdio_stm32f1.c ****     if (NumberOfBlocks * BlockSize > SD_MAX_DATA_LENGTH)
1197:lib/ff/sdio_stm32f1.c ****     {
1198:lib/ff/sdio_stm32f1.c ****       errorstatus = SD_INVALID_PARAMETER;
1199:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
1200:lib/ff/sdio_stm32f1.c ****     }
1201:lib/ff/sdio_stm32f1.c **** 
1202:lib/ff/sdio_stm32f1.c ****     TotalNumberOfBytes = NumberOfBlocks * BlockSize;
1203:lib/ff/sdio_stm32f1.c ****     StopCondition = 1;
1204:lib/ff/sdio_stm32f1.c ****     DestBuffer = (uint32_t *)readbuff;
1205:lib/ff/sdio_stm32f1.c **** 
1206:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_DataTimeOut = SD_DATATIMEOUT;
1207:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_DataLength = NumberOfBlocks * BlockSize;
1208:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_DataBlockSize = (uint32_t) power << 4;
1209:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToSDIO;
1210:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
1211:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Enable;
1212:lib/ff/sdio_stm32f1.c ****     SDIO_DataConfig(&SDIO_DataInitStructure);
1213:lib/ff/sdio_stm32f1.c **** 
1214:lib/ff/sdio_stm32f1.c ****     /*!< Send CMD18 READ_MULT_BLOCK with argument data address */
1215:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Argument = (uint32_t)ReadAddr;
1216:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_READ_MULT_BLOCK;
1217:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
1218:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
1219:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
1220:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
1221:lib/ff/sdio_stm32f1.c **** 
1222:lib/ff/sdio_stm32f1.c ****     errorstatus = CmdResp1Error(SD_CMD_READ_MULT_BLOCK);
1223:lib/ff/sdio_stm32f1.c **** 
1224:lib/ff/sdio_stm32f1.c ****     if (errorstatus != SD_OK)
1225:lib/ff/sdio_stm32f1.c ****     {
1226:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
1227:lib/ff/sdio_stm32f1.c ****     }
1228:lib/ff/sdio_stm32f1.c **** 
1229:lib/ff/sdio_stm32f1.c ****     if (DeviceMode == SD_POLLING_MODE)
1230:lib/ff/sdio_stm32f1.c ****     {
1231:lib/ff/sdio_stm32f1.c ****       /*!< Polling mode */
1232:lib/ff/sdio_stm32f1.c ****       while (!(SDIO->STA &(SDIO_FLAG_RXOVERR | SDIO_FLAG_DCRCFAIL | SDIO_FLAG_DATAEND | SDIO_FLAG_D
1233:lib/ff/sdio_stm32f1.c ****       {
1234:lib/ff/sdio_stm32f1.c ****         if (SDIO_GetFlagStatus(SDIO_FLAG_RXFIFOHF) != RESET)
1235:lib/ff/sdio_stm32f1.c ****         {
1236:lib/ff/sdio_stm32f1.c ****           for (count = 0; count < SD_HALFFIFO; count++)
1237:lib/ff/sdio_stm32f1.c ****           {
1238:lib/ff/sdio_stm32f1.c ****             *(tempbuff + count) = SDIO_ReadData();
1239:lib/ff/sdio_stm32f1.c ****           }
1240:lib/ff/sdio_stm32f1.c ****           tempbuff += SD_HALFFIFO;
1241:lib/ff/sdio_stm32f1.c ****         }
1242:lib/ff/sdio_stm32f1.c ****       }
1243:lib/ff/sdio_stm32f1.c **** 
1244:lib/ff/sdio_stm32f1.c ****       if (SDIO_GetFlagStatus(SDIO_FLAG_DTIMEOUT) != RESET)
1245:lib/ff/sdio_stm32f1.c ****       {
1246:lib/ff/sdio_stm32f1.c ****         SDIO_ClearFlag(SDIO_FLAG_DTIMEOUT);
1247:lib/ff/sdio_stm32f1.c ****         errorstatus = SD_DATA_TIMEOUT;
1248:lib/ff/sdio_stm32f1.c ****         return(errorstatus);
1249:lib/ff/sdio_stm32f1.c ****       }
1250:lib/ff/sdio_stm32f1.c ****       else if (SDIO_GetFlagStatus(SDIO_FLAG_DCRCFAIL) != RESET)
1251:lib/ff/sdio_stm32f1.c ****       {
1252:lib/ff/sdio_stm32f1.c ****         SDIO_ClearFlag(SDIO_FLAG_DCRCFAIL);
1253:lib/ff/sdio_stm32f1.c ****         errorstatus = SD_DATA_CRC_FAIL;
1254:lib/ff/sdio_stm32f1.c ****         return(errorstatus);
1255:lib/ff/sdio_stm32f1.c ****       }
1256:lib/ff/sdio_stm32f1.c ****       else if (SDIO_GetFlagStatus(SDIO_FLAG_RXOVERR) != RESET)
1257:lib/ff/sdio_stm32f1.c ****       {
1258:lib/ff/sdio_stm32f1.c ****         SDIO_ClearFlag(SDIO_FLAG_RXOVERR);
1259:lib/ff/sdio_stm32f1.c ****         errorstatus = SD_RX_OVERRUN;
1260:lib/ff/sdio_stm32f1.c ****         return(errorstatus);
1261:lib/ff/sdio_stm32f1.c ****       }
1262:lib/ff/sdio_stm32f1.c ****       else if (SDIO_GetFlagStatus(SDIO_FLAG_STBITERR) != RESET)
1263:lib/ff/sdio_stm32f1.c ****       {
1264:lib/ff/sdio_stm32f1.c ****         SDIO_ClearFlag(SDIO_FLAG_STBITERR);
1265:lib/ff/sdio_stm32f1.c ****         errorstatus = SD_START_BIT_ERR;
1266:lib/ff/sdio_stm32f1.c ****         return(errorstatus);
1267:lib/ff/sdio_stm32f1.c ****       }
1268:lib/ff/sdio_stm32f1.c ****       while (SDIO_GetFlagStatus(SDIO_FLAG_RXDAVL) != RESET)
1269:lib/ff/sdio_stm32f1.c ****       {
1270:lib/ff/sdio_stm32f1.c ****         *tempbuff = SDIO_ReadData();
1271:lib/ff/sdio_stm32f1.c ****         tempbuff++;
1272:lib/ff/sdio_stm32f1.c ****       }
1273:lib/ff/sdio_stm32f1.c **** 
1274:lib/ff/sdio_stm32f1.c ****       if (SDIO_GetFlagStatus(SDIO_FLAG_DATAEND) != RESET)
1275:lib/ff/sdio_stm32f1.c ****       {
1276:lib/ff/sdio_stm32f1.c ****         /*!< In Case Of SD-CARD Send Command STOP_TRANSMISSION */
1277:lib/ff/sdio_stm32f1.c ****         if ((SDIO_STD_CAPACITY_SD_CARD_V1_1 == CardType) || (SDIO_HIGH_CAPACITY_SD_CARD == CardType
1278:lib/ff/sdio_stm32f1.c ****         {
1279:lib/ff/sdio_stm32f1.c ****           /*!< Send CMD12 STOP_TRANSMISSION */
1280:lib/ff/sdio_stm32f1.c ****           SDIO_CmdInitStructure.SDIO_Argument = 0x0;
1281:lib/ff/sdio_stm32f1.c ****           SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_STOP_TRANSMISSION;
1282:lib/ff/sdio_stm32f1.c ****           SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
1283:lib/ff/sdio_stm32f1.c ****           SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
1284:lib/ff/sdio_stm32f1.c ****           SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
1285:lib/ff/sdio_stm32f1.c ****           SDIO_SendCommand(&SDIO_CmdInitStructure);
1286:lib/ff/sdio_stm32f1.c **** 
1287:lib/ff/sdio_stm32f1.c ****           errorstatus = CmdResp1Error(SD_CMD_STOP_TRANSMISSION);
1288:lib/ff/sdio_stm32f1.c **** 
1289:lib/ff/sdio_stm32f1.c ****           if (errorstatus != SD_OK)
1290:lib/ff/sdio_stm32f1.c ****           {
1291:lib/ff/sdio_stm32f1.c ****             return(errorstatus);
1292:lib/ff/sdio_stm32f1.c ****           }
1293:lib/ff/sdio_stm32f1.c ****         }
1294:lib/ff/sdio_stm32f1.c ****       }
1295:lib/ff/sdio_stm32f1.c ****       /*!< Clear all the static flags */
1296:lib/ff/sdio_stm32f1.c ****       SDIO_ClearFlag(SDIO_STATIC_FLAGS);
1297:lib/ff/sdio_stm32f1.c ****     }
1298:lib/ff/sdio_stm32f1.c ****     else if (DeviceMode == SD_INTERRUPT_MODE)
1299:lib/ff/sdio_stm32f1.c ****     {
1300:lib/ff/sdio_stm32f1.c ****       SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND | SDIO_IT_RXOVERR | SDIO_
1301:lib/ff/sdio_stm32f1.c ****       while ((TransferEnd == 0) && (TransferError == SD_OK))
1302:lib/ff/sdio_stm32f1.c ****       {}
1303:lib/ff/sdio_stm32f1.c ****       if (TransferError != SD_OK)
1304:lib/ff/sdio_stm32f1.c ****       {
1305:lib/ff/sdio_stm32f1.c ****         return(TransferError);
1306:lib/ff/sdio_stm32f1.c ****       }
1307:lib/ff/sdio_stm32f1.c ****     }
1308:lib/ff/sdio_stm32f1.c ****     else if (DeviceMode == SD_DMA_MODE)
1309:lib/ff/sdio_stm32f1.c ****     {
1310:lib/ff/sdio_stm32f1.c ****       SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND | SDIO_IT_RXOVERR | SDIO_
1311:lib/ff/sdio_stm32f1.c ****       SDIO_DMACmd(ENABLE);
1312:lib/ff/sdio_stm32f1.c ****       SD_LowLevel_DMA_RxConfig((uint32_t *)readbuff, (NumberOfBlocks * BlockSize));
1313:lib/ff/sdio_stm32f1.c ****       while ((SD_DMAEndOfTransferStatus() == RESET) && (TransferEnd == 0) && (TransferError == SD_O
1314:lib/ff/sdio_stm32f1.c ****       {}
1315:lib/ff/sdio_stm32f1.c ****       if (TransferError != SD_OK)
1316:lib/ff/sdio_stm32f1.c ****       {
1317:lib/ff/sdio_stm32f1.c ****         return(TransferError);
1318:lib/ff/sdio_stm32f1.c ****       }
1319:lib/ff/sdio_stm32f1.c ****     }
1320:lib/ff/sdio_stm32f1.c ****   }
1321:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
1322:lib/ff/sdio_stm32f1.c **** }
1323:lib/ff/sdio_stm32f1.c **** 
1324:lib/ff/sdio_stm32f1.c **** 
1325:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
1326:lib/ff/sdio_stm32f1.c **** /*! 
1327:lib/ff/sdio_stm32f1.c **** 	@brief  Allows to write one block starting from a specified address in a card.
1328:lib/ff/sdio_stm32f1.c **** 	@param  writebuff: pointer to the buffer that contain the data to be transferred.
1329:lib/ff/sdio_stm32f1.c **** 	@param  WriteAddr: Address from where data are to be read.   
1330:lib/ff/sdio_stm32f1.c **** 	@param  BlockSize: the SD card Data block size.
1331:lib/ff/sdio_stm32f1.c **** 	@retval SD_Error: SD Card Error code.
1332:lib/ff/sdio_stm32f1.c **** */
1333:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
1334:lib/ff/sdio_stm32f1.c **** SD_Error SD_WriteBlock(uint8_t *writebuff, uint64_t WriteAddr, uint16_t BlockSize)
1335:lib/ff/sdio_stm32f1.c **** {
1336:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
1337:lib/ff/sdio_stm32f1.c ****   uint8_t  power = 0, cardstate = 0;
1338:lib/ff/sdio_stm32f1.c ****   uint32_t timeout = 0, bytestransferred = 0;
1339:lib/ff/sdio_stm32f1.c ****   uint32_t cardstatus = 0, count = 0, restwords = 0;
1340:lib/ff/sdio_stm32f1.c ****   uint32_t *tempbuff = (uint32_t *)writebuff;
1341:lib/ff/sdio_stm32f1.c **** 
1342:lib/ff/sdio_stm32f1.c ****   if (writebuff == NULL)
1343:lib/ff/sdio_stm32f1.c ****   {
1344:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_INVALID_PARAMETER;
1345:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
1346:lib/ff/sdio_stm32f1.c ****   }
1347:lib/ff/sdio_stm32f1.c **** 
1348:lib/ff/sdio_stm32f1.c ****   TransferError = SD_OK;
1349:lib/ff/sdio_stm32f1.c ****   TransferEnd = 0;
1350:lib/ff/sdio_stm32f1.c ****   TotalNumberOfBytes = 0;
1351:lib/ff/sdio_stm32f1.c **** 
1352:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataTimeOut = SD_DATATIMEOUT;
1353:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataLength = 0;
1354:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataBlockSize = SDIO_DataBlockSize_1b;
1355:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToCard;
1356:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
1357:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Disable;
1358:lib/ff/sdio_stm32f1.c ****   SDIO_DataConfig(&SDIO_DataInitStructure);
1359:lib/ff/sdio_stm32f1.c ****   SDIO_DMACmd(DISABLE);
1360:lib/ff/sdio_stm32f1.c **** 
1361:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetResponse(SDIO_RESP1) & SD_CARD_LOCKED)
1362:lib/ff/sdio_stm32f1.c ****   {
1363:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_LOCK_UNLOCK_FAILED;
1364:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
1365:lib/ff/sdio_stm32f1.c ****   }
1366:lib/ff/sdio_stm32f1.c **** 
1367:lib/ff/sdio_stm32f1.c ****   if (CardType == SDIO_HIGH_CAPACITY_SD_CARD)
1368:lib/ff/sdio_stm32f1.c ****   {
1369:lib/ff/sdio_stm32f1.c ****     BlockSize = 512;
1370:lib/ff/sdio_stm32f1.c ****     WriteAddr /= 512;
1371:lib/ff/sdio_stm32f1.c ****   }
1372:lib/ff/sdio_stm32f1.c ****   
1373:lib/ff/sdio_stm32f1.c ****   /*!< Set the block size, both on controller and card */
1374:lib/ff/sdio_stm32f1.c ****   if ((BlockSize > 0) && (BlockSize <= 2048) && ((BlockSize & (BlockSize - 1)) == 0))
1375:lib/ff/sdio_stm32f1.c ****   {
1376:lib/ff/sdio_stm32f1.c ****     power = convert_from_bytes_to_power_of_two(BlockSize);
1377:lib/ff/sdio_stm32f1.c **** 
1378:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) BlockSize;
1379:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SET_BLOCKLEN;
1380:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
1381:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
1382:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
1383:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
1384:lib/ff/sdio_stm32f1.c **** 
1385:lib/ff/sdio_stm32f1.c ****     errorstatus = CmdResp1Error(SD_CMD_SET_BLOCKLEN);
1386:lib/ff/sdio_stm32f1.c **** 
1387:lib/ff/sdio_stm32f1.c ****     if (errorstatus != SD_OK)
1388:lib/ff/sdio_stm32f1.c ****     {
1389:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
1390:lib/ff/sdio_stm32f1.c ****     }
1391:lib/ff/sdio_stm32f1.c ****   }
1392:lib/ff/sdio_stm32f1.c ****   else
1393:lib/ff/sdio_stm32f1.c ****   {
1394:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_INVALID_PARAMETER;
1395:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
1396:lib/ff/sdio_stm32f1.c ****   }
1397:lib/ff/sdio_stm32f1.c **** 
1398:lib/ff/sdio_stm32f1.c ****   /*!< Wait till card is ready for data Added */
1399:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) (RCA << 16);
1400:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SEND_STATUS;
1401:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
1402:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
1403:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
1404:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
1405:lib/ff/sdio_stm32f1.c **** 
1406:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_SEND_STATUS);
1407:lib/ff/sdio_stm32f1.c **** 
1408:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
1409:lib/ff/sdio_stm32f1.c ****   {
1410:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
1411:lib/ff/sdio_stm32f1.c ****   }
1412:lib/ff/sdio_stm32f1.c **** 
1413:lib/ff/sdio_stm32f1.c ****   cardstatus = SDIO_GetResponse(SDIO_RESP1);
1414:lib/ff/sdio_stm32f1.c **** 
1415:lib/ff/sdio_stm32f1.c ****   timeout = SD_DATATIMEOUT;
1416:lib/ff/sdio_stm32f1.c **** 
1417:lib/ff/sdio_stm32f1.c ****   while (((cardstatus & 0x00000100) == 0) && (timeout > 0))
1418:lib/ff/sdio_stm32f1.c ****   {
1419:lib/ff/sdio_stm32f1.c ****     timeout--;
1420:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) (RCA << 16);
1421:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SEND_STATUS;
1422:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
1423:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
1424:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
1425:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
1426:lib/ff/sdio_stm32f1.c **** 
1427:lib/ff/sdio_stm32f1.c ****     errorstatus = CmdResp1Error(SD_CMD_SEND_STATUS);
1428:lib/ff/sdio_stm32f1.c **** 
1429:lib/ff/sdio_stm32f1.c ****     if (errorstatus != SD_OK)
1430:lib/ff/sdio_stm32f1.c ****     {
1431:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
1432:lib/ff/sdio_stm32f1.c ****     }
1433:lib/ff/sdio_stm32f1.c ****     cardstatus = SDIO_GetResponse(SDIO_RESP1);
1434:lib/ff/sdio_stm32f1.c ****   }
1435:lib/ff/sdio_stm32f1.c **** 
1436:lib/ff/sdio_stm32f1.c ****   if (timeout == 0)
1437:lib/ff/sdio_stm32f1.c ****   {
1438:lib/ff/sdio_stm32f1.c ****     return(SD_ERROR);
1439:lib/ff/sdio_stm32f1.c ****   }
1440:lib/ff/sdio_stm32f1.c **** 
1441:lib/ff/sdio_stm32f1.c ****   /*!< Send CMD24 WRITE_SINGLE_BLOCK */
1442:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) WriteAddr;
1443:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_WRITE_SINGLE_BLOCK;
1444:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
1445:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
1446:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
1447:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
1448:lib/ff/sdio_stm32f1.c **** 
1449:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_WRITE_SINGLE_BLOCK);
1450:lib/ff/sdio_stm32f1.c **** 
1451:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
1452:lib/ff/sdio_stm32f1.c ****   {
1453:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
1454:lib/ff/sdio_stm32f1.c ****   }
1455:lib/ff/sdio_stm32f1.c **** 
1456:lib/ff/sdio_stm32f1.c ****   TotalNumberOfBytes = BlockSize;
1457:lib/ff/sdio_stm32f1.c ****   StopCondition = 0;
1458:lib/ff/sdio_stm32f1.c ****   SrcBuffer = (uint32_t *)writebuff;
1459:lib/ff/sdio_stm32f1.c **** 
1460:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataTimeOut = SD_DATATIMEOUT;
1461:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataLength = BlockSize;
1462:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataBlockSize = (uint32_t) power << 4;
1463:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToCard;
1464:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
1465:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Enable;
1466:lib/ff/sdio_stm32f1.c ****   SDIO_DataConfig(&SDIO_DataInitStructure);
1467:lib/ff/sdio_stm32f1.c **** 
1468:lib/ff/sdio_stm32f1.c ****   /*!< In case of single data block transfer no need of stop command at all */
1469:lib/ff/sdio_stm32f1.c ****   if (DeviceMode == SD_POLLING_MODE)
1470:lib/ff/sdio_stm32f1.c ****   {
1471:lib/ff/sdio_stm32f1.c ****     while (!(SDIO->STA & (SDIO_FLAG_DBCKEND | SDIO_FLAG_TXUNDERR | SDIO_FLAG_DCRCFAIL | SDIO_FLAG_D
1472:lib/ff/sdio_stm32f1.c ****     {
1473:lib/ff/sdio_stm32f1.c ****       if (SDIO_GetFlagStatus(SDIO_FLAG_TXFIFOHE) != RESET)
1474:lib/ff/sdio_stm32f1.c ****       {
1475:lib/ff/sdio_stm32f1.c ****         if ((TotalNumberOfBytes - bytestransferred) < 32)
1476:lib/ff/sdio_stm32f1.c ****         {
1477:lib/ff/sdio_stm32f1.c ****           restwords = ((TotalNumberOfBytes - bytestransferred) % 4 == 0) ? ((TotalNumberOfBytes - b
1478:lib/ff/sdio_stm32f1.c **** 
1479:lib/ff/sdio_stm32f1.c ****           for (count = 0; count < restwords; count++, tempbuff++, bytestransferred += 4)
1480:lib/ff/sdio_stm32f1.c ****           {
1481:lib/ff/sdio_stm32f1.c ****             SDIO_WriteData(*tempbuff);
1482:lib/ff/sdio_stm32f1.c ****           }
1483:lib/ff/sdio_stm32f1.c ****         }
1484:lib/ff/sdio_stm32f1.c ****         else
1485:lib/ff/sdio_stm32f1.c ****         {
1486:lib/ff/sdio_stm32f1.c ****           for (count = 0; count < 8; count++)
1487:lib/ff/sdio_stm32f1.c ****           {
1488:lib/ff/sdio_stm32f1.c ****             SDIO_WriteData(*(tempbuff + count));
1489:lib/ff/sdio_stm32f1.c ****           }
1490:lib/ff/sdio_stm32f1.c ****           tempbuff += 8;
1491:lib/ff/sdio_stm32f1.c ****           bytestransferred += 32;
1492:lib/ff/sdio_stm32f1.c ****         }
1493:lib/ff/sdio_stm32f1.c ****       }
1494:lib/ff/sdio_stm32f1.c ****     }
1495:lib/ff/sdio_stm32f1.c ****     if (SDIO_GetFlagStatus(SDIO_FLAG_DTIMEOUT) != RESET)
1496:lib/ff/sdio_stm32f1.c ****     {
1497:lib/ff/sdio_stm32f1.c ****       SDIO_ClearFlag(SDIO_FLAG_DTIMEOUT);
1498:lib/ff/sdio_stm32f1.c ****       errorstatus = SD_DATA_TIMEOUT;
1499:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
1500:lib/ff/sdio_stm32f1.c ****     }
1501:lib/ff/sdio_stm32f1.c ****     else if (SDIO_GetFlagStatus(SDIO_FLAG_DCRCFAIL) != RESET)
1502:lib/ff/sdio_stm32f1.c ****     {
1503:lib/ff/sdio_stm32f1.c ****       SDIO_ClearFlag(SDIO_FLAG_DCRCFAIL);
1504:lib/ff/sdio_stm32f1.c ****       errorstatus = SD_DATA_CRC_FAIL;
1505:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
1506:lib/ff/sdio_stm32f1.c ****     }
1507:lib/ff/sdio_stm32f1.c ****     else if (SDIO_GetFlagStatus(SDIO_FLAG_TXUNDERR) != RESET)
1508:lib/ff/sdio_stm32f1.c ****     {
1509:lib/ff/sdio_stm32f1.c ****       SDIO_ClearFlag(SDIO_FLAG_TXUNDERR);
1510:lib/ff/sdio_stm32f1.c ****       errorstatus = SD_TX_UNDERRUN;
1511:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
1512:lib/ff/sdio_stm32f1.c ****     }
1513:lib/ff/sdio_stm32f1.c ****     else if (SDIO_GetFlagStatus(SDIO_FLAG_STBITERR) != RESET)
1514:lib/ff/sdio_stm32f1.c ****     {
1515:lib/ff/sdio_stm32f1.c ****       SDIO_ClearFlag(SDIO_FLAG_STBITERR);
1516:lib/ff/sdio_stm32f1.c ****       errorstatus = SD_START_BIT_ERR;
1517:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
1518:lib/ff/sdio_stm32f1.c ****     }
1519:lib/ff/sdio_stm32f1.c ****   }
1520:lib/ff/sdio_stm32f1.c ****   else if (DeviceMode == SD_INTERRUPT_MODE)
1521:lib/ff/sdio_stm32f1.c ****   {
1522:lib/ff/sdio_stm32f1.c ****     SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND | SDIO_FLAG_TXFIFOHE | SDIO
1523:lib/ff/sdio_stm32f1.c ****     while ((TransferEnd == 0) && (TransferError == SD_OK))
1524:lib/ff/sdio_stm32f1.c ****     {}
1525:lib/ff/sdio_stm32f1.c ****     if (TransferError != SD_OK)
1526:lib/ff/sdio_stm32f1.c ****     {
1527:lib/ff/sdio_stm32f1.c ****       return(TransferError);
1528:lib/ff/sdio_stm32f1.c ****     }
1529:lib/ff/sdio_stm32f1.c ****   }
1530:lib/ff/sdio_stm32f1.c ****   else if (DeviceMode == SD_DMA_MODE)
1531:lib/ff/sdio_stm32f1.c ****   {
1532:lib/ff/sdio_stm32f1.c ****     SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND | SDIO_IT_TXUNDERR | SDIO_I
1533:lib/ff/sdio_stm32f1.c ****     SD_LowLevel_DMA_TxConfig((uint32_t *)writebuff, BlockSize);
1534:lib/ff/sdio_stm32f1.c ****     SDIO_DMACmd(ENABLE);
1535:lib/ff/sdio_stm32f1.c ****     while ((SD_DMAEndOfTransferStatus() == RESET) && (TransferEnd == 0) && (TransferError == SD_OK)
1536:lib/ff/sdio_stm32f1.c ****     {}
1537:lib/ff/sdio_stm32f1.c ****     if (TransferError != SD_OK)
1538:lib/ff/sdio_stm32f1.c ****     {
1539:lib/ff/sdio_stm32f1.c ****       return(TransferError);
1540:lib/ff/sdio_stm32f1.c ****     }
1541:lib/ff/sdio_stm32f1.c ****   }
1542:lib/ff/sdio_stm32f1.c **** 
1543:lib/ff/sdio_stm32f1.c ****   /*!< Clear all the static flags */
1544:lib/ff/sdio_stm32f1.c ****   SDIO_ClearFlag(SDIO_STATIC_FLAGS);
1545:lib/ff/sdio_stm32f1.c **** 
1546:lib/ff/sdio_stm32f1.c ****   /*!< Wait till the card is in programming state */
1547:lib/ff/sdio_stm32f1.c ****   errorstatus = IsCardProgramming(&cardstate);
1548:lib/ff/sdio_stm32f1.c **** 
1549:lib/ff/sdio_stm32f1.c ****   while ((errorstatus == SD_OK) && ((cardstate == SD_CARD_PROGRAMMING) || (cardstate == SD_CARD_REC
1550:lib/ff/sdio_stm32f1.c ****   {
1551:lib/ff/sdio_stm32f1.c ****     errorstatus = IsCardProgramming(&cardstate);
1552:lib/ff/sdio_stm32f1.c ****   }
1553:lib/ff/sdio_stm32f1.c **** 
1554:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
1555:lib/ff/sdio_stm32f1.c **** }
1556:lib/ff/sdio_stm32f1.c **** 
1557:lib/ff/sdio_stm32f1.c **** 
1558:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
1559:lib/ff/sdio_stm32f1.c **** /*! 
1560:lib/ff/sdio_stm32f1.c **** 	@brief  Allows to write blocks starting from a specified address in a card.
1561:lib/ff/sdio_stm32f1.c **** 	@param  WriteAddr: Address from where data are to be read.
1562:lib/ff/sdio_stm32f1.c **** 	@param  writebuff: pointer to the buffer that contain the data to be transferred.
1563:lib/ff/sdio_stm32f1.c **** 	@param  BlockSize: the SD card Data block size.
1564:lib/ff/sdio_stm32f1.c **** 	@param  NumberOfBlocks: number of blocks to be written.
1565:lib/ff/sdio_stm32f1.c **** 	@retval SD_Error: SD Card Error code.
1566:lib/ff/sdio_stm32f1.c **** */
1567:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
1568:lib/ff/sdio_stm32f1.c **** SD_Error SD_WriteMultiBlocks(uint8_t *writebuff, uint64_t WriteAddr, uint16_t BlockSize, uint32_t N
1569:lib/ff/sdio_stm32f1.c **** {
1570:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
1571:lib/ff/sdio_stm32f1.c ****   uint8_t  power = 0, cardstate = 0;
1572:lib/ff/sdio_stm32f1.c ****   uint32_t bytestransferred = 0;
1573:lib/ff/sdio_stm32f1.c ****   uint32_t restwords = 0;
1574:lib/ff/sdio_stm32f1.c ****   uint32_t *tempbuff = (uint32_t *)writebuff;
1575:lib/ff/sdio_stm32f1.c ****   __IO uint32_t count = 0;
1576:lib/ff/sdio_stm32f1.c ****   
1577:lib/ff/sdio_stm32f1.c ****   if (writebuff == NULL)
1578:lib/ff/sdio_stm32f1.c ****   {
1579:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_INVALID_PARAMETER;
1580:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
1581:lib/ff/sdio_stm32f1.c ****   }
1582:lib/ff/sdio_stm32f1.c **** 
1583:lib/ff/sdio_stm32f1.c ****   TransferError = SD_OK;
1584:lib/ff/sdio_stm32f1.c ****   TransferEnd = 0;
1585:lib/ff/sdio_stm32f1.c ****   TotalNumberOfBytes = 0;
1586:lib/ff/sdio_stm32f1.c **** 
1587:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataTimeOut = SD_DATATIMEOUT;
1588:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataLength = 0;
1589:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataBlockSize = SDIO_DataBlockSize_1b;
1590:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToCard;
1591:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
1592:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Disable;
1593:lib/ff/sdio_stm32f1.c ****   SDIO_DataConfig(&SDIO_DataInitStructure);
1594:lib/ff/sdio_stm32f1.c ****   SDIO_DMACmd(DISABLE);
1595:lib/ff/sdio_stm32f1.c **** 
1596:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetResponse(SDIO_RESP1) & SD_CARD_LOCKED)
1597:lib/ff/sdio_stm32f1.c ****   {
1598:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_LOCK_UNLOCK_FAILED;
1599:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
1600:lib/ff/sdio_stm32f1.c ****   }
1601:lib/ff/sdio_stm32f1.c **** 
1602:lib/ff/sdio_stm32f1.c ****   if (CardType == SDIO_HIGH_CAPACITY_SD_CARD)
1603:lib/ff/sdio_stm32f1.c ****   {
1604:lib/ff/sdio_stm32f1.c ****     BlockSize = 512;
1605:lib/ff/sdio_stm32f1.c ****     WriteAddr /= 512;
1606:lib/ff/sdio_stm32f1.c ****   }
1607:lib/ff/sdio_stm32f1.c ****   
1608:lib/ff/sdio_stm32f1.c ****   /*!< Set the block size, both on controller and card */
1609:lib/ff/sdio_stm32f1.c ****   if ((BlockSize > 0) && (BlockSize <= 2048) && ((BlockSize & (BlockSize - 1)) == 0))
1610:lib/ff/sdio_stm32f1.c ****   {
1611:lib/ff/sdio_stm32f1.c ****     power = convert_from_bytes_to_power_of_two(BlockSize);
1612:lib/ff/sdio_stm32f1.c **** 
1613:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) BlockSize;
1614:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SET_BLOCKLEN;
1615:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
1616:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
1617:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
1618:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
1619:lib/ff/sdio_stm32f1.c **** 
1620:lib/ff/sdio_stm32f1.c ****     errorstatus = CmdResp1Error(SD_CMD_SET_BLOCKLEN);
1621:lib/ff/sdio_stm32f1.c **** 
1622:lib/ff/sdio_stm32f1.c ****     if (errorstatus != SD_OK)
1623:lib/ff/sdio_stm32f1.c ****     {
1624:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
1625:lib/ff/sdio_stm32f1.c ****     }
1626:lib/ff/sdio_stm32f1.c ****   }
1627:lib/ff/sdio_stm32f1.c ****   else
1628:lib/ff/sdio_stm32f1.c ****   {
1629:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_INVALID_PARAMETER;
1630:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
1631:lib/ff/sdio_stm32f1.c ****   }
1632:lib/ff/sdio_stm32f1.c **** 
1633:lib/ff/sdio_stm32f1.c ****   /*!< Wait till card is ready for data Added */
1634:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) (RCA << 16);
1635:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SEND_STATUS;
1636:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
1637:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
1638:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
1639:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
1640:lib/ff/sdio_stm32f1.c **** 
1641:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_SEND_STATUS);
1642:lib/ff/sdio_stm32f1.c **** 
1643:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
1644:lib/ff/sdio_stm32f1.c ****   {
1645:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
1646:lib/ff/sdio_stm32f1.c ****   }
1647:lib/ff/sdio_stm32f1.c **** 
1648:lib/ff/sdio_stm32f1.c ****   if (NumberOfBlocks > 1)
1649:lib/ff/sdio_stm32f1.c ****   {
1650:lib/ff/sdio_stm32f1.c ****     /*!< Common to all modes */
1651:lib/ff/sdio_stm32f1.c ****     if (NumberOfBlocks * BlockSize > SD_MAX_DATA_LENGTH)
1652:lib/ff/sdio_stm32f1.c ****     {
1653:lib/ff/sdio_stm32f1.c ****       errorstatus = SD_INVALID_PARAMETER;
1654:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
1655:lib/ff/sdio_stm32f1.c ****     }
1656:lib/ff/sdio_stm32f1.c **** 
1657:lib/ff/sdio_stm32f1.c ****     if ((SDIO_STD_CAPACITY_SD_CARD_V1_1 == CardType) || (SDIO_STD_CAPACITY_SD_CARD_V2_0 == CardType
1658:lib/ff/sdio_stm32f1.c ****     {
1659:lib/ff/sdio_stm32f1.c ****       /*!< To improve performance */
1660:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) (RCA << 16);
1661:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_CMD;
1662:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
1663:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
1664:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
1665:lib/ff/sdio_stm32f1.c ****       SDIO_SendCommand(&SDIO_CmdInitStructure);
1666:lib/ff/sdio_stm32f1.c **** 
1667:lib/ff/sdio_stm32f1.c **** 
1668:lib/ff/sdio_stm32f1.c ****       errorstatus = CmdResp1Error(SD_CMD_APP_CMD);
1669:lib/ff/sdio_stm32f1.c **** 
1670:lib/ff/sdio_stm32f1.c ****       if (errorstatus != SD_OK)
1671:lib/ff/sdio_stm32f1.c ****       {
1672:lib/ff/sdio_stm32f1.c ****         return(errorstatus);
1673:lib/ff/sdio_stm32f1.c ****       }
1674:lib/ff/sdio_stm32f1.c ****       /*!< To improve performance */
1675:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Argument = (uint32_t)NumberOfBlocks;
1676:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SET_BLOCK_COUNT;
1677:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
1678:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
1679:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
1680:lib/ff/sdio_stm32f1.c ****       SDIO_SendCommand(&SDIO_CmdInitStructure);
1681:lib/ff/sdio_stm32f1.c **** 
1682:lib/ff/sdio_stm32f1.c ****       errorstatus = CmdResp1Error(SD_CMD_SET_BLOCK_COUNT);
1683:lib/ff/sdio_stm32f1.c **** 
1684:lib/ff/sdio_stm32f1.c ****       if (errorstatus != SD_OK)
1685:lib/ff/sdio_stm32f1.c ****       {
1686:lib/ff/sdio_stm32f1.c ****         return(errorstatus);
1687:lib/ff/sdio_stm32f1.c ****       }
1688:lib/ff/sdio_stm32f1.c ****     }
1689:lib/ff/sdio_stm32f1.c **** 
1690:lib/ff/sdio_stm32f1.c ****     /*!< Send CMD25 WRITE_MULT_BLOCK with argument data address */
1691:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Argument = (uint32_t)WriteAddr;
1692:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_WRITE_MULT_BLOCK;
1693:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
1694:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
1695:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
1696:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
1697:lib/ff/sdio_stm32f1.c **** 
1698:lib/ff/sdio_stm32f1.c ****     errorstatus = CmdResp1Error(SD_CMD_WRITE_MULT_BLOCK);
1699:lib/ff/sdio_stm32f1.c **** 
1700:lib/ff/sdio_stm32f1.c ****     if (SD_OK != errorstatus)
1701:lib/ff/sdio_stm32f1.c ****     {
1702:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
1703:lib/ff/sdio_stm32f1.c ****     }
1704:lib/ff/sdio_stm32f1.c **** 
1705:lib/ff/sdio_stm32f1.c ****     TotalNumberOfBytes = NumberOfBlocks * BlockSize;
1706:lib/ff/sdio_stm32f1.c ****     StopCondition = 1;
1707:lib/ff/sdio_stm32f1.c ****     SrcBuffer = (uint32_t *)writebuff;
1708:lib/ff/sdio_stm32f1.c **** 
1709:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_DataTimeOut = SD_DATATIMEOUT;
1710:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_DataLength = NumberOfBlocks * BlockSize;
1711:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_DataBlockSize = (uint32_t) power << 4;
1712:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToCard;
1713:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
1714:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Enable;
1715:lib/ff/sdio_stm32f1.c ****     SDIO_DataConfig(&SDIO_DataInitStructure);
1716:lib/ff/sdio_stm32f1.c **** 
1717:lib/ff/sdio_stm32f1.c ****     if (DeviceMode == SD_POLLING_MODE)
1718:lib/ff/sdio_stm32f1.c ****     {
1719:lib/ff/sdio_stm32f1.c ****       while (!(SDIO->STA & (SDIO_FLAG_TXUNDERR | SDIO_FLAG_DCRCFAIL | SDIO_FLAG_DATAEND | SDIO_FLAG
1720:lib/ff/sdio_stm32f1.c ****       {
1721:lib/ff/sdio_stm32f1.c ****         if (SDIO_GetFlagStatus(SDIO_FLAG_TXFIFOHE) != RESET)
1722:lib/ff/sdio_stm32f1.c ****         {
1723:lib/ff/sdio_stm32f1.c ****           if (!((TotalNumberOfBytes - bytestransferred) < SD_HALFFIFOBYTES))
1724:lib/ff/sdio_stm32f1.c ****           {
1725:lib/ff/sdio_stm32f1.c ****             for (count = 0; count < SD_HALFFIFO; count++)
1726:lib/ff/sdio_stm32f1.c ****             {
1727:lib/ff/sdio_stm32f1.c ****               SDIO_WriteData(*(tempbuff + count));
1728:lib/ff/sdio_stm32f1.c ****             }
1729:lib/ff/sdio_stm32f1.c ****             tempbuff += SD_HALFFIFO;
1730:lib/ff/sdio_stm32f1.c ****             bytestransferred += SD_HALFFIFOBYTES;
1731:lib/ff/sdio_stm32f1.c ****           }
1732:lib/ff/sdio_stm32f1.c ****           else
1733:lib/ff/sdio_stm32f1.c ****           {
1734:lib/ff/sdio_stm32f1.c ****             restwords = ((TotalNumberOfBytes - bytestransferred) % 4 == 0) ? ((TotalNumberOfBytes -
1735:lib/ff/sdio_stm32f1.c ****                         ((TotalNumberOfBytes - bytestransferred) / 4 + 1);
1736:lib/ff/sdio_stm32f1.c **** 
1737:lib/ff/sdio_stm32f1.c ****             for (count = 0; count < restwords; count++, tempbuff++, bytestransferred += 4)
1738:lib/ff/sdio_stm32f1.c ****             {
1739:lib/ff/sdio_stm32f1.c ****               SDIO_WriteData(*tempbuff);
1740:lib/ff/sdio_stm32f1.c ****             }
1741:lib/ff/sdio_stm32f1.c ****           }
1742:lib/ff/sdio_stm32f1.c ****         }
1743:lib/ff/sdio_stm32f1.c ****       }
1744:lib/ff/sdio_stm32f1.c **** 
1745:lib/ff/sdio_stm32f1.c ****       if (SDIO_GetFlagStatus(SDIO_FLAG_DTIMEOUT) != RESET)
1746:lib/ff/sdio_stm32f1.c ****       {
1747:lib/ff/sdio_stm32f1.c ****         SDIO_ClearFlag(SDIO_FLAG_DTIMEOUT);
1748:lib/ff/sdio_stm32f1.c ****         errorstatus = SD_DATA_TIMEOUT;
1749:lib/ff/sdio_stm32f1.c ****         return(errorstatus);
1750:lib/ff/sdio_stm32f1.c ****       }
1751:lib/ff/sdio_stm32f1.c ****       else if (SDIO_GetFlagStatus(SDIO_FLAG_DCRCFAIL) != RESET)
1752:lib/ff/sdio_stm32f1.c ****       {
1753:lib/ff/sdio_stm32f1.c ****         SDIO_ClearFlag(SDIO_FLAG_DCRCFAIL);
1754:lib/ff/sdio_stm32f1.c ****         errorstatus = SD_DATA_CRC_FAIL;
1755:lib/ff/sdio_stm32f1.c ****         return(errorstatus);
1756:lib/ff/sdio_stm32f1.c ****       }
1757:lib/ff/sdio_stm32f1.c ****       else if (SDIO_GetFlagStatus(SDIO_FLAG_TXUNDERR) != RESET)
1758:lib/ff/sdio_stm32f1.c ****       {
1759:lib/ff/sdio_stm32f1.c ****         SDIO_ClearFlag(SDIO_FLAG_TXUNDERR);
1760:lib/ff/sdio_stm32f1.c ****         errorstatus = SD_TX_UNDERRUN;
1761:lib/ff/sdio_stm32f1.c ****         return(errorstatus);
1762:lib/ff/sdio_stm32f1.c ****       }
1763:lib/ff/sdio_stm32f1.c ****       else if (SDIO_GetFlagStatus(SDIO_FLAG_STBITERR) != RESET)
1764:lib/ff/sdio_stm32f1.c ****       {
1765:lib/ff/sdio_stm32f1.c ****         SDIO_ClearFlag(SDIO_FLAG_STBITERR);
1766:lib/ff/sdio_stm32f1.c ****         errorstatus = SD_START_BIT_ERR;
1767:lib/ff/sdio_stm32f1.c ****         return(errorstatus);
1768:lib/ff/sdio_stm32f1.c ****       }
1769:lib/ff/sdio_stm32f1.c **** 
1770:lib/ff/sdio_stm32f1.c ****       if (SDIO_GetFlagStatus(SDIO_FLAG_DATAEND) != RESET)
1771:lib/ff/sdio_stm32f1.c ****       {
1772:lib/ff/sdio_stm32f1.c ****        if ((SDIO_STD_CAPACITY_SD_CARD_V1_1 == CardType) || (SDIO_STD_CAPACITY_SD_CARD_V2_0 == CardT
1773:lib/ff/sdio_stm32f1.c ****         {
1774:lib/ff/sdio_stm32f1.c ****           /*!< Send CMD12 STOP_TRANSMISSION */
1775:lib/ff/sdio_stm32f1.c ****           SDIO_CmdInitStructure.SDIO_Argument = 0x0;
1776:lib/ff/sdio_stm32f1.c ****           SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_STOP_TRANSMISSION;
1777:lib/ff/sdio_stm32f1.c ****           SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
1778:lib/ff/sdio_stm32f1.c ****           SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
1779:lib/ff/sdio_stm32f1.c ****           SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
1780:lib/ff/sdio_stm32f1.c ****           SDIO_SendCommand(&SDIO_CmdInitStructure);
1781:lib/ff/sdio_stm32f1.c **** 
1782:lib/ff/sdio_stm32f1.c **** 
1783:lib/ff/sdio_stm32f1.c ****           errorstatus = CmdResp1Error(SD_CMD_STOP_TRANSMISSION);
1784:lib/ff/sdio_stm32f1.c **** 
1785:lib/ff/sdio_stm32f1.c ****           if (errorstatus != SD_OK)
1786:lib/ff/sdio_stm32f1.c ****           {
1787:lib/ff/sdio_stm32f1.c ****             return(errorstatus);
1788:lib/ff/sdio_stm32f1.c ****           }
1789:lib/ff/sdio_stm32f1.c ****         }
1790:lib/ff/sdio_stm32f1.c ****       }
1791:lib/ff/sdio_stm32f1.c ****     }
1792:lib/ff/sdio_stm32f1.c ****     else if (DeviceMode == SD_INTERRUPT_MODE)
1793:lib/ff/sdio_stm32f1.c ****     {
1794:lib/ff/sdio_stm32f1.c ****       SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND | SDIO_IT_TXFIFOHE | SDIO
1795:lib/ff/sdio_stm32f1.c ****       while ((TransferEnd == 0) && (TransferError == SD_OK))
1796:lib/ff/sdio_stm32f1.c ****       {}
1797:lib/ff/sdio_stm32f1.c ****       if (TransferError != SD_OK)
1798:lib/ff/sdio_stm32f1.c ****       {
1799:lib/ff/sdio_stm32f1.c ****         return(TransferError);
1800:lib/ff/sdio_stm32f1.c ****       }
1801:lib/ff/sdio_stm32f1.c ****     }
1802:lib/ff/sdio_stm32f1.c ****     else if (DeviceMode == SD_DMA_MODE)
1803:lib/ff/sdio_stm32f1.c ****     {
1804:lib/ff/sdio_stm32f1.c ****       SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND | SDIO_IT_TXUNDERR | SDIO
1805:lib/ff/sdio_stm32f1.c ****       SDIO_DMACmd(ENABLE);
1806:lib/ff/sdio_stm32f1.c ****       SD_LowLevel_DMA_TxConfig((uint32_t *)writebuff, (NumberOfBlocks * BlockSize));
1807:lib/ff/sdio_stm32f1.c ****       while ((SD_DMAEndOfTransferStatus() == RESET) && (TransferEnd == 0) && (TransferError == SD_O
1808:lib/ff/sdio_stm32f1.c ****       {}
1809:lib/ff/sdio_stm32f1.c ****       if (TransferError != SD_OK)
1810:lib/ff/sdio_stm32f1.c ****       {
1811:lib/ff/sdio_stm32f1.c ****         return(TransferError);
1812:lib/ff/sdio_stm32f1.c ****       }
1813:lib/ff/sdio_stm32f1.c ****     }
1814:lib/ff/sdio_stm32f1.c ****   }
1815:lib/ff/sdio_stm32f1.c ****   /*!< Clear all the static flags */
1816:lib/ff/sdio_stm32f1.c ****   SDIO_ClearFlag(SDIO_STATIC_FLAGS);
1817:lib/ff/sdio_stm32f1.c ****   
1818:lib/ff/sdio_stm32f1.c ****   /*!< Add some delay before checking the Card Status */
1819:lib/ff/sdio_stm32f1.c ****   for(count = 0; count < 0xFFFF; count++)
1820:lib/ff/sdio_stm32f1.c ****   {
1821:lib/ff/sdio_stm32f1.c ****   }
1822:lib/ff/sdio_stm32f1.c ****   /*!< Wait till the card is in programming state */
1823:lib/ff/sdio_stm32f1.c ****   errorstatus = IsCardProgramming(&cardstate);
1824:lib/ff/sdio_stm32f1.c **** 
1825:lib/ff/sdio_stm32f1.c ****   while ((errorstatus == SD_OK) && ((cardstate == SD_CARD_PROGRAMMING) || (cardstate == SD_CARD_REC
1826:lib/ff/sdio_stm32f1.c ****   {
1827:lib/ff/sdio_stm32f1.c ****     errorstatus = IsCardProgramming(&cardstate);
1828:lib/ff/sdio_stm32f1.c ****   }
1829:lib/ff/sdio_stm32f1.c **** 
1830:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
1831:lib/ff/sdio_stm32f1.c **** }
1832:lib/ff/sdio_stm32f1.c **** 
1833:lib/ff/sdio_stm32f1.c **** 
1834:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
1835:lib/ff/sdio_stm32f1.c **** /*! 
1836:lib/ff/sdio_stm32f1.c **** 	@brief  Gets the cuurent data transfer state.
1837:lib/ff/sdio_stm32f1.c **** 	@param  None
1838:lib/ff/sdio_stm32f1.c **** 	@retval SDTransferState: Data Transfer state.
1839:lib/ff/sdio_stm32f1.c **** 			This value can be: 
1840:lib/ff/sdio_stm32f1.c **** 			- SD_TRANSFER_OK: No data transfer is acting
1841:lib/ff/sdio_stm32f1.c **** 			- SD_TRANSFER_BUSY: Data transfer is acting
1842:lib/ff/sdio_stm32f1.c **** */
1843:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
1844:lib/ff/sdio_stm32f1.c **** SDTransferState SD_GetTransferState(void)
1845:lib/ff/sdio_stm32f1.c **** {
1846:lib/ff/sdio_stm32f1.c ****   if (SDIO->STA & (SDIO_FLAG_TXACT | SDIO_FLAG_RXACT))
1847:lib/ff/sdio_stm32f1.c ****   {
1848:lib/ff/sdio_stm32f1.c ****     return(SD_TRANSFER_BUSY);
1849:lib/ff/sdio_stm32f1.c ****   }
1850:lib/ff/sdio_stm32f1.c ****   else
1851:lib/ff/sdio_stm32f1.c ****   {
1852:lib/ff/sdio_stm32f1.c ****     return(SD_TRANSFER_OK);
1853:lib/ff/sdio_stm32f1.c ****   }
1854:lib/ff/sdio_stm32f1.c **** }
1855:lib/ff/sdio_stm32f1.c **** 
1856:lib/ff/sdio_stm32f1.c **** 
1857:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
1858:lib/ff/sdio_stm32f1.c **** /*! 
1859:lib/ff/sdio_stm32f1.c **** 	@brief  Aborts an ongoing data transfer.
1860:lib/ff/sdio_stm32f1.c **** 	@param  None
1861:lib/ff/sdio_stm32f1.c **** 	@retval SD_Error: SD Card Error code.
1862:lib/ff/sdio_stm32f1.c **** */
1863:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
1864:lib/ff/sdio_stm32f1.c **** SD_Error SD_StopTransfer(void)
1865:lib/ff/sdio_stm32f1.c **** {
1866:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
1867:lib/ff/sdio_stm32f1.c **** 
1868:lib/ff/sdio_stm32f1.c ****   /*!< Send CMD12 STOP_TRANSMISSION  */
1869:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = 0x0;
1870:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_STOP_TRANSMISSION;
1871:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
1872:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
1873:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
1874:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
1875:lib/ff/sdio_stm32f1.c **** 
1876:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_STOP_TRANSMISSION);
1877:lib/ff/sdio_stm32f1.c **** 
1878:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
1879:lib/ff/sdio_stm32f1.c **** }
1880:lib/ff/sdio_stm32f1.c **** 
1881:lib/ff/sdio_stm32f1.c **** 
1882:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
1883:lib/ff/sdio_stm32f1.c **** /*! 
1884:lib/ff/sdio_stm32f1.c **** 	@brief  Allows to erase memory area specified for the given card.
1885:lib/ff/sdio_stm32f1.c **** 	@param  startaddr: the start address.
1886:lib/ff/sdio_stm32f1.c **** 	@param  endaddr: the end address.
1887:lib/ff/sdio_stm32f1.c **** 	@retval SD_Error: SD Card Error code.
1888:lib/ff/sdio_stm32f1.c **** */
1889:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
1890:lib/ff/sdio_stm32f1.c **** SD_Error SD_Erase(uint64_t startaddr, uint64_t endaddr)
1891:lib/ff/sdio_stm32f1.c **** {
1892:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
1893:lib/ff/sdio_stm32f1.c ****   uint32_t delay = 0;
1894:lib/ff/sdio_stm32f1.c ****   __IO uint32_t maxdelay = 0;
1895:lib/ff/sdio_stm32f1.c ****   uint8_t cardstate = 0;
1896:lib/ff/sdio_stm32f1.c **** 
1897:lib/ff/sdio_stm32f1.c ****   /*!< Check if the card coomnd class supports erase command */
1898:lib/ff/sdio_stm32f1.c ****   if (((CSD_Tab[1] >> 20) & SD_CCCC_ERASE) == 0)
1899:lib/ff/sdio_stm32f1.c ****   {
1900:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_REQUEST_NOT_APPLICABLE;
1901:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
1902:lib/ff/sdio_stm32f1.c ****   }
1903:lib/ff/sdio_stm32f1.c **** 
1904:lib/ff/sdio_stm32f1.c ****   maxdelay = 120000 / ((SDIO->CLKCR & 0xFF) + 2);
1905:lib/ff/sdio_stm32f1.c **** 
1906:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetResponse(SDIO_RESP1) & SD_CARD_LOCKED)
1907:lib/ff/sdio_stm32f1.c ****   {
1908:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_LOCK_UNLOCK_FAILED;
1909:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
1910:lib/ff/sdio_stm32f1.c ****   }
1911:lib/ff/sdio_stm32f1.c **** 
1912:lib/ff/sdio_stm32f1.c ****   if (CardType == SDIO_HIGH_CAPACITY_SD_CARD)
1913:lib/ff/sdio_stm32f1.c ****   {
1914:lib/ff/sdio_stm32f1.c ****     startaddr /= 512;
1915:lib/ff/sdio_stm32f1.c ****     endaddr /= 512;
1916:lib/ff/sdio_stm32f1.c ****   }
1917:lib/ff/sdio_stm32f1.c ****   
1918:lib/ff/sdio_stm32f1.c ****   /*!< According to sd-card spec 1.0 ERASE_GROUP_START (CMD32) and erase_group_end(CMD33) */
1919:lib/ff/sdio_stm32f1.c ****   if ((SDIO_STD_CAPACITY_SD_CARD_V1_1 == CardType) || (SDIO_STD_CAPACITY_SD_CARD_V2_0 == CardType) 
1920:lib/ff/sdio_stm32f1.c ****   {
1921:lib/ff/sdio_stm32f1.c ****     /*!< Send CMD32 SD_ERASE_GRP_START with argument as addr  */
1922:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) startaddr;
1923:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SD_ERASE_GRP_START;
1924:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
1925:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
1926:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
1927:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
1928:lib/ff/sdio_stm32f1.c **** 
1929:lib/ff/sdio_stm32f1.c ****     errorstatus = CmdResp1Error(SD_CMD_SD_ERASE_GRP_START);
1930:lib/ff/sdio_stm32f1.c ****     if (errorstatus != SD_OK)
1931:lib/ff/sdio_stm32f1.c ****     {
1932:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
1933:lib/ff/sdio_stm32f1.c ****     }
1934:lib/ff/sdio_stm32f1.c **** 
1935:lib/ff/sdio_stm32f1.c ****     /*!< Send CMD33 SD_ERASE_GRP_END with argument as addr  */
1936:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) endaddr;
1937:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SD_ERASE_GRP_END;
1938:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
1939:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
1940:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
1941:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
1942:lib/ff/sdio_stm32f1.c **** 
1943:lib/ff/sdio_stm32f1.c ****     errorstatus = CmdResp1Error(SD_CMD_SD_ERASE_GRP_END);
1944:lib/ff/sdio_stm32f1.c ****     if (errorstatus != SD_OK)
1945:lib/ff/sdio_stm32f1.c ****     {
1946:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
1947:lib/ff/sdio_stm32f1.c ****     }
1948:lib/ff/sdio_stm32f1.c ****   }
1949:lib/ff/sdio_stm32f1.c **** 
1950:lib/ff/sdio_stm32f1.c ****   /*!< Send CMD38 ERASE */
1951:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = 0;
1952:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_ERASE;
1953:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
1954:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
1955:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
1956:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
1957:lib/ff/sdio_stm32f1.c **** 
1958:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_ERASE);
1959:lib/ff/sdio_stm32f1.c **** 
1960:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
1961:lib/ff/sdio_stm32f1.c ****   {
1962:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
1963:lib/ff/sdio_stm32f1.c ****   }
1964:lib/ff/sdio_stm32f1.c **** 
1965:lib/ff/sdio_stm32f1.c ****   for (delay = 0; delay < maxdelay; delay++)
1966:lib/ff/sdio_stm32f1.c ****   {}
1967:lib/ff/sdio_stm32f1.c **** 
1968:lib/ff/sdio_stm32f1.c ****   /*!< Wait till the card is in programming state */
1969:lib/ff/sdio_stm32f1.c ****   errorstatus = IsCardProgramming(&cardstate);
1970:lib/ff/sdio_stm32f1.c **** 
1971:lib/ff/sdio_stm32f1.c ****   while ((errorstatus == SD_OK) && ((SD_CARD_PROGRAMMING == cardstate) || (SD_CARD_RECEIVING == car
1972:lib/ff/sdio_stm32f1.c ****   {
1973:lib/ff/sdio_stm32f1.c ****     errorstatus = IsCardProgramming(&cardstate);
1974:lib/ff/sdio_stm32f1.c ****   }
1975:lib/ff/sdio_stm32f1.c **** 
1976:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
1977:lib/ff/sdio_stm32f1.c **** }
1978:lib/ff/sdio_stm32f1.c **** 
1979:lib/ff/sdio_stm32f1.c **** 
1980:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
1981:lib/ff/sdio_stm32f1.c **** /*! 
1982:lib/ff/sdio_stm32f1.c **** 	@brief  Returns the current card's status.
1983:lib/ff/sdio_stm32f1.c **** 	@param  pcardstatus: pointer to the buffer that will contain the SD card 
1984:lib/ff/sdio_stm32f1.c **** 			status (Card Status register).
1985:lib/ff/sdio_stm32f1.c **** 	@retval SD_Error: SD Card Error code.
1986:lib/ff/sdio_stm32f1.c **** */
1987:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
1988:lib/ff/sdio_stm32f1.c **** SD_Error SD_SendStatus(uint32_t *pcardstatus)
1989:lib/ff/sdio_stm32f1.c **** {
1990:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
1991:lib/ff/sdio_stm32f1.c **** 
1992:lib/ff/sdio_stm32f1.c ****   if (pcardstatus == NULL)
1993:lib/ff/sdio_stm32f1.c ****   {
1994:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_INVALID_PARAMETER;
1995:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
1996:lib/ff/sdio_stm32f1.c ****   }
1997:lib/ff/sdio_stm32f1.c **** 
1998:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) RCA << 16;
1999:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SEND_STATUS;
2000:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
2001:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
2002:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
2003:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
2004:lib/ff/sdio_stm32f1.c **** 
2005:lib/ff/sdio_stm32f1.c **** 
2006:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_SEND_STATUS);
2007:lib/ff/sdio_stm32f1.c **** 
2008:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
2009:lib/ff/sdio_stm32f1.c ****   {
2010:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2011:lib/ff/sdio_stm32f1.c ****   }
2012:lib/ff/sdio_stm32f1.c **** 
2013:lib/ff/sdio_stm32f1.c ****   *pcardstatus = SDIO_GetResponse(SDIO_RESP1);
2014:lib/ff/sdio_stm32f1.c **** 
2015:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
2016:lib/ff/sdio_stm32f1.c **** }
2017:lib/ff/sdio_stm32f1.c **** 
2018:lib/ff/sdio_stm32f1.c **** 
2019:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2020:lib/ff/sdio_stm32f1.c **** /*! 
2021:lib/ff/sdio_stm32f1.c **** 	@brief  Returns the current SD card's status.
2022:lib/ff/sdio_stm32f1.c **** 	@param  psdstatus: pointer to the buffer that will contain the SD card status 
2023:lib/ff/sdio_stm32f1.c **** 			(SD Status register).
2024:lib/ff/sdio_stm32f1.c **** 	@retval SD_Error: SD Card Error code.
2025:lib/ff/sdio_stm32f1.c **** */
2026:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2027:lib/ff/sdio_stm32f1.c **** SD_Error SD_SendSDStatus(uint32_t *psdstatus)
2028:lib/ff/sdio_stm32f1.c **** {
2029:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
2030:lib/ff/sdio_stm32f1.c ****   uint32_t count = 0;
2031:lib/ff/sdio_stm32f1.c **** 
2032:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetResponse(SDIO_RESP1) & SD_CARD_LOCKED)
2033:lib/ff/sdio_stm32f1.c ****   {
2034:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_LOCK_UNLOCK_FAILED;
2035:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2036:lib/ff/sdio_stm32f1.c ****   }
2037:lib/ff/sdio_stm32f1.c **** 
2038:lib/ff/sdio_stm32f1.c ****   /*!< Set block size for card if it is not equal to current block size for card. */
2039:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = 64;
2040:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SET_BLOCKLEN;
2041:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
2042:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
2043:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
2044:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
2045:lib/ff/sdio_stm32f1.c **** 
2046:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_SET_BLOCKLEN);
2047:lib/ff/sdio_stm32f1.c **** 
2048:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
2049:lib/ff/sdio_stm32f1.c ****   {
2050:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2051:lib/ff/sdio_stm32f1.c ****   }
2052:lib/ff/sdio_stm32f1.c **** 
2053:lib/ff/sdio_stm32f1.c ****   /*!< CMD55 */
2054:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) RCA << 16;
2055:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_CMD;
2056:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
2057:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
2058:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
2059:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
2060:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_APP_CMD);
2061:lib/ff/sdio_stm32f1.c **** 
2062:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
2063:lib/ff/sdio_stm32f1.c ****   {
2064:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2065:lib/ff/sdio_stm32f1.c ****   }
2066:lib/ff/sdio_stm32f1.c **** 
2067:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataTimeOut = SD_DATATIMEOUT;
2068:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataLength = 64;
2069:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataBlockSize = SDIO_DataBlockSize_64b;
2070:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToSDIO;
2071:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
2072:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Enable;
2073:lib/ff/sdio_stm32f1.c ****   SDIO_DataConfig(&SDIO_DataInitStructure);
2074:lib/ff/sdio_stm32f1.c **** 
2075:lib/ff/sdio_stm32f1.c ****   /*!< Send ACMD13 SD_APP_STAUS  with argument as card's RCA.*/
2076:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = 0;
2077:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SD_APP_STAUS;
2078:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
2079:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
2080:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
2081:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
2082:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_SD_APP_STAUS);
2083:lib/ff/sdio_stm32f1.c **** 
2084:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
2085:lib/ff/sdio_stm32f1.c ****   {
2086:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2087:lib/ff/sdio_stm32f1.c ****   }
2088:lib/ff/sdio_stm32f1.c **** 
2089:lib/ff/sdio_stm32f1.c ****   while (!(SDIO->STA &(SDIO_FLAG_RXOVERR | SDIO_FLAG_DCRCFAIL | SDIO_FLAG_DTIMEOUT | SDIO_FLAG_DBCK
2090:lib/ff/sdio_stm32f1.c ****   {
2091:lib/ff/sdio_stm32f1.c ****     if (SDIO_GetFlagStatus(SDIO_FLAG_RXFIFOHF) != RESET)
2092:lib/ff/sdio_stm32f1.c ****     {
2093:lib/ff/sdio_stm32f1.c ****       for (count = 0; count < 8; count++)
2094:lib/ff/sdio_stm32f1.c ****       {
2095:lib/ff/sdio_stm32f1.c ****         *(psdstatus + count) = SDIO_ReadData();
2096:lib/ff/sdio_stm32f1.c ****       }
2097:lib/ff/sdio_stm32f1.c ****       psdstatus += 8;
2098:lib/ff/sdio_stm32f1.c ****     }
2099:lib/ff/sdio_stm32f1.c ****   }
2100:lib/ff/sdio_stm32f1.c **** 
2101:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetFlagStatus(SDIO_FLAG_DTIMEOUT) != RESET)
2102:lib/ff/sdio_stm32f1.c ****   {
2103:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_DTIMEOUT);
2104:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_DATA_TIMEOUT;
2105:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2106:lib/ff/sdio_stm32f1.c ****   }
2107:lib/ff/sdio_stm32f1.c ****   else if (SDIO_GetFlagStatus(SDIO_FLAG_DCRCFAIL) != RESET)
2108:lib/ff/sdio_stm32f1.c ****   {
2109:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_DCRCFAIL);
2110:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_DATA_CRC_FAIL;
2111:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2112:lib/ff/sdio_stm32f1.c ****   }
2113:lib/ff/sdio_stm32f1.c ****   else if (SDIO_GetFlagStatus(SDIO_FLAG_RXOVERR) != RESET)
2114:lib/ff/sdio_stm32f1.c ****   {
2115:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_RXOVERR);
2116:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_RX_OVERRUN;
2117:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2118:lib/ff/sdio_stm32f1.c ****   }
2119:lib/ff/sdio_stm32f1.c ****   else if (SDIO_GetFlagStatus(SDIO_FLAG_STBITERR) != RESET)
2120:lib/ff/sdio_stm32f1.c ****   {
2121:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_STBITERR);
2122:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_START_BIT_ERR;
2123:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2124:lib/ff/sdio_stm32f1.c ****   }
2125:lib/ff/sdio_stm32f1.c **** 
2126:lib/ff/sdio_stm32f1.c ****   while (SDIO_GetFlagStatus(SDIO_FLAG_RXDAVL) != RESET)
2127:lib/ff/sdio_stm32f1.c ****   {
2128:lib/ff/sdio_stm32f1.c ****     *psdstatus = SDIO_ReadData();
2129:lib/ff/sdio_stm32f1.c ****     psdstatus++;
2130:lib/ff/sdio_stm32f1.c ****   }
2131:lib/ff/sdio_stm32f1.c **** 
2132:lib/ff/sdio_stm32f1.c ****   /*!< Clear all the static status flags*/
2133:lib/ff/sdio_stm32f1.c ****   SDIO_ClearFlag(SDIO_STATIC_FLAGS);
2134:lib/ff/sdio_stm32f1.c ****   psdstatus -= 16;
2135:lib/ff/sdio_stm32f1.c ****   for (count = 0; count < 16; count++)
2136:lib/ff/sdio_stm32f1.c ****   {
2137:lib/ff/sdio_stm32f1.c ****     psdstatus[count] = ((psdstatus[count] & SD_0TO7BITS) << 24) |((psdstatus[count] & SD_8TO15BITS)
2138:lib/ff/sdio_stm32f1.c ****                        ((psdstatus[count] & SD_16TO23BITS) >> 8) |((psdstatus[count] & SD_24TO31BIT
2139:lib/ff/sdio_stm32f1.c ****   }
2140:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
2141:lib/ff/sdio_stm32f1.c **** }
2142:lib/ff/sdio_stm32f1.c **** 
2143:lib/ff/sdio_stm32f1.c **** 
2144:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2145:lib/ff/sdio_stm32f1.c **** /*! 
2146:lib/ff/sdio_stm32f1.c **** 	@brief  Allows to process all the interrupts that are high.
2147:lib/ff/sdio_stm32f1.c **** 	@param  None
2148:lib/ff/sdio_stm32f1.c **** 	@retval SD_Error: SD Card Error code.
2149:lib/ff/sdio_stm32f1.c **** */
2150:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2151:lib/ff/sdio_stm32f1.c **** SD_Error SD_ProcessIRQSrc(void)
2152:lib/ff/sdio_stm32f1.c **** {
2153:lib/ff/sdio_stm32f1.c ****   uint32_t count = 0, restwords = 0;
2154:lib/ff/sdio_stm32f1.c **** 
2155:lib/ff/sdio_stm32f1.c ****   if (DeviceMode == SD_INTERRUPT_MODE)
2156:lib/ff/sdio_stm32f1.c ****   {
2157:lib/ff/sdio_stm32f1.c ****     if (SDIO_GetITStatus(SDIO_IT_RXFIFOHF) != RESET)
2158:lib/ff/sdio_stm32f1.c ****     {
2159:lib/ff/sdio_stm32f1.c ****       for (count = 0; count < SD_HALFFIFO; count++)
2160:lib/ff/sdio_stm32f1.c ****       {
2161:lib/ff/sdio_stm32f1.c ****         *(DestBuffer + count) = SDIO_ReadData();
2162:lib/ff/sdio_stm32f1.c ****       }
2163:lib/ff/sdio_stm32f1.c ****       DestBuffer += SD_HALFFIFO;
2164:lib/ff/sdio_stm32f1.c ****       NumberOfBytes += SD_HALFFIFOBYTES;
2165:lib/ff/sdio_stm32f1.c ****     }
2166:lib/ff/sdio_stm32f1.c ****     else if (SDIO_GetITStatus(SDIO_IT_TXFIFOHE) != RESET)
2167:lib/ff/sdio_stm32f1.c ****     {
2168:lib/ff/sdio_stm32f1.c ****       if ((TotalNumberOfBytes - NumberOfBytes) < SD_HALFFIFOBYTES)
2169:lib/ff/sdio_stm32f1.c ****       {
2170:lib/ff/sdio_stm32f1.c ****         restwords = ((TotalNumberOfBytes - NumberOfBytes) %  4 == 0) ?
2171:lib/ff/sdio_stm32f1.c ****                     ((TotalNumberOfBytes - NumberOfBytes) / 4) :
2172:lib/ff/sdio_stm32f1.c ****                     ((TotalNumberOfBytes - NumberOfBytes) / 4 + 1);
2173:lib/ff/sdio_stm32f1.c **** 
2174:lib/ff/sdio_stm32f1.c ****         for (count = 0; count < restwords;  count++, SrcBuffer++, NumberOfBytes += 4)
2175:lib/ff/sdio_stm32f1.c ****         {
2176:lib/ff/sdio_stm32f1.c ****           SDIO_WriteData(*SrcBuffer);
2177:lib/ff/sdio_stm32f1.c ****         }
2178:lib/ff/sdio_stm32f1.c ****       }
2179:lib/ff/sdio_stm32f1.c ****       else
2180:lib/ff/sdio_stm32f1.c ****       {
2181:lib/ff/sdio_stm32f1.c ****         for (count = 0; count < SD_HALFFIFO; count++)
2182:lib/ff/sdio_stm32f1.c ****         {
2183:lib/ff/sdio_stm32f1.c ****           SDIO_WriteData(*(SrcBuffer + count));
2184:lib/ff/sdio_stm32f1.c ****         }
2185:lib/ff/sdio_stm32f1.c **** 
2186:lib/ff/sdio_stm32f1.c ****         SrcBuffer += SD_HALFFIFO;
2187:lib/ff/sdio_stm32f1.c ****         NumberOfBytes += SD_HALFFIFOBYTES;
2188:lib/ff/sdio_stm32f1.c ****       }
2189:lib/ff/sdio_stm32f1.c ****     }
2190:lib/ff/sdio_stm32f1.c ****   }
2191:lib/ff/sdio_stm32f1.c **** 
2192:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetITStatus(SDIO_IT_DATAEND) != RESET)
2193:lib/ff/sdio_stm32f1.c ****   {
2194:lib/ff/sdio_stm32f1.c ****     if (DeviceMode != SD_DMA_MODE)
2195:lib/ff/sdio_stm32f1.c ****     {
2196:lib/ff/sdio_stm32f1.c ****       while ((SDIO_GetFlagStatus(SDIO_FLAG_RXDAVL) != RESET)  &&  (NumberOfBytes < TotalNumberOfByt
2197:lib/ff/sdio_stm32f1.c ****       {
2198:lib/ff/sdio_stm32f1.c ****         *DestBuffer = SDIO_ReadData();
2199:lib/ff/sdio_stm32f1.c ****         DestBuffer++;
2200:lib/ff/sdio_stm32f1.c ****         NumberOfBytes += 4;
2201:lib/ff/sdio_stm32f1.c ****       }
2202:lib/ff/sdio_stm32f1.c ****     }
2203:lib/ff/sdio_stm32f1.c **** 
2204:lib/ff/sdio_stm32f1.c ****     if (StopCondition == 1)
2205:lib/ff/sdio_stm32f1.c ****     {
2206:lib/ff/sdio_stm32f1.c ****       TransferError = SD_StopTransfer();
2207:lib/ff/sdio_stm32f1.c ****     }
2208:lib/ff/sdio_stm32f1.c ****     else
2209:lib/ff/sdio_stm32f1.c ****     {
2210:lib/ff/sdio_stm32f1.c ****       TransferError = SD_OK;
2211:lib/ff/sdio_stm32f1.c ****     }
2212:lib/ff/sdio_stm32f1.c ****     SDIO_ClearITPendingBit(SDIO_IT_DATAEND);
2213:lib/ff/sdio_stm32f1.c ****     SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND |
2214:lib/ff/sdio_stm32f1.c ****                   SDIO_IT_TXFIFOHE | SDIO_IT_RXFIFOHF | SDIO_IT_TXUNDERR |
2215:lib/ff/sdio_stm32f1.c ****                   SDIO_IT_RXOVERR | SDIO_IT_STBITERR, DISABLE);
2216:lib/ff/sdio_stm32f1.c ****     TransferEnd = 1;
2217:lib/ff/sdio_stm32f1.c ****     NumberOfBytes = 0;
2218:lib/ff/sdio_stm32f1.c ****     return(TransferError);
2219:lib/ff/sdio_stm32f1.c ****   }
2220:lib/ff/sdio_stm32f1.c **** 
2221:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetITStatus(SDIO_IT_DCRCFAIL) != RESET)
2222:lib/ff/sdio_stm32f1.c ****   {
2223:lib/ff/sdio_stm32f1.c ****     SDIO_ClearITPendingBit(SDIO_IT_DCRCFAIL);
2224:lib/ff/sdio_stm32f1.c ****     SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND |
2225:lib/ff/sdio_stm32f1.c ****                   SDIO_IT_TXFIFOHE | SDIO_IT_RXFIFOHF | SDIO_IT_TXUNDERR |
2226:lib/ff/sdio_stm32f1.c ****                   SDIO_IT_RXOVERR | SDIO_IT_STBITERR, DISABLE);
2227:lib/ff/sdio_stm32f1.c ****     NumberOfBytes = 0;
2228:lib/ff/sdio_stm32f1.c ****     TransferError = SD_DATA_CRC_FAIL;
2229:lib/ff/sdio_stm32f1.c ****     return(SD_DATA_CRC_FAIL);
2230:lib/ff/sdio_stm32f1.c ****   }
2231:lib/ff/sdio_stm32f1.c **** 
2232:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetITStatus(SDIO_IT_DTIMEOUT) != RESET)
2233:lib/ff/sdio_stm32f1.c ****   {
2234:lib/ff/sdio_stm32f1.c ****     SDIO_ClearITPendingBit(SDIO_IT_DTIMEOUT);
2235:lib/ff/sdio_stm32f1.c ****     SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND |
2236:lib/ff/sdio_stm32f1.c ****                   SDIO_IT_TXFIFOHE | SDIO_IT_RXFIFOHF | SDIO_IT_TXUNDERR |
2237:lib/ff/sdio_stm32f1.c ****                   SDIO_IT_RXOVERR | SDIO_IT_STBITERR, DISABLE);
2238:lib/ff/sdio_stm32f1.c ****     NumberOfBytes = 0;
2239:lib/ff/sdio_stm32f1.c ****     TransferError = SD_DATA_TIMEOUT;
2240:lib/ff/sdio_stm32f1.c ****     return(SD_DATA_TIMEOUT);
2241:lib/ff/sdio_stm32f1.c ****   }
2242:lib/ff/sdio_stm32f1.c **** 
2243:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetITStatus(SDIO_IT_RXOVERR) != RESET)
2244:lib/ff/sdio_stm32f1.c ****   {
2245:lib/ff/sdio_stm32f1.c ****     SDIO_ClearITPendingBit(SDIO_IT_RXOVERR);
2246:lib/ff/sdio_stm32f1.c ****     SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND |
2247:lib/ff/sdio_stm32f1.c ****                   SDIO_IT_TXFIFOHE | SDIO_IT_RXFIFOHF | SDIO_IT_TXUNDERR |
2248:lib/ff/sdio_stm32f1.c ****                   SDIO_IT_RXOVERR | SDIO_IT_STBITERR, DISABLE);
2249:lib/ff/sdio_stm32f1.c ****     NumberOfBytes = 0;
2250:lib/ff/sdio_stm32f1.c ****     TransferError = SD_RX_OVERRUN;
2251:lib/ff/sdio_stm32f1.c ****     return(SD_RX_OVERRUN);
2252:lib/ff/sdio_stm32f1.c ****   }
2253:lib/ff/sdio_stm32f1.c **** 
2254:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetITStatus(SDIO_IT_TXUNDERR) != RESET)
2255:lib/ff/sdio_stm32f1.c ****   {
2256:lib/ff/sdio_stm32f1.c ****     SDIO_ClearITPendingBit(SDIO_IT_TXUNDERR);
2257:lib/ff/sdio_stm32f1.c ****     SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND |
2258:lib/ff/sdio_stm32f1.c ****                   SDIO_IT_TXFIFOHE | SDIO_IT_RXFIFOHF | SDIO_IT_TXUNDERR |
2259:lib/ff/sdio_stm32f1.c ****                   SDIO_IT_RXOVERR | SDIO_IT_STBITERR, DISABLE);
2260:lib/ff/sdio_stm32f1.c ****     NumberOfBytes = 0;
2261:lib/ff/sdio_stm32f1.c ****     TransferError = SD_TX_UNDERRUN;
2262:lib/ff/sdio_stm32f1.c ****     return(SD_TX_UNDERRUN);
2263:lib/ff/sdio_stm32f1.c ****   }
2264:lib/ff/sdio_stm32f1.c **** 
2265:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetITStatus(SDIO_IT_STBITERR) != RESET)
2266:lib/ff/sdio_stm32f1.c ****   {
2267:lib/ff/sdio_stm32f1.c ****     SDIO_ClearITPendingBit(SDIO_IT_STBITERR);
2268:lib/ff/sdio_stm32f1.c ****     SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND |
2269:lib/ff/sdio_stm32f1.c ****                   SDIO_IT_TXFIFOHE | SDIO_IT_RXFIFOHF | SDIO_IT_TXUNDERR |
2270:lib/ff/sdio_stm32f1.c ****                   SDIO_IT_RXOVERR | SDIO_IT_STBITERR, DISABLE);
2271:lib/ff/sdio_stm32f1.c ****     NumberOfBytes = 0;
2272:lib/ff/sdio_stm32f1.c ****     TransferError = SD_START_BIT_ERR;
2273:lib/ff/sdio_stm32f1.c ****     return(SD_START_BIT_ERR);
2274:lib/ff/sdio_stm32f1.c ****   }
2275:lib/ff/sdio_stm32f1.c **** 
2276:lib/ff/sdio_stm32f1.c ****   return(SD_OK);
2277:lib/ff/sdio_stm32f1.c **** }
2278:lib/ff/sdio_stm32f1.c **** 
2279:lib/ff/sdio_stm32f1.c **** 
2280:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2281:lib/ff/sdio_stm32f1.c **** /*! 
2282:lib/ff/sdio_stm32f1.c **** 	@brief  Checks for error conditions for CMD0.
2283:lib/ff/sdio_stm32f1.c **** 	@param  None
2284:lib/ff/sdio_stm32f1.c **** 	@retval SD_Error: SD Card Error code.
2285:lib/ff/sdio_stm32f1.c **** */
2286:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2287:lib/ff/sdio_stm32f1.c **** static SD_Error CmdError(void)
2288:lib/ff/sdio_stm32f1.c **** {
2289:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
2290:lib/ff/sdio_stm32f1.c ****   uint32_t timeout;
2291:lib/ff/sdio_stm32f1.c **** 
2292:lib/ff/sdio_stm32f1.c ****   timeout = SDIO_CMD0TIMEOUT; /*!< 10000 */
2293:lib/ff/sdio_stm32f1.c **** 
2294:lib/ff/sdio_stm32f1.c ****   while ((timeout > 0) && (SDIO_GetFlagStatus(SDIO_FLAG_CMDSENT) == RESET))
2295:lib/ff/sdio_stm32f1.c ****   {
2296:lib/ff/sdio_stm32f1.c ****     timeout--;
2297:lib/ff/sdio_stm32f1.c ****   }
2298:lib/ff/sdio_stm32f1.c **** 
2299:lib/ff/sdio_stm32f1.c ****   if (timeout == 0)
2300:lib/ff/sdio_stm32f1.c ****   {
2301:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_CMD_RSP_TIMEOUT;
2302:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2303:lib/ff/sdio_stm32f1.c ****   }
2304:lib/ff/sdio_stm32f1.c **** 
2305:lib/ff/sdio_stm32f1.c ****   /*!< Clear all the static flags */
2306:lib/ff/sdio_stm32f1.c ****   SDIO_ClearFlag(SDIO_STATIC_FLAGS);
2307:lib/ff/sdio_stm32f1.c **** 
2308:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
2309:lib/ff/sdio_stm32f1.c **** }
2310:lib/ff/sdio_stm32f1.c **** 
2311:lib/ff/sdio_stm32f1.c **** 
2312:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2313:lib/ff/sdio_stm32f1.c **** /*! 
2314:lib/ff/sdio_stm32f1.c **** 	@brief  Checks for error conditions for R7 response.
2315:lib/ff/sdio_stm32f1.c **** 	@param  None
2316:lib/ff/sdio_stm32f1.c **** 	@retval SD_Error: SD Card Error code.
2317:lib/ff/sdio_stm32f1.c **** */
2318:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2319:lib/ff/sdio_stm32f1.c **** static SD_Error CmdResp7Error(void)
2320:lib/ff/sdio_stm32f1.c **** {
2321:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
2322:lib/ff/sdio_stm32f1.c ****   uint32_t status;
2323:lib/ff/sdio_stm32f1.c ****   uint32_t timeout = SDIO_CMD0TIMEOUT;
2324:lib/ff/sdio_stm32f1.c **** 
2325:lib/ff/sdio_stm32f1.c ****   status = SDIO->STA;
2326:lib/ff/sdio_stm32f1.c **** 
2327:lib/ff/sdio_stm32f1.c ****   while (!(status & (SDIO_FLAG_CCRCFAIL | SDIO_FLAG_CMDREND | SDIO_FLAG_CTIMEOUT)) && (timeout > 0)
2328:lib/ff/sdio_stm32f1.c ****   {
2329:lib/ff/sdio_stm32f1.c ****     timeout--;
2330:lib/ff/sdio_stm32f1.c ****     status = SDIO->STA;
2331:lib/ff/sdio_stm32f1.c ****   }
2332:lib/ff/sdio_stm32f1.c **** 
2333:lib/ff/sdio_stm32f1.c ****   if ((timeout == 0) || (status & SDIO_FLAG_CTIMEOUT))
2334:lib/ff/sdio_stm32f1.c ****   {
2335:lib/ff/sdio_stm32f1.c ****     /*!< Card is not V2.0 complient or card does not support the set voltage range */
2336:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_CMD_RSP_TIMEOUT;
2337:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_CTIMEOUT);
2338:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2339:lib/ff/sdio_stm32f1.c ****   }
2340:lib/ff/sdio_stm32f1.c **** 
2341:lib/ff/sdio_stm32f1.c ****   if (status & SDIO_FLAG_CMDREND)
2342:lib/ff/sdio_stm32f1.c ****   {
2343:lib/ff/sdio_stm32f1.c ****     /*!< Card is SD V2.0 compliant */
2344:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_OK;
2345:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_CMDREND);
2346:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2347:lib/ff/sdio_stm32f1.c ****   }
2348:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
2349:lib/ff/sdio_stm32f1.c **** }
2350:lib/ff/sdio_stm32f1.c **** 
2351:lib/ff/sdio_stm32f1.c **** 
2352:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2353:lib/ff/sdio_stm32f1.c **** /*! 
2354:lib/ff/sdio_stm32f1.c **** 	@brief  Checks for error conditions for R1 response.
2355:lib/ff/sdio_stm32f1.c **** 	@param  cmd: The sent command index.
2356:lib/ff/sdio_stm32f1.c **** 	@retval SD_Error: SD Card Error code.
2357:lib/ff/sdio_stm32f1.c **** */
2358:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2359:lib/ff/sdio_stm32f1.c **** static SD_Error CmdResp1Error(uint8_t cmd)
2360:lib/ff/sdio_stm32f1.c **** {
2361:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
2362:lib/ff/sdio_stm32f1.c ****   uint32_t status;
2363:lib/ff/sdio_stm32f1.c ****   uint32_t response_r1;
2364:lib/ff/sdio_stm32f1.c **** 
2365:lib/ff/sdio_stm32f1.c ****   status = SDIO->STA;
2366:lib/ff/sdio_stm32f1.c **** 
2367:lib/ff/sdio_stm32f1.c ****   while (!(status & (SDIO_FLAG_CCRCFAIL | SDIO_FLAG_CMDREND | SDIO_FLAG_CTIMEOUT)))
2368:lib/ff/sdio_stm32f1.c ****   {
2369:lib/ff/sdio_stm32f1.c ****     status = SDIO->STA;
2370:lib/ff/sdio_stm32f1.c ****   }
2371:lib/ff/sdio_stm32f1.c **** 
2372:lib/ff/sdio_stm32f1.c ****   if (status & SDIO_FLAG_CTIMEOUT)
2373:lib/ff/sdio_stm32f1.c ****   {
2374:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_CMD_RSP_TIMEOUT;
2375:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_CTIMEOUT);
2376:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2377:lib/ff/sdio_stm32f1.c ****   }
2378:lib/ff/sdio_stm32f1.c ****   else if (status & SDIO_FLAG_CCRCFAIL)
2379:lib/ff/sdio_stm32f1.c ****   {
2380:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_CMD_CRC_FAIL;
2381:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_CCRCFAIL);
2382:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2383:lib/ff/sdio_stm32f1.c ****   }
2384:lib/ff/sdio_stm32f1.c **** 
2385:lib/ff/sdio_stm32f1.c ****   /*!< Check response received is of desired command */
2386:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetCommandResponse() != cmd)
2387:lib/ff/sdio_stm32f1.c ****   {
2388:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_ILLEGAL_CMD;
2389:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2390:lib/ff/sdio_stm32f1.c ****   }
2391:lib/ff/sdio_stm32f1.c **** 
2392:lib/ff/sdio_stm32f1.c ****   /*!< Clear all the static flags */
2393:lib/ff/sdio_stm32f1.c ****   SDIO_ClearFlag(SDIO_STATIC_FLAGS);
2394:lib/ff/sdio_stm32f1.c **** 
2395:lib/ff/sdio_stm32f1.c ****   /*!< We have received response, retrieve it for analysis  */
2396:lib/ff/sdio_stm32f1.c ****   response_r1 = SDIO_GetResponse(SDIO_RESP1);
2397:lib/ff/sdio_stm32f1.c **** 
2398:lib/ff/sdio_stm32f1.c ****   if ((response_r1 & SD_OCR_ERRORBITS) == SD_ALLZERO)
2399:lib/ff/sdio_stm32f1.c ****   {
2400:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2401:lib/ff/sdio_stm32f1.c ****   }
2402:lib/ff/sdio_stm32f1.c **** 
2403:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_ADDR_OUT_OF_RANGE)
2404:lib/ff/sdio_stm32f1.c ****   {
2405:lib/ff/sdio_stm32f1.c ****     return(SD_ADDR_OUT_OF_RANGE);
2406:lib/ff/sdio_stm32f1.c ****   }
2407:lib/ff/sdio_stm32f1.c **** 
2408:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_ADDR_MISALIGNED)
2409:lib/ff/sdio_stm32f1.c ****   {
2410:lib/ff/sdio_stm32f1.c ****     return(SD_ADDR_MISALIGNED);
2411:lib/ff/sdio_stm32f1.c ****   }
2412:lib/ff/sdio_stm32f1.c **** 
2413:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_BLOCK_LEN_ERR)
2414:lib/ff/sdio_stm32f1.c ****   {
2415:lib/ff/sdio_stm32f1.c ****     return(SD_BLOCK_LEN_ERR);
2416:lib/ff/sdio_stm32f1.c ****   }
2417:lib/ff/sdio_stm32f1.c **** 
2418:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_ERASE_SEQ_ERR)
2419:lib/ff/sdio_stm32f1.c ****   {
2420:lib/ff/sdio_stm32f1.c ****     return(SD_ERASE_SEQ_ERR);
2421:lib/ff/sdio_stm32f1.c ****   }
2422:lib/ff/sdio_stm32f1.c **** 
2423:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_BAD_ERASE_PARAM)
2424:lib/ff/sdio_stm32f1.c ****   {
2425:lib/ff/sdio_stm32f1.c ****     return(SD_BAD_ERASE_PARAM);
2426:lib/ff/sdio_stm32f1.c ****   }
2427:lib/ff/sdio_stm32f1.c **** 
2428:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_WRITE_PROT_VIOLATION)
2429:lib/ff/sdio_stm32f1.c ****   {
2430:lib/ff/sdio_stm32f1.c ****     return(SD_WRITE_PROT_VIOLATION);
2431:lib/ff/sdio_stm32f1.c ****   }
2432:lib/ff/sdio_stm32f1.c **** 
2433:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_LOCK_UNLOCK_FAILED)
2434:lib/ff/sdio_stm32f1.c ****   {
2435:lib/ff/sdio_stm32f1.c ****     return(SD_LOCK_UNLOCK_FAILED);
2436:lib/ff/sdio_stm32f1.c ****   }
2437:lib/ff/sdio_stm32f1.c **** 
2438:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_COM_CRC_FAILED)
2439:lib/ff/sdio_stm32f1.c ****   {
2440:lib/ff/sdio_stm32f1.c ****     return(SD_COM_CRC_FAILED);
2441:lib/ff/sdio_stm32f1.c ****   }
2442:lib/ff/sdio_stm32f1.c **** 
2443:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_ILLEGAL_CMD)
2444:lib/ff/sdio_stm32f1.c ****   {
2445:lib/ff/sdio_stm32f1.c ****     return(SD_ILLEGAL_CMD);
2446:lib/ff/sdio_stm32f1.c ****   }
2447:lib/ff/sdio_stm32f1.c **** 
2448:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_CARD_ECC_FAILED)
2449:lib/ff/sdio_stm32f1.c ****   {
2450:lib/ff/sdio_stm32f1.c ****     return(SD_CARD_ECC_FAILED);
2451:lib/ff/sdio_stm32f1.c ****   }
2452:lib/ff/sdio_stm32f1.c **** 
2453:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_CC_ERROR)
2454:lib/ff/sdio_stm32f1.c ****   {
2455:lib/ff/sdio_stm32f1.c ****     return(SD_CC_ERROR);
2456:lib/ff/sdio_stm32f1.c ****   }
2457:lib/ff/sdio_stm32f1.c **** 
2458:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_GENERAL_UNKNOWN_ERROR)
2459:lib/ff/sdio_stm32f1.c ****   {
2460:lib/ff/sdio_stm32f1.c ****     return(SD_GENERAL_UNKNOWN_ERROR);
2461:lib/ff/sdio_stm32f1.c ****   }
2462:lib/ff/sdio_stm32f1.c **** 
2463:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_STREAM_READ_UNDERRUN)
2464:lib/ff/sdio_stm32f1.c ****   {
2465:lib/ff/sdio_stm32f1.c ****     return(SD_STREAM_READ_UNDERRUN);
2466:lib/ff/sdio_stm32f1.c ****   }
2467:lib/ff/sdio_stm32f1.c **** 
2468:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_STREAM_WRITE_OVERRUN)
2469:lib/ff/sdio_stm32f1.c ****   {
2470:lib/ff/sdio_stm32f1.c ****     return(SD_STREAM_WRITE_OVERRUN);
2471:lib/ff/sdio_stm32f1.c ****   }
2472:lib/ff/sdio_stm32f1.c **** 
2473:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_CID_CSD_OVERWRIETE)
2474:lib/ff/sdio_stm32f1.c ****   {
2475:lib/ff/sdio_stm32f1.c ****     return(SD_CID_CSD_OVERWRITE);
2476:lib/ff/sdio_stm32f1.c ****   }
2477:lib/ff/sdio_stm32f1.c **** 
2478:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_WP_ERASE_SKIP)
2479:lib/ff/sdio_stm32f1.c ****   {
2480:lib/ff/sdio_stm32f1.c ****     return(SD_WP_ERASE_SKIP);
2481:lib/ff/sdio_stm32f1.c ****   }
2482:lib/ff/sdio_stm32f1.c **** 
2483:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_CARD_ECC_DISABLED)
2484:lib/ff/sdio_stm32f1.c ****   {
2485:lib/ff/sdio_stm32f1.c ****     return(SD_CARD_ECC_DISABLED);
2486:lib/ff/sdio_stm32f1.c ****   }
2487:lib/ff/sdio_stm32f1.c **** 
2488:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_ERASE_RESET)
2489:lib/ff/sdio_stm32f1.c ****   {
2490:lib/ff/sdio_stm32f1.c ****     return(SD_ERASE_RESET);
2491:lib/ff/sdio_stm32f1.c ****   }
2492:lib/ff/sdio_stm32f1.c **** 
2493:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_AKE_SEQ_ERROR)
2494:lib/ff/sdio_stm32f1.c ****   {
2495:lib/ff/sdio_stm32f1.c ****     return(SD_AKE_SEQ_ERROR);
2496:lib/ff/sdio_stm32f1.c ****   }
2497:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
2498:lib/ff/sdio_stm32f1.c **** }
2499:lib/ff/sdio_stm32f1.c **** 
2500:lib/ff/sdio_stm32f1.c **** 
2501:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2502:lib/ff/sdio_stm32f1.c **** /*! 
2503:lib/ff/sdio_stm32f1.c **** 	@brief  Checks for error conditions for R3 (OCR) response.
2504:lib/ff/sdio_stm32f1.c **** 	@param  None
2505:lib/ff/sdio_stm32f1.c **** 	@retval SD_Error: SD Card Error code.
2506:lib/ff/sdio_stm32f1.c **** */
2507:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2508:lib/ff/sdio_stm32f1.c **** static SD_Error CmdResp3Error(void)
2509:lib/ff/sdio_stm32f1.c **** {
2510:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
2511:lib/ff/sdio_stm32f1.c ****   uint32_t status;
2512:lib/ff/sdio_stm32f1.c **** 
2513:lib/ff/sdio_stm32f1.c ****   status = SDIO->STA;
2514:lib/ff/sdio_stm32f1.c **** 
2515:lib/ff/sdio_stm32f1.c ****   while (!(status & (SDIO_FLAG_CCRCFAIL | SDIO_FLAG_CMDREND | SDIO_FLAG_CTIMEOUT)))
2516:lib/ff/sdio_stm32f1.c ****   {
2517:lib/ff/sdio_stm32f1.c ****     status = SDIO->STA;
2518:lib/ff/sdio_stm32f1.c ****   }
2519:lib/ff/sdio_stm32f1.c **** 
2520:lib/ff/sdio_stm32f1.c ****   if (status & SDIO_FLAG_CTIMEOUT)
2521:lib/ff/sdio_stm32f1.c ****   {
2522:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_CMD_RSP_TIMEOUT;
2523:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_CTIMEOUT);
2524:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2525:lib/ff/sdio_stm32f1.c ****   }
2526:lib/ff/sdio_stm32f1.c ****   /*!< Clear all the static flags */
2527:lib/ff/sdio_stm32f1.c ****   SDIO_ClearFlag(SDIO_STATIC_FLAGS);
2528:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
2529:lib/ff/sdio_stm32f1.c **** }
2530:lib/ff/sdio_stm32f1.c **** 
2531:lib/ff/sdio_stm32f1.c **** 
2532:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2533:lib/ff/sdio_stm32f1.c **** /*! 
2534:lib/ff/sdio_stm32f1.c **** 	@brief  Checks for error conditions for R2 (CID or CSD) response.
2535:lib/ff/sdio_stm32f1.c **** 	@param  None
2536:lib/ff/sdio_stm32f1.c **** 	@retval SD_Error: SD Card Error code.
2537:lib/ff/sdio_stm32f1.c **** */
2538:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2539:lib/ff/sdio_stm32f1.c **** static SD_Error CmdResp2Error(void)
2540:lib/ff/sdio_stm32f1.c **** {
  26              		.loc 1 2540 0
  27              		.cfi_startproc
  28              		@ args = 0, pretend = 0, frame = 0
  29              		@ frame_needed = 0, uses_anonymous_args = 0
  30 0000 08B5     		push	{r3, lr}
  31              	.LCFI0:
  32              		.cfi_def_cfa_offset 8
  33              		.cfi_offset 3, -8
  34              		.cfi_offset 14, -4
  35              	.LVL0:
2541:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
2542:lib/ff/sdio_stm32f1.c ****   uint32_t status;
2543:lib/ff/sdio_stm32f1.c **** 
2544:lib/ff/sdio_stm32f1.c ****   status = SDIO->STA;
  36              		.loc 1 2544 0
  37 0002 0C4A     		ldr	r2, .L8
  38              	.L3:
2545:lib/ff/sdio_stm32f1.c **** 
2546:lib/ff/sdio_stm32f1.c ****   while (!(status & (SDIO_FLAG_CCRCFAIL | SDIO_FLAG_CTIMEOUT | SDIO_FLAG_CMDREND)))
2547:lib/ff/sdio_stm32f1.c ****   {
2548:lib/ff/sdio_stm32f1.c ****     status = SDIO->STA;
  39              		.loc 1 2548 0
  40 0004 536B     		ldr	r3, [r2, #52]
  41              	.LVL1:
2546:lib/ff/sdio_stm32f1.c ****   {
  42              		.loc 1 2546 0
  43 0006 13F0450F 		tst	r3, #69
  44 000a FBD0     		beq	.L3
2549:lib/ff/sdio_stm32f1.c ****   }
2550:lib/ff/sdio_stm32f1.c **** 
2551:lib/ff/sdio_stm32f1.c ****   if (status & SDIO_FLAG_CTIMEOUT)
  45              		.loc 1 2551 0
  46 000c 5A07     		lsls	r2, r3, #29
  47 000e 04D5     		bpl	.L4
  48              	.LVL2:
2552:lib/ff/sdio_stm32f1.c ****   {
2553:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_CMD_RSP_TIMEOUT;
2554:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_CTIMEOUT);
  49              		.loc 1 2554 0
  50 0010 0420     		movs	r0, #4
  51 0012 FFF7FEFF 		bl	SDIO_ClearFlag
  52              	.LVL3:
2555:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
  53              		.loc 1 2555 0
  54 0016 0320     		movs	r0, #3
  55 0018 08BD     		pop	{r3, pc}
  56              	.LVL4:
  57              	.L4:
2556:lib/ff/sdio_stm32f1.c ****   }
2557:lib/ff/sdio_stm32f1.c ****   else if (status & SDIO_FLAG_CCRCFAIL)
  58              		.loc 1 2557 0
  59 001a DB07     		lsls	r3, r3, #31
  60              	.LVL5:
  61 001c 04D5     		bpl	.L6
  62              	.LVL6:
2558:lib/ff/sdio_stm32f1.c ****   {
2559:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_CMD_CRC_FAIL;
2560:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_CCRCFAIL);
  63              		.loc 1 2560 0
  64 001e 0120     		movs	r0, #1
  65 0020 FFF7FEFF 		bl	SDIO_ClearFlag
  66              	.LVL7:
2561:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
  67              		.loc 1 2561 0
  68 0024 0120     		movs	r0, #1
  69 0026 08BD     		pop	{r3, pc}
  70              	.LVL8:
  71              	.L6:
2562:lib/ff/sdio_stm32f1.c ****   }
2563:lib/ff/sdio_stm32f1.c **** 
2564:lib/ff/sdio_stm32f1.c ****   /*!< Clear all the static flags */
2565:lib/ff/sdio_stm32f1.c ****   SDIO_ClearFlag(SDIO_STATIC_FLAGS);
  72              		.loc 1 2565 0
  73 0028 40F2FF50 		movw	r0, #1535
  74 002c FFF7FEFF 		bl	SDIO_ClearFlag
  75              	.LVL9:
2566:lib/ff/sdio_stm32f1.c **** 
2567:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
  76              		.loc 1 2567 0
  77 0030 2A20     		movs	r0, #42
2568:lib/ff/sdio_stm32f1.c **** }
  78              		.loc 1 2568 0
  79 0032 08BD     		pop	{r3, pc}
  80              	.L9:
  81              		.align	2
  82              	.L8:
  83 0034 00800140 		.word	1073840128
  84              		.cfi_endproc
  85              	.LFE82:
  87              		.section	.text.IsCardProgramming,"ax",%progbits
  88              		.align	1
  89              		.thumb
  90              		.thumb_func
  92              	IsCardProgramming:
  93              	.LFB85:
2569:lib/ff/sdio_stm32f1.c **** 
2570:lib/ff/sdio_stm32f1.c **** 
2571:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2572:lib/ff/sdio_stm32f1.c **** /*! 
2573:lib/ff/sdio_stm32f1.c **** 	@brief  Checks for error conditions for R6 (RCA) response.
2574:lib/ff/sdio_stm32f1.c **** 	@param  cmd: The sent command index.
2575:lib/ff/sdio_stm32f1.c **** 	@param  prca: pointer to the variable that will contain the SD card relative 
2576:lib/ff/sdio_stm32f1.c **** 			address RCA. 
2577:lib/ff/sdio_stm32f1.c **** 	@retval SD_Error: SD Card Error code.
2578:lib/ff/sdio_stm32f1.c **** */
2579:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2580:lib/ff/sdio_stm32f1.c **** static SD_Error CmdResp6Error(uint8_t cmd, uint16_t *prca)
2581:lib/ff/sdio_stm32f1.c **** {
2582:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
2583:lib/ff/sdio_stm32f1.c ****   uint32_t status;
2584:lib/ff/sdio_stm32f1.c ****   uint32_t response_r1;
2585:lib/ff/sdio_stm32f1.c **** 
2586:lib/ff/sdio_stm32f1.c ****   status = SDIO->STA;
2587:lib/ff/sdio_stm32f1.c **** 
2588:lib/ff/sdio_stm32f1.c ****   while (!(status & (SDIO_FLAG_CCRCFAIL | SDIO_FLAG_CTIMEOUT | SDIO_FLAG_CMDREND)))
2589:lib/ff/sdio_stm32f1.c ****   {
2590:lib/ff/sdio_stm32f1.c ****     status = SDIO->STA;
2591:lib/ff/sdio_stm32f1.c ****   }
2592:lib/ff/sdio_stm32f1.c **** 
2593:lib/ff/sdio_stm32f1.c ****   if (status & SDIO_FLAG_CTIMEOUT)
2594:lib/ff/sdio_stm32f1.c ****   {
2595:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_CMD_RSP_TIMEOUT;
2596:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_CTIMEOUT);
2597:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2598:lib/ff/sdio_stm32f1.c ****   }
2599:lib/ff/sdio_stm32f1.c ****   else if (status & SDIO_FLAG_CCRCFAIL)
2600:lib/ff/sdio_stm32f1.c ****   {
2601:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_CMD_CRC_FAIL;
2602:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_CCRCFAIL);
2603:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2604:lib/ff/sdio_stm32f1.c ****   }
2605:lib/ff/sdio_stm32f1.c **** 
2606:lib/ff/sdio_stm32f1.c ****   /*!< Check response received is of desired command */
2607:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetCommandResponse() != cmd)
2608:lib/ff/sdio_stm32f1.c ****   {
2609:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_ILLEGAL_CMD;
2610:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2611:lib/ff/sdio_stm32f1.c ****   }
2612:lib/ff/sdio_stm32f1.c **** 
2613:lib/ff/sdio_stm32f1.c ****   /*!< Clear all the static flags */
2614:lib/ff/sdio_stm32f1.c ****   SDIO_ClearFlag(SDIO_STATIC_FLAGS);
2615:lib/ff/sdio_stm32f1.c **** 
2616:lib/ff/sdio_stm32f1.c ****   /*!< We have received response, retrieve it.  */
2617:lib/ff/sdio_stm32f1.c ****   response_r1 = SDIO_GetResponse(SDIO_RESP1);
2618:lib/ff/sdio_stm32f1.c **** 
2619:lib/ff/sdio_stm32f1.c ****   if (SD_ALLZERO == (response_r1 & (SD_R6_GENERAL_UNKNOWN_ERROR | SD_R6_ILLEGAL_CMD | SD_R6_COM_CRC
2620:lib/ff/sdio_stm32f1.c ****   {
2621:lib/ff/sdio_stm32f1.c ****     *prca = (uint16_t) (response_r1 >> 16);
2622:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2623:lib/ff/sdio_stm32f1.c ****   }
2624:lib/ff/sdio_stm32f1.c **** 
2625:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_R6_GENERAL_UNKNOWN_ERROR)
2626:lib/ff/sdio_stm32f1.c ****   {
2627:lib/ff/sdio_stm32f1.c ****     return(SD_GENERAL_UNKNOWN_ERROR);
2628:lib/ff/sdio_stm32f1.c ****   }
2629:lib/ff/sdio_stm32f1.c **** 
2630:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_R6_ILLEGAL_CMD)
2631:lib/ff/sdio_stm32f1.c ****   {
2632:lib/ff/sdio_stm32f1.c ****     return(SD_ILLEGAL_CMD);
2633:lib/ff/sdio_stm32f1.c ****   }
2634:lib/ff/sdio_stm32f1.c **** 
2635:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_R6_COM_CRC_FAILED)
2636:lib/ff/sdio_stm32f1.c ****   {
2637:lib/ff/sdio_stm32f1.c ****     return(SD_COM_CRC_FAILED);
2638:lib/ff/sdio_stm32f1.c ****   }
2639:lib/ff/sdio_stm32f1.c **** 
2640:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
2641:lib/ff/sdio_stm32f1.c **** }
2642:lib/ff/sdio_stm32f1.c **** 
2643:lib/ff/sdio_stm32f1.c **** 
2644:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2645:lib/ff/sdio_stm32f1.c **** /*! 
2646:lib/ff/sdio_stm32f1.c **** 	@brief  Enables or disables the SDIO wide bus mode.
2647:lib/ff/sdio_stm32f1.c **** 	@param  NewState: new state of the SDIO wide bus mode.
2648:lib/ff/sdio_stm32f1.c **** 		This parameter can be: ENABLE or DISABLE.
2649:lib/ff/sdio_stm32f1.c **** 	@retval SD_Error: SD Card Error code.
2650:lib/ff/sdio_stm32f1.c **** */
2651:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2652:lib/ff/sdio_stm32f1.c **** static SD_Error SDEnWideBus(FunctionalState NewState)
2653:lib/ff/sdio_stm32f1.c **** {
2654:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
2655:lib/ff/sdio_stm32f1.c **** 
2656:lib/ff/sdio_stm32f1.c ****   uint32_t scr[2] = {0, 0};
2657:lib/ff/sdio_stm32f1.c **** 
2658:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetResponse(SDIO_RESP1) & SD_CARD_LOCKED)
2659:lib/ff/sdio_stm32f1.c ****   {
2660:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_LOCK_UNLOCK_FAILED;
2661:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2662:lib/ff/sdio_stm32f1.c ****   }
2663:lib/ff/sdio_stm32f1.c **** 
2664:lib/ff/sdio_stm32f1.c ****   /*!< Get SCR Register */
2665:lib/ff/sdio_stm32f1.c ****   errorstatus = FindSCR(RCA, scr);
2666:lib/ff/sdio_stm32f1.c **** 
2667:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
2668:lib/ff/sdio_stm32f1.c ****   {
2669:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2670:lib/ff/sdio_stm32f1.c ****   }
2671:lib/ff/sdio_stm32f1.c **** 
2672:lib/ff/sdio_stm32f1.c ****   /*!< If wide bus operation to be enabled */
2673:lib/ff/sdio_stm32f1.c ****   if (NewState == ENABLE)
2674:lib/ff/sdio_stm32f1.c ****   {
2675:lib/ff/sdio_stm32f1.c ****     /*!< If requested card supports wide bus operation */
2676:lib/ff/sdio_stm32f1.c ****     if ((scr[1] & SD_WIDE_BUS_SUPPORT) != SD_ALLZERO)
2677:lib/ff/sdio_stm32f1.c ****     {
2678:lib/ff/sdio_stm32f1.c ****       /*!< Send CMD55 APP_CMD with argument as card's RCA.*/
2679:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) RCA << 16;
2680:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_CMD;
2681:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
2682:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
2683:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
2684:lib/ff/sdio_stm32f1.c ****       SDIO_SendCommand(&SDIO_CmdInitStructure);
2685:lib/ff/sdio_stm32f1.c **** 
2686:lib/ff/sdio_stm32f1.c ****       errorstatus = CmdResp1Error(SD_CMD_APP_CMD);
2687:lib/ff/sdio_stm32f1.c **** 
2688:lib/ff/sdio_stm32f1.c ****       if (errorstatus != SD_OK)
2689:lib/ff/sdio_stm32f1.c ****       {
2690:lib/ff/sdio_stm32f1.c ****         return(errorstatus);
2691:lib/ff/sdio_stm32f1.c ****       }
2692:lib/ff/sdio_stm32f1.c **** 
2693:lib/ff/sdio_stm32f1.c ****       /*!< Send ACMD6 APP_CMD with argument as 2 for wide bus mode */
2694:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Argument = 0x2;
2695:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_SD_SET_BUSWIDTH;
2696:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
2697:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
2698:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
2699:lib/ff/sdio_stm32f1.c ****       SDIO_SendCommand(&SDIO_CmdInitStructure);
2700:lib/ff/sdio_stm32f1.c **** 
2701:lib/ff/sdio_stm32f1.c ****       errorstatus = CmdResp1Error(SD_CMD_APP_SD_SET_BUSWIDTH);
2702:lib/ff/sdio_stm32f1.c **** 
2703:lib/ff/sdio_stm32f1.c ****       if (errorstatus != SD_OK)
2704:lib/ff/sdio_stm32f1.c ****       {
2705:lib/ff/sdio_stm32f1.c ****         return(errorstatus);
2706:lib/ff/sdio_stm32f1.c ****       }
2707:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
2708:lib/ff/sdio_stm32f1.c ****     }
2709:lib/ff/sdio_stm32f1.c ****     else
2710:lib/ff/sdio_stm32f1.c ****     {
2711:lib/ff/sdio_stm32f1.c ****       errorstatus = SD_REQUEST_NOT_APPLICABLE;
2712:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
2713:lib/ff/sdio_stm32f1.c ****     }
2714:lib/ff/sdio_stm32f1.c ****   }   /*!< If wide bus operation to be disabled */
2715:lib/ff/sdio_stm32f1.c ****   else
2716:lib/ff/sdio_stm32f1.c ****   {
2717:lib/ff/sdio_stm32f1.c ****     /*!< If requested card supports 1 bit mode operation */
2718:lib/ff/sdio_stm32f1.c ****     if ((scr[1] & SD_SINGLE_BUS_SUPPORT) != SD_ALLZERO)
2719:lib/ff/sdio_stm32f1.c ****     {
2720:lib/ff/sdio_stm32f1.c ****       /*!< Send CMD55 APP_CMD with argument as card's RCA.*/
2721:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) RCA << 16;
2722:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_CMD;
2723:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
2724:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
2725:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
2726:lib/ff/sdio_stm32f1.c ****       SDIO_SendCommand(&SDIO_CmdInitStructure);
2727:lib/ff/sdio_stm32f1.c **** 
2728:lib/ff/sdio_stm32f1.c **** 
2729:lib/ff/sdio_stm32f1.c ****       errorstatus = CmdResp1Error(SD_CMD_APP_CMD);
2730:lib/ff/sdio_stm32f1.c **** 
2731:lib/ff/sdio_stm32f1.c ****       if (errorstatus != SD_OK)
2732:lib/ff/sdio_stm32f1.c ****       {
2733:lib/ff/sdio_stm32f1.c ****         return(errorstatus);
2734:lib/ff/sdio_stm32f1.c ****       }
2735:lib/ff/sdio_stm32f1.c **** 
2736:lib/ff/sdio_stm32f1.c ****       /*!< Send ACMD6 APP_CMD with argument as 2 for wide bus mode */
2737:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Argument = 0x00;
2738:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_SD_SET_BUSWIDTH;
2739:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
2740:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
2741:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
2742:lib/ff/sdio_stm32f1.c ****       SDIO_SendCommand(&SDIO_CmdInitStructure);
2743:lib/ff/sdio_stm32f1.c **** 
2744:lib/ff/sdio_stm32f1.c ****       errorstatus = CmdResp1Error(SD_CMD_APP_SD_SET_BUSWIDTH);
2745:lib/ff/sdio_stm32f1.c **** 
2746:lib/ff/sdio_stm32f1.c ****       if (errorstatus != SD_OK)
2747:lib/ff/sdio_stm32f1.c ****       {
2748:lib/ff/sdio_stm32f1.c ****         return(errorstatus);
2749:lib/ff/sdio_stm32f1.c ****       }
2750:lib/ff/sdio_stm32f1.c **** 
2751:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
2752:lib/ff/sdio_stm32f1.c ****     }
2753:lib/ff/sdio_stm32f1.c ****     else
2754:lib/ff/sdio_stm32f1.c ****     {
2755:lib/ff/sdio_stm32f1.c ****       errorstatus = SD_REQUEST_NOT_APPLICABLE;
2756:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
2757:lib/ff/sdio_stm32f1.c ****     }
2758:lib/ff/sdio_stm32f1.c ****   }
2759:lib/ff/sdio_stm32f1.c **** }
2760:lib/ff/sdio_stm32f1.c **** 
2761:lib/ff/sdio_stm32f1.c **** 
2762:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2763:lib/ff/sdio_stm32f1.c **** /*! 
2764:lib/ff/sdio_stm32f1.c **** 	@brief  Checks if the SD card is in programming state.
2765:lib/ff/sdio_stm32f1.c **** 	@param  pstatus: pointer to the variable that will contain the SD card state.
2766:lib/ff/sdio_stm32f1.c **** 	@retval SD_Error: SD Card Error code.
2767:lib/ff/sdio_stm32f1.c **** */
2768:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2769:lib/ff/sdio_stm32f1.c **** static SD_Error IsCardProgramming(uint8_t *pstatus)
2770:lib/ff/sdio_stm32f1.c **** {
  94              		.loc 1 2770 0
  95              		.cfi_startproc
  96              		@ args = 0, pretend = 0, frame = 8
  97              		@ frame_needed = 0, uses_anonymous_args = 0
  98              	.LVL10:
  99 0000 37B5     		push	{r0, r1, r2, r4, r5, lr}
 100              	.LCFI1:
 101              		.cfi_def_cfa_offset 24
 102              		.cfi_offset 0, -24
 103              		.cfi_offset 1, -20
 104              		.cfi_offset 2, -16
 105              		.cfi_offset 4, -12
 106              		.cfi_offset 5, -8
 107              		.cfi_offset 14, -4
 108 0002 0446     		mov	r4, r0
 109              	.LVL11:
2771:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
2772:lib/ff/sdio_stm32f1.c ****   __IO uint32_t respR1 = 0, status = 0;
 110              		.loc 1 2772 0
 111 0004 0022     		movs	r2, #0
 112 0006 0092     		str	r2, [sp, #0]
 113              	.LVL12:
 114 0008 0192     		str	r2, [sp, #4]
 115              	.LVL13:
2773:lib/ff/sdio_stm32f1.c **** 
2774:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) RCA << 16;
 116              		.loc 1 2774 0
 117 000a 5048     		ldr	r0, .L37
 118              	.LVL14:
 119 000c 5049     		ldr	r1, .L37+4
 120 000e 0B68     		ldr	r3, [r1, #0]
 121 0010 1904     		lsls	r1, r3, #16
 122 0012 0160     		str	r1, [r0, #0]
2775:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SEND_STATUS;
 123              		.loc 1 2775 0
 124 0014 0D23     		movs	r3, #13
 125 0016 4360     		str	r3, [r0, #4]
2776:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 126              		.loc 1 2776 0
 127 0018 4021     		movs	r1, #64
 128 001a 8160     		str	r1, [r0, #8]
2777:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 129              		.loc 1 2777 0
 130 001c C260     		str	r2, [r0, #12]
2778:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 131              		.loc 1 2778 0
 132 001e 4FF48062 		mov	r2, #1024
 133 0022 0261     		str	r2, [r0, #16]
2779:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 134              		.loc 1 2779 0
 135 0024 FFF7FEFF 		bl	SDIO_SendCommand
 136              	.LVL15:
2780:lib/ff/sdio_stm32f1.c **** 
2781:lib/ff/sdio_stm32f1.c ****   status = SDIO->STA;
 137              		.loc 1 2781 0
 138 0028 4A48     		ldr	r0, .L37+8
 139              	.L12:
2782:lib/ff/sdio_stm32f1.c ****   while (!(status & (SDIO_FLAG_CCRCFAIL | SDIO_FLAG_CMDREND | SDIO_FLAG_CTIMEOUT)))
2783:lib/ff/sdio_stm32f1.c ****   {
2784:lib/ff/sdio_stm32f1.c ****     status = SDIO->STA;
 140              		.loc 1 2784 0
 141 002a 436B     		ldr	r3, [r0, #52]
 142              	.LVL16:
 143 002c 0193     		str	r3, [sp, #4]
2782:lib/ff/sdio_stm32f1.c ****   while (!(status & (SDIO_FLAG_CCRCFAIL | SDIO_FLAG_CMDREND | SDIO_FLAG_CTIMEOUT)))
 144              		.loc 1 2782 0
 145 002e 0199     		ldr	r1, [sp, #4]
 146 0030 11F0450F 		tst	r1, #69
 147 0034 F9D0     		beq	.L12
2785:lib/ff/sdio_stm32f1.c ****   }
2786:lib/ff/sdio_stm32f1.c **** 
2787:lib/ff/sdio_stm32f1.c ****   if (status & SDIO_FLAG_CTIMEOUT)
 148              		.loc 1 2787 0
 149 0036 019A     		ldr	r2, [sp, #4]
 150 0038 5007     		lsls	r0, r2, #29
 151 003a 04D5     		bpl	.L13
 152              	.LVL17:
2788:lib/ff/sdio_stm32f1.c ****   {
2789:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_CMD_RSP_TIMEOUT;
2790:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_CTIMEOUT);
 153              		.loc 1 2790 0
 154 003c 0420     		movs	r0, #4
 155 003e FFF7FEFF 		bl	SDIO_ClearFlag
 156              	.LVL18:
2791:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 157              		.loc 1 2791 0
 158 0042 0320     		movs	r0, #3
 159 0044 81E0     		b	.L14
 160              	.LVL19:
 161              	.L13:
2792:lib/ff/sdio_stm32f1.c ****   }
2793:lib/ff/sdio_stm32f1.c ****   else if (status & SDIO_FLAG_CCRCFAIL)
 162              		.loc 1 2793 0
 163 0046 019D     		ldr	r5, [sp, #4]
 164 0048 15F00105 		ands	r5, r5, #1
 165 004c 04D0     		beq	.L15
 166              	.LVL20:
2794:lib/ff/sdio_stm32f1.c ****   {
2795:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_CMD_CRC_FAIL;
2796:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_CCRCFAIL);
 167              		.loc 1 2796 0
 168 004e 0120     		movs	r0, #1
 169 0050 FFF7FEFF 		bl	SDIO_ClearFlag
 170              	.LVL21:
2797:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 171              		.loc 1 2797 0
 172 0054 0120     		movs	r0, #1
 173 0056 78E0     		b	.L14
 174              	.LVL22:
 175              	.L15:
2798:lib/ff/sdio_stm32f1.c ****   }
2799:lib/ff/sdio_stm32f1.c **** 
2800:lib/ff/sdio_stm32f1.c ****   status = (uint32_t)SDIO_GetCommandResponse();
 176              		.loc 1 2800 0
 177 0058 FFF7FEFF 		bl	SDIO_GetCommandResponse
 178              	.LVL23:
 179 005c 0190     		str	r0, [sp, #4]
2801:lib/ff/sdio_stm32f1.c **** 
2802:lib/ff/sdio_stm32f1.c ****   /*!< Check response received is of desired command */
2803:lib/ff/sdio_stm32f1.c ****   if (status != SD_CMD_SEND_STATUS)
 180              		.loc 1 2803 0
 181 005e 0198     		ldr	r0, [sp, #4]
 182 0060 0D28     		cmp	r0, #13
 183 0062 01D0     		beq	.L16
 184              	.L17:
2804:lib/ff/sdio_stm32f1.c ****   {
2805:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_ILLEGAL_CMD;
2806:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 185              		.loc 1 2806 0
 186 0064 1020     		movs	r0, #16
 187 0066 70E0     		b	.L14
 188              	.L16:
2807:lib/ff/sdio_stm32f1.c ****   }
2808:lib/ff/sdio_stm32f1.c **** 
2809:lib/ff/sdio_stm32f1.c ****   /*!< Clear all the static flags */
2810:lib/ff/sdio_stm32f1.c ****   SDIO_ClearFlag(SDIO_STATIC_FLAGS);
 189              		.loc 1 2810 0
 190 0068 40F2FF50 		movw	r0, #1535
 191 006c FFF7FEFF 		bl	SDIO_ClearFlag
 192              	.LVL24:
2811:lib/ff/sdio_stm32f1.c **** 
2812:lib/ff/sdio_stm32f1.c **** 
2813:lib/ff/sdio_stm32f1.c ****   /*!< We have received response, retrieve it for analysis  */
2814:lib/ff/sdio_stm32f1.c ****   respR1 = SDIO_GetResponse(SDIO_RESP1);
 193              		.loc 1 2814 0
 194 0070 2846     		mov	r0, r5
 195 0072 FFF7FEFF 		bl	SDIO_GetResponse
 196              	.LVL25:
 197 0076 0090     		str	r0, [sp, #0]
2815:lib/ff/sdio_stm32f1.c **** 
2816:lib/ff/sdio_stm32f1.c ****   /*!< Find out card status */
2817:lib/ff/sdio_stm32f1.c ****   *pstatus = (uint8_t) ((respR1 >> 9) & 0x0000000F);
 198              		.loc 1 2817 0
 199 0078 009B     		ldr	r3, [sp, #0]
 200 007a C3F34321 		ubfx	r1, r3, #9, #4
 201 007e 2170     		strb	r1, [r4, #0]
2818:lib/ff/sdio_stm32f1.c **** 
2819:lib/ff/sdio_stm32f1.c ****   if ((respR1 & SD_OCR_ERRORBITS) == SD_ALLZERO)
 202              		.loc 1 2819 0
 203 0080 009A     		ldr	r2, [sp, #0]
 204 0082 3548     		ldr	r0, .L37+12
 205              	.LVL26:
 206 0084 1040     		ands	r0, r0, r2
 207 0086 0028     		cmp	r0, #0
 208 0088 3CD0     		beq	.L18
2820:lib/ff/sdio_stm32f1.c ****   {
2821:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2822:lib/ff/sdio_stm32f1.c ****   }
2823:lib/ff/sdio_stm32f1.c **** 
2824:lib/ff/sdio_stm32f1.c ****   if (respR1 & SD_OCR_ADDR_OUT_OF_RANGE)
 209              		.loc 1 2824 0
 210 008a 009B     		ldr	r3, [sp, #0]
 211 008c 002B     		cmp	r3, #0
 212 008e 3BDB     		blt	.L19
2825:lib/ff/sdio_stm32f1.c ****   {
2826:lib/ff/sdio_stm32f1.c ****     return(SD_ADDR_OUT_OF_RANGE);
2827:lib/ff/sdio_stm32f1.c ****   }
2828:lib/ff/sdio_stm32f1.c **** 
2829:lib/ff/sdio_stm32f1.c ****   if (respR1 & SD_OCR_ADDR_MISALIGNED)
 213              		.loc 1 2829 0
 214 0090 0099     		ldr	r1, [sp, #0]
 215 0092 4900     		lsls	r1, r1, #1
 216 0094 3AD4     		bmi	.L20
2830:lib/ff/sdio_stm32f1.c ****   {
2831:lib/ff/sdio_stm32f1.c ****     return(SD_ADDR_MISALIGNED);
2832:lib/ff/sdio_stm32f1.c ****   }
2833:lib/ff/sdio_stm32f1.c **** 
2834:lib/ff/sdio_stm32f1.c ****   if (respR1 & SD_OCR_BLOCK_LEN_ERR)
 217              		.loc 1 2834 0
 218 0096 009A     		ldr	r2, [sp, #0]
 219 0098 9200     		lsls	r2, r2, #2
 220 009a 39D4     		bmi	.L21
2835:lib/ff/sdio_stm32f1.c ****   {
2836:lib/ff/sdio_stm32f1.c ****     return(SD_BLOCK_LEN_ERR);
2837:lib/ff/sdio_stm32f1.c ****   }
2838:lib/ff/sdio_stm32f1.c **** 
2839:lib/ff/sdio_stm32f1.c ****   if (respR1 & SD_OCR_ERASE_SEQ_ERR)
 221              		.loc 1 2839 0
 222 009c 0098     		ldr	r0, [sp, #0]
 223 009e C300     		lsls	r3, r0, #3
 224 00a0 38D4     		bmi	.L22
2840:lib/ff/sdio_stm32f1.c ****   {
2841:lib/ff/sdio_stm32f1.c ****     return(SD_ERASE_SEQ_ERR);
2842:lib/ff/sdio_stm32f1.c ****   }
2843:lib/ff/sdio_stm32f1.c **** 
2844:lib/ff/sdio_stm32f1.c ****   if (respR1 & SD_OCR_BAD_ERASE_PARAM)
 225              		.loc 1 2844 0
 226 00a2 009B     		ldr	r3, [sp, #0]
 227 00a4 1801     		lsls	r0, r3, #4
 228 00a6 37D4     		bmi	.L23
2845:lib/ff/sdio_stm32f1.c ****   {
2846:lib/ff/sdio_stm32f1.c ****     return(SD_BAD_ERASE_PARAM);
2847:lib/ff/sdio_stm32f1.c ****   }
2848:lib/ff/sdio_stm32f1.c **** 
2849:lib/ff/sdio_stm32f1.c ****   if (respR1 & SD_OCR_WRITE_PROT_VIOLATION)
 229              		.loc 1 2849 0
 230 00a8 0099     		ldr	r1, [sp, #0]
 231 00aa 4901     		lsls	r1, r1, #5
 232 00ac 36D4     		bmi	.L24
2850:lib/ff/sdio_stm32f1.c ****   {
2851:lib/ff/sdio_stm32f1.c ****     return(SD_WRITE_PROT_VIOLATION);
2852:lib/ff/sdio_stm32f1.c ****   }
2853:lib/ff/sdio_stm32f1.c **** 
2854:lib/ff/sdio_stm32f1.c ****   if (respR1 & SD_OCR_LOCK_UNLOCK_FAILED)
 233              		.loc 1 2854 0
 234 00ae 009A     		ldr	r2, [sp, #0]
 235 00b0 D201     		lsls	r2, r2, #7
 236 00b2 35D4     		bmi	.L25
2855:lib/ff/sdio_stm32f1.c ****   {
2856:lib/ff/sdio_stm32f1.c ****     return(SD_LOCK_UNLOCK_FAILED);
2857:lib/ff/sdio_stm32f1.c ****   }
2858:lib/ff/sdio_stm32f1.c **** 
2859:lib/ff/sdio_stm32f1.c ****   if (respR1 & SD_OCR_COM_CRC_FAILED)
 237              		.loc 1 2859 0
 238 00b4 0098     		ldr	r0, [sp, #0]
 239 00b6 0302     		lsls	r3, r0, #8
 240 00b8 34D4     		bmi	.L26
2860:lib/ff/sdio_stm32f1.c ****   {
2861:lib/ff/sdio_stm32f1.c ****     return(SD_COM_CRC_FAILED);
2862:lib/ff/sdio_stm32f1.c ****   }
2863:lib/ff/sdio_stm32f1.c **** 
2864:lib/ff/sdio_stm32f1.c ****   if (respR1 & SD_OCR_ILLEGAL_CMD)
 241              		.loc 1 2864 0
 242 00ba 009B     		ldr	r3, [sp, #0]
 243 00bc 5802     		lsls	r0, r3, #9
 244 00be D1D4     		bmi	.L17
2865:lib/ff/sdio_stm32f1.c ****   {
2866:lib/ff/sdio_stm32f1.c ****     return(SD_ILLEGAL_CMD);
2867:lib/ff/sdio_stm32f1.c ****   }
2868:lib/ff/sdio_stm32f1.c **** 
2869:lib/ff/sdio_stm32f1.c ****   if (respR1 & SD_OCR_CARD_ECC_FAILED)
 245              		.loc 1 2869 0
 246 00c0 0099     		ldr	r1, [sp, #0]
 247 00c2 8902     		lsls	r1, r1, #10
 248 00c4 30D4     		bmi	.L27
2870:lib/ff/sdio_stm32f1.c ****   {
2871:lib/ff/sdio_stm32f1.c ****     return(SD_CARD_ECC_FAILED);
2872:lib/ff/sdio_stm32f1.c ****   }
2873:lib/ff/sdio_stm32f1.c **** 
2874:lib/ff/sdio_stm32f1.c ****   if (respR1 & SD_OCR_CC_ERROR)
 249              		.loc 1 2874 0
 250 00c6 009A     		ldr	r2, [sp, #0]
 251 00c8 D202     		lsls	r2, r2, #11
 252 00ca 2FD4     		bmi	.L28
2875:lib/ff/sdio_stm32f1.c ****   {
2876:lib/ff/sdio_stm32f1.c ****     return(SD_CC_ERROR);
2877:lib/ff/sdio_stm32f1.c ****   }
2878:lib/ff/sdio_stm32f1.c **** 
2879:lib/ff/sdio_stm32f1.c ****   if (respR1 & SD_OCR_GENERAL_UNKNOWN_ERROR)
 253              		.loc 1 2879 0
 254 00cc 0098     		ldr	r0, [sp, #0]
 255 00ce 0303     		lsls	r3, r0, #12
 256 00d0 2ED4     		bmi	.L29
2880:lib/ff/sdio_stm32f1.c ****   {
2881:lib/ff/sdio_stm32f1.c ****     return(SD_GENERAL_UNKNOWN_ERROR);
2882:lib/ff/sdio_stm32f1.c ****   }
2883:lib/ff/sdio_stm32f1.c **** 
2884:lib/ff/sdio_stm32f1.c ****   if (respR1 & SD_OCR_STREAM_READ_UNDERRUN)
 257              		.loc 1 2884 0
 258 00d2 009B     		ldr	r3, [sp, #0]
 259 00d4 5803     		lsls	r0, r3, #13
 260 00d6 2DD4     		bmi	.L30
2885:lib/ff/sdio_stm32f1.c ****   {
2886:lib/ff/sdio_stm32f1.c ****     return(SD_STREAM_READ_UNDERRUN);
2887:lib/ff/sdio_stm32f1.c ****   }
2888:lib/ff/sdio_stm32f1.c **** 
2889:lib/ff/sdio_stm32f1.c ****   if (respR1 & SD_OCR_STREAM_WRITE_OVERRUN)
 261              		.loc 1 2889 0
 262 00d8 0099     		ldr	r1, [sp, #0]
 263 00da 8903     		lsls	r1, r1, #14
 264 00dc 2CD4     		bmi	.L31
2890:lib/ff/sdio_stm32f1.c ****   {
2891:lib/ff/sdio_stm32f1.c ****     return(SD_STREAM_WRITE_OVERRUN);
2892:lib/ff/sdio_stm32f1.c ****   }
2893:lib/ff/sdio_stm32f1.c **** 
2894:lib/ff/sdio_stm32f1.c ****   if (respR1 & SD_OCR_CID_CSD_OVERWRIETE)
 265              		.loc 1 2894 0
 266 00de 009A     		ldr	r2, [sp, #0]
 267 00e0 D203     		lsls	r2, r2, #15
 268 00e2 2BD4     		bmi	.L32
2895:lib/ff/sdio_stm32f1.c ****   {
2896:lib/ff/sdio_stm32f1.c ****     return(SD_CID_CSD_OVERWRITE);
2897:lib/ff/sdio_stm32f1.c ****   }
2898:lib/ff/sdio_stm32f1.c **** 
2899:lib/ff/sdio_stm32f1.c ****   if (respR1 & SD_OCR_WP_ERASE_SKIP)
 269              		.loc 1 2899 0
 270 00e4 0098     		ldr	r0, [sp, #0]
 271 00e6 0304     		lsls	r3, r0, #16
 272 00e8 2AD4     		bmi	.L33
2900:lib/ff/sdio_stm32f1.c ****   {
2901:lib/ff/sdio_stm32f1.c ****     return(SD_WP_ERASE_SKIP);
2902:lib/ff/sdio_stm32f1.c ****   }
2903:lib/ff/sdio_stm32f1.c **** 
2904:lib/ff/sdio_stm32f1.c ****   if (respR1 & SD_OCR_CARD_ECC_DISABLED)
 273              		.loc 1 2904 0
 274 00ea 009B     		ldr	r3, [sp, #0]
 275 00ec 5804     		lsls	r0, r3, #17
 276 00ee 29D4     		bmi	.L34
2905:lib/ff/sdio_stm32f1.c ****   {
2906:lib/ff/sdio_stm32f1.c ****     return(SD_CARD_ECC_DISABLED);
2907:lib/ff/sdio_stm32f1.c ****   }
2908:lib/ff/sdio_stm32f1.c **** 
2909:lib/ff/sdio_stm32f1.c ****   if (respR1 & SD_OCR_ERASE_RESET)
 277              		.loc 1 2909 0
 278 00f0 0099     		ldr	r1, [sp, #0]
 279 00f2 8904     		lsls	r1, r1, #18
 280 00f4 28D4     		bmi	.L35
2910:lib/ff/sdio_stm32f1.c ****   {
2911:lib/ff/sdio_stm32f1.c ****     return(SD_ERASE_RESET);
2912:lib/ff/sdio_stm32f1.c ****   }
2913:lib/ff/sdio_stm32f1.c **** 
2914:lib/ff/sdio_stm32f1.c ****   if (respR1 & SD_OCR_AKE_SEQ_ERROR)
 281              		.loc 1 2914 0
 282 00f6 009A     		ldr	r2, [sp, #0]
2915:lib/ff/sdio_stm32f1.c ****   {
2916:lib/ff/sdio_stm32f1.c ****     return(SD_AKE_SEQ_ERROR);
 283              		.loc 1 2916 0
 284 00f8 12F0080F 		tst	r2, #8
 285 00fc 0CBF     		ite	eq
 286 00fe 2A20     		moveq	r0, #42
 287 0100 1A20     		movne	r0, #26
 288 0102 22E0     		b	.L14
 289              	.L18:
2821:lib/ff/sdio_stm32f1.c ****   }
 290              		.loc 1 2821 0
 291 0104 2A20     		movs	r0, #42
 292 0106 20E0     		b	.L14
 293              	.L19:
2826:lib/ff/sdio_stm32f1.c ****   }
 294              		.loc 1 2826 0
 295 0108 1C20     		movs	r0, #28
 296 010a 1EE0     		b	.L14
 297              	.L20:
2831:lib/ff/sdio_stm32f1.c ****   }
 298              		.loc 1 2831 0
 299 010c 0920     		movs	r0, #9
 300 010e 1CE0     		b	.L14
 301              	.L21:
2836:lib/ff/sdio_stm32f1.c ****   }
 302              		.loc 1 2836 0
 303 0110 0A20     		movs	r0, #10
 304 0112 1AE0     		b	.L14
 305              	.L22:
2841:lib/ff/sdio_stm32f1.c ****   }
 306              		.loc 1 2841 0
 307 0114 0B20     		movs	r0, #11
 308 0116 18E0     		b	.L14
 309              	.L23:
2846:lib/ff/sdio_stm32f1.c ****   }
 310              		.loc 1 2846 0
 311 0118 0C20     		movs	r0, #12
 312 011a 16E0     		b	.L14
 313              	.L24:
2851:lib/ff/sdio_stm32f1.c ****   }
 314              		.loc 1 2851 0
 315 011c 0D20     		movs	r0, #13
 316 011e 14E0     		b	.L14
 317              	.L25:
2856:lib/ff/sdio_stm32f1.c ****   }
 318              		.loc 1 2856 0
 319 0120 0E20     		movs	r0, #14
 320 0122 12E0     		b	.L14
 321              	.L26:
2861:lib/ff/sdio_stm32f1.c ****   }
 322              		.loc 1 2861 0
 323 0124 0F20     		movs	r0, #15
 324 0126 10E0     		b	.L14
 325              	.L27:
2871:lib/ff/sdio_stm32f1.c ****   }
 326              		.loc 1 2871 0
 327 0128 1120     		movs	r0, #17
 328 012a 0EE0     		b	.L14
 329              	.L28:
2876:lib/ff/sdio_stm32f1.c ****   }
 330              		.loc 1 2876 0
 331 012c 1220     		movs	r0, #18
 332 012e 0CE0     		b	.L14
 333              	.L29:
2881:lib/ff/sdio_stm32f1.c ****   }
 334              		.loc 1 2881 0
 335 0130 1320     		movs	r0, #19
 336 0132 0AE0     		b	.L14
 337              	.L30:
2886:lib/ff/sdio_stm32f1.c ****   }
 338              		.loc 1 2886 0
 339 0134 1420     		movs	r0, #20
 340 0136 08E0     		b	.L14
 341              	.L31:
2891:lib/ff/sdio_stm32f1.c ****   }
 342              		.loc 1 2891 0
 343 0138 1520     		movs	r0, #21
 344 013a 06E0     		b	.L14
 345              	.L32:
2896:lib/ff/sdio_stm32f1.c ****   }
 346              		.loc 1 2896 0
 347 013c 1620     		movs	r0, #22
 348 013e 04E0     		b	.L14
 349              	.L33:
2901:lib/ff/sdio_stm32f1.c ****   }
 350              		.loc 1 2901 0
 351 0140 1720     		movs	r0, #23
 352 0142 02E0     		b	.L14
 353              	.L34:
2906:lib/ff/sdio_stm32f1.c ****   }
 354              		.loc 1 2906 0
 355 0144 1820     		movs	r0, #24
 356 0146 00E0     		b	.L14
 357              	.L35:
2911:lib/ff/sdio_stm32f1.c ****   }
 358              		.loc 1 2911 0
 359 0148 1920     		movs	r0, #25
 360              	.LVL27:
 361              	.L14:
2917:lib/ff/sdio_stm32f1.c ****   }
2918:lib/ff/sdio_stm32f1.c **** 
2919:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
2920:lib/ff/sdio_stm32f1.c **** }
 362              		.loc 1 2920 0
 363 014a 3EBD     		pop	{r1, r2, r3, r4, r5, pc}
 364              	.L38:
 365              		.align	2
 366              	.L37:
 367 014c 00000000 		.word	.LANCHOR0
 368 0150 00000000 		.word	.LANCHOR1
 369 0154 00800140 		.word	1073840128
 370 0158 08E0FFFD 		.word	-33562616
 371              		.cfi_endproc
 372              	.LFE85:
 374              		.section	.text.unlikely.SD_LowLevel_DMA_TxConfig,"ax",%progbits
 375              		.align	1
 376              		.thumb
 377              		.thumb_func
 379              	SD_LowLevel_DMA_TxConfig:
 380              	.LFB88:
2921:lib/ff/sdio_stm32f1.c **** 
2922:lib/ff/sdio_stm32f1.c **** 
2923:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2924:lib/ff/sdio_stm32f1.c **** /*! 
2925:lib/ff/sdio_stm32f1.c **** 	@brief  Find the SD card SCR register value.
2926:lib/ff/sdio_stm32f1.c **** 	@param  rca: selected card address.
2927:lib/ff/sdio_stm32f1.c **** 	@param  pscr: pointer to the buffer that will contain the SCR value.
2928:lib/ff/sdio_stm32f1.c **** 	@retval SD_Error: SD Card Error code.
2929:lib/ff/sdio_stm32f1.c **** */
2930:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2931:lib/ff/sdio_stm32f1.c **** static SD_Error FindSCR(uint16_t rca, uint32_t *pscr)
2932:lib/ff/sdio_stm32f1.c **** {
2933:lib/ff/sdio_stm32f1.c ****   uint32_t index = 0;
2934:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
2935:lib/ff/sdio_stm32f1.c ****   uint32_t tempscr[2] = {0, 0};
2936:lib/ff/sdio_stm32f1.c **** 
2937:lib/ff/sdio_stm32f1.c ****   /*!< Set Block Size To 8 Bytes */
2938:lib/ff/sdio_stm32f1.c ****   /*!< Send CMD55 APP_CMD with argument as card's RCA */
2939:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = (uint32_t)8;
2940:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SET_BLOCKLEN;
2941:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
2942:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
2943:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
2944:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
2945:lib/ff/sdio_stm32f1.c **** 
2946:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_SET_BLOCKLEN);
2947:lib/ff/sdio_stm32f1.c **** 
2948:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
2949:lib/ff/sdio_stm32f1.c ****   {
2950:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2951:lib/ff/sdio_stm32f1.c ****   }
2952:lib/ff/sdio_stm32f1.c **** 
2953:lib/ff/sdio_stm32f1.c ****   /*!< Send CMD55 APP_CMD with argument as card's RCA */
2954:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) RCA << 16;
2955:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_CMD;
2956:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
2957:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
2958:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
2959:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
2960:lib/ff/sdio_stm32f1.c **** 
2961:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_APP_CMD);
2962:lib/ff/sdio_stm32f1.c **** 
2963:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
2964:lib/ff/sdio_stm32f1.c ****   {
2965:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2966:lib/ff/sdio_stm32f1.c ****   }
2967:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataTimeOut = SD_DATATIMEOUT;
2968:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataLength = 8;
2969:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataBlockSize = SDIO_DataBlockSize_8b;
2970:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToSDIO;
2971:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
2972:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Enable;
2973:lib/ff/sdio_stm32f1.c ****   SDIO_DataConfig(&SDIO_DataInitStructure);
2974:lib/ff/sdio_stm32f1.c **** 
2975:lib/ff/sdio_stm32f1.c **** 
2976:lib/ff/sdio_stm32f1.c ****   /*!< Send ACMD51 SD_APP_SEND_SCR with argument as 0 */
2977:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = 0x0;
2978:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SD_APP_SEND_SCR;
2979:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
2980:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
2981:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
2982:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
2983:lib/ff/sdio_stm32f1.c **** 
2984:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_SD_APP_SEND_SCR);
2985:lib/ff/sdio_stm32f1.c **** 
2986:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
2987:lib/ff/sdio_stm32f1.c ****   {
2988:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2989:lib/ff/sdio_stm32f1.c ****   }
2990:lib/ff/sdio_stm32f1.c **** 
2991:lib/ff/sdio_stm32f1.c ****   while (!(SDIO->STA & (SDIO_FLAG_RXOVERR | SDIO_FLAG_DCRCFAIL | SDIO_FLAG_DTIMEOUT | SDIO_FLAG_DBC
2992:lib/ff/sdio_stm32f1.c ****   {
2993:lib/ff/sdio_stm32f1.c ****     if (SDIO_GetFlagStatus(SDIO_FLAG_RXDAVL) != RESET)
2994:lib/ff/sdio_stm32f1.c ****     {
2995:lib/ff/sdio_stm32f1.c ****       *(tempscr + index) = SDIO_ReadData();
2996:lib/ff/sdio_stm32f1.c ****       index++;
2997:lib/ff/sdio_stm32f1.c ****     }
2998:lib/ff/sdio_stm32f1.c ****   }
2999:lib/ff/sdio_stm32f1.c **** 
3000:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetFlagStatus(SDIO_FLAG_DTIMEOUT) != RESET)
3001:lib/ff/sdio_stm32f1.c ****   {
3002:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_DTIMEOUT);
3003:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_DATA_TIMEOUT;
3004:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
3005:lib/ff/sdio_stm32f1.c ****   }
3006:lib/ff/sdio_stm32f1.c ****   else if (SDIO_GetFlagStatus(SDIO_FLAG_DCRCFAIL) != RESET)
3007:lib/ff/sdio_stm32f1.c ****   {
3008:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_DCRCFAIL);
3009:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_DATA_CRC_FAIL;
3010:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
3011:lib/ff/sdio_stm32f1.c ****   }
3012:lib/ff/sdio_stm32f1.c ****   else if (SDIO_GetFlagStatus(SDIO_FLAG_RXOVERR) != RESET)
3013:lib/ff/sdio_stm32f1.c ****   {
3014:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_RXOVERR);
3015:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_RX_OVERRUN;
3016:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
3017:lib/ff/sdio_stm32f1.c ****   }
3018:lib/ff/sdio_stm32f1.c ****   else if (SDIO_GetFlagStatus(SDIO_FLAG_STBITERR) != RESET)
3019:lib/ff/sdio_stm32f1.c ****   {
3020:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_STBITERR);
3021:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_START_BIT_ERR;
3022:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
3023:lib/ff/sdio_stm32f1.c ****   }
3024:lib/ff/sdio_stm32f1.c **** 
3025:lib/ff/sdio_stm32f1.c ****   /*!< Clear all the static flags */
3026:lib/ff/sdio_stm32f1.c ****   SDIO_ClearFlag(SDIO_STATIC_FLAGS);
3027:lib/ff/sdio_stm32f1.c **** 
3028:lib/ff/sdio_stm32f1.c ****   *(pscr + 1) = ((tempscr[0] & SD_0TO7BITS) << 24) | ((tempscr[0] & SD_8TO15BITS) << 8) | ((tempscr
3029:lib/ff/sdio_stm32f1.c **** 
3030:lib/ff/sdio_stm32f1.c ****   *(pscr) = ((tempscr[1] & SD_0TO7BITS) << 24) | ((tempscr[1] & SD_8TO15BITS) << 8) | ((tempscr[1] 
3031:lib/ff/sdio_stm32f1.c **** 
3032:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
3033:lib/ff/sdio_stm32f1.c **** }
3034:lib/ff/sdio_stm32f1.c **** 
3035:lib/ff/sdio_stm32f1.c **** 
3036:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
3037:lib/ff/sdio_stm32f1.c **** /*! 
3038:lib/ff/sdio_stm32f1.c **** 	@brief  Converts the number of bytes in power of two and returns the power.
3039:lib/ff/sdio_stm32f1.c **** 	@param  NumberOfBytes: number of bytes.
3040:lib/ff/sdio_stm32f1.c **** 	@retval None
3041:lib/ff/sdio_stm32f1.c **** */
3042:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
3043:lib/ff/sdio_stm32f1.c **** static uint8_t convert_from_bytes_to_power_of_two(uint16_t NumberOfBytes)
3044:lib/ff/sdio_stm32f1.c **** {
3045:lib/ff/sdio_stm32f1.c ****   uint8_t count = 0;
3046:lib/ff/sdio_stm32f1.c **** 
3047:lib/ff/sdio_stm32f1.c ****   while (NumberOfBytes != 1)
3048:lib/ff/sdio_stm32f1.c ****   {
3049:lib/ff/sdio_stm32f1.c ****     NumberOfBytes >>= 1;
3050:lib/ff/sdio_stm32f1.c ****     count++;
3051:lib/ff/sdio_stm32f1.c ****   }
3052:lib/ff/sdio_stm32f1.c ****   return(count);
3053:lib/ff/sdio_stm32f1.c **** }
3054:lib/ff/sdio_stm32f1.c **** 
3055:lib/ff/sdio_stm32f1.c **** 
3056:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
3057:lib/ff/sdio_stm32f1.c **** /*! 
3058:lib/ff/sdio_stm32f1.c **** 	@brief  Configures the DMA2 Channel4 for SDIO Tx request.
3059:lib/ff/sdio_stm32f1.c **** 	@param  BufferSRC: pointer to the source buffer
3060:lib/ff/sdio_stm32f1.c **** 	@param  BufferSize: buffer size
3061:lib/ff/sdio_stm32f1.c **** 	@retval None
3062:lib/ff/sdio_stm32f1.c **** */
3063:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
3064:lib/ff/sdio_stm32f1.c **** void SD_LowLevel_DMA_TxConfig(uint32_t *BufferSRC, uint32_t BufferSize)
3065:lib/ff/sdio_stm32f1.c **** {
 381              		.loc 1 3065 0
 382              		.cfi_startproc
 383              		@ args = 0, pretend = 0, frame = 48
 384              		@ frame_needed = 0, uses_anonymous_args = 0
 385              	.LVL28:
 386 0000 70B5     		push	{r4, r5, r6, lr}
 387              	.LCFI2:
 388              		.cfi_def_cfa_offset 16
 389              		.cfi_offset 4, -16
 390              		.cfi_offset 5, -12
 391              		.cfi_offset 6, -8
 392              		.cfi_offset 14, -4
 393 0002 8CB0     		sub	sp, sp, #48
 394              	.LCFI3:
 395              		.cfi_def_cfa_offset 64
 396 0004 0546     		mov	r5, r0
 397 0006 0E46     		mov	r6, r1
3066:lib/ff/sdio_stm32f1.c **** 
3067:lib/ff/sdio_stm32f1.c ****   DMA_InitTypeDef DMA_InitStructure;
3068:lib/ff/sdio_stm32f1.c **** 
3069:lib/ff/sdio_stm32f1.c ****   DMA_ClearFlag(DMA2_FLAG_TC4 | DMA2_FLAG_TE4 | DMA2_FLAG_HT4 | DMA2_FLAG_GL4);
 398              		.loc 1 3069 0
 399 0008 1348     		ldr	r0, .L40
 400              	.LVL29:
 401 000a FFF7FEFF 		bl	DMA_ClearFlag
 402              	.LVL30:
3070:lib/ff/sdio_stm32f1.c **** 
3071:lib/ff/sdio_stm32f1.c ****   /*!< DMA2 Channel4 disable */
3072:lib/ff/sdio_stm32f1.c ****   DMA_Cmd(DMA2_Channel4, DISABLE);
 403              		.loc 1 3072 0
 404 000e 134C     		ldr	r4, .L40+4
 405 0010 2046     		mov	r0, r4
 406 0012 0021     		movs	r1, #0
 407 0014 FFF7FEFF 		bl	DMA_Cmd
 408              	.LVL31:
3073:lib/ff/sdio_stm32f1.c **** 
3074:lib/ff/sdio_stm32f1.c ****   /*!< DMA2 Channel4 Config */
3075:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_PeripheralBaseAddr = (uint32_t)SDIO_FIFO_ADDRESS;
 409              		.loc 1 3075 0
 410 0018 114B     		ldr	r3, .L40+8
 411 001a 0193     		str	r3, [sp, #4]
3076:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_MemoryBaseAddr = (uint32_t)BufferSRC;
 412              		.loc 1 3076 0
 413 001c 0295     		str	r5, [sp, #8]
3077:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_DIR = DMA_DIR_PeripheralDST;
 414              		.loc 1 3077 0
 415 001e 1020     		movs	r0, #16
 416 0020 0390     		str	r0, [sp, #12]
3078:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_BufferSize = BufferSize / 4;
 417              		.loc 1 3078 0
 418 0022 B608     		lsrs	r6, r6, #2
 419              	.LVL32:
 420 0024 0496     		str	r6, [sp, #16]
3079:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_PeripheralInc = DMA_PeripheralInc_Disable;
 421              		.loc 1 3079 0
 422 0026 0021     		movs	r1, #0
 423 0028 0591     		str	r1, [sp, #20]
3080:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_MemoryInc = DMA_MemoryInc_Enable;
 424              		.loc 1 3080 0
 425 002a 8022     		movs	r2, #128
 426 002c 0692     		str	r2, [sp, #24]
3081:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_PeripheralDataSize = DMA_PeripheralDataSize_Word;
 427              		.loc 1 3081 0
 428 002e 4FF40073 		mov	r3, #512
 429 0032 0793     		str	r3, [sp, #28]
3082:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_MemoryDataSize = DMA_MemoryDataSize_Word;
 430              		.loc 1 3082 0
 431 0034 4FF40060 		mov	r0, #2048
 432 0038 0890     		str	r0, [sp, #32]
3083:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_Mode = DMA_Mode_Normal;
 433              		.loc 1 3083 0
 434 003a 0991     		str	r1, [sp, #36]
3084:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_Priority = DMA_Priority_High;
 435              		.loc 1 3084 0
 436 003c 4FF40052 		mov	r2, #8192
 437 0040 0A92     		str	r2, [sp, #40]
3085:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_M2M = DMA_M2M_Disable;
 438              		.loc 1 3085 0
 439 0042 0B91     		str	r1, [sp, #44]
3086:lib/ff/sdio_stm32f1.c ****   DMA_Init(DMA2_Channel4, &DMA_InitStructure);
 440              		.loc 1 3086 0
 441 0044 2046     		mov	r0, r4
 442 0046 01A9     		add	r1, sp, #4
 443 0048 FFF7FEFF 		bl	DMA_Init
 444              	.LVL33:
3087:lib/ff/sdio_stm32f1.c **** 
3088:lib/ff/sdio_stm32f1.c ****   /*!< DMA2 Channel4 enable */
3089:lib/ff/sdio_stm32f1.c ****   DMA_Cmd(DMA2_Channel4, ENABLE);  
 445              		.loc 1 3089 0
 446 004c 2046     		mov	r0, r4
 447 004e 0121     		movs	r1, #1
 448 0050 FFF7FEFF 		bl	DMA_Cmd
 449              	.LVL34:
3090:lib/ff/sdio_stm32f1.c **** }
 450              		.loc 1 3090 0
 451 0054 0CB0     		add	sp, sp, #48
 452 0056 70BD     		pop	{r4, r5, r6, pc}
 453              	.L41:
 454              		.align	2
 455              	.L40:
 456 0058 00F00010 		.word	268496896
 457 005c 44040240 		.word	1073873988
 458 0060 80800140 		.word	1073840256
 459              		.cfi_endproc
 460              	.LFE88:
 462              		.section	.text.unlikely.SD_LowLevel_DMA_RxConfig,"ax",%progbits
 463              		.align	1
 464              		.thumb
 465              		.thumb_func
 467              	SD_LowLevel_DMA_RxConfig:
 468              	.LFB89:
3091:lib/ff/sdio_stm32f1.c **** 
3092:lib/ff/sdio_stm32f1.c **** 
3093:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
3094:lib/ff/sdio_stm32f1.c **** /*! 
3095:lib/ff/sdio_stm32f1.c **** 	@brief  Configures the DMA2 Channel4 for SDIO Rx request.
3096:lib/ff/sdio_stm32f1.c **** 	@param  BufferDST: pointer to the destination buffer
3097:lib/ff/sdio_stm32f1.c **** 	@param  BufferSize: buffer size
3098:lib/ff/sdio_stm32f1.c **** 	@retval None
3099:lib/ff/sdio_stm32f1.c **** */
3100:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
3101:lib/ff/sdio_stm32f1.c **** void SD_LowLevel_DMA_RxConfig(uint32_t *BufferDST, uint32_t BufferSize)
3102:lib/ff/sdio_stm32f1.c **** {
 469              		.loc 1 3102 0
 470              		.cfi_startproc
 471              		@ args = 0, pretend = 0, frame = 48
 472              		@ frame_needed = 0, uses_anonymous_args = 0
 473              	.LVL35:
 474 0000 70B5     		push	{r4, r5, r6, lr}
 475              	.LCFI4:
 476              		.cfi_def_cfa_offset 16
 477              		.cfi_offset 4, -16
 478              		.cfi_offset 5, -12
 479              		.cfi_offset 6, -8
 480              		.cfi_offset 14, -4
 481 0002 8CB0     		sub	sp, sp, #48
 482              	.LCFI5:
 483              		.cfi_def_cfa_offset 64
 484 0004 0546     		mov	r5, r0
 485 0006 0E46     		mov	r6, r1
3103:lib/ff/sdio_stm32f1.c ****   DMA_InitTypeDef DMA_InitStructure;
3104:lib/ff/sdio_stm32f1.c **** 
3105:lib/ff/sdio_stm32f1.c ****   DMA_ClearFlag(DMA2_FLAG_TC4 | DMA2_FLAG_TE4 | DMA2_FLAG_HT4 | DMA2_FLAG_GL4);
 486              		.loc 1 3105 0
 487 0008 1348     		ldr	r0, .L43
 488              	.LVL36:
 489 000a FFF7FEFF 		bl	DMA_ClearFlag
 490              	.LVL37:
3106:lib/ff/sdio_stm32f1.c **** 
3107:lib/ff/sdio_stm32f1.c ****   /*!< DMA2 Channel4 disable */
3108:lib/ff/sdio_stm32f1.c ****   DMA_Cmd(DMA2_Channel4, DISABLE);
 491              		.loc 1 3108 0
 492 000e 134C     		ldr	r4, .L43+4
 493 0010 2046     		mov	r0, r4
 494 0012 0021     		movs	r1, #0
 495 0014 FFF7FEFF 		bl	DMA_Cmd
 496              	.LVL38:
3109:lib/ff/sdio_stm32f1.c **** 
3110:lib/ff/sdio_stm32f1.c ****   /*!< DMA2 Channel4 Config */
3111:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_PeripheralBaseAddr = (uint32_t)SDIO_FIFO_ADDRESS;
 497              		.loc 1 3111 0
 498 0018 114B     		ldr	r3, .L43+8
 499 001a 0193     		str	r3, [sp, #4]
3112:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_MemoryBaseAddr = (uint32_t)BufferDST;
 500              		.loc 1 3112 0
 501 001c 0295     		str	r5, [sp, #8]
3113:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_DIR = DMA_DIR_PeripheralSRC;
 502              		.loc 1 3113 0
 503 001e 0020     		movs	r0, #0
 504 0020 0390     		str	r0, [sp, #12]
3114:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_BufferSize = BufferSize / 4;
 505              		.loc 1 3114 0
 506 0022 B608     		lsrs	r6, r6, #2
 507              	.LVL39:
 508 0024 0496     		str	r6, [sp, #16]
3115:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_PeripheralInc = DMA_PeripheralInc_Disable;
 509              		.loc 1 3115 0
 510 0026 0590     		str	r0, [sp, #20]
3116:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_MemoryInc = DMA_MemoryInc_Enable;
 511              		.loc 1 3116 0
 512 0028 8022     		movs	r2, #128
 513 002a 0692     		str	r2, [sp, #24]
3117:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_PeripheralDataSize = DMA_PeripheralDataSize_Word;
 514              		.loc 1 3117 0
 515 002c 4FF40071 		mov	r1, #512
 516 0030 0791     		str	r1, [sp, #28]
3118:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_MemoryDataSize = DMA_MemoryDataSize_Word;
 517              		.loc 1 3118 0
 518 0032 4FF40063 		mov	r3, #2048
 519 0036 0893     		str	r3, [sp, #32]
3119:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_Mode = DMA_Mode_Normal;
 520              		.loc 1 3119 0
 521 0038 0990     		str	r0, [sp, #36]
3120:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_Priority = DMA_Priority_High;
 522              		.loc 1 3120 0
 523 003a 4FF40052 		mov	r2, #8192
 524 003e 0A92     		str	r2, [sp, #40]
3121:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_M2M = DMA_M2M_Disable;
 525              		.loc 1 3121 0
 526 0040 0B90     		str	r0, [sp, #44]
3122:lib/ff/sdio_stm32f1.c ****   DMA_Init(DMA2_Channel4, &DMA_InitStructure);
 527              		.loc 1 3122 0
 528 0042 2046     		mov	r0, r4
 529 0044 01A9     		add	r1, sp, #4
 530 0046 FFF7FEFF 		bl	DMA_Init
 531              	.LVL40:
3123:lib/ff/sdio_stm32f1.c **** 
3124:lib/ff/sdio_stm32f1.c ****   /*!< DMA2 Channel4 enable */
3125:lib/ff/sdio_stm32f1.c ****   DMA_Cmd(DMA2_Channel4, ENABLE); 
 532              		.loc 1 3125 0
 533 004a 2046     		mov	r0, r4
 534 004c 0121     		movs	r1, #1
 535 004e FFF7FEFF 		bl	DMA_Cmd
 536              	.LVL41:
3126:lib/ff/sdio_stm32f1.c **** }
 537              		.loc 1 3126 0
 538 0052 0CB0     		add	sp, sp, #48
 539 0054 70BD     		pop	{r4, r5, r6, pc}
 540              	.L44:
 541 0056 00BF     		.align	2
 542              	.L43:
 543 0058 00F00010 		.word	268496896
 544 005c 44040240 		.word	1073873988
 545 0060 80800140 		.word	1073840256
 546              		.cfi_endproc
 547              	.LFE89:
 549              		.section	.text.CmdResp1Error,"ax",%progbits
 550              		.align	1
 551              		.thumb
 552              		.thumb_func
 554              	CmdResp1Error:
 555              	.LFB80:
2360:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
 556              		.loc 1 2360 0
 557              		.cfi_startproc
 558              		@ args = 0, pretend = 0, frame = 0
 559              		@ frame_needed = 0, uses_anonymous_args = 0
 560              	.LVL42:
 561 0000 38B5     		push	{r3, r4, r5, lr}
 562              	.LCFI6:
 563              		.cfi_def_cfa_offset 16
 564              		.cfi_offset 3, -16
 565              		.cfi_offset 4, -12
 566              		.cfi_offset 5, -8
 567              		.cfi_offset 14, -4
 568 0002 0546     		mov	r5, r0
 569              	.LVL43:
2365:lib/ff/sdio_stm32f1.c **** 
 570              		.loc 1 2365 0
 571 0004 394A     		ldr	r2, .L73
 572              	.L47:
2369:lib/ff/sdio_stm32f1.c ****   }
 573              		.loc 1 2369 0
 574 0006 536B     		ldr	r3, [r2, #52]
 575              	.LVL44:
2367:lib/ff/sdio_stm32f1.c ****   {
 576              		.loc 1 2367 0
 577 0008 13F0450F 		tst	r3, #69
 578 000c FBD0     		beq	.L47
2372:lib/ff/sdio_stm32f1.c ****   {
 579              		.loc 1 2372 0
 580 000e 5907     		lsls	r1, r3, #29
 581 0010 04D5     		bpl	.L48
 582              	.LVL45:
2375:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 583              		.loc 1 2375 0
 584 0012 0420     		movs	r0, #4
 585              	.LVL46:
 586 0014 FFF7FEFF 		bl	SDIO_ClearFlag
 587              	.LVL47:
2376:lib/ff/sdio_stm32f1.c ****   }
 588              		.loc 1 2376 0
 589 0018 0320     		movs	r0, #3
 590 001a 38BD     		pop	{r3, r4, r5, pc}
 591              	.LVL48:
 592              	.L48:
2378:lib/ff/sdio_stm32f1.c ****   {
 593              		.loc 1 2378 0
 594 001c 13F00104 		ands	r4, r3, #1
 595 0020 04D0     		beq	.L50
 596              	.LVL49:
2381:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 597              		.loc 1 2381 0
 598 0022 0120     		movs	r0, #1
 599              	.LVL50:
 600 0024 FFF7FEFF 		bl	SDIO_ClearFlag
 601              	.LVL51:
2382:lib/ff/sdio_stm32f1.c ****   }
 602              		.loc 1 2382 0
 603 0028 0120     		movs	r0, #1
 604 002a 38BD     		pop	{r3, r4, r5, pc}
 605              	.LVL52:
 606              	.L50:
2386:lib/ff/sdio_stm32f1.c ****   {
 607              		.loc 1 2386 0
 608 002c FFF7FEFF 		bl	SDIO_GetCommandResponse
 609              	.LVL53:
 610 0030 A842     		cmp	r0, r5
 611 0032 58D1     		bne	.L52
 612              	.LBB8:
 613              	.LBB9:
2393:lib/ff/sdio_stm32f1.c **** 
 614              		.loc 1 2393 0
 615 0034 40F2FF50 		movw	r0, #1535
 616 0038 FFF7FEFF 		bl	SDIO_ClearFlag
 617              	.LVL54:
2396:lib/ff/sdio_stm32f1.c **** 
 618              		.loc 1 2396 0
 619 003c 2046     		mov	r0, r4
 620 003e FFF7FEFF 		bl	SDIO_GetResponse
 621              	.LVL55:
2398:lib/ff/sdio_stm32f1.c ****   {
 622              		.loc 1 2398 0
 623 0042 2B49     		ldr	r1, .L73+4
 624 0044 0140     		ands	r1, r1, r0
 625 0046 0029     		cmp	r1, #0
 626 0048 29D0     		beq	.L53
2403:lib/ff/sdio_stm32f1.c ****   {
 627              		.loc 1 2403 0
 628 004a 0028     		cmp	r0, #0
 629 004c 29DB     		blt	.L54
2408:lib/ff/sdio_stm32f1.c ****   {
 630              		.loc 1 2408 0
 631 004e 4200     		lsls	r2, r0, #1
 632 0050 29D4     		bmi	.L55
2413:lib/ff/sdio_stm32f1.c ****   {
 633              		.loc 1 2413 0
 634 0052 8300     		lsls	r3, r0, #2
 635 0054 29D4     		bmi	.L56
2418:lib/ff/sdio_stm32f1.c ****   {
 636              		.loc 1 2418 0
 637 0056 C100     		lsls	r1, r0, #3
 638 0058 29D4     		bmi	.L57
2423:lib/ff/sdio_stm32f1.c ****   {
 639              		.loc 1 2423 0
 640 005a 0201     		lsls	r2, r0, #4
 641 005c 29D4     		bmi	.L58
2428:lib/ff/sdio_stm32f1.c ****   {
 642              		.loc 1 2428 0
 643 005e 4301     		lsls	r3, r0, #5
 644 0060 29D4     		bmi	.L59
2433:lib/ff/sdio_stm32f1.c ****   {
 645              		.loc 1 2433 0
 646 0062 C101     		lsls	r1, r0, #7
 647 0064 29D4     		bmi	.L60
2438:lib/ff/sdio_stm32f1.c ****   {
 648              		.loc 1 2438 0
 649 0066 0202     		lsls	r2, r0, #8
 650 0068 29D4     		bmi	.L61
2443:lib/ff/sdio_stm32f1.c ****   {
 651              		.loc 1 2443 0
 652 006a 4302     		lsls	r3, r0, #9
 653 006c 3BD4     		bmi	.L52
2448:lib/ff/sdio_stm32f1.c ****   {
 654              		.loc 1 2448 0
 655 006e 8102     		lsls	r1, r0, #10
 656 0070 27D4     		bmi	.L63
2453:lib/ff/sdio_stm32f1.c ****   {
 657              		.loc 1 2453 0
 658 0072 C202     		lsls	r2, r0, #11
 659 0074 27D4     		bmi	.L64
2458:lib/ff/sdio_stm32f1.c ****   {
 660              		.loc 1 2458 0
 661 0076 0303     		lsls	r3, r0, #12
 662 0078 27D4     		bmi	.L65
2463:lib/ff/sdio_stm32f1.c ****   {
 663              		.loc 1 2463 0
 664 007a 4103     		lsls	r1, r0, #13
 665 007c 27D4     		bmi	.L66
2468:lib/ff/sdio_stm32f1.c ****   {
 666              		.loc 1 2468 0
 667 007e 8203     		lsls	r2, r0, #14
 668 0080 27D4     		bmi	.L67
2473:lib/ff/sdio_stm32f1.c ****   {
 669              		.loc 1 2473 0
 670 0082 C303     		lsls	r3, r0, #15
 671 0084 27D4     		bmi	.L68
2478:lib/ff/sdio_stm32f1.c ****   {
 672              		.loc 1 2478 0
 673 0086 0104     		lsls	r1, r0, #16
 674 0088 27D4     		bmi	.L69
2483:lib/ff/sdio_stm32f1.c ****   {
 675              		.loc 1 2483 0
 676 008a 4204     		lsls	r2, r0, #17
 677 008c 27D4     		bmi	.L70
2488:lib/ff/sdio_stm32f1.c ****   {
 678              		.loc 1 2488 0
 679 008e 8304     		lsls	r3, r0, #18
 680 0090 27D4     		bmi	.L71
2495:lib/ff/sdio_stm32f1.c ****   }
 681              		.loc 1 2495 0
 682 0092 10F0080F 		tst	r0, #8
 683 0096 0CBF     		ite	eq
 684 0098 2A20     		moveq	r0, #42
 685 009a 1A20     		movne	r0, #26
 686              	.LVL56:
 687 009c 38BD     		pop	{r3, r4, r5, pc}
 688              	.LVL57:
 689              	.L53:
2400:lib/ff/sdio_stm32f1.c ****   }
 690              		.loc 1 2400 0
 691 009e 2A20     		movs	r0, #42
 692              	.LVL58:
 693 00a0 38BD     		pop	{r3, r4, r5, pc}
 694              	.LVL59:
 695              	.L54:
2405:lib/ff/sdio_stm32f1.c ****   }
 696              		.loc 1 2405 0
 697 00a2 1C20     		movs	r0, #28
 698              	.LVL60:
 699 00a4 38BD     		pop	{r3, r4, r5, pc}
 700              	.LVL61:
 701              	.L55:
2410:lib/ff/sdio_stm32f1.c ****   }
 702              		.loc 1 2410 0
 703 00a6 0920     		movs	r0, #9
 704              	.LVL62:
 705 00a8 38BD     		pop	{r3, r4, r5, pc}
 706              	.LVL63:
 707              	.L56:
2415:lib/ff/sdio_stm32f1.c ****   }
 708              		.loc 1 2415 0
 709 00aa 0A20     		movs	r0, #10
 710              	.LVL64:
 711 00ac 38BD     		pop	{r3, r4, r5, pc}
 712              	.LVL65:
 713              	.L57:
2420:lib/ff/sdio_stm32f1.c ****   }
 714              		.loc 1 2420 0
 715 00ae 0B20     		movs	r0, #11
 716              	.LVL66:
 717 00b0 38BD     		pop	{r3, r4, r5, pc}
 718              	.LVL67:
 719              	.L58:
2425:lib/ff/sdio_stm32f1.c ****   }
 720              		.loc 1 2425 0
 721 00b2 0C20     		movs	r0, #12
 722              	.LVL68:
 723 00b4 38BD     		pop	{r3, r4, r5, pc}
 724              	.LVL69:
 725              	.L59:
2430:lib/ff/sdio_stm32f1.c ****   }
 726              		.loc 1 2430 0
 727 00b6 0D20     		movs	r0, #13
 728              	.LVL70:
 729 00b8 38BD     		pop	{r3, r4, r5, pc}
 730              	.LVL71:
 731              	.L60:
2435:lib/ff/sdio_stm32f1.c ****   }
 732              		.loc 1 2435 0
 733 00ba 0E20     		movs	r0, #14
 734              	.LVL72:
 735 00bc 38BD     		pop	{r3, r4, r5, pc}
 736              	.LVL73:
 737              	.L61:
2440:lib/ff/sdio_stm32f1.c ****   }
 738              		.loc 1 2440 0
 739 00be 0F20     		movs	r0, #15
 740              	.LVL74:
 741 00c0 38BD     		pop	{r3, r4, r5, pc}
 742              	.LVL75:
 743              	.L63:
2450:lib/ff/sdio_stm32f1.c ****   }
 744              		.loc 1 2450 0
 745 00c2 1120     		movs	r0, #17
 746              	.LVL76:
 747 00c4 38BD     		pop	{r3, r4, r5, pc}
 748              	.LVL77:
 749              	.L64:
2455:lib/ff/sdio_stm32f1.c ****   }
 750              		.loc 1 2455 0
 751 00c6 1220     		movs	r0, #18
 752              	.LVL78:
 753 00c8 38BD     		pop	{r3, r4, r5, pc}
 754              	.LVL79:
 755              	.L65:
2460:lib/ff/sdio_stm32f1.c ****   }
 756              		.loc 1 2460 0
 757 00ca 1320     		movs	r0, #19
 758              	.LVL80:
 759 00cc 38BD     		pop	{r3, r4, r5, pc}
 760              	.LVL81:
 761              	.L66:
2465:lib/ff/sdio_stm32f1.c ****   }
 762              		.loc 1 2465 0
 763 00ce 1420     		movs	r0, #20
 764              	.LVL82:
 765 00d0 38BD     		pop	{r3, r4, r5, pc}
 766              	.LVL83:
 767              	.L67:
2470:lib/ff/sdio_stm32f1.c ****   }
 768              		.loc 1 2470 0
 769 00d2 1520     		movs	r0, #21
 770              	.LVL84:
 771 00d4 38BD     		pop	{r3, r4, r5, pc}
 772              	.LVL85:
 773              	.L68:
2475:lib/ff/sdio_stm32f1.c ****   }
 774              		.loc 1 2475 0
 775 00d6 1620     		movs	r0, #22
 776              	.LVL86:
 777 00d8 38BD     		pop	{r3, r4, r5, pc}
 778              	.LVL87:
 779              	.L69:
2480:lib/ff/sdio_stm32f1.c ****   }
 780              		.loc 1 2480 0
 781 00da 1720     		movs	r0, #23
 782              	.LVL88:
 783 00dc 38BD     		pop	{r3, r4, r5, pc}
 784              	.LVL89:
 785              	.L70:
2485:lib/ff/sdio_stm32f1.c ****   }
 786              		.loc 1 2485 0
 787 00de 1820     		movs	r0, #24
 788              	.LVL90:
 789 00e0 38BD     		pop	{r3, r4, r5, pc}
 790              	.LVL91:
 791              	.L71:
2490:lib/ff/sdio_stm32f1.c ****   }
 792              		.loc 1 2490 0
 793 00e2 1920     		movs	r0, #25
 794              	.LVL92:
 795 00e4 38BD     		pop	{r3, r4, r5, pc}
 796              	.L52:
 797              	.LBE9:
 798              	.LBE8:
2389:lib/ff/sdio_stm32f1.c ****   }
 799              		.loc 1 2389 0
 800 00e6 1020     		movs	r0, #16
2498:lib/ff/sdio_stm32f1.c **** 
 801              		.loc 1 2498 0
 802 00e8 38BD     		pop	{r3, r4, r5, pc}
 803              	.L74:
 804 00ea 00BF     		.align	2
 805              	.L73:
 806 00ec 00800140 		.word	1073840128
 807 00f0 08E0FFFD 		.word	-33562616
 808              		.cfi_endproc
 809              	.LFE80:
 811              		.section	.text.SDEnWideBus,"ax",%progbits
 812              		.align	1
 813              		.thumb
 814              		.thumb_func
 816              	SDEnWideBus:
 817              	.LFB84:
2653:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
 818              		.loc 1 2653 0
 819              		.cfi_startproc
 820              		@ args = 0, pretend = 0, frame = 8
 821              		@ frame_needed = 0, uses_anonymous_args = 0
 822              	.LVL93:
 823 0000 2DE9F347 		push	{r0, r1, r4, r5, r6, r7, r8, r9, sl, lr}
 824              	.LCFI7:
 825              		.cfi_def_cfa_offset 40
 826              		.cfi_offset 0, -40
 827              		.cfi_offset 1, -36
 828              		.cfi_offset 4, -32
 829              		.cfi_offset 5, -28
 830              		.cfi_offset 6, -24
 831              		.cfi_offset 7, -20
 832              		.cfi_offset 8, -16
 833              		.cfi_offset 9, -12
 834              		.cfi_offset 10, -8
 835              		.cfi_offset 14, -4
 836 0004 8046     		mov	r8, r0
 837              	.LVL94:
2658:lib/ff/sdio_stm32f1.c ****   {
 838              		.loc 1 2658 0
 839 0006 0020     		movs	r0, #0
 840              	.LVL95:
 841 0008 FFF7FEFF 		bl	SDIO_GetResponse
 842              	.LVL96:
 843 000c 10F00075 		ands	r5, r0, #33554432
 844 0010 40F0DE80 		bne	.L86
 845              	.LVL97:
 846              	.LBB12:
 847              	.LBB13:
2935:lib/ff/sdio_stm32f1.c **** 
 848              		.loc 1 2935 0
 849 0014 0095     		str	r5, [sp, #0]
 850 0016 0195     		str	r5, [sp, #4]
2939:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SET_BLOCKLEN;
 851              		.loc 1 2939 0
 852 0018 704C     		ldr	r4, .L101
2940:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 853              		.loc 1 2940 0
 854 001a 4FF00809 		mov	r9, #8
 855 001e 4FF0100A 		mov	sl, #16
 856 0022 84E80006 		stmia	r4, {r9, sl}
2941:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 857              		.loc 1 2941 0
 858 0026 4027     		movs	r7, #64
 859 0028 A760     		str	r7, [r4, #8]
2942:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 860              		.loc 1 2942 0
 861 002a E560     		str	r5, [r4, #12]
2943:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 862              		.loc 1 2943 0
 863 002c 4FF48066 		mov	r6, #1024
 864 0030 2661     		str	r6, [r4, #16]
2944:lib/ff/sdio_stm32f1.c **** 
 865              		.loc 1 2944 0
 866 0032 2046     		mov	r0, r4
 867 0034 FFF7FEFF 		bl	SDIO_SendCommand
 868              	.LVL98:
2946:lib/ff/sdio_stm32f1.c **** 
 869              		.loc 1 2946 0
 870 0038 5046     		mov	r0, sl
 871 003a FFF7FEFF 		bl	CmdResp1Error
 872              	.LVL99:
2948:lib/ff/sdio_stm32f1.c ****   {
 873              		.loc 1 2948 0
 874 003e 2A28     		cmp	r0, #42
 875 0040 70D1     		bne	.L77
2954:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_CMD;
 876              		.loc 1 2954 0
 877 0042 674B     		ldr	r3, .L101+4
 878 0044 1868     		ldr	r0, [r3, #0]
 879              	.LVL100:
 880 0046 00FA0AF1 		lsl	r1, r0, sl
 881 004a 2160     		str	r1, [r4, #0]
2955:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 882              		.loc 1 2955 0
 883 004c 4FF0370A 		mov	sl, #55
 884 0050 C4F804A0 		str	sl, [r4, #4]
2956:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 885              		.loc 1 2956 0
 886 0054 A760     		str	r7, [r4, #8]
2957:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 887              		.loc 1 2957 0
 888 0056 E560     		str	r5, [r4, #12]
2958:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 889              		.loc 1 2958 0
 890 0058 2661     		str	r6, [r4, #16]
2959:lib/ff/sdio_stm32f1.c **** 
 891              		.loc 1 2959 0
 892 005a 2046     		mov	r0, r4
 893 005c FFF7FEFF 		bl	SDIO_SendCommand
 894              	.LVL101:
2961:lib/ff/sdio_stm32f1.c **** 
 895              		.loc 1 2961 0
 896 0060 5046     		mov	r0, sl
 897 0062 FFF7FEFF 		bl	CmdResp1Error
 898              	.LVL102:
2963:lib/ff/sdio_stm32f1.c ****   {
 899              		.loc 1 2963 0
 900 0066 2A28     		cmp	r0, #42
 901 0068 5CD1     		bne	.L77
2967:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataLength = 8;
 902              		.loc 1 2967 0
 903 006a 5E48     		ldr	r0, .L101+8
 904              	.LVL103:
 905 006c 5E4A     		ldr	r2, .L101+12
2968:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataBlockSize = SDIO_DataBlockSize_8b;
 906              		.loc 1 2968 0
 907 006e 80E80402 		stmia	r0, {r2, r9}
2969:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToSDIO;
 908              		.loc 1 2969 0
 909 0072 3022     		movs	r2, #48
 910 0074 8260     		str	r2, [r0, #8]
2970:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
 911              		.loc 1 2970 0
 912 0076 0223     		movs	r3, #2
 913 0078 C360     		str	r3, [r0, #12]
2971:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Enable;
 914              		.loc 1 2971 0
 915 007a 0561     		str	r5, [r0, #16]
2972:lib/ff/sdio_stm32f1.c ****   SDIO_DataConfig(&SDIO_DataInitStructure);
 916              		.loc 1 2972 0
 917 007c 0121     		movs	r1, #1
 918 007e 4161     		str	r1, [r0, #20]
2973:lib/ff/sdio_stm32f1.c **** 
 919              		.loc 1 2973 0
 920 0080 FFF7FEFF 		bl	SDIO_DataConfig
 921              	.LVL104:
2977:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SD_APP_SEND_SCR;
 922              		.loc 1 2977 0
 923 0084 2560     		str	r5, [r4, #0]
2978:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 924              		.loc 1 2978 0
 925 0086 4FF03309 		mov	r9, #51
 926 008a C4F80490 		str	r9, [r4, #4]
2979:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 927              		.loc 1 2979 0
 928 008e A760     		str	r7, [r4, #8]
2980:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 929              		.loc 1 2980 0
 930 0090 E560     		str	r5, [r4, #12]
2981:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 931              		.loc 1 2981 0
 932 0092 2661     		str	r6, [r4, #16]
2982:lib/ff/sdio_stm32f1.c **** 
 933              		.loc 1 2982 0
 934 0094 2046     		mov	r0, r4
 935 0096 FFF7FEFF 		bl	SDIO_SendCommand
 936              	.LVL105:
2984:lib/ff/sdio_stm32f1.c **** 
 937              		.loc 1 2984 0
 938 009a 4846     		mov	r0, r9
 939 009c FFF7FEFF 		bl	CmdResp1Error
 940              	.LVL106:
2986:lib/ff/sdio_stm32f1.c ****   {
 941              		.loc 1 2986 0
 942 00a0 2A28     		cmp	r0, #42
 943 00a2 3FD1     		bne	.L77
2652:lib/ff/sdio_stm32f1.c **** {
 944              		.loc 1 2652 0
 945 00a4 ADF10404 		sub	r4, sp, #4
 946              	.LVL107:
 947              	.L97:
2991:lib/ff/sdio_stm32f1.c ****   {
 948              		.loc 1 2991 0
 949 00a8 5048     		ldr	r0, .L101+16
 950 00aa 426B     		ldr	r2, [r0, #52]
 951 00ac 40F22A63 		movw	r3, #1578
 952 00b0 1340     		ands	r3, r3, r2
 953 00b2 53B9     		cbnz	r3, .L100
 954              	.L80:
2993:lib/ff/sdio_stm32f1.c ****     {
 955              		.loc 1 2993 0
 956 00b4 4FF40010 		mov	r0, #2097152
 957 00b8 FFF7FEFF 		bl	SDIO_GetFlagStatus
 958              	.LVL108:
 959 00bc 0028     		cmp	r0, #0
 960 00be F3D0     		beq	.L97
2995:lib/ff/sdio_stm32f1.c ****       index++;
 961              		.loc 1 2995 0
 962 00c0 FFF7FEFF 		bl	SDIO_ReadData
 963              	.LVL109:
 964 00c4 44F8040F 		str	r0, [r4, #4]!
 965 00c8 EEE7     		b	.L97
 966              	.L100:
3000:lib/ff/sdio_stm32f1.c ****   {
 967              		.loc 1 3000 0
 968 00ca 0820     		movs	r0, #8
 969 00cc FFF7FEFF 		bl	SDIO_GetFlagStatus
 970              	.LVL110:
 971 00d0 20B1     		cbz	r0, .L81
3002:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_DATA_TIMEOUT;
 972              		.loc 1 3002 0
 973 00d2 0820     		movs	r0, #8
 974 00d4 FFF7FEFF 		bl	SDIO_ClearFlag
 975              	.LVL111:
3004:lib/ff/sdio_stm32f1.c ****   }
 976              		.loc 1 3004 0
 977 00d8 0420     		movs	r0, #4
 978 00da 7CE0     		b	.L76
 979              	.LVL112:
 980              	.L81:
3006:lib/ff/sdio_stm32f1.c ****   {
 981              		.loc 1 3006 0
 982 00dc 0220     		movs	r0, #2
 983 00de FFF7FEFF 		bl	SDIO_GetFlagStatus
 984              	.LVL113:
 985 00e2 20B1     		cbz	r0, .L82
3008:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_DATA_CRC_FAIL;
 986              		.loc 1 3008 0
 987 00e4 0220     		movs	r0, #2
 988 00e6 FFF7FEFF 		bl	SDIO_ClearFlag
 989              	.LVL114:
3010:lib/ff/sdio_stm32f1.c ****   }
 990              		.loc 1 3010 0
 991 00ea 0220     		movs	r0, #2
 992 00ec 73E0     		b	.L76
 993              	.LVL115:
 994              	.L82:
3012:lib/ff/sdio_stm32f1.c ****   {
 995              		.loc 1 3012 0
 996 00ee 2020     		movs	r0, #32
 997 00f0 FFF7FEFF 		bl	SDIO_GetFlagStatus
 998              	.LVL116:
 999 00f4 20B1     		cbz	r0, .L83
3014:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_RX_OVERRUN;
 1000              		.loc 1 3014 0
 1001 00f6 2020     		movs	r0, #32
 1002 00f8 FFF7FEFF 		bl	SDIO_ClearFlag
 1003              	.LVL117:
3016:lib/ff/sdio_stm32f1.c ****   }
 1004              		.loc 1 3016 0
 1005 00fc 0620     		movs	r0, #6
 1006 00fe 6AE0     		b	.L76
 1007              	.LVL118:
 1008              	.L83:
3018:lib/ff/sdio_stm32f1.c ****   {
 1009              		.loc 1 3018 0
 1010 0100 4FF40070 		mov	r0, #512
 1011 0104 FFF7FEFF 		bl	SDIO_GetFlagStatus
 1012              	.LVL119:
 1013 0108 28B1     		cbz	r0, .L84
3020:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_START_BIT_ERR;
 1014              		.loc 1 3020 0
 1015 010a 4FF40070 		mov	r0, #512
 1016 010e FFF7FEFF 		bl	SDIO_ClearFlag
 1017              	.LVL120:
3022:lib/ff/sdio_stm32f1.c ****   }
 1018              		.loc 1 3022 0
 1019 0112 0720     		movs	r0, #7
 1020 0114 5FE0     		b	.L76
 1021              	.LVL121:
 1022              	.L84:
3026:lib/ff/sdio_stm32f1.c **** 
 1023              		.loc 1 3026 0
 1024 0116 40F2FF50 		movw	r0, #1535
 1025 011a FFF7FEFF 		bl	SDIO_ClearFlag
 1026              	.LVL122:
 1027 011e 009D     		ldr	r5, [sp, #0]
 1028 0120 2DBA     		rev	r5, r5
 1029 0122 01E0     		b	.L98
 1030              	.LVL123:
 1031              	.L77:
 1032              	.LBE13:
 1033              	.LBE12:
2667:lib/ff/sdio_stm32f1.c ****   {
 1034              		.loc 1 2667 0
 1035 0124 2A28     		cmp	r0, #42
 1036 0126 56D1     		bne	.L76
 1037              	.LVL124:
 1038              	.L98:
2673:lib/ff/sdio_stm32f1.c ****   {
 1039              		.loc 1 2673 0
 1040 0128 B8F1010F 		cmp	r8, #1
 1041 012c 26D1     		bne	.L85
2676:lib/ff/sdio_stm32f1.c ****     {
 1042              		.loc 1 2676 0
 1043 012e 6B03     		lsls	r3, r5, #13
 1044 0130 50D5     		bpl	.L91
2679:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_CMD;
 1045              		.loc 1 2679 0
 1046 0132 2A4C     		ldr	r4, .L101
 1047 0134 2A48     		ldr	r0, .L101+4
 1048 0136 0268     		ldr	r2, [r0, #0]
 1049 0138 1304     		lsls	r3, r2, #16
 1050 013a 2360     		str	r3, [r4, #0]
2680:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 1051              		.loc 1 2680 0
 1052 013c 3725     		movs	r5, #55
 1053 013e 6560     		str	r5, [r4, #4]
2681:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 1054              		.loc 1 2681 0
 1055 0140 4FF04008 		mov	r8, #64
 1056 0144 C4F80880 		str	r8, [r4, #8]
2682:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 1057              		.loc 1 2682 0
 1058 0148 0027     		movs	r7, #0
 1059 014a E760     		str	r7, [r4, #12]
2683:lib/ff/sdio_stm32f1.c ****       SDIO_SendCommand(&SDIO_CmdInitStructure);
 1060              		.loc 1 2683 0
 1061 014c 4FF48066 		mov	r6, #1024
 1062 0150 2661     		str	r6, [r4, #16]
2684:lib/ff/sdio_stm32f1.c **** 
 1063              		.loc 1 2684 0
 1064 0152 2046     		mov	r0, r4
 1065 0154 FFF7FEFF 		bl	SDIO_SendCommand
 1066              	.LVL125:
2686:lib/ff/sdio_stm32f1.c **** 
 1067              		.loc 1 2686 0
 1068 0158 2846     		mov	r0, r5
 1069 015a FFF7FEFF 		bl	CmdResp1Error
 1070              	.LVL126:
2688:lib/ff/sdio_stm32f1.c ****       {
 1071              		.loc 1 2688 0
 1072 015e 2A28     		cmp	r0, #42
 1073 0160 39D1     		bne	.L76
2695:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 1074              		.loc 1 2695 0
 1075 0162 0223     		movs	r3, #2
 1076 0164 0625     		movs	r5, #6
 1077 0166 84E82800 		stmia	r4, {r3, r5}
2696:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 1078              		.loc 1 2696 0
 1079 016a C4F80880 		str	r8, [r4, #8]
2697:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 1080              		.loc 1 2697 0
 1081 016e E760     		str	r7, [r4, #12]
2698:lib/ff/sdio_stm32f1.c ****       SDIO_SendCommand(&SDIO_CmdInitStructure);
 1082              		.loc 1 2698 0
 1083 0170 2661     		str	r6, [r4, #16]
2699:lib/ff/sdio_stm32f1.c **** 
 1084              		.loc 1 2699 0
 1085 0172 2046     		mov	r0, r4
 1086              	.LVL127:
 1087 0174 FFF7FEFF 		bl	SDIO_SendCommand
 1088              	.LVL128:
2701:lib/ff/sdio_stm32f1.c **** 
 1089              		.loc 1 2701 0
 1090 0178 2846     		mov	r0, r5
 1091 017a 24E0     		b	.L99
 1092              	.L85:
2718:lib/ff/sdio_stm32f1.c ****     {
 1093              		.loc 1 2718 0
 1094 017c E803     		lsls	r0, r5, #15
 1095 017e 29D5     		bpl	.L91
2721:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_CMD;
 1096              		.loc 1 2721 0
 1097 0180 164C     		ldr	r4, .L101
 1098 0182 174E     		ldr	r6, .L101+4
 1099 0184 3768     		ldr	r7, [r6, #0]
 1100 0186 3904     		lsls	r1, r7, #16
 1101 0188 2160     		str	r1, [r4, #0]
2722:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 1102              		.loc 1 2722 0
 1103 018a 3726     		movs	r6, #55
 1104 018c 6660     		str	r6, [r4, #4]
2723:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 1105              		.loc 1 2723 0
 1106 018e 4FF04008 		mov	r8, #64
 1107 0192 C4F80880 		str	r8, [r4, #8]
2724:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 1108              		.loc 1 2724 0
 1109 0196 0025     		movs	r5, #0
 1110 0198 E560     		str	r5, [r4, #12]
2725:lib/ff/sdio_stm32f1.c ****       SDIO_SendCommand(&SDIO_CmdInitStructure);
 1111              		.loc 1 2725 0
 1112 019a 4FF48067 		mov	r7, #1024
 1113 019e 2761     		str	r7, [r4, #16]
2726:lib/ff/sdio_stm32f1.c **** 
 1114              		.loc 1 2726 0
 1115 01a0 2046     		mov	r0, r4
 1116 01a2 FFF7FEFF 		bl	SDIO_SendCommand
 1117              	.LVL129:
2729:lib/ff/sdio_stm32f1.c **** 
 1118              		.loc 1 2729 0
 1119 01a6 3046     		mov	r0, r6
 1120 01a8 FFF7FEFF 		bl	CmdResp1Error
 1121              	.LVL130:
2731:lib/ff/sdio_stm32f1.c ****       {
 1122              		.loc 1 2731 0
 1123 01ac 2A28     		cmp	r0, #42
 1124 01ae 12D1     		bne	.L76
2737:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_SD_SET_BUSWIDTH;
 1125              		.loc 1 2737 0
 1126 01b0 2560     		str	r5, [r4, #0]
2738:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 1127              		.loc 1 2738 0
 1128 01b2 0626     		movs	r6, #6
 1129 01b4 6660     		str	r6, [r4, #4]
2739:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 1130              		.loc 1 2739 0
 1131 01b6 C4F80880 		str	r8, [r4, #8]
2740:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 1132              		.loc 1 2740 0
 1133 01ba E560     		str	r5, [r4, #12]
2741:lib/ff/sdio_stm32f1.c ****       SDIO_SendCommand(&SDIO_CmdInitStructure);
 1134              		.loc 1 2741 0
 1135 01bc 2761     		str	r7, [r4, #16]
2742:lib/ff/sdio_stm32f1.c **** 
 1136              		.loc 1 2742 0
 1137 01be 2046     		mov	r0, r4
 1138              	.LVL131:
 1139 01c0 FFF7FEFF 		bl	SDIO_SendCommand
 1140              	.LVL132:
2744:lib/ff/sdio_stm32f1.c **** 
 1141              		.loc 1 2744 0
 1142 01c4 3046     		mov	r0, r6
 1143              	.L99:
2759:lib/ff/sdio_stm32f1.c **** 
 1144              		.loc 1 2759 0
 1145 01c6 02B0     		add	sp, sp, #8
 1146 01c8 BDE8F047 		pop	{r4, r5, r6, r7, r8, r9, sl, lr}
2744:lib/ff/sdio_stm32f1.c **** 
 1147              		.loc 1 2744 0
 1148 01cc FFF7FEBF 		b	CmdResp1Error
 1149              	.LVL133:
 1150              	.L86:
2661:lib/ff/sdio_stm32f1.c ****   }
 1151              		.loc 1 2661 0
 1152 01d0 0E20     		movs	r0, #14
 1153 01d2 00E0     		b	.L76
 1154              	.LVL134:
 1155              	.L91:
2712:lib/ff/sdio_stm32f1.c ****     }
 1156              		.loc 1 2712 0
 1157 01d4 2520     		movs	r0, #37
 1158              	.LVL135:
 1159              	.L76:
2759:lib/ff/sdio_stm32f1.c **** 
 1160              		.loc 1 2759 0
 1161 01d6 02B0     		add	sp, sp, #8
 1162 01d8 BDE8F087 		pop	{r4, r5, r6, r7, r8, r9, sl, pc}
 1163              	.L102:
 1164              		.align	2
 1165              	.L101:
 1166 01dc 00000000 		.word	.LANCHOR0
 1167 01e0 00000000 		.word	.LANCHOR1
 1168 01e4 00000000 		.word	.LANCHOR2
 1169 01e8 FFFF0F00 		.word	1048575
 1170 01ec 00800140 		.word	1073840128
 1171              		.cfi_endproc
 1172              	.LFE84:
 1174              		.section	.text.SD_DeInit,"ax",%progbits
 1175              		.align	1
 1176              		.global	SD_DeInit
 1177              		.thumb
 1178              		.thumb_func
 1180              	SD_DeInit:
 1181              	.LFB56:
 145:lib/ff/sdio_stm32f1.c ****   GPIO_InitTypeDef  GPIO_InitStructure;
 1182              		.loc 1 145 0
 1183              		.cfi_startproc
 1184              		@ args = 0, pretend = 0, frame = 8
 1185              		@ frame_needed = 0, uses_anonymous_args = 0
 1186 0000 13B5     		push	{r0, r1, r4, lr}
 1187              	.LCFI8:
 1188              		.cfi_def_cfa_offset 16
 1189              		.cfi_offset 0, -16
 1190              		.cfi_offset 1, -12
 1191              		.cfi_offset 4, -8
 1192              		.cfi_offset 14, -4
 149:lib/ff/sdio_stm32f1.c ****   
 1193              		.loc 1 149 0
 1194 0002 0020     		movs	r0, #0
 1195 0004 FFF7FEFF 		bl	SDIO_ClockCmd
 1196              	.LVL136:
 152:lib/ff/sdio_stm32f1.c **** 
 1197              		.loc 1 152 0
 1198 0008 0020     		movs	r0, #0
 1199 000a FFF7FEFF 		bl	SDIO_SetPowerState
 1200              	.LVL137:
 155:lib/ff/sdio_stm32f1.c ****   
 1201              		.loc 1 155 0
 1202 000e FFF7FEFF 		bl	SDIO_DeInit
 1203              	.LVL138:
 158:lib/ff/sdio_stm32f1.c **** 
 1204              		.loc 1 158 0
 1205 0012 4FF48060 		mov	r0, #1024
 1206 0016 0021     		movs	r1, #0
 1207 0018 FFF7FEFF 		bl	RCC_AHBPeriphClockCmd
 1208              	.LVL139:
 161:lib/ff/sdio_stm32f1.c ****   GPIO_InitStructure.GPIO_Mode = GPIO_Mode_IN_FLOATING;
 1209              		.loc 1 161 0
 1210 001c 4FF4F853 		mov	r3, #7936
 1211 0020 ADF80430 		strh	r3, [sp, #4]	@ movhi
 162:lib/ff/sdio_stm32f1.c ****   GPIO_Init(GPIOC, &GPIO_InitStructure);
 1212              		.loc 1 162 0
 1213 0024 0424     		movs	r4, #4
 1214 0026 8DF80740 		strb	r4, [sp, #7]
 163:lib/ff/sdio_stm32f1.c **** 
 1215              		.loc 1 163 0
 1216 002a 0648     		ldr	r0, .L104
 1217 002c 0DEB0401 		add	r1, sp, r4
 1218 0030 FFF7FEFF 		bl	GPIO_Init
 1219              	.LVL140:
 166:lib/ff/sdio_stm32f1.c ****   GPIO_Init(GPIOD, &GPIO_InitStructure);
 1220              		.loc 1 166 0
 1221 0034 ADF80440 		strh	r4, [sp, #4]	@ movhi
 167:lib/ff/sdio_stm32f1.c **** }
 1222              		.loc 1 167 0
 1223 0038 0348     		ldr	r0, .L104+4
 1224 003a 0DEB0401 		add	r1, sp, r4
 1225 003e FFF7FEFF 		bl	GPIO_Init
 1226              	.LVL141:
 168:lib/ff/sdio_stm32f1.c **** 
 1227              		.loc 1 168 0
 1228 0042 1CBD     		pop	{r2, r3, r4, pc}
 1229              	.L105:
 1230              		.align	2
 1231              	.L104:
 1232 0044 00100140 		.word	1073811456
 1233 0048 00140140 		.word	1073812480
 1234              		.cfi_endproc
 1235              	.LFE56:
 1237              		.section	.text.SD_Detect,"ax",%progbits
 1238              		.align	1
 1239              		.global	SD_Detect
 1240              		.thumb
 1241              		.thumb_func
 1243              	SD_Detect:
 1244              	.LFB60:
 342:lib/ff/sdio_stm32f1.c ****   __IO uint8_t status = SD_PRESENT;
 1245              		.loc 1 342 0
 1246              		.cfi_startproc
 1247              		@ args = 0, pretend = 0, frame = 8
 1248              		@ frame_needed = 0, uses_anonymous_args = 0
 1249              		@ link register save eliminated.
 1250 0000 82B0     		sub	sp, sp, #8
 1251              	.LCFI9:
 1252              		.cfi_def_cfa_offset 8
 343:lib/ff/sdio_stm32f1.c **** 
 1253              		.loc 1 343 0
 1254 0002 0123     		movs	r3, #1
 1255 0004 8DF80730 		strb	r3, [sp, #7]
 1256              	.LVL142:
 353:lib/ff/sdio_stm32f1.c **** }
 1257              		.loc 1 353 0
 1258 0008 9DF80700 		ldrb	r0, [sp, #7]	@ zero_extendqisi2
 1259              	.LVL143:
 1260              	.LVL144:
 354:lib/ff/sdio_stm32f1.c **** 
 1261              		.loc 1 354 0
 1262 000c 02B0     		add	sp, sp, #8
 1263 000e 7047     		bx	lr
 1264              		.cfi_endproc
 1265              	.LFE60:
 1267              		.section	.text.SD_PowerON,"ax",%progbits
 1268              		.align	1
 1269              		.global	SD_PowerON
 1270              		.thumb
 1271              		.thumb_func
 1273              	SD_PowerON:
 1274              	.LFB61:
 366:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
 1275              		.loc 1 366 0
 1276              		.cfi_startproc
 1277              		@ args = 0, pretend = 0, frame = 0
 1278              		@ frame_needed = 0, uses_anonymous_args = 0
 1279 0000 2DE9F84F 		push	{r3, r4, r5, r6, r7, r8, r9, sl, fp, lr}
 1280              	.LCFI10:
 1281              		.cfi_def_cfa_offset 40
 1282              		.cfi_offset 3, -40
 1283              		.cfi_offset 4, -36
 1284              		.cfi_offset 5, -32
 1285              		.cfi_offset 6, -28
 1286              		.cfi_offset 7, -24
 1287              		.cfi_offset 8, -20
 1288              		.cfi_offset 9, -16
 1289              		.cfi_offset 10, -12
 1290              		.cfi_offset 11, -8
 1291              		.cfi_offset 14, -4
 1292              	.LVL145:
 375:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_ClockEdge = SDIO_ClockEdge_Rising;
 1293              		.loc 1 375 0
 1294 0004 6548     		ldr	r0, .L141
 1295 0006 B223     		movs	r3, #178
 1296 0008 0375     		strb	r3, [r0, #20]
 376:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_ClockBypass = SDIO_ClockBypass_Disable;
 1297              		.loc 1 376 0
 1298 000a 0024     		movs	r4, #0
 1299 000c 0460     		str	r4, [r0, #0]
 377:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_ClockPowerSave = SDIO_ClockPowerSave_Disable;
 1300              		.loc 1 377 0
 1301 000e 4460     		str	r4, [r0, #4]
 378:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_BusWide = SDIO_BusWide_1b;
 1302              		.loc 1 378 0
 1303 0010 8460     		str	r4, [r0, #8]
 379:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_HardwareFlowControl = SDIO_HardwareFlowControl_Disable;
 1304              		.loc 1 379 0
 1305 0012 C460     		str	r4, [r0, #12]
 380:lib/ff/sdio_stm32f1.c ****   SDIO_Init(&SDIO_InitStructure);
 1306              		.loc 1 380 0
 1307 0014 0461     		str	r4, [r0, #16]
 381:lib/ff/sdio_stm32f1.c **** 
 1308              		.loc 1 381 0
 1309 0016 FFF7FEFF 		bl	SDIO_Init
 1310              	.LVL146:
 384:lib/ff/sdio_stm32f1.c **** 
 1311              		.loc 1 384 0
 1312 001a 0320     		movs	r0, #3
 1313 001c FFF7FEFF 		bl	SDIO_SetPowerState
 1314              	.LVL147:
 387:lib/ff/sdio_stm32f1.c **** 
 1315              		.loc 1 387 0
 1316 0020 0120     		movs	r0, #1
 1317 0022 FFF7FEFF 		bl	SDIO_ClockCmd
 1318              	.LVL148:
 391:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_GO_IDLE_STATE;
 1319              		.loc 1 391 0
 1320 0026 5E48     		ldr	r0, .L141+4
 1321 0028 0460     		str	r4, [r0, #0]
 392:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_No;
 1322              		.loc 1 392 0
 1323 002a 4460     		str	r4, [r0, #4]
 393:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 1324              		.loc 1 393 0
 1325 002c 8460     		str	r4, [r0, #8]
 394:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 1326              		.loc 1 394 0
 1327 002e C460     		str	r4, [r0, #12]
 395:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 1328              		.loc 1 395 0
 1329 0030 4FF48061 		mov	r1, #1024
 1330 0034 0161     		str	r1, [r0, #16]
 396:lib/ff/sdio_stm32f1.c **** 
 1331              		.loc 1 396 0
 1332 0036 FFF7FEFF 		bl	SDIO_SendCommand
 1333              	.LVL149:
 1334 003a 4FF48034 		mov	r4, #65536
 1335              	.LVL150:
 1336              	.L108:
 1337              	.LBB20:
 1338              	.LBB21:
2294:lib/ff/sdio_stm32f1.c ****   {
 1339              		.loc 1 2294 0
 1340 003e 8020     		movs	r0, #128
 1341 0040 FFF7FEFF 		bl	SDIO_GetFlagStatus
 1342              	.LVL151:
 1343 0044 0028     		cmp	r0, #0
 1344 0046 46D1     		bne	.L140
 1345              	.L110:
 1346 0048 013C     		subs	r4, r4, #1
 1347 004a F8D1     		bne	.L108
 1348 004c 41E0     		b	.L125
 1349              	.LVL152:
 1350              	.L121:
 1351              	.LBE21:
 1352              	.LBE20:
 1353              	.LBB23:
 1354              	.LBB24:
2527:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
 1355              		.loc 1 2527 0
 1356 004e 40F2FF50 		movw	r0, #1535
 1357 0052 FFF7FEFF 		bl	SDIO_ClearFlag
 1358              	.LVL153:
 1359              	.LBE24:
 1360              	.LBE23:
 486:lib/ff/sdio_stm32f1.c ****       validvoltage = (((response >> 31) == 1) ? 1 : 0);
 1361              		.loc 1 486 0
 1362 0056 2046     		mov	r0, r4
 1363 0058 FFF7FEFF 		bl	SDIO_GetResponse
 1364              	.LVL154:
 487:lib/ff/sdio_stm32f1.c ****       count++;
 1365              		.loc 1 487 0
 1366 005c C60F     		lsrs	r6, r0, #31
 1367              	.LVL155:
 488:lib/ff/sdio_stm32f1.c ****     }
 1368              		.loc 1 488 0
 1369 005e 0137     		adds	r7, r7, #1
 1370              	.LVL156:
 1371              	.L118:
 1372 0060 4FF6FF71 		movw	r1, #65535
 453:lib/ff/sdio_stm32f1.c ****     {
 1373              		.loc 1 453 0 discriminator 1
 1374 0064 002E     		cmp	r6, #0
 1375 0066 40F08B80 		bne	.L122
 453:lib/ff/sdio_stm32f1.c ****     {
 1376              		.loc 1 453 0 is_stmt 0 discriminator 2
 1377 006a 8F42     		cmp	r7, r1
 1378 006c 00F09280 		beq	.L128
 1379              	.L123:
 457:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_CMD;
 1380              		.loc 1 457 0 is_stmt 1
 1381 0070 4B4C     		ldr	r4, .L141+4
 1382 0072 2660     		str	r6, [r4, #0]
 458:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 1383              		.loc 1 458 0
 1384 0074 4FF0370B 		mov	fp, #55
 1385 0078 C4F804B0 		str	fp, [r4, #4]
 459:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 1386              		.loc 1 459 0
 1387 007c 4FF0400A 		mov	sl, #64
 1388 0080 C4F808A0 		str	sl, [r4, #8]
 460:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 1389              		.loc 1 460 0
 1390 0084 E660     		str	r6, [r4, #12]
 461:lib/ff/sdio_stm32f1.c ****       SDIO_SendCommand(&SDIO_CmdInitStructure);
 1391              		.loc 1 461 0
 1392 0086 4FF48069 		mov	r9, #1024
 1393 008a C4F81090 		str	r9, [r4, #16]
 462:lib/ff/sdio_stm32f1.c **** 
 1394              		.loc 1 462 0
 1395 008e 2046     		mov	r0, r4
 1396 0090 FFF7FEFF 		bl	SDIO_SendCommand
 1397              	.LVL157:
 464:lib/ff/sdio_stm32f1.c **** 
 1398              		.loc 1 464 0
 1399 0094 5846     		mov	r0, fp
 1400 0096 FFF7FEFF 		bl	CmdResp1Error
 1401              	.LVL158:
 466:lib/ff/sdio_stm32f1.c ****       {
 1402              		.loc 1 466 0
 1403 009a 2A28     		cmp	r0, #42
 1404 009c 78D1     		bne	.L127
 472:lib/ff/sdio_stm32f1.c **** 											SDType;
 1405              		.loc 1 472 0
 1406 009e 48F01043 		orr	r3, r8, #-1879048192
 1407 00a2 43F48011 		orr	r1, r3, #1048576
 470:lib/ff/sdio_stm32f1.c **** 											SD_SDXC_XPC_FULLPOWER 		| \
 1408              		.loc 1 470 0
 1409 00a6 2160     		str	r1, [r4, #0]
 474:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 1410              		.loc 1 474 0
 1411 00a8 2920     		movs	r0, #41
 1412              	.LVL159:
 1413 00aa 6060     		str	r0, [r4, #4]
 475:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 1414              		.loc 1 475 0
 1415 00ac C4F808A0 		str	sl, [r4, #8]
 476:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 1416              		.loc 1 476 0
 1417 00b0 E660     		str	r6, [r4, #12]
 477:lib/ff/sdio_stm32f1.c ****       SDIO_SendCommand(&SDIO_CmdInitStructure);
 1418              		.loc 1 477 0
 1419 00b2 C4F81090 		str	r9, [r4, #16]
 478:lib/ff/sdio_stm32f1.c **** 
 1420              		.loc 1 478 0
 1421 00b6 2046     		mov	r0, r4
 1422 00b8 FFF7FEFF 		bl	SDIO_SendCommand
 1423              	.LVL160:
 1424              	.LBB26:
 1425              	.LBB25:
2513:lib/ff/sdio_stm32f1.c **** 
 1426              		.loc 1 2513 0
 1427 00bc 394C     		ldr	r4, .L141+8
 1428              	.L120:
2517:lib/ff/sdio_stm32f1.c ****   }
 1429              		.loc 1 2517 0
 1430 00be 626B     		ldr	r2, [r4, #52]
 1431              	.LVL161:
2515:lib/ff/sdio_stm32f1.c ****   {
 1432              		.loc 1 2515 0
 1433 00c0 12F0450F 		tst	r2, #69
 1434 00c4 FBD0     		beq	.L120
2520:lib/ff/sdio_stm32f1.c ****   {
 1435              		.loc 1 2520 0
 1436 00c6 12F00404 		ands	r4, r2, #4
 1437 00ca C0D0     		beq	.L121
 1438              	.LVL162:
2523:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 1439              		.loc 1 2523 0
 1440 00cc 0420     		movs	r0, #4
 1441 00ce FFF7FEFF 		bl	SDIO_ClearFlag
 1442              	.LVL163:
 1443              	.L125:
 1444              	.LBE25:
 1445              	.LBE26:
 1446              	.LBB27:
 1447              	.LBB22:
2302:lib/ff/sdio_stm32f1.c ****   }
 1448              		.loc 1 2302 0
 1449 00d2 0325     		movs	r5, #3
 1450 00d4 5FE0     		b	.L132
 1451              	.LVL164:
 1452              	.L140:
2306:lib/ff/sdio_stm32f1.c **** 
 1453              		.loc 1 2306 0
 1454 00d6 40F2FF50 		movw	r0, #1535
 1455 00da FFF7FEFF 		bl	SDIO_ClearFlag
 1456              	.LVL165:
 1457              	.LBE22:
 1458              	.LBE27:
 412:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SDIO_SEND_IF_COND;
 1459              		.loc 1 412 0
 1460 00de 3048     		ldr	r0, .L141+4
 415:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 1461              		.loc 1 415 0
 1462 00e0 4FF4D571 		mov	r1, #426
 1463 00e4 0822     		movs	r2, #8
 1464 00e6 4023     		movs	r3, #64
 1465 00e8 0024     		movs	r4, #0
 1466 00ea 80E81E00 		stmia	r0, {r1, r2, r3, r4}
 416:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 1467              		.loc 1 416 0
 1468 00ee 4FF48062 		mov	r2, #1024
 1469 00f2 0261     		str	r2, [r0, #16]
 417:lib/ff/sdio_stm32f1.c **** 
 1470              		.loc 1 417 0
 1471 00f4 FFF7FEFF 		bl	SDIO_SendCommand
 1472              	.LVL166:
 1473              	.LBB28:
 1474              	.LBB29:
2325:lib/ff/sdio_stm32f1.c **** 
 1475              		.loc 1 2325 0
 1476 00f8 2A48     		ldr	r0, .L141+8
 1477 00fa 456B     		ldr	r5, [r0, #52]
 1478              	.LVL167:
2323:lib/ff/sdio_stm32f1.c **** 
 1479              		.loc 1 2323 0
 1480 00fc 4FF48036 		mov	r6, #65536
 1481              	.LVL168:
 1482              	.L124:
2327:lib/ff/sdio_stm32f1.c ****   {
 1483              		.loc 1 2327 0
 1484 0100 15F0450F 		tst	r5, #69
 1485 0104 04D1     		bne	.L112
 1486 0106 36B1     		cbz	r6, .L114
 1487              	.L113:
2329:lib/ff/sdio_stm32f1.c ****     status = SDIO->STA;
 1488              		.loc 1 2329 0
 1489 0108 013E     		subs	r6, r6, #1
 1490              	.LVL169:
2330:lib/ff/sdio_stm32f1.c ****   }
 1491              		.loc 1 2330 0
 1492 010a 264D     		ldr	r5, .L141+8
 1493              	.LVL170:
 1494 010c 6D6B     		ldr	r5, [r5, #52]
 1495              	.LVL171:
 1496 010e F7E7     		b	.L124
 1497              	.L112:
2333:lib/ff/sdio_stm32f1.c ****   {
 1498              		.loc 1 2333 0
 1499 0110 0EB1     		cbz	r6, .L114
 1500 0112 6907     		lsls	r1, r5, #29
 1501 0114 14D5     		bpl	.L115
 1502              	.L114:
 1503              	.LVL172:
2337:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 1504              		.loc 1 2337 0
 1505 0116 0420     		movs	r0, #4
 1506 0118 FFF7FEFF 		bl	SDIO_ClearFlag
 1507              	.LVL173:
 1508              	.LBE29:
 1509              	.LBE28:
 429:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_CMD;
 1510              		.loc 1 429 0
 1511 011c 2048     		ldr	r0, .L141+4
 430:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 1512              		.loc 1 430 0
 1513 011e 0024     		movs	r4, #0
 1514 0120 3725     		movs	r5, #55
 1515              	.LVL174:
 1516 0122 80E83000 		stmia	r0, {r4, r5}
 431:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 1517              		.loc 1 431 0
 1518 0126 4021     		movs	r1, #64
 1519 0128 8160     		str	r1, [r0, #8]
 432:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 1520              		.loc 1 432 0
 1521 012a C460     		str	r4, [r0, #12]
 433:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
 1522              		.loc 1 433 0
 1523 012c 4FF48062 		mov	r2, #1024
 1524 0130 0261     		str	r2, [r0, #16]
 434:lib/ff/sdio_stm32f1.c ****     errorstatus = CmdResp1Error(SD_CMD_APP_CMD);
 1525              		.loc 1 434 0
 1526 0132 FFF7FEFF 		bl	SDIO_SendCommand
 1527              	.LVL175:
 435:lib/ff/sdio_stm32f1.c ****   }
 1528              		.loc 1 435 0
 1529 0136 2846     		mov	r0, r5
 1530 0138 FFF7FEFF 		bl	CmdResp1Error
 1531              	.LVL176:
 369:lib/ff/sdio_stm32f1.c **** 
 1532              		.loc 1 369 0
 1533 013c A046     		mov	r8, r4
 1534 013e 09E0     		b	.L116
 1535              	.LVL177:
 1536              	.L115:
 1537              	.LBB31:
 1538              	.LBB30:
2341:lib/ff/sdio_stm32f1.c ****   {
 1539              		.loc 1 2341 0
 1540 0140 6A06     		lsls	r2, r5, #25
 1541 0142 02D5     		bpl	.L117
2345:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 1542              		.loc 1 2345 0
 1543 0144 4020     		movs	r0, #64
 1544 0146 FFF7FEFF 		bl	SDIO_ClearFlag
 1545              	.LVL178:
 1546              	.L117:
 1547              	.LBE30:
 1548              	.LBE31:
 423:lib/ff/sdio_stm32f1.c ****     SDType = SD_HIGH_CAPACITY;
 1549              		.loc 1 423 0
 1550 014a 0124     		movs	r4, #1
 1551 014c 164B     		ldr	r3, .L141+12
 1552 014e 1C60     		str	r4, [r3, #0]
 1553              	.LVL179:
 424:lib/ff/sdio_stm32f1.c ****   }
 1554              		.loc 1 424 0
 1555 0150 4FF08048 		mov	r8, #1073741824
 1556              	.LVL180:
 1557              	.L116:
 438:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_CMD;
 1558              		.loc 1 438 0
 1559 0154 1248     		ldr	r0, .L141+4
 1560 0156 0026     		movs	r6, #0
 1561              	.LVL181:
 1562 0158 0660     		str	r6, [r0, #0]
 439:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 1563              		.loc 1 439 0
 1564 015a 3724     		movs	r4, #55
 1565 015c 4460     		str	r4, [r0, #4]
 440:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 1566              		.loc 1 440 0
 1567 015e 4025     		movs	r5, #64
 1568 0160 8560     		str	r5, [r0, #8]
 441:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 1569              		.loc 1 441 0
 1570 0162 C660     		str	r6, [r0, #12]
 442:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 1571              		.loc 1 442 0
 1572 0164 4FF48063 		mov	r3, #1024
 1573 0168 0361     		str	r3, [r0, #16]
 443:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_APP_CMD);
 1574              		.loc 1 443 0
 1575 016a FFF7FEFF 		bl	SDIO_SendCommand
 1576              	.LVL182:
 444:lib/ff/sdio_stm32f1.c **** 
 1577              		.loc 1 444 0
 1578 016e 2046     		mov	r0, r4
 1579 0170 FFF7FEFF 		bl	CmdResp1Error
 1580              	.LVL183:
 1581 0174 0546     		mov	r5, r0
 1582              	.LVL184:
 449:lib/ff/sdio_stm32f1.c ****   {
 1583              		.loc 1 449 0
 1584 0176 2A28     		cmp	r0, #42
 1585 0178 0DD1     		bne	.L132
 1586 017a 3746     		mov	r7, r6
 1587 017c 3046     		mov	r0, r6
 1588              	.LVL185:
 1589 017e 6FE7     		b	.L118
 1590              	.LVL186:
 1591              	.L122:
 490:lib/ff/sdio_stm32f1.c ****     {
 1592              		.loc 1 490 0
 1593 0180 8F42     		cmp	r7, r1
 1594 0182 07D0     		beq	.L128
 1595              	.LVL187:
 496:lib/ff/sdio_stm32f1.c ****     {
 1596              		.loc 1 496 0
 1597 0184 4300     		lsls	r3, r0, #1
 1598 0186 06D5     		bpl	.L132
 498:lib/ff/sdio_stm32f1.c ****     }
 1599              		.loc 1 498 0
 1600 0188 0220     		movs	r0, #2
 1601              	.LVL188:
 1602 018a 074A     		ldr	r2, .L141+12
 1603 018c 1060     		str	r0, [r2, #0]
 1604 018e 02E0     		b	.L132
 1605              	.LVL189:
 1606              	.L127:
 464:lib/ff/sdio_stm32f1.c **** 
 1607              		.loc 1 464 0
 1608 0190 0546     		mov	r5, r0
 1609 0192 00E0     		b	.L132
 1610              	.LVL190:
 1611              	.L128:
 493:lib/ff/sdio_stm32f1.c ****     }
 1612              		.loc 1 493 0
 1613 0194 1B25     		movs	r5, #27
 1614              	.LVL191:
 1615              	.L132:
 504:lib/ff/sdio_stm32f1.c **** 
 1616              		.loc 1 504 0
 1617 0196 2846     		mov	r0, r5
 1618 0198 BDE8F88F 		pop	{r3, r4, r5, r6, r7, r8, r9, sl, fp, pc}
 1619              	.L142:
 1620              		.align	2
 1621              	.L141:
 1622 019c 00000000 		.word	.LANCHOR3
 1623 01a0 00000000 		.word	.LANCHOR0
 1624 01a4 00800140 		.word	1073840128
 1625 01a8 00000000 		.word	.LANCHOR4
 1626              		.cfi_endproc
 1627              	.LFE61:
 1629              		.section	.text.SD_PowerOFF,"ax",%progbits
 1630              		.align	1
 1631              		.global	SD_PowerOFF
 1632              		.thumb
 1633              		.thumb_func
 1635              	SD_PowerOFF:
 1636              	.LFB62:
 515:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
 1637              		.loc 1 515 0
 1638              		.cfi_startproc
 1639              		@ args = 0, pretend = 0, frame = 0
 1640              		@ frame_needed = 0, uses_anonymous_args = 0
 1641 0000 08B5     		push	{r3, lr}
 1642              	.LCFI11:
 1643              		.cfi_def_cfa_offset 8
 1644              		.cfi_offset 3, -8
 1645              		.cfi_offset 14, -4
 1646              	.LVL192:
 519:lib/ff/sdio_stm32f1.c **** 
 1647              		.loc 1 519 0
 1648 0002 0020     		movs	r0, #0
 1649 0004 FFF7FEFF 		bl	SDIO_SetPowerState
 1650              	.LVL193:
 522:lib/ff/sdio_stm32f1.c **** 
 1651              		.loc 1 522 0
 1652 0008 2A20     		movs	r0, #42
 1653 000a 08BD     		pop	{r3, pc}
 1654              		.cfi_endproc
 1655              	.LFE62:
 1657              		.section	.text.SD_InitializeCards,"ax",%progbits
 1658              		.align	1
 1659              		.global	SD_InitializeCards
 1660              		.thumb
 1661              		.thumb_func
 1663              	SD_InitializeCards:
 1664              	.LFB63:
 534:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
 1665              		.loc 1 534 0
 1666              		.cfi_startproc
 1667              		@ args = 0, pretend = 0, frame = 0
 1668              		@ frame_needed = 0, uses_anonymous_args = 0
 1669 0000 38B5     		push	{r3, r4, r5, lr}
 1670              	.LCFI12:
 1671              		.cfi_def_cfa_offset 16
 1672              		.cfi_offset 3, -16
 1673              		.cfi_offset 4, -12
 1674              		.cfi_offset 5, -8
 1675              		.cfi_offset 14, -4
 1676              	.LVL194:
 538:lib/ff/sdio_stm32f1.c ****   {
 1677              		.loc 1 538 0
 1678 0002 FFF7FEFF 		bl	SDIO_GetPowerState
 1679              	.LVL195:
 1680 0006 0028     		cmp	r0, #0
 1681 0008 00F09480 		beq	.L157
 544:lib/ff/sdio_stm32f1.c ****   {
 1682              		.loc 1 544 0
 1683 000c 4F4B     		ldr	r3, .L169
 1684 000e 1868     		ldr	r0, [r3, #0]
 1685 0010 0428     		cmp	r0, #4
 1686 0012 23D0     		beq	.L146
 547:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_ALL_SEND_CID;
 1687              		.loc 1 547 0
 1688 0014 4E48     		ldr	r0, .L169+4
 1689 0016 0025     		movs	r5, #0
 1690 0018 0560     		str	r5, [r0, #0]
 548:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Long;
 1691              		.loc 1 548 0
 1692 001a 0222     		movs	r2, #2
 1693 001c 4260     		str	r2, [r0, #4]
 549:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 1694              		.loc 1 549 0
 1695 001e C021     		movs	r1, #192
 1696 0020 8160     		str	r1, [r0, #8]
 550:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 1697              		.loc 1 550 0
 1698 0022 C560     		str	r5, [r0, #12]
 551:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
 1699              		.loc 1 551 0
 1700 0024 4FF48064 		mov	r4, #1024
 1701 0028 0461     		str	r4, [r0, #16]
 552:lib/ff/sdio_stm32f1.c **** 
 1702              		.loc 1 552 0
 1703 002a FFF7FEFF 		bl	SDIO_SendCommand
 1704              	.LVL196:
 554:lib/ff/sdio_stm32f1.c **** 
 1705              		.loc 1 554 0
 1706 002e FFF7FEFF 		bl	CmdResp2Error
 1707              	.LVL197:
 1708 0032 0446     		mov	r4, r0
 1709              	.LVL198:
 556:lib/ff/sdio_stm32f1.c ****     {
 1710              		.loc 1 556 0
 1711 0034 2A28     		cmp	r0, #42
 1712 0036 40F08680 		bne	.L164
 561:lib/ff/sdio_stm32f1.c ****     CID_Tab[1] = SDIO_GetResponse(SDIO_RESP2);
 1713              		.loc 1 561 0
 1714 003a 2846     		mov	r0, r5
 1715              	.LVL199:
 1716 003c FFF7FEFF 		bl	SDIO_GetResponse
 1717              	.LVL200:
 1718 0040 444C     		ldr	r4, .L169+8
 1719              	.LVL201:
 1720 0042 2060     		str	r0, [r4, #0]
 562:lib/ff/sdio_stm32f1.c ****     CID_Tab[2] = SDIO_GetResponse(SDIO_RESP3);
 1721              		.loc 1 562 0
 1722 0044 0420     		movs	r0, #4
 1723 0046 FFF7FEFF 		bl	SDIO_GetResponse
 1724              	.LVL202:
 1725 004a 6060     		str	r0, [r4, #4]
 563:lib/ff/sdio_stm32f1.c ****     CID_Tab[3] = SDIO_GetResponse(SDIO_RESP4);
 1726              		.loc 1 563 0
 1727 004c 0820     		movs	r0, #8
 1728 004e FFF7FEFF 		bl	SDIO_GetResponse
 1729              	.LVL203:
 1730 0052 A060     		str	r0, [r4, #8]
 564:lib/ff/sdio_stm32f1.c ****   }
 1731              		.loc 1 564 0
 1732 0054 0C20     		movs	r0, #12
 1733 0056 FFF7FEFF 		bl	SDIO_GetResponse
 1734              	.LVL204:
 1735 005a E060     		str	r0, [r4, #12]
 1736              	.L146:
 566:lib/ff/sdio_stm32f1.c ****       ||  (SDIO_HIGH_CAPACITY_SD_CARD == CardType))
 1737              		.loc 1 566 0
 1738 005c 3B4B     		ldr	r3, .L169
 1739 005e 1868     		ldr	r0, [r3, #0]
 1740 0060 0128     		cmp	r0, #1
 1741 0062 03D9     		bls	.L147
 566:lib/ff/sdio_stm32f1.c ****       ||  (SDIO_HIGH_CAPACITY_SD_CARD == CardType))
 1742              		.loc 1 566 0 is_stmt 0 discriminator 1
 1743 0064 0628     		cmp	r0, #6
 1744 0066 01D0     		beq	.L147
 567:lib/ff/sdio_stm32f1.c ****   {
 1745              		.loc 1 567 0 is_stmt 1
 1746 0068 0228     		cmp	r0, #2
 1747 006a 36D1     		bne	.L158
 1748              	.L147:
 571:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SET_REL_ADDR;
 1749              		.loc 1 571 0
 1750 006c 3848     		ldr	r0, .L169+4
 1751 006e 0021     		movs	r1, #0
 1752 0070 0160     		str	r1, [r0, #0]
 572:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 1753              		.loc 1 572 0
 1754 0072 0322     		movs	r2, #3
 1755 0074 4260     		str	r2, [r0, #4]
 573:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 1756              		.loc 1 573 0
 1757 0076 4024     		movs	r4, #64
 1758 0078 8460     		str	r4, [r0, #8]
 574:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 1759              		.loc 1 574 0
 1760 007a C160     		str	r1, [r0, #12]
 575:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
 1761              		.loc 1 575 0
 1762 007c 4FF48063 		mov	r3, #1024
 1763 0080 0361     		str	r3, [r0, #16]
 576:lib/ff/sdio_stm32f1.c **** 
 1764              		.loc 1 576 0
 1765 0082 FFF7FEFF 		bl	SDIO_SendCommand
 1766              	.LVL205:
 1767              	.LBB34:
 1768              	.LBB35:
2586:lib/ff/sdio_stm32f1.c **** 
 1769              		.loc 1 2586 0
 1770 0086 3449     		ldr	r1, .L169+12
 1771              	.L150:
2590:lib/ff/sdio_stm32f1.c ****   }
 1772              		.loc 1 2590 0
 1773 0088 486B     		ldr	r0, [r1, #52]
 1774              	.LVL206:
2588:lib/ff/sdio_stm32f1.c ****   {
 1775              		.loc 1 2588 0
 1776 008a 10F0450F 		tst	r0, #69
 1777 008e FBD0     		beq	.L150
2593:lib/ff/sdio_stm32f1.c ****   {
 1778              		.loc 1 2593 0
 1779 0090 4207     		lsls	r2, r0, #29
 1780 0092 04D5     		bpl	.L151
 1781              	.LVL207:
2596:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 1782              		.loc 1 2596 0
 1783 0094 0420     		movs	r0, #4
 1784              	.LVL208:
 1785 0096 FFF7FEFF 		bl	SDIO_ClearFlag
 1786              	.LVL209:
2597:lib/ff/sdio_stm32f1.c ****   }
 1787              		.loc 1 2597 0
 1788 009a 0324     		movs	r4, #3
 1789 009c 53E0     		b	.L164
 1790              	.LVL210:
 1791              	.L151:
2599:lib/ff/sdio_stm32f1.c ****   {
 1792              		.loc 1 2599 0
 1793 009e 10F00104 		ands	r4, r0, #1
 1794 00a2 04D0     		beq	.L153
 1795              	.LVL211:
2602:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 1796              		.loc 1 2602 0
 1797 00a4 0120     		movs	r0, #1
 1798              	.LVL212:
 1799 00a6 FFF7FEFF 		bl	SDIO_ClearFlag
 1800              	.LVL213:
2603:lib/ff/sdio_stm32f1.c ****   }
 1801              		.loc 1 2603 0
 1802 00aa 0124     		movs	r4, #1
 1803 00ac 4BE0     		b	.L164
 1804              	.LVL214:
 1805              	.L153:
2607:lib/ff/sdio_stm32f1.c ****   {
 1806              		.loc 1 2607 0
 1807 00ae FFF7FEFF 		bl	SDIO_GetCommandResponse
 1808              	.LVL215:
 1809 00b2 0328     		cmp	r0, #3
 1810 00b4 42D1     		bne	.L154
2614:lib/ff/sdio_stm32f1.c **** 
 1811              		.loc 1 2614 0
 1812 00b6 40F2FF50 		movw	r0, #1535
 1813 00ba FFF7FEFF 		bl	SDIO_ClearFlag
 1814              	.LVL216:
2617:lib/ff/sdio_stm32f1.c **** 
 1815              		.loc 1 2617 0
 1816 00be 2046     		mov	r0, r4
 1817 00c0 FFF7FEFF 		bl	SDIO_GetResponse
 1818              	.LVL217:
2619:lib/ff/sdio_stm32f1.c ****   {
 1819              		.loc 1 2619 0
 1820 00c4 10F4604F 		tst	r0, #57344
 1821 00c8 01D1     		bne	.L155
2621:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 1822              		.loc 1 2621 0
 1823 00ca 020C     		lsrs	r2, r0, #16
 1824              	.LVL218:
 1825 00cc 06E0     		b	.L148
 1826              	.LVL219:
 1827              	.L155:
2625:lib/ff/sdio_stm32f1.c ****   {
 1828              		.loc 1 2625 0
 1829 00ce 8304     		lsls	r3, r0, #18
 1830 00d0 36D4     		bmi	.L159
2630:lib/ff/sdio_stm32f1.c ****   {
 1831              		.loc 1 2630 0
 1832 00d2 4404     		lsls	r4, r0, #17
 1833 00d4 32D4     		bmi	.L154
2635:lib/ff/sdio_stm32f1.c ****   {
 1834              		.loc 1 2635 0
 1835 00d6 0004     		lsls	r0, r0, #16
 1836              	.LVL220:
 1837 00d8 34D4     		bmi	.L160
 1838              	.LVL221:
 1839              	.L158:
 1840              	.LBE35:
 1841              	.LBE34:
 536:lib/ff/sdio_stm32f1.c **** 
 1842              		.loc 1 536 0
 1843 00da 0122     		movs	r2, #1
 1844              	.LVL222:
 1845              	.L148:
 586:lib/ff/sdio_stm32f1.c ****   {
 1846              		.loc 1 586 0
 1847 00dc 1B4B     		ldr	r3, .L169
 1848 00de 1968     		ldr	r1, [r3, #0]
 1849 00e0 0429     		cmp	r1, #4
 1850 00e2 29D0     		beq	.L161
 588:lib/ff/sdio_stm32f1.c **** 
 1851              		.loc 1 588 0
 1852 00e4 1D4D     		ldr	r5, .L169+16
 1853 00e6 2A60     		str	r2, [r5, #0]
 591:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SEND_CSD;
 1854              		.loc 1 591 0
 1855 00e8 194C     		ldr	r4, .L169+4
 1856 00ea 1004     		lsls	r0, r2, #16
 1857 00ec 2060     		str	r0, [r4, #0]
 592:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Long;
 1858              		.loc 1 592 0
 1859 00ee 0922     		movs	r2, #9
 1860              	.LVL223:
 1861 00f0 6260     		str	r2, [r4, #4]
 593:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 1862              		.loc 1 593 0
 1863 00f2 C023     		movs	r3, #192
 1864 00f4 A360     		str	r3, [r4, #8]
 594:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 1865              		.loc 1 594 0
 1866 00f6 0025     		movs	r5, #0
 1867 00f8 E560     		str	r5, [r4, #12]
 595:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
 1868              		.loc 1 595 0
 1869 00fa 4FF48061 		mov	r1, #1024
 1870 00fe 2161     		str	r1, [r4, #16]
 596:lib/ff/sdio_stm32f1.c **** 
 1871              		.loc 1 596 0
 1872 0100 2046     		mov	r0, r4
 1873 0102 FFF7FEFF 		bl	SDIO_SendCommand
 1874              	.LVL224:
 598:lib/ff/sdio_stm32f1.c **** 
 1875              		.loc 1 598 0
 1876 0106 FFF7FEFF 		bl	CmdResp2Error
 1877              	.LVL225:
 1878 010a 0446     		mov	r4, r0
 1879              	.LVL226:
 600:lib/ff/sdio_stm32f1.c ****     {
 1880              		.loc 1 600 0
 1881 010c 2A28     		cmp	r0, #42
 1882 010e 1AD1     		bne	.L164
 605:lib/ff/sdio_stm32f1.c ****     CSD_Tab[1] = SDIO_GetResponse(SDIO_RESP2);
 1883              		.loc 1 605 0
 1884 0110 2846     		mov	r0, r5
 1885              	.LVL227:
 1886 0112 FFF7FEFF 		bl	SDIO_GetResponse
 1887              	.LVL228:
 1888 0116 124D     		ldr	r5, .L169+20
 1889 0118 2860     		str	r0, [r5, #0]
 606:lib/ff/sdio_stm32f1.c ****     CSD_Tab[2] = SDIO_GetResponse(SDIO_RESP3);
 1890              		.loc 1 606 0
 1891 011a 0420     		movs	r0, #4
 1892 011c FFF7FEFF 		bl	SDIO_GetResponse
 1893              	.LVL229:
 1894 0120 6860     		str	r0, [r5, #4]
 607:lib/ff/sdio_stm32f1.c ****     CSD_Tab[3] = SDIO_GetResponse(SDIO_RESP4);
 1895              		.loc 1 607 0
 1896 0122 0820     		movs	r0, #8
 1897 0124 FFF7FEFF 		bl	SDIO_GetResponse
 1898              	.LVL230:
 1899 0128 A860     		str	r0, [r5, #8]
 608:lib/ff/sdio_stm32f1.c ****   }
 1900              		.loc 1 608 0
 1901 012a 0C20     		movs	r0, #12
 1902 012c FFF7FEFF 		bl	SDIO_GetResponse
 1903              	.LVL231:
 1904 0130 E860     		str	r0, [r5, #12]
 1905 0132 08E0     		b	.L164
 1906              	.LVL232:
 1907              	.L157:
 541:lib/ff/sdio_stm32f1.c ****   }
 1908              		.loc 1 541 0
 1909 0134 2524     		movs	r4, #37
 1910 0136 06E0     		b	.L164
 1911              	.LVL233:
 1912              	.L161:
 613:lib/ff/sdio_stm32f1.c **** }
 1913              		.loc 1 613 0
 1914 0138 2A24     		movs	r4, #42
 1915 013a 04E0     		b	.L164
 1916              	.LVL234:
 1917              	.L154:
 1918              	.LBB37:
 1919              	.LBB36:
2610:lib/ff/sdio_stm32f1.c ****   }
 1920              		.loc 1 2610 0
 1921 013c 1024     		movs	r4, #16
 1922 013e 02E0     		b	.L164
 1923              	.LVL235:
 1924              	.L159:
2627:lib/ff/sdio_stm32f1.c ****   }
 1925              		.loc 1 2627 0
 1926 0140 1324     		movs	r4, #19
 1927 0142 00E0     		b	.L164
 1928              	.LVL236:
 1929              	.L160:
2637:lib/ff/sdio_stm32f1.c ****   }
 1930              		.loc 1 2637 0
 1931 0144 0F24     		movs	r4, #15
 1932              	.LVL237:
 1933              	.L164:
 1934              	.LBE36:
 1935              	.LBE37:
 614:lib/ff/sdio_stm32f1.c **** 
 1936              		.loc 1 614 0
 1937 0146 2046     		mov	r0, r4
 1938 0148 38BD     		pop	{r3, r4, r5, pc}
 1939              	.L170:
 1940 014a 00BF     		.align	2
 1941              	.L169:
 1942 014c 00000000 		.word	.LANCHOR4
 1943 0150 00000000 		.word	.LANCHOR0
 1944 0154 00000000 		.word	.LANCHOR5
 1945 0158 00800140 		.word	1073840128
 1946 015c 00000000 		.word	.LANCHOR1
 1947 0160 00000000 		.word	.LANCHOR6
 1948              		.cfi_endproc
 1949              	.LFE63:
 1951              		.section	.text.SD_GetCardInfo,"ax",%progbits
 1952              		.align	1
 1953              		.global	SD_GetCardInfo
 1954              		.thumb
 1955              		.thumb_func
 1957              	SD_GetCardInfo:
 1958              	.LFB64:
 626:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
 1959              		.loc 1 626 0
 1960              		.cfi_startproc
 1961              		@ args = 0, pretend = 0, frame = 0
 1962              		@ frame_needed = 0, uses_anonymous_args = 0
 1963              	.LVL238:
 1964 0000 70B5     		push	{r4, r5, r6, lr}
 1965              	.LCFI13:
 1966              		.cfi_def_cfa_offset 16
 1967              		.cfi_offset 4, -16
 1968              		.cfi_offset 5, -12
 1969              		.cfi_offset 6, -8
 1970              		.cfi_offset 14, -4
 1971              	.LVL239:
 630:lib/ff/sdio_stm32f1.c ****   cardinfo->RCA = (uint16_t)RCA;
 1972              		.loc 1 630 0
 1973 0002 A14B     		ldr	r3, .L174
 1974 0004 1D68     		ldr	r5, [r3, #0]
 1975 0006 80F85650 		strb	r5, [r0, #86]
 631:lib/ff/sdio_stm32f1.c **** 
 1976              		.loc 1 631 0
 1977 000a A049     		ldr	r1, .L174+4
 1978 000c 0A68     		ldr	r2, [r1, #0]
 1979 000e A0F85420 		strh	r2, [r0, #84]	@ movhi
 634:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.CSDStruct = (tmp & 0xC0) >> 6;
 1980              		.loc 1 634 0
 1981 0012 9F4C     		ldr	r4, .L174+8
 1982 0014 2668     		ldr	r6, [r4, #0]
 1983 0016 330E     		lsrs	r3, r6, #24
 1984              	.LVL240:
 635:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.SysSpecVersion = (tmp & 0x3C) >> 2;
 1985              		.loc 1 635 0
 1986 0018 9909     		lsrs	r1, r3, #6
 1987 001a 0170     		strb	r1, [r0, #0]
 636:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.Reserved1 = tmp & 0x03;
 1988              		.loc 1 636 0
 1989 001c C3F38302 		ubfx	r2, r3, #2, #4
 1990 0020 4270     		strb	r2, [r0, #1]
 637:lib/ff/sdio_stm32f1.c **** 
 1991              		.loc 1 637 0
 1992 0022 03F00303 		and	r3, r3, #3
 1993              	.LVL241:
 1994 0026 8370     		strb	r3, [r0, #2]
 640:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.TAAC = tmp;
 1995              		.loc 1 640 0
 1996 0028 C6F30741 		ubfx	r1, r6, #16, #8
 1997              	.LVL242:
 641:lib/ff/sdio_stm32f1.c **** 
 1998              		.loc 1 641 0
 1999 002c C170     		strb	r1, [r0, #3]
 644:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.NSAC = tmp;
 2000              		.loc 1 644 0
 2001 002e C6F30722 		ubfx	r2, r6, #8, #8
 2002              	.LVL243:
 645:lib/ff/sdio_stm32f1.c **** 
 2003              		.loc 1 645 0
 2004 0032 0271     		strb	r2, [r0, #4]
 648:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.MaxBusClkFrec = tmp;
 2005              		.loc 1 648 0
 2006 0034 F6B2     		uxtb	r6, r6
 2007              	.LVL244:
 649:lib/ff/sdio_stm32f1.c **** 
 2008              		.loc 1 649 0
 2009 0036 4671     		strb	r6, [r0, #5]
 652:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.CardComdClasses = tmp << 4;
 2010              		.loc 1 652 0
 2011 0038 6368     		ldr	r3, [r4, #4]
 2012              	.LVL245:
 653:lib/ff/sdio_stm32f1.c **** 
 2013              		.loc 1 653 0
 2014 003a 190E     		lsrs	r1, r3, #24
 2015 003c 0A01     		lsls	r2, r1, #4
 2016 003e C280     		strh	r2, [r0, #6]	@ movhi
 656:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.CardComdClasses |= (tmp & 0xF0) >> 4;
 2017              		.loc 1 656 0
 2018 0040 C3F30746 		ubfx	r6, r3, #16, #8
 2019              	.LVL246:
 657:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.RdBlockLen = tmp & 0x0F;
 2020              		.loc 1 657 0
 2021 0044 C188     		ldrh	r1, [r0, #6]
 2022 0046 8AB2     		uxth	r2, r1
 2023 0048 42EA1611 		orr	r1, r2, r6, lsr #4
 2024 004c C180     		strh	r1, [r0, #6]	@ movhi
 658:lib/ff/sdio_stm32f1.c **** 
 2025              		.loc 1 658 0
 2026 004e 06F00F06 		and	r6, r6, #15
 2027              	.LVL247:
 2028 0052 0672     		strb	r6, [r0, #8]
 661:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.PartBlockRead = (tmp & 0x80) >> 7;
 2029              		.loc 1 661 0
 2030 0054 C3F30722 		ubfx	r2, r3, #8, #8
 2031 0058 D1B2     		uxtb	r1, r2
 2032              	.LVL248:
 662:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.WrBlockMisalign = (tmp & 0x40) >> 6;
 2033              		.loc 1 662 0
 2034 005a CE09     		lsrs	r6, r1, #7
 2035 005c 4672     		strb	r6, [r0, #9]
 663:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.RdBlockMisalign = (tmp & 0x20) >> 5;
 2036              		.loc 1 663 0
 2037 005e C2F38016 		ubfx	r6, r2, #6, #1
 2038 0062 8672     		strb	r6, [r0, #10]
 664:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.DSRImpl = (tmp & 0x10) >> 4;
 2039              		.loc 1 664 0
 2040 0064 C2F34016 		ubfx	r6, r2, #5, #1
 2041 0068 C672     		strb	r6, [r0, #11]
 665:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.Reserved2 = 0; /*!< Reserved */
 2042              		.loc 1 665 0
 2043 006a C2F30016 		ubfx	r6, r2, #4, #1
 2044 006e 0673     		strb	r6, [r0, #12]
 666:lib/ff/sdio_stm32f1.c **** 
 2045              		.loc 1 666 0
 2046 0070 0026     		movs	r6, #0
 2047 0072 4673     		strb	r6, [r0, #13]
 668:lib/ff/sdio_stm32f1.c ****   {
 2048              		.loc 1 668 0
 2049 0074 012D     		cmp	r5, #1
 2050 0076 3CD8     		bhi	.L172
 670:lib/ff/sdio_stm32f1.c **** 
 2051              		.loc 1 670 0
 2052 0078 02F00306 		and	r6, r2, #3
 2053 007c B102     		lsls	r1, r6, #10
 2054 007e 0161     		str	r1, [r0, #16]
 2055              	.LVL249:
 674:lib/ff/sdio_stm32f1.c **** 
 2056              		.loc 1 674 0
 2057 0080 0569     		ldr	r5, [r0, #16]
3127:lib/ff/sdio_stm32f1.c **** 
3128:lib/ff/sdio_stm32f1.c **** 
3129:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
3130:lib/ff/sdio_stm32f1.c **** /*! 
3131:lib/ff/sdio_stm32f1.c **** 	@brief  Returns the DMA End Of Transfer Status.
3132:lib/ff/sdio_stm32f1.c **** 	@param  None
3133:lib/ff/sdio_stm32f1.c **** 	@retval DMA SDIO Channel Status.
3134:lib/ff/sdio_stm32f1.c **** */
3135:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
3136:lib/ff/sdio_stm32f1.c **** uint32_t SD_DMAEndOfTransferStatus(void)
3137:lib/ff/sdio_stm32f1.c **** {
3138:lib/ff/sdio_stm32f1.c ****   return (uint32_t)DMA_GetFlagStatus(DMA2_FLAG_TC4);
3139:lib/ff/sdio_stm32f1.c **** }
3140:lib/ff/sdio_stm32f1.c **** 
3141:lib/ff/sdio_stm32f1.c **** 
3142:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
3143:lib/ff/sdio_stm32f1.c **** /*! 
3144:lib/ff/sdio_stm32f1.c ****     @brief	Handles SDIO interrupts requests.
3145:lib/ff/sdio_stm32f1.c **** 	@param	None.
3146:lib/ff/sdio_stm32f1.c ****     @retval	None.
3147:lib/ff/sdio_stm32f1.c **** */
3148:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
3149:lib/ff/sdio_stm32f1.c **** void SDIO_IRQHandler(void)
3150:lib/ff/sdio_stm32f1.c **** {
3151:lib/ff/sdio_stm32f1.c ****   /* Process All SDIO Interrupt Sources */
3152:lib/ff/sdio_stm32f1.c ****   SD_ProcessIRQSrc();
3153:lib/ff/sdio_stm32f1.c **** }
3154:lib/ff/sdio_stm32f1.c **** 
3155:lib/ff/sdio_stm32f1.c **** /**
3156:lib/ff/sdio_stm32f1.c ****   * @brief  Enables wide bus opeartion for the requeseted card if supported by 
3157:lib/ff/sdio_stm32f1.c ****   *         card.
3158:lib/ff/sdio_stm32f1.c ****   * @param  WideMode: Specifies the SD card wide bus mode. 
3159:lib/ff/sdio_stm32f1.c ****   *   This parameter can be one of the following values:
3160:lib/ff/sdio_stm32f1.c ****   *     @arg SDIO_BusWide_8b: 8-bit data transfer (Only for MMC)
3161:lib/ff/sdio_stm32f1.c ****   *     @arg SDIO_BusWide_4b: 4-bit data transfer
3162:lib/ff/sdio_stm32f1.c ****   *     @arg SDIO_BusWide_1b: 1-bit data transfer
3163:lib/ff/sdio_stm32f1.c ****   * @retval SD_Error: SD Card Error code.
3164:lib/ff/sdio_stm32f1.c ****   */
3165:lib/ff/sdio_stm32f1.c **** SD_Error SD_GetCardStatus(SD_CardStatus *cardstatus)
3166:lib/ff/sdio_stm32f1.c **** {
3167:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
3168:lib/ff/sdio_stm32f1.c ****   uint8_t tmp = 0;
3169:lib/ff/sdio_stm32f1.c **** 
3170:lib/ff/sdio_stm32f1.c ****   errorstatus = SD_SendSDStatus((uint32_t *)SDSTATUS_Tab);
3171:lib/ff/sdio_stm32f1.c **** 
3172:lib/ff/sdio_stm32f1.c ****   if (errorstatus  != SD_OK)
3173:lib/ff/sdio_stm32f1.c ****   {
3174:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
3175:lib/ff/sdio_stm32f1.c ****   }
3176:lib/ff/sdio_stm32f1.c **** 
3177:lib/ff/sdio_stm32f1.c ****   /*!< Byte 0 */
3178:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((SDSTATUS_Tab[0] & 0xC0) >> 6);
3179:lib/ff/sdio_stm32f1.c ****   cardstatus->DAT_BUS_WIDTH = tmp;
3180:lib/ff/sdio_stm32f1.c **** 
3181:lib/ff/sdio_stm32f1.c ****   /*!< Byte 0 */
3182:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((SDSTATUS_Tab[0] & 0x20) >> 5);
3183:lib/ff/sdio_stm32f1.c ****   cardstatus->SECURED_MODE = tmp;
3184:lib/ff/sdio_stm32f1.c **** 
3185:lib/ff/sdio_stm32f1.c ****   /*!< Byte 2 */
3186:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((SDSTATUS_Tab[2] & 0xFF));
3187:lib/ff/sdio_stm32f1.c ****   cardstatus->SD_CARD_TYPE = tmp << 8;
3188:lib/ff/sdio_stm32f1.c **** 
3189:lib/ff/sdio_stm32f1.c ****   /*!< Byte 3 */
3190:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((SDSTATUS_Tab[3] & 0xFF));
3191:lib/ff/sdio_stm32f1.c ****   cardstatus->SD_CARD_TYPE |= tmp;
3192:lib/ff/sdio_stm32f1.c **** 
3193:lib/ff/sdio_stm32f1.c ****   /*!< Byte 4 */
3194:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)(SDSTATUS_Tab[4] & 0xFF);
3195:lib/ff/sdio_stm32f1.c ****   cardstatus->SIZE_OF_PROTECTED_AREA = tmp << 24;
3196:lib/ff/sdio_stm32f1.c **** 
3197:lib/ff/sdio_stm32f1.c ****   /*!< Byte 5 */
3198:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)(SDSTATUS_Tab[5] & 0xFF);
3199:lib/ff/sdio_stm32f1.c ****   cardstatus->SIZE_OF_PROTECTED_AREA |= tmp << 16;
3200:lib/ff/sdio_stm32f1.c **** 
3201:lib/ff/sdio_stm32f1.c ****   /*!< Byte 6 */
3202:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)(SDSTATUS_Tab[6] & 0xFF);
3203:lib/ff/sdio_stm32f1.c ****   cardstatus->SIZE_OF_PROTECTED_AREA |= tmp << 8;
3204:lib/ff/sdio_stm32f1.c **** 
3205:lib/ff/sdio_stm32f1.c ****   /*!< Byte 7 */
3206:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)(SDSTATUS_Tab[7] & 0xFF);
3207:lib/ff/sdio_stm32f1.c ****   cardstatus->SIZE_OF_PROTECTED_AREA |= tmp;
3208:lib/ff/sdio_stm32f1.c **** 
3209:lib/ff/sdio_stm32f1.c ****   /*!< Byte 8 */
3210:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((SDSTATUS_Tab[8] & 0xFF));
3211:lib/ff/sdio_stm32f1.c ****   cardstatus->SPEED_CLASS = tmp;
3212:lib/ff/sdio_stm32f1.c **** 
3213:lib/ff/sdio_stm32f1.c ****   /*!< Byte 9 */
3214:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((SDSTATUS_Tab[9] & 0xFF));
3215:lib/ff/sdio_stm32f1.c ****   cardstatus->PERFORMANCE_MOVE = tmp;
3216:lib/ff/sdio_stm32f1.c **** 
3217:lib/ff/sdio_stm32f1.c ****   /*!< Byte 10 */
3218:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((SDSTATUS_Tab[10] & 0xF0) >> 4);
3219:lib/ff/sdio_stm32f1.c ****   cardstatus->AU_SIZE = tmp;
3220:lib/ff/sdio_stm32f1.c **** 
3221:lib/ff/sdio_stm32f1.c ****   /*!< Byte 11 */
3222:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)(SDSTATUS_Tab[11] & 0xFF);
3223:lib/ff/sdio_stm32f1.c ****   cardstatus->ERASE_SIZE = tmp << 8;
3224:lib/ff/sdio_stm32f1.c **** 
3225:lib/ff/sdio_stm32f1.c ****   /*!< Byte 12 */
3226:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)(SDSTATUS_Tab[12] & 0xFF);
3227:lib/ff/sdio_stm32f1.c ****   cardstatus->ERASE_SIZE |= tmp;
3228:lib/ff/sdio_stm32f1.c **** 
3229:lib/ff/sdio_stm32f1.c ****   /*!< Byte 13 */
3230:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((SDSTATUS_Tab[13] & 0xFC) >> 2);
3231:lib/ff/sdio_stm32f1.c ****   cardstatus->ERASE_TIMEOUT = tmp;
3232:lib/ff/sdio_stm32f1.c **** 
3233:lib/ff/sdio_stm32f1.c ****   /*!< Byte 13 */
3234:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((SDSTATUS_Tab[13] & 0x3));
3235:lib/ff/sdio_stm32f1.c ****   cardstatus->ERASE_OFFSET = tmp;
3236:lib/ff/sdio_stm32f1.c ****  
3237:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
3238:lib/ff/sdio_stm32f1.c **** }
 2058              		.loc 1 3238 0
 2059 0082 DBB2     		uxtb	r3, r3
 2060              	.LVL250:
 674:lib/ff/sdio_stm32f1.c **** 
 2061              		.loc 1 674 0
 2062 0084 45EA8302 		orr	r2, r5, r3, lsl #2
 2063 0088 0261     		str	r2, [r0, #16]
 677:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.DeviceSize |= (tmp & 0xC0) >> 6;
 2064              		.loc 1 677 0
 2065 008a A468     		ldr	r4, [r4, #8]
 2066 008c 260E     		lsrs	r6, r4, #24
 2067              	.LVL251:
 678:lib/ff/sdio_stm32f1.c **** 
 2068              		.loc 1 678 0
 2069 008e 0169     		ldr	r1, [r0, #16]
 2070 0090 41EA9615 		orr	r5, r1, r6, lsr #6
 2071 0094 0561     		str	r5, [r0, #16]
 680:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.MaxRdCurrentVDDMax = (tmp & 0x07);
 2072              		.loc 1 680 0
 2073 0096 C6F3C203 		ubfx	r3, r6, #3, #3
 2074 009a 0375     		strb	r3, [r0, #20]
 681:lib/ff/sdio_stm32f1.c **** 
 2075              		.loc 1 681 0
 2076 009c 06F00702 		and	r2, r6, #7
 2077 00a0 4275     		strb	r2, [r0, #21]
 684:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.MaxWrCurrentVDDMin = (tmp & 0xE0) >> 5;
 2078              		.loc 1 684 0
 2079 00a2 C4F30746 		ubfx	r6, r4, #16, #8
 2080              	.LVL252:
 685:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.MaxWrCurrentVDDMax = (tmp & 0x1C) >> 2;
 2081              		.loc 1 685 0
 2082 00a6 7109     		lsrs	r1, r6, #5
 2083 00a8 8175     		strb	r1, [r0, #22]
 686:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.DeviceSizeMul = (tmp & 0x03) << 1;
 2084              		.loc 1 686 0
 2085 00aa C6F38205 		ubfx	r5, r6, #2, #3
 2086 00ae C575     		strb	r5, [r0, #23]
 687:lib/ff/sdio_stm32f1.c ****     /*!< Byte 10 */
 2087              		.loc 1 687 0
 2088 00b0 06F00303 		and	r3, r6, #3
 2089 00b4 5A00     		lsls	r2, r3, #1
 2090 00b6 0276     		strb	r2, [r0, #24]
 689:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.DeviceSizeMul |= (tmp & 0x80) >> 7;
 2091              		.loc 1 689 0
 2092 00b8 C4F30721 		ubfx	r1, r4, #8, #8
 2093              	.LVL253:
 690:lib/ff/sdio_stm32f1.c ****     
 2094              		.loc 1 690 0
 2095 00bc 047E     		ldrb	r4, [r0, #24]	@ zero_extendqisi2
 2096 00be 44EAD116 		orr	r6, r4, r1, lsr #7
 2097 00c2 0676     		strb	r6, [r0, #24]
 692:lib/ff/sdio_stm32f1.c ****     cardinfo->CardCapacity *= (1 << (cardinfo->SD_csd.DeviceSizeMul + 2));
 2098              		.loc 1 692 0
 2099 00c4 0669     		ldr	r6, [r0, #16]
 693:lib/ff/sdio_stm32f1.c ****     cardinfo->CardBlockSize = 1 << (cardinfo->SD_csd.RdBlockLen);
 2100              		.loc 1 693 0
 2101 00c6 057E     		ldrb	r5, [r0, #24]	@ zero_extendqisi2
 694:lib/ff/sdio_stm32f1.c ****     cardinfo->CardCapacity *= cardinfo->CardBlockSize;
 2102              		.loc 1 694 0
 2103 00c8 027A     		ldrb	r2, [r0, #8]	@ zero_extendqisi2
 2104 00ca 0123     		movs	r3, #1
 2105 00cc 03FA02F4 		lsl	r4, r3, r2
 2106 00d0 0465     		str	r4, [r0, #80]
 693:lib/ff/sdio_stm32f1.c ****     cardinfo->CardBlockSize = 1 << (cardinfo->SD_csd.RdBlockLen);
 2107              		.loc 1 693 0
 2108 00d2 0235     		adds	r5, r5, #2
 2109 00d4 03FA05F2 		lsl	r2, r3, r5
 2110 00d8 D517     		asrs	r5, r2, #31
 2111 00da A2FB0423 		umull	r2, r3, r2, r4
 2112 00de 04FB0533 		mla	r3, r4, r5, r3
 692:lib/ff/sdio_stm32f1.c ****     cardinfo->CardCapacity *= (1 << (cardinfo->SD_csd.DeviceSizeMul + 2));
 2113              		.loc 1 692 0
 2114 00e2 0136     		adds	r6, r6, #1
 695:lib/ff/sdio_stm32f1.c ****   }
 2115              		.loc 1 695 0
 2116 00e4 A2FB0645 		umull	r4, r5, r2, r6
 2117 00e8 06FB0355 		mla	r5, r6, r3, r5
 2118 00ec C0E91245 		strd	r4, [r0, #72]
 2119 00f0 22E0     		b	.L173
 2120              	.LVL254:
 2121              	.L172:
 697:lib/ff/sdio_stm32f1.c ****   {
 2122              		.loc 1 697 0
 2123 00f2 022D     		cmp	r5, #2
 2124 00f4 20D1     		bne	.L173
 2125              	.LVL255:
 701:lib/ff/sdio_stm32f1.c **** 
 2126              		.loc 1 701 0
 2127 00f6 03F03F05 		and	r5, r3, #63
 2128 00fa 2B04     		lsls	r3, r5, #16
 2129              	.LVL256:
 2130 00fc 0361     		str	r3, [r0, #16]
 704:lib/ff/sdio_stm32f1.c **** 
 2131              		.loc 1 704 0
 2132 00fe A468     		ldr	r4, [r4, #8]
 2133              	.LVL257:
 706:lib/ff/sdio_stm32f1.c **** 
 2134              		.loc 1 706 0
 2135 0100 0169     		ldr	r1, [r0, #16]
 2136              		.loc 1 3238 0
 2137 0102 220E     		lsrs	r2, r4, #24
 706:lib/ff/sdio_stm32f1.c **** 
 2138              		.loc 1 706 0
 2139 0104 41EA0225 		orr	r5, r1, r2, lsl #8
 2140 0108 0561     		str	r5, [r0, #16]
 2141              	.LVL258:
 711:lib/ff/sdio_stm32f1.c **** 
 2142              		.loc 1 711 0
 2143 010a 0369     		ldr	r3, [r0, #16]
 709:lib/ff/sdio_stm32f1.c **** 
 2144              		.loc 1 709 0
 2145 010c C4F30741 		ubfx	r1, r4, #16, #8
 711:lib/ff/sdio_stm32f1.c **** 
 2146              		.loc 1 711 0
 2147 0110 41EA0302 		orr	r2, r1, r3
 2148 0114 0261     		str	r2, [r0, #16]
 714:lib/ff/sdio_stm32f1.c ****     /* nemui fixed due to SD2.00 Capacity fomula is Size = (C_SIZE+1)~2^19 */
 2149              		.loc 1 714 0
 2150 0116 C4F30721 		ubfx	r1, r4, #8, #8
 2151              	.LVL259:
 716:lib/ff/sdio_stm32f1.c ****     cardinfo->CardBlockSize = 512;    
 2152              		.loc 1 716 0
 2153 011a 0469     		ldr	r4, [r0, #16]
 2154 011c 0125     		movs	r5, #1
 2155 011e 0023     		movs	r3, #0
 2156 0120 2A19     		adds	r2, r5, r4
 2157 0122 43F10004 		adc	r4, r3, #0
 2158 0126 E504     		lsls	r5, r4, #19
 2159 0128 45EA5233 		orr	r3, r5, r2, lsr #13
 2160 012c C364     		str	r3, [r0, #76]
 2161 012e D204     		lsls	r2, r2, #19
 2162 0130 8264     		str	r2, [r0, #72]
 717:lib/ff/sdio_stm32f1.c ****   }
 2163              		.loc 1 717 0
 2164 0132 4FF40074 		mov	r4, #512
 2165 0136 0465     		str	r4, [r0, #80]
 2166              	.LVL260:
 2167              	.L173:
 721:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.EraseGrMul = (tmp & 0x3F) << 1;
 2168              		.loc 1 721 0
 2169 0138 C1F38014 		ubfx	r4, r1, #6, #1
 2170 013c 4476     		strb	r4, [r0, #25]
 722:lib/ff/sdio_stm32f1.c **** 
 2171              		.loc 1 722 0
 2172 013e 01F03F01 		and	r1, r1, #63
 2173              	.LVL261:
 2174 0142 4A00     		lsls	r2, r1, #1
 2175 0144 8276     		strb	r2, [r0, #26]
 725:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.EraseGrMul |= (tmp & 0x80) >> 7;
 2176              		.loc 1 725 0
 2177 0146 524D     		ldr	r5, .L174+8
 2178 0148 AB68     		ldr	r3, [r5, #8]
 2179              	.LVL262:
 726:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.WrProtectGrSize = (tmp & 0x7F);
 2180              		.loc 1 726 0
 2181 014a 847E     		ldrb	r4, [r0, #26]	@ zero_extendqisi2
 2182 014c C3F3C011 		ubfx	r1, r3, #7, #1
 2183 0150 44EA0102 		orr	r2, r4, r1
 2184 0154 8276     		strb	r2, [r0, #26]
 727:lib/ff/sdio_stm32f1.c **** 
 2185              		.loc 1 727 0
 2186 0156 03F07F03 		and	r3, r3, #127
 2187              	.LVL263:
 2188 015a C376     		strb	r3, [r0, #27]
 730:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.WrProtectGrEnable = (tmp & 0x80) >> 7;
 2189              		.loc 1 730 0
 2190 015c ED68     		ldr	r5, [r5, #12]
 2191 015e 2C0E     		lsrs	r4, r5, #24
 2192              	.LVL264:
 731:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.ManDeflECC = (tmp & 0x60) >> 5;
 2193              		.loc 1 731 0
 2194 0160 E109     		lsrs	r1, r4, #7
 2195 0162 0177     		strb	r1, [r0, #28]
 732:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.WrSpeedFact = (tmp & 0x1C) >> 2;
 2196              		.loc 1 732 0
 2197 0164 C4F34112 		ubfx	r2, r4, #5, #2
 2198 0168 4277     		strb	r2, [r0, #29]
 733:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.MaxWrBlockLen = (tmp & 0x03) << 2;
 2199              		.loc 1 733 0
 2200 016a C4F38203 		ubfx	r3, r4, #2, #3
 2201 016e 8377     		strb	r3, [r0, #30]
 734:lib/ff/sdio_stm32f1.c **** 
 2202              		.loc 1 734 0
 2203 0170 04F00304 		and	r4, r4, #3
 2204              	.LVL265:
 2205 0174 A100     		lsls	r1, r4, #2
 2206 0176 C177     		strb	r1, [r0, #31]
 737:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.MaxWrBlockLen |= (tmp & 0xC0) >> 6;
 2207              		.loc 1 737 0
 2208 0178 C5F30742 		ubfx	r2, r5, #16, #8
 2209              	.LVL266:
 738:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.WriteBlockPaPartial = (tmp & 0x20) >> 5;
 2210              		.loc 1 738 0
 2211 017c C37F     		ldrb	r3, [r0, #31]	@ zero_extendqisi2
 2212 017e 43EA9214 		orr	r4, r3, r2, lsr #6
 2213 0182 C477     		strb	r4, [r0, #31]
 739:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.Reserved3 = 0;
 2214              		.loc 1 739 0
 2215 0184 C2F34011 		ubfx	r1, r2, #5, #1
 2216 0188 80F82010 		strb	r1, [r0, #32]
 740:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.ContentProtectAppli = (tmp & 0x01);
 2217              		.loc 1 740 0
 2218 018c 0023     		movs	r3, #0
 2219 018e 80F82130 		strb	r3, [r0, #33]
 741:lib/ff/sdio_stm32f1.c **** 
 2220              		.loc 1 741 0
 2221 0192 02F00102 		and	r2, r2, #1
 2222              	.LVL267:
 2223 0196 80F82220 		strb	r2, [r0, #34]
 744:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.FileFormatGrouop = (tmp & 0x80) >> 7;
 2224              		.loc 1 744 0
 2225 019a C5F30724 		ubfx	r4, r5, #8, #8
 2226              	.LVL268:
 745:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.CopyFlag = (tmp & 0x40) >> 6;
 2227              		.loc 1 745 0
 2228 019e E109     		lsrs	r1, r4, #7
 2229 01a0 80F82310 		strb	r1, [r0, #35]
 746:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.PermWrProtect = (tmp & 0x20) >> 5;
 2230              		.loc 1 746 0
 2231 01a4 C4F38013 		ubfx	r3, r4, #6, #1
 2232 01a8 80F82430 		strb	r3, [r0, #36]
 747:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.TempWrProtect = (tmp & 0x10) >> 4;
 2233              		.loc 1 747 0
 2234 01ac C4F34012 		ubfx	r2, r4, #5, #1
 2235 01b0 80F82520 		strb	r2, [r0, #37]
 748:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.FileFormat = (tmp & 0x0C) >> 2;
 2236              		.loc 1 748 0
 2237 01b4 C4F30011 		ubfx	r1, r4, #4, #1
 2238 01b8 80F82610 		strb	r1, [r0, #38]
 749:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.ECC = (tmp & 0x03);
 2239              		.loc 1 749 0
 2240 01bc C4F38103 		ubfx	r3, r4, #2, #2
 2241 01c0 80F82730 		strb	r3, [r0, #39]
 750:lib/ff/sdio_stm32f1.c **** 
 2242              		.loc 1 750 0
 2243 01c4 04F00304 		and	r4, r4, #3
 2244              	.LVL269:
 2245 01c8 80F82840 		strb	r4, [r0, #40]
 2246              	.LVL270:
 754:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.Reserved4 = 1;
 2247              		.loc 1 754 0
 2248 01cc C5F34605 		ubfx	r5, r5, #1, #7
 2249              	.LVL271:
 2250 01d0 80F82950 		strb	r5, [r0, #41]
 755:lib/ff/sdio_stm32f1.c **** 
 2251              		.loc 1 755 0
 2252 01d4 0121     		movs	r1, #1
 2253 01d6 80F82A10 		strb	r1, [r0, #42]
 759:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ManufacturerID = tmp;
 2254              		.loc 1 759 0
 2255 01da 2E4B     		ldr	r3, .L174+12
 2256 01dc 1A68     		ldr	r2, [r3, #0]
 2257 01de 140E     		lsrs	r4, r2, #24
 2258              	.LVL272:
 760:lib/ff/sdio_stm32f1.c **** 
 2259              		.loc 1 760 0
 2260 01e0 80F82C40 		strb	r4, [r0, #44]
 2261              	.LVL273:
 763:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.OEM_AppliID = tmp << 8;
 2262              		.loc 1 763 0
 2263 01e4 C2F30745 		ubfx	r5, r2, #16, #8
 764:lib/ff/sdio_stm32f1.c **** 
 2264              		.loc 1 764 0
 2265 01e8 2C02     		lsls	r4, r5, #8
 2266 01ea C485     		strh	r4, [r0, #46]	@ movhi
 2267              	.LVL274:
 768:lib/ff/sdio_stm32f1.c **** 
 2268              		.loc 1 768 0
 2269 01ec C58D     		ldrh	r5, [r0, #46]
 2270 01ee ACB2     		uxth	r4, r5
 767:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.OEM_AppliID |= tmp;
 2271              		.loc 1 767 0
 2272 01f0 C2F30725 		ubfx	r5, r2, #8, #8
 768:lib/ff/sdio_stm32f1.c **** 
 2273              		.loc 1 768 0
 2274 01f4 2C43     		orrs	r4, r4, r5
 2275 01f6 C485     		strh	r4, [r0, #46]	@ movhi
 2276              	.LVL275:
 772:lib/ff/sdio_stm32f1.c **** 
 2277              		.loc 1 772 0
 2278 01f8 1206     		lsls	r2, r2, #24
 2279              	.LVL276:
 2280 01fa 0263     		str	r2, [r0, #48]
 775:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdName1 |= tmp << 16;
 2281              		.loc 1 775 0
 2282 01fc 5A68     		ldr	r2, [r3, #4]
 2283              	.LVL277:
 776:lib/ff/sdio_stm32f1.c **** 
 2284              		.loc 1 776 0
 2285 01fe 046B     		ldr	r4, [r0, #48]
 2286              		.loc 1 3238 0
 2287 0200 150E     		lsrs	r5, r2, #24
 776:lib/ff/sdio_stm32f1.c **** 
 2288              		.loc 1 776 0
 2289 0202 44EA0544 		orr	r4, r4, r5, lsl #16
 2290 0206 0463     		str	r4, [r0, #48]
 2291              	.LVL278:
 780:lib/ff/sdio_stm32f1.c **** 
 2292              		.loc 1 780 0
 2293 0208 046B     		ldr	r4, [r0, #48]
 779:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdName1 |= tmp << 8;
 2294              		.loc 1 779 0
 2295 020a C2F30745 		ubfx	r5, r2, #16, #8
 780:lib/ff/sdio_stm32f1.c **** 
 2296              		.loc 1 780 0
 2297 020e 44EA0524 		orr	r4, r4, r5, lsl #8
 2298 0212 0463     		str	r4, [r0, #48]
 2299              	.LVL279:
 784:lib/ff/sdio_stm32f1.c **** 
 2300              		.loc 1 784 0
 2301 0214 046B     		ldr	r4, [r0, #48]
 783:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdName1 |= tmp;
 2302              		.loc 1 783 0
 2303 0216 C2F30725 		ubfx	r5, r2, #8, #8
 784:lib/ff/sdio_stm32f1.c **** 
 2304              		.loc 1 784 0
 2305 021a 2C43     		orrs	r4, r4, r5
 2306 021c 0463     		str	r4, [r0, #48]
 787:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdName2 = tmp;
 2307              		.loc 1 787 0
 2308 021e D2B2     		uxtb	r2, r2
 2309              	.LVL280:
 788:lib/ff/sdio_stm32f1.c **** 
 2310              		.loc 1 788 0
 2311 0220 80F83420 		strb	r2, [r0, #52]
 791:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdRev = tmp;
 2312              		.loc 1 791 0
 2313 0224 9A68     		ldr	r2, [r3, #8]
 2314              	.LVL281:
 2315 0226 150E     		lsrs	r5, r2, #24
 2316              	.LVL282:
 792:lib/ff/sdio_stm32f1.c **** 
 2317              		.loc 1 792 0
 2318 0228 80F83550 		strb	r5, [r0, #53]
 2319              	.LVL283:
 795:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdSN = tmp << 24;
 2320              		.loc 1 795 0
 2321 022c C2F30744 		ubfx	r4, r2, #16, #8
 796:lib/ff/sdio_stm32f1.c **** 
 2322              		.loc 1 796 0
 2323 0230 2506     		lsls	r5, r4, #24
 2324 0232 8563     		str	r5, [r0, #56]
 2325              	.LVL284:
 800:lib/ff/sdio_stm32f1.c **** 
 2326              		.loc 1 800 0
 2327 0234 846B     		ldr	r4, [r0, #56]
 799:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdSN |= tmp << 16;
 2328              		.loc 1 799 0
 2329 0236 C2F30725 		ubfx	r5, r2, #8, #8
 800:lib/ff/sdio_stm32f1.c **** 
 2330              		.loc 1 800 0
 2331 023a 44EA0544 		orr	r4, r4, r5, lsl #16
 2332 023e 8463     		str	r4, [r0, #56]
 2333              	.LVL285:
 804:lib/ff/sdio_stm32f1.c **** 
 2334              		.loc 1 804 0
 2335 0240 846B     		ldr	r4, [r0, #56]
 2336              		.loc 1 3238 0
 2337 0242 D2B2     		uxtb	r2, r2
 2338              	.LVL286:
 804:lib/ff/sdio_stm32f1.c **** 
 2339              		.loc 1 804 0
 2340 0244 44EA0224 		orr	r4, r4, r2, lsl #8
 2341 0248 8463     		str	r4, [r0, #56]
 807:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdSN |= tmp;
 2342              		.loc 1 807 0
 2343 024a DB68     		ldr	r3, [r3, #12]
 2344              	.LVL287:
 808:lib/ff/sdio_stm32f1.c **** 
 2345              		.loc 1 808 0
 2346 024c 826B     		ldr	r2, [r0, #56]
 2347 024e 42EA1364 		orr	r4, r2, r3, lsr #24
 2348 0252 8463     		str	r4, [r0, #56]
 811:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.Reserved1 |= (tmp & 0xF0) >> 4;
 2349              		.loc 1 811 0
 2350 0254 C3F30742 		ubfx	r2, r3, #16, #8
 2351              	.LVL288:
 812:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ManufactDate = (tmp & 0x0F) << 8;
 2352              		.loc 1 812 0
 2353 0258 90F83C40 		ldrb	r4, [r0, #60]	@ zero_extendqisi2
 2354 025c 44EA1214 		orr	r4, r4, r2, lsr #4
 2355 0260 80F83C40 		strb	r4, [r0, #60]
 813:lib/ff/sdio_stm32f1.c **** 
 2356              		.loc 1 813 0
 2357 0264 02F00F02 		and	r2, r2, #15
 2358              	.LVL289:
 2359 0268 1402     		lsls	r4, r2, #8
 2360 026a C487     		strh	r4, [r0, #62]	@ movhi
 2361              	.LVL290:
 817:lib/ff/sdio_stm32f1.c **** 
 2362              		.loc 1 817 0
 2363 026c C28F     		ldrh	r2, [r0, #62]
 2364 026e 92B2     		uxth	r2, r2
 816:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ManufactDate |= tmp;
 2365              		.loc 1 816 0
 2366 0270 C3F30724 		ubfx	r4, r3, #8, #8
 817:lib/ff/sdio_stm32f1.c **** 
 2367              		.loc 1 817 0
 2368 0274 2243     		orrs	r2, r2, r4
 2369 0276 C287     		strh	r2, [r0, #62]	@ movhi
 2370              	.LVL291:
 821:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.Reserved2 = 1;
 2371              		.loc 1 821 0
 2372 0278 C3F34603 		ubfx	r3, r3, #1, #7
 2373              	.LVL292:
 2374 027c 80F84030 		strb	r3, [r0, #64]
 822:lib/ff/sdio_stm32f1.c ****   
 2375              		.loc 1 822 0
 2376 0280 80F84110 		strb	r1, [r0, #65]
 825:lib/ff/sdio_stm32f1.c **** 
 2377              		.loc 1 825 0
 2378 0284 2A20     		movs	r0, #42
 2379              	.LVL293:
 2380 0286 70BD     		pop	{r4, r5, r6, pc}
 2381              	.L175:
 2382              		.align	2
 2383              	.L174:
 2384 0288 00000000 		.word	.LANCHOR4
 2385 028c 00000000 		.word	.LANCHOR1
 2386 0290 00000000 		.word	.LANCHOR6
 2387 0294 00000000 		.word	.LANCHOR5
 2388              		.cfi_endproc
 2389              	.LFE64:
 2391              		.section	.text.SD_EnableWideBusOperation,"ax",%progbits
 2392              		.align	1
 2393              		.global	SD_EnableWideBusOperation
 2394              		.thumb
 2395              		.thumb_func
 2397              	SD_EnableWideBusOperation:
 2398              	.LFB65:
 841:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
 2399              		.loc 1 841 0
 2400              		.cfi_startproc
 2401              		@ args = 0, pretend = 0, frame = 0
 2402              		@ frame_needed = 0, uses_anonymous_args = 0
 2403              	.LVL294:
 2404 0000 38B5     		push	{r3, r4, r5, lr}
 2405              	.LCFI14:
 2406              		.cfi_def_cfa_offset 16
 2407              		.cfi_offset 3, -16
 2408              		.cfi_offset 4, -12
 2409              		.cfi_offset 5, -8
 2410              		.cfi_offset 14, -4
 2411 0002 0546     		mov	r5, r0
 2412              	.LVL295:
 845:lib/ff/sdio_stm32f1.c ****   {
 2413              		.loc 1 845 0
 2414 0004 194B     		ldr	r3, .L183
 2415 0006 1868     		ldr	r0, [r3, #0]
 2416              	.LVL296:
 2417 0008 0328     		cmp	r0, #3
 2418 000a 2BD0     		beq	.L181
 850:lib/ff/sdio_stm32f1.c ****   {
 2419              		.loc 1 850 0
 2420 000c 0228     		cmp	r0, #2
 2421 000e 27D8     		bhi	.L180
 852:lib/ff/sdio_stm32f1.c ****     {
 2422              		.loc 1 852 0
 2423 0010 B5F5805F 		cmp	r5, #4096
 2424 0014 26D0     		beq	.L181
 857:lib/ff/sdio_stm32f1.c ****     {
 2425              		.loc 1 857 0
 2426 0016 B5F5006F 		cmp	r5, #2048
 2427 001a 0FD1     		bne	.L178
 859:lib/ff/sdio_stm32f1.c **** 
 2428              		.loc 1 859 0
 2429 001c 0120     		movs	r0, #1
 2430 001e FFF7FEFF 		bl	SDEnWideBus
 2431              	.LVL297:
 2432 0022 0446     		mov	r4, r0
 2433              	.LVL298:
 861:lib/ff/sdio_stm32f1.c ****       {
 2434              		.loc 1 861 0
 2435 0024 2A28     		cmp	r0, #42
 2436 0026 1ED1     		bne	.L177
 864:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_ClockEdge = SDIO_ClockEdge_Rising;
 2437              		.loc 1 864 0
 2438 0028 1148     		ldr	r0, .L183+4
 2439              	.LVL299:
 2440 002a 0123     		movs	r3, #1
 2441 002c 0375     		strb	r3, [r0, #20]
 865:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_ClockBypass = SDIO_ClockBypass_Disable;
 2442              		.loc 1 865 0
 2443 002e 0021     		movs	r1, #0
 2444 0030 0160     		str	r1, [r0, #0]
 866:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_ClockPowerSave = SDIO_ClockPowerSave_Disable;
 2445              		.loc 1 866 0
 2446 0032 4160     		str	r1, [r0, #4]
 867:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_BusWide = SDIO_BusWide_4b;
 2447              		.loc 1 867 0
 2448 0034 8160     		str	r1, [r0, #8]
 868:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_HardwareFlowControl = SDIO_HardwareFlowControl_Disable;
 2449              		.loc 1 868 0
 2450 0036 C560     		str	r5, [r0, #12]
 869:lib/ff/sdio_stm32f1.c ****         SDIO_Init(&SDIO_InitStructure);
 2451              		.loc 1 869 0
 2452 0038 0161     		str	r1, [r0, #16]
 2453 003a 0EE0     		b	.L182
 2454              	.LVL300:
 2455              	.L178:
 875:lib/ff/sdio_stm32f1.c **** 
 2456              		.loc 1 875 0
 2457 003c 0020     		movs	r0, #0
 2458 003e FFF7FEFF 		bl	SDEnWideBus
 2459              	.LVL301:
 2460 0042 0446     		mov	r4, r0
 2461              	.LVL302:
 877:lib/ff/sdio_stm32f1.c ****       {
 2462              		.loc 1 877 0
 2463 0044 2A28     		cmp	r0, #42
 2464 0046 0ED1     		bne	.L177
 880:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_ClockEdge = SDIO_ClockEdge_Rising;
 2465              		.loc 1 880 0
 2466 0048 0948     		ldr	r0, .L183+4
 2467              	.LVL303:
 2468 004a 0121     		movs	r1, #1
 2469 004c 0175     		strb	r1, [r0, #20]
 881:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_ClockBypass = SDIO_ClockBypass_Disable;
 2470              		.loc 1 881 0
 2471 004e 0022     		movs	r2, #0
 2472 0050 0260     		str	r2, [r0, #0]
 882:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_ClockPowerSave = SDIO_ClockPowerSave_Disable;
 2473              		.loc 1 882 0
 2474 0052 4260     		str	r2, [r0, #4]
 883:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_BusWide = SDIO_BusWide_1b;
 2475              		.loc 1 883 0
 2476 0054 8260     		str	r2, [r0, #8]
 884:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_HardwareFlowControl = SDIO_HardwareFlowControl_Disable;
 2477              		.loc 1 884 0
 2478 0056 C260     		str	r2, [r0, #12]
 885:lib/ff/sdio_stm32f1.c ****         SDIO_Init(&SDIO_InitStructure);
 2479              		.loc 1 885 0
 2480 0058 0261     		str	r2, [r0, #16]
 2481              	.LVL304:
 2482              	.L182:
 886:lib/ff/sdio_stm32f1.c ****       }
 2483              		.loc 1 886 0
 2484 005a FFF7FEFF 		bl	SDIO_Init
 2485              	.LVL305:
 2486 005e 02E0     		b	.L177
 2487              	.LVL306:
 2488              	.L180:
 842:lib/ff/sdio_stm32f1.c **** 
 2489              		.loc 1 842 0
 2490 0060 2A24     		movs	r4, #42
 2491 0062 00E0     		b	.L177
 2492              	.L181:
 848:lib/ff/sdio_stm32f1.c ****   }
 2493              		.loc 1 848 0
 2494 0064 2724     		movs	r4, #39
 2495              	.LVL307:
 2496              	.L177:
 892:lib/ff/sdio_stm32f1.c **** 
 2497              		.loc 1 892 0
 2498 0066 2046     		mov	r0, r4
 2499 0068 38BD     		pop	{r3, r4, r5, pc}
 2500              	.L184:
 2501 006a 00BF     		.align	2
 2502              	.L183:
 2503 006c 00000000 		.word	.LANCHOR4
 2504 0070 00000000 		.word	.LANCHOR3
 2505              		.cfi_endproc
 2506              	.LFE65:
 2508              		.section	.text.SD_SetDeviceMode,"ax",%progbits
 2509              		.align	1
 2510              		.global	SD_SetDeviceMode
 2511              		.thumb
 2512              		.thumb_func
 2514              	SD_SetDeviceMode:
 2515              	.LFB66:
 907:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
 2516              		.loc 1 907 0
 2517              		.cfi_startproc
 2518              		@ args = 0, pretend = 0, frame = 0
 2519              		@ frame_needed = 0, uses_anonymous_args = 0
 2520              		@ link register save eliminated.
 2521              	.LVL308:
 2522              	.LVL309:
 910:lib/ff/sdio_stm32f1.c ****   {
 2523              		.loc 1 910 0
 2524 0000 0228     		cmp	r0, #2
 2525 0002 03D8     		bhi	.L187
 912:lib/ff/sdio_stm32f1.c ****   }
 2526              		.loc 1 912 0
 2527 0004 024B     		ldr	r3, .L188
 2528 0006 1860     		str	r0, [r3, #0]
 908:lib/ff/sdio_stm32f1.c **** 
 2529              		.loc 1 908 0
 2530 0008 2A20     		movs	r0, #42
 2531              	.LVL310:
 2532 000a 7047     		bx	lr
 2533              	.LVL311:
 2534              	.L187:
 916:lib/ff/sdio_stm32f1.c ****   }
 2535              		.loc 1 916 0
 2536 000c 2620     		movs	r0, #38
 2537              	.LVL312:
 920:lib/ff/sdio_stm32f1.c **** 
 2538              		.loc 1 920 0
 2539 000e 7047     		bx	lr
 2540              	.L189:
 2541              		.align	2
 2542              	.L188:
 2543 0010 00000000 		.word	.LANCHOR7
 2544              		.cfi_endproc
 2545              	.LFE66:
 2547              		.section	.text.SD_SelectDeselect,"ax",%progbits
 2548              		.align	1
 2549              		.global	SD_SelectDeselect
 2550              		.thumb
 2551              		.thumb_func
 2553              	SD_SelectDeselect:
 2554              	.LFB67:
 931:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
 2555              		.loc 1 931 0
 2556              		.cfi_startproc
 2557              		@ args = 0, pretend = 0, frame = 0
 2558              		@ frame_needed = 0, uses_anonymous_args = 0
 2559              	.LVL313:
 2560 0000 10B5     		push	{r4, lr}
 2561              	.LCFI15:
 2562              		.cfi_def_cfa_offset 8
 2563              		.cfi_offset 4, -8
 2564              		.cfi_offset 14, -4
 2565              	.LVL314:
 935:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SEL_DESEL_CARD;
 2566              		.loc 1 935 0
 2567 0002 094B     		ldr	r3, .L191
 2568 0004 1860     		str	r0, [r3, #0]
 936:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 2569              		.loc 1 936 0
 2570 0006 0724     		movs	r4, #7
 2571 0008 5C60     		str	r4, [r3, #4]
 937:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 2572              		.loc 1 937 0
 2573 000a 4022     		movs	r2, #64
 2574 000c 9A60     		str	r2, [r3, #8]
 938:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 2575              		.loc 1 938 0
 2576 000e 0020     		movs	r0, #0
 2577              	.LVL315:
 2578 0010 D860     		str	r0, [r3, #12]
 939:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 2579              		.loc 1 939 0
 2580 0012 4FF48061 		mov	r1, #1024
 2581 0016 1961     		str	r1, [r3, #16]
 940:lib/ff/sdio_stm32f1.c **** 
 2582              		.loc 1 940 0
 2583 0018 1846     		mov	r0, r3
 2584 001a FFF7FEFF 		bl	SDIO_SendCommand
 2585              	.LVL316:
 942:lib/ff/sdio_stm32f1.c **** 
 2586              		.loc 1 942 0
 2587 001e 2046     		mov	r0, r4
 945:lib/ff/sdio_stm32f1.c **** 
 2588              		.loc 1 945 0
 2589 0020 BDE81040 		pop	{r4, lr}
 942:lib/ff/sdio_stm32f1.c **** 
 2590              		.loc 1 942 0
 2591 0024 FFF7FEBF 		b	CmdResp1Error
 2592              	.LVL317:
 2593              	.L192:
 2594              		.align	2
 2595              	.L191:
 2596 0028 00000000 		.word	.LANCHOR0
 2597              		.cfi_endproc
 2598              	.LFE67:
 2600              		.section	.text.SD_Init,"ax",%progbits
 2601              		.align	1
 2602              		.global	SD_Init
 2603              		.thumb
 2604              		.thumb_func
 2606              	SD_Init:
 2607              	.LFB57:
 180:lib/ff/sdio_stm32f1.c ****   GPIO_InitTypeDef  GPIO_InitStructure;
 2608              		.loc 1 180 0
 2609              		.cfi_startproc
 2610              		@ args = 0, pretend = 0, frame = 8
 2611              		@ frame_needed = 0, uses_anonymous_args = 0
 2612 0000 73B5     		push	{r0, r1, r4, r5, r6, lr}
 2613              	.LCFI16:
 2614              		.cfi_def_cfa_offset 24
 2615              		.cfi_offset 0, -24
 2616              		.cfi_offset 1, -20
 2617              		.cfi_offset 4, -16
 2618              		.cfi_offset 5, -12
 2619              		.cfi_offset 6, -8
 2620              		.cfi_offset 14, -4
 2621              	.LVL318:
 187:lib/ff/sdio_stm32f1.c **** 
 2622              		.loc 1 187 0
 2623 0002 B020     		movs	r0, #176
 2624 0004 0121     		movs	r1, #1
 2625 0006 FFF7FEFF 		bl	RCC_APB2PeriphClockCmd
 2626              	.LVL319:
 190:lib/ff/sdio_stm32f1.c ****   GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;
 2627              		.loc 1 190 0
 2628 000a 4FF4F853 		mov	r3, #7936
 2629 000e ADF80030 		strh	r3, [sp, #0]	@ movhi
 191:lib/ff/sdio_stm32f1.c ****   GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF_PP;
 2630              		.loc 1 191 0
 2631 0012 0320     		movs	r0, #3
 2632 0014 8DF80200 		strb	r0, [sp, #2]
 192:lib/ff/sdio_stm32f1.c ****   GPIO_Init(GPIOC, &GPIO_InitStructure);
 2633              		.loc 1 192 0
 2634 0018 1821     		movs	r1, #24
 2635 001a 8DF80310 		strb	r1, [sp, #3]
 193:lib/ff/sdio_stm32f1.c **** 
 2636              		.loc 1 193 0
 2637 001e 2B48     		ldr	r0, .L196
 2638 0020 6946     		mov	r1, sp
 2639 0022 FFF7FEFF 		bl	GPIO_Init
 2640              	.LVL320:
 196:lib/ff/sdio_stm32f1.c ****   GPIO_Init(GPIOD, &GPIO_InitStructure);
 2641              		.loc 1 196 0
 2642 0026 0422     		movs	r2, #4
 2643 0028 ADF80020 		strh	r2, [sp, #0]	@ movhi
 197:lib/ff/sdio_stm32f1.c **** 
 2644              		.loc 1 197 0
 2645 002c 2848     		ldr	r0, .L196+4
 2646 002e 6946     		mov	r1, sp
 2647 0030 FFF7FEFF 		bl	GPIO_Init
 2648              	.LVL321:
 200:lib/ff/sdio_stm32f1.c ****   GPIO_InitStructure.GPIO_Mode = GPIO_Mode_IPU;
 2649              		.loc 1 200 0
 2650 0034 4FF40065 		mov	r5, #2048
 2651 0038 ADF80050 		strh	r5, [sp, #0]	@ movhi
 201:lib/ff/sdio_stm32f1.c ****   GPIO_Init(SD_DETECT_GPIO_PORT, &GPIO_InitStructure);
 2652              		.loc 1 201 0
 2653 003c 4823     		movs	r3, #72
 2654 003e 8DF80330 		strb	r3, [sp, #3]
 202:lib/ff/sdio_stm32f1.c ****   
 2655              		.loc 1 202 0
 2656 0042 2448     		ldr	r0, .L196+8
 2657 0044 6946     		mov	r1, sp
 2658 0046 FFF7FEFF 		bl	GPIO_Init
 2659              	.LVL322:
 205:lib/ff/sdio_stm32f1.c **** 
 2660              		.loc 1 205 0
 2661 004a 4FF48060 		mov	r0, #1024
 2662 004e 0121     		movs	r1, #1
 2663 0050 FFF7FEFF 		bl	RCC_AHBPeriphClockCmd
 2664              	.LVL323:
 208:lib/ff/sdio_stm32f1.c ****   /* End of LowLevel Init */
 2665              		.loc 1 208 0
 2666 0054 0220     		movs	r0, #2
 2667 0056 0121     		movs	r1, #1
 2668 0058 FFF7FEFF 		bl	RCC_AHBPeriphClockCmd
 2669              	.LVL324:
 212:lib/ff/sdio_stm32f1.c **** 
 2670              		.loc 1 212 0
 2671 005c FFF7FEFF 		bl	SDIO_DeInit
 2672              	.LVL325:
 214:lib/ff/sdio_stm32f1.c **** 
 2673              		.loc 1 214 0
 2674 0060 FFF7FEFF 		bl	SD_PowerON
 2675              	.LVL326:
 216:lib/ff/sdio_stm32f1.c ****   {
 2676              		.loc 1 216 0
 2677 0064 2A28     		cmp	r0, #42
 2678 0066 2FD1     		bne	.L194
 222:lib/ff/sdio_stm32f1.c **** 
 2679              		.loc 1 222 0
 2680 0068 FFF7FEFF 		bl	SD_InitializeCards
 2681              	.LVL327:
 224:lib/ff/sdio_stm32f1.c ****   {
 2682              		.loc 1 224 0
 2683 006c 2A28     		cmp	r0, #42
 2684 006e 2BD1     		bne	.L194
 232:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_ClockEdge = SDIO_ClockEdge_Rising;
 2685              		.loc 1 232 0
 2686 0070 1948     		ldr	r0, .L196+12
 2687              	.LVL328:
 2688 0072 0126     		movs	r6, #1
 2689 0074 0675     		strb	r6, [r0, #20]
 233:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_ClockBypass = SDIO_ClockBypass_Disable;
 2690              		.loc 1 233 0
 2691 0076 0024     		movs	r4, #0
 2692 0078 0460     		str	r4, [r0, #0]
 234:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_ClockPowerSave = SDIO_ClockPowerSave_Disable;
 2693              		.loc 1 234 0
 2694 007a 4460     		str	r4, [r0, #4]
 235:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_BusWide = SDIO_BusWide_1b;
 2695              		.loc 1 235 0
 2696 007c 8460     		str	r4, [r0, #8]
 236:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_HardwareFlowControl = SDIO_HardwareFlowControl_Disable;
 2697              		.loc 1 236 0
 2698 007e C460     		str	r4, [r0, #12]
 237:lib/ff/sdio_stm32f1.c ****   SDIO_Init(&SDIO_InitStructure);
 2699              		.loc 1 237 0
 2700 0080 0461     		str	r4, [r0, #16]
 238:lib/ff/sdio_stm32f1.c **** 
 2701              		.loc 1 238 0
 2702 0082 FFF7FEFF 		bl	SDIO_Init
 2703              	.LVL329:
 241:lib/ff/sdio_stm32f1.c ****   NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 0;
 2704              		.loc 1 241 0
 2705 0086 3120     		movs	r0, #49
 2706 0088 8DF80400 		strb	r0, [sp, #4]
 242:lib/ff/sdio_stm32f1.c ****   NVIC_InitStructure.NVIC_IRQChannelSubPriority = 0;
 2707              		.loc 1 242 0
 2708 008c 8DF80540 		strb	r4, [sp, #5]
 243:lib/ff/sdio_stm32f1.c ****   NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;
 2709              		.loc 1 243 0
 2710 0090 8DF80640 		strb	r4, [sp, #6]
 244:lib/ff/sdio_stm32f1.c ****   NVIC_Init(&NVIC_InitStructure);
 2711              		.loc 1 244 0
 2712 0094 8DF80760 		strb	r6, [sp, #7]
 245:lib/ff/sdio_stm32f1.c **** 
 2713              		.loc 1 245 0
 2714 0098 01A8     		add	r0, sp, #4
 2715 009a FFF7FEFF 		bl	NVIC_Init
 2716              	.LVL330:
 250:lib/ff/sdio_stm32f1.c ****   }
 2717              		.loc 1 250 0
 2718 009e 0F4E     		ldr	r6, .L196+16
 2719 00a0 3046     		mov	r0, r6
 2720 00a2 FFF7FEFF 		bl	SD_GetCardInfo
 2721              	.LVL331:
 253:lib/ff/sdio_stm32f1.c ****   {
 2722              		.loc 1 253 0
 2723 00a6 2A28     		cmp	r0, #42
 2724 00a8 0ED1     		bne	.L194
 256:lib/ff/sdio_stm32f1.c ****   }
 2725              		.loc 1 256 0
 2726 00aa B6F85410 		ldrh	r1, [r6, #84]
 2727 00ae 0804     		lsls	r0, r1, #16
 2728              	.LVL332:
 2729 00b0 2146     		mov	r1, r4
 2730 00b2 FFF7FEFF 		bl	SD_SelectDeselect
 2731              	.LVL333:
 259:lib/ff/sdio_stm32f1.c ****   {
 2732              		.loc 1 259 0
 2733 00b6 2A28     		cmp	r0, #42
 2734 00b8 06D1     		bne	.L194
 261:lib/ff/sdio_stm32f1.c ****   }  
 2735              		.loc 1 261 0
 2736 00ba 2846     		mov	r0, r5
 2737              	.LVL334:
 2738 00bc FFF7FEFF 		bl	SD_EnableWideBusOperation
 2739              	.LVL335:
 265:lib/ff/sdio_stm32f1.c ****   {  
 2740              		.loc 1 265 0
 2741 00c0 2A28     		cmp	r0, #42
 2742              	.LVL336:
 2743              	.LBB38:
 2744              	.LBB39:
 912:lib/ff/sdio_stm32f1.c ****   }
 2745              		.loc 1 912 0
 2746 00c2 04BF     		itt	eq
 2747 00c4 064A     		ldreq	r2, .L196+20
 2748 00c6 1460     		streq	r4, [r2, #0]
 2749              	.LVL337:
 2750              	.L194:
 2751              	.LBE39:
 2752              	.LBE38:
 271:lib/ff/sdio_stm32f1.c **** 
 2753              		.loc 1 271 0
 2754 00c8 7CBD     		pop	{r2, r3, r4, r5, r6, pc}
 2755              	.L197:
 2756 00ca 00BF     		.align	2
 2757              	.L196:
 2758 00cc 00100140 		.word	1073811456
 2759 00d0 00140140 		.word	1073812480
 2760 00d4 001C0140 		.word	1073814528
 2761 00d8 00000000 		.word	.LANCHOR3
 2762 00dc 00000000 		.word	.LANCHOR8
 2763 00e0 00000000 		.word	.LANCHOR7
 2764              		.cfi_endproc
 2765              	.LFE57:
 2767              		.section	.text.SD_ReadBlock,"ax",%progbits
 2768              		.align	1
 2769              		.global	SD_ReadBlock
 2770              		.thumb
 2771              		.thumb_func
 2773              	SD_ReadBlock:
 2774              	.LFB68:
 958:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
 2775              		.loc 1 958 0
 2776              		.cfi_startproc
 2777              		@ args = 4, pretend = 0, frame = 8
 2778              		@ frame_needed = 0, uses_anonymous_args = 0
 2779              	.LVL338:
 2780 0000 2DE9F74F 		push	{r0, r1, r2, r4, r5, r6, r7, r8, r9, sl, fp, lr}
 2781              	.LCFI17:
 2782              		.cfi_def_cfa_offset 48
 2783              		.cfi_offset 0, -48
 2784              		.cfi_offset 1, -44
 2785              		.cfi_offset 2, -40
 2786              		.cfi_offset 4, -36
 2787              		.cfi_offset 5, -32
 2788              		.cfi_offset 6, -28
 2789              		.cfi_offset 7, -24
 2790              		.cfi_offset 8, -20
 2791              		.cfi_offset 9, -16
 2792              		.cfi_offset 10, -12
 2793              		.cfi_offset 11, -8
 2794              		.cfi_offset 14, -4
 2795 0004 9146     		mov	r9, r2
 2796 0006 1D46     		mov	r5, r3
 2797 0008 BDF83060 		ldrh	r6, [sp, #48]
 2798              	.LVL339:
 963:lib/ff/sdio_stm32f1.c ****   {
 2799              		.loc 1 963 0
 2800 000c 8046     		mov	r8, r0
 2801 000e 08B9     		cbnz	r0, .L199
 2802              	.LVL340:
 2803              	.L202:
 966:lib/ff/sdio_stm32f1.c ****   }
 2804              		.loc 1 966 0
 2805 0010 2624     		movs	r4, #38
 2806 0012 F4E0     		b	.L200
 2807              	.LVL341:
 2808              	.L199:
 969:lib/ff/sdio_stm32f1.c ****   TransferEnd = 0;
 2809              		.loc 1 969 0
 2810 0014 2A22     		movs	r2, #42
 2811              	.LVL342:
 2812 0016 7B4B     		ldr	r3, .L249
 2813 0018 1A70     		strb	r2, [r3, #0]
 970:lib/ff/sdio_stm32f1.c ****   TotalNumberOfBytes = 0;
 2814              		.loc 1 970 0
 2815 001a 0024     		movs	r4, #0
 2816 001c 7A48     		ldr	r0, .L249+4
 2817              	.LVL343:
 2818 001e 0460     		str	r4, [r0, #0]
 971:lib/ff/sdio_stm32f1.c **** 
 2819              		.loc 1 971 0
 2820 0020 7A49     		ldr	r1, .L249+8
 2821 0022 0C60     		str	r4, [r1, #0]
 974:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataLength = 0;
 2822              		.loc 1 974 0
 2823 0024 7A48     		ldr	r0, .L249+12
 2824 0026 7B4B     		ldr	r3, .L249+16
 975:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataBlockSize = SDIO_DataBlockSize_1b;
 2825              		.loc 1 975 0
 2826 0028 80E81800 		stmia	r0, {r3, r4}
 976:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToCard;
 2827              		.loc 1 976 0
 2828 002c 8460     		str	r4, [r0, #8]
 977:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
 2829              		.loc 1 977 0
 2830 002e C460     		str	r4, [r0, #12]
 978:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Disable;
 2831              		.loc 1 978 0
 2832 0030 0461     		str	r4, [r0, #16]
 979:lib/ff/sdio_stm32f1.c ****   SDIO_DataConfig(&SDIO_DataInitStructure);
 2833              		.loc 1 979 0
 2834 0032 4461     		str	r4, [r0, #20]
 980:lib/ff/sdio_stm32f1.c ****   SDIO_DMACmd(DISABLE);
 2835              		.loc 1 980 0
 2836 0034 FFF7FEFF 		bl	SDIO_DataConfig
 2837              	.LVL344:
 981:lib/ff/sdio_stm32f1.c **** 
 2838              		.loc 1 981 0
 2839 0038 2046     		mov	r0, r4
 2840 003a FFF7FEFF 		bl	SDIO_DMACmd
 2841              	.LVL345:
 983:lib/ff/sdio_stm32f1.c ****   {
 2842              		.loc 1 983 0
 2843 003e 2046     		mov	r0, r4
 2844 0040 FFF7FEFF 		bl	SDIO_GetResponse
 2845              	.LVL346:
 2846 0044 8301     		lsls	r3, r0, #6
 2847 0046 00F1D980 		bmi	.L223
 989:lib/ff/sdio_stm32f1.c ****   {
 2848              		.loc 1 989 0
 2849 004a 734C     		ldr	r4, .L249+20
 2850 004c 2268     		ldr	r2, [r4, #0]
 2851 004e 022A     		cmp	r2, #2
 2852 0050 05D1     		bne	.L201
 2853              	.LVL347:
 992:lib/ff/sdio_stm32f1.c ****   }
 2854              		.loc 1 992 0
 2855 0052 4FEA5929 		lsr	r9, r9, #9
 2856 0056 49EAC559 		orr	r9, r9, r5, lsl #23
 2857              	.LVL348:
 991:lib/ff/sdio_stm32f1.c ****     ReadAddr /= 512;
 2858              		.loc 1 991 0
 2859 005a 4FF40076 		mov	r6, #512
 2860              	.LVL349:
 2861              	.L201:
 994:lib/ff/sdio_stm32f1.c ****   {
 2862              		.loc 1 994 0
 2863 005e 701E     		subs	r0, r6, #1
 2864 0060 83B2     		uxth	r3, r0
 2865 0062 B3F5006F 		cmp	r3, #2048
 2866 0066 D3D2     		bcs	.L202
 994:lib/ff/sdio_stm32f1.c ****   {
 2867              		.loc 1 994 0 is_stmt 0 discriminator 1
 2868 0068 10EA0601 		ands	r1, r0, r6
 2869 006c D0D1     		bne	.L202
 994:lib/ff/sdio_stm32f1.c ****   {
 2870              		.loc 1 994 0
 2871 006e 3746     		mov	r7, r6
 2872              	.L203:
 2873              	.LVL350:
 2874              	.LBB44:
 2875              	.LBB45:
3047:lib/ff/sdio_stm32f1.c ****   {
 2876              		.loc 1 3047 0 is_stmt 1
 2877 0070 012F     		cmp	r7, #1
 2878 0072 04D0     		beq	.L246
 2879              	.L204:
3049:lib/ff/sdio_stm32f1.c ****     count++;
 2880              		.loc 1 3049 0
 2881 0074 C7F34F07 		ubfx	r7, r7, #1, #16
 2882              	.LVL351:
3050:lib/ff/sdio_stm32f1.c ****   }
 2883              		.loc 1 3050 0
 2884 0078 4D1C     		adds	r5, r1, #1
 2885 007a E9B2     		uxtb	r1, r5
 2886              	.LVL352:
 2887 007c F8E7     		b	.L203
 2888              	.LVL353:
 2889              	.L246:
 2890              	.LBE45:
 2891              	.LBE44:
 999:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SET_BLOCKLEN;
 2892              		.loc 1 999 0
 2893 007e 674D     		ldr	r5, .L249+24
 2894 0080 2E60     		str	r6, [r5, #0]
1000:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 2895              		.loc 1 1000 0
 2896 0082 1024     		movs	r4, #16
 2897 0084 6C60     		str	r4, [r5, #4]
1001:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 2898              		.loc 1 1001 0
 2899 0086 4FF0400B 		mov	fp, #64
 2900 008a C5F808B0 		str	fp, [r5, #8]
1002:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 2901              		.loc 1 1002 0
 2902 008e 4FF0000A 		mov	sl, #0
 2903 0092 C5F80CA0 		str	sl, [r5, #12]
1003:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
 2904              		.loc 1 1003 0
 2905 0096 4FF48062 		mov	r2, #1024
 2906 009a 2A61     		str	r2, [r5, #16]
1004:lib/ff/sdio_stm32f1.c **** 
 2907              		.loc 1 1004 0
 2908 009c 2846     		mov	r0, r5
 2909 009e 0191     		str	r1, [sp, #4]
 2910 00a0 FFF7FEFF 		bl	SDIO_SendCommand
 2911              	.LVL354:
1006:lib/ff/sdio_stm32f1.c **** 
 2912              		.loc 1 1006 0
 2913 00a4 2046     		mov	r0, r4
 2914 00a6 FFF7FEFF 		bl	CmdResp1Error
 2915              	.LVL355:
 2916 00aa 0446     		mov	r4, r0
 2917              	.LVL356:
1008:lib/ff/sdio_stm32f1.c ****     {
 2918              		.loc 1 1008 0
 2919 00ac 2A28     		cmp	r0, #42
 2920 00ae 019B     		ldr	r3, [sp, #4]
 2921 00b0 40F0A580 		bne	.L200
1019:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataLength = BlockSize;
 2922              		.loc 1 1019 0
 2923 00b4 5648     		ldr	r0, .L249+12
 2924              	.LVL357:
 2925 00b6 5749     		ldr	r1, .L249+16
1020:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataBlockSize = (uint32_t) power << 4;
 2926              		.loc 1 1020 0
 2927 00b8 80E84200 		stmia	r0, {r1, r6}
1021:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToSDIO;
 2928              		.loc 1 1021 0
 2929 00bc 1901     		lsls	r1, r3, #4
 2930 00be 8160     		str	r1, [r0, #8]
1022:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
 2931              		.loc 1 1022 0
 2932 00c0 0224     		movs	r4, #2
 2933              	.LVL358:
 2934 00c2 C460     		str	r4, [r0, #12]
1023:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Enable;
 2935              		.loc 1 1023 0
 2936 00c4 C0F810A0 		str	sl, [r0, #16]
1024:lib/ff/sdio_stm32f1.c ****   SDIO_DataConfig(&SDIO_DataInitStructure);
 2937              		.loc 1 1024 0
 2938 00c8 4761     		str	r7, [r0, #20]
1025:lib/ff/sdio_stm32f1.c **** 
 2939              		.loc 1 1025 0
 2940 00ca FFF7FEFF 		bl	SDIO_DataConfig
 2941              	.LVL359:
1027:lib/ff/sdio_stm32f1.c ****   StopCondition = 0;
 2942              		.loc 1 1027 0
 2943 00ce 4F48     		ldr	r0, .L249+8
 2944 00d0 0660     		str	r6, [r0, #0]
1028:lib/ff/sdio_stm32f1.c ****   DestBuffer = (uint32_t *)readbuff;
 2945              		.loc 1 1028 0
 2946 00d2 534A     		ldr	r2, .L249+28
 2947 00d4 C2F800A0 		str	sl, [r2, #0]
1029:lib/ff/sdio_stm32f1.c **** 
 2948              		.loc 1 1029 0
 2949 00d8 524B     		ldr	r3, .L249+32
 2950 00da C3F80080 		str	r8, [r3, #0]
1032:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_READ_SINGLE_BLOCK;
 2951              		.loc 1 1032 0
 2952 00de C5F80090 		str	r9, [r5, #0]
1033:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 2953              		.loc 1 1033 0
 2954 00e2 1124     		movs	r4, #17
 2955 00e4 6C60     		str	r4, [r5, #4]
1034:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 2956              		.loc 1 1034 0
 2957 00e6 C5F808B0 		str	fp, [r5, #8]
1035:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 2958              		.loc 1 1035 0
 2959 00ea C5F80CA0 		str	sl, [r5, #12]
1036:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 2960              		.loc 1 1036 0
 2961 00ee 4FF48061 		mov	r1, #1024
 2962 00f2 2961     		str	r1, [r5, #16]
1037:lib/ff/sdio_stm32f1.c **** 
 2963              		.loc 1 1037 0
 2964 00f4 2846     		mov	r0, r5
 2965 00f6 FFF7FEFF 		bl	SDIO_SendCommand
 2966              	.LVL360:
1039:lib/ff/sdio_stm32f1.c **** 
 2967              		.loc 1 1039 0
 2968 00fa 2046     		mov	r0, r4
 2969 00fc FFF7FEFF 		bl	CmdResp1Error
 2970              	.LVL361:
 2971 0100 0446     		mov	r4, r0
 2972              	.LVL362:
1041:lib/ff/sdio_stm32f1.c ****   {
 2973              		.loc 1 1041 0
 2974 0102 2A28     		cmp	r0, #42
 2975 0104 7BD1     		bne	.L200
1046:lib/ff/sdio_stm32f1.c ****   {
 2976              		.loc 1 1046 0
 2977 0106 4848     		ldr	r0, .L249+36
 2978              	.LVL363:
 2979 0108 0268     		ldr	r2, [r0, #0]
 2980 010a 022A     		cmp	r2, #2
 2981 010c 49D1     		bne	.L205
1046:lib/ff/sdio_stm32f1.c ****   {
 2982              		.loc 1 1046 0 is_stmt 0 discriminator 1
 2983 010e 4546     		mov	r5, r8
 2984              	.LVL364:
 2985              	.L242:
1049:lib/ff/sdio_stm32f1.c ****     {
 2986              		.loc 1 1049 0 is_stmt 1 discriminator 1
 2987 0110 464E     		ldr	r6, .L249+40
 2988 0112 736B     		ldr	r3, [r6, #52]
 2989 0114 40F22A66 		movw	r6, #1578
 2990 0118 1E40     		ands	r6, r6, r3
 2991 011a 6EB9     		cbnz	r6, .L247
 2992              	.L209:
1051:lib/ff/sdio_stm32f1.c ****       {
 2993              		.loc 1 1051 0
 2994 011c 4FF40040 		mov	r0, #32768
 2995 0120 FFF7FEFF 		bl	SDIO_GetFlagStatus
 2996              	.LVL365:
 2997 0124 0028     		cmp	r0, #0
 2998 0126 F3D0     		beq	.L242
 2999              	.L208:
1055:lib/ff/sdio_stm32f1.c ****         }
 3000              		.loc 1 1055 0 discriminator 2
 3001 0128 FFF7FEFF 		bl	SDIO_ReadData
 3002              	.LVL366:
 3003 012c A851     		str	r0, [r5, r6]
 3004 012e 0436     		adds	r6, r6, #4
1053:lib/ff/sdio_stm32f1.c ****         {
 3005              		.loc 1 1053 0 discriminator 2
 3006 0130 202E     		cmp	r6, #32
 3007 0132 F9D1     		bne	.L208
1057:lib/ff/sdio_stm32f1.c ****       }
 3008              		.loc 1 1057 0
 3009 0134 2035     		adds	r5, r5, #32
 3010              	.LVL367:
 3011 0136 EBE7     		b	.L242
 3012              	.L247:
1061:lib/ff/sdio_stm32f1.c ****     {
 3013              		.loc 1 1061 0
 3014 0138 0820     		movs	r0, #8
 3015 013a FFF7FEFF 		bl	SDIO_GetFlagStatus
 3016              	.LVL368:
 3017 013e 20B1     		cbz	r0, .L210
1063:lib/ff/sdio_stm32f1.c ****       errorstatus = SD_DATA_TIMEOUT;
 3018              		.loc 1 1063 0
 3019 0140 0820     		movs	r0, #8
 3020 0142 FFF7FEFF 		bl	SDIO_ClearFlag
 3021              	.LVL369:
1065:lib/ff/sdio_stm32f1.c ****     }
 3022              		.loc 1 1065 0
 3023 0146 0424     		movs	r4, #4
 3024 0148 59E0     		b	.L200
 3025              	.LVL370:
 3026              	.L210:
1067:lib/ff/sdio_stm32f1.c ****     {
 3027              		.loc 1 1067 0
 3028 014a 0220     		movs	r0, #2
 3029 014c FFF7FEFF 		bl	SDIO_GetFlagStatus
 3030              	.LVL371:
 3031 0150 20B1     		cbz	r0, .L211
1069:lib/ff/sdio_stm32f1.c ****       errorstatus = SD_DATA_CRC_FAIL;
 3032              		.loc 1 1069 0
 3033 0152 0220     		movs	r0, #2
 3034 0154 FFF7FEFF 		bl	SDIO_ClearFlag
 3035              	.LVL372:
1071:lib/ff/sdio_stm32f1.c ****     }
 3036              		.loc 1 1071 0
 3037 0158 0224     		movs	r4, #2
 3038 015a 50E0     		b	.L200
 3039              	.LVL373:
 3040              	.L211:
1073:lib/ff/sdio_stm32f1.c ****     {
 3041              		.loc 1 1073 0
 3042 015c 2020     		movs	r0, #32
 3043 015e FFF7FEFF 		bl	SDIO_GetFlagStatus
 3044              	.LVL374:
 3045 0162 20B1     		cbz	r0, .L212
1075:lib/ff/sdio_stm32f1.c ****       errorstatus = SD_RX_OVERRUN;
 3046              		.loc 1 1075 0
 3047 0164 2020     		movs	r0, #32
 3048 0166 FFF7FEFF 		bl	SDIO_ClearFlag
 3049              	.LVL375:
1077:lib/ff/sdio_stm32f1.c ****     }
 3050              		.loc 1 1077 0
 3051 016a 0624     		movs	r4, #6
 3052 016c 47E0     		b	.L200
 3053              	.LVL376:
 3054              	.L212:
1079:lib/ff/sdio_stm32f1.c ****     {
 3055              		.loc 1 1079 0
 3056 016e 4FF40070 		mov	r0, #512
 3057 0172 FFF7FEFF 		bl	SDIO_GetFlagStatus
 3058              	.LVL377:
 3059 0176 28B1     		cbz	r0, .L243
1081:lib/ff/sdio_stm32f1.c ****       errorstatus = SD_START_BIT_ERR;
 3060              		.loc 1 1081 0
 3061 0178 4FF40070 		mov	r0, #512
 3062 017c FFF7FEFF 		bl	SDIO_ClearFlag
 3063              	.LVL378:
1083:lib/ff/sdio_stm32f1.c ****     }
 3064              		.loc 1 1083 0
 3065 0180 0724     		movs	r4, #7
 3066 0182 3CE0     		b	.L200
 3067              	.LVL379:
 3068              	.L243:
1085:lib/ff/sdio_stm32f1.c ****     {
 3069              		.loc 1 1085 0 discriminator 1
 3070 0184 4FF40010 		mov	r0, #2097152
 3071 0188 FFF7FEFF 		bl	SDIO_GetFlagStatus
 3072              	.LVL380:
 3073 018c 20B1     		cbz	r0, .L248
 3074              	.L215:
1087:lib/ff/sdio_stm32f1.c ****       tempbuff++;
 3075              		.loc 1 1087 0
 3076 018e FFF7FEFF 		bl	SDIO_ReadData
 3077              	.LVL381:
 3078 0192 45F8040B 		str	r0, [r5], #4
 3079              	.LVL382:
 3080 0196 F5E7     		b	.L243
 3081              	.LVL383:
 3082              	.L248:
1092:lib/ff/sdio_stm32f1.c ****   }
 3083              		.loc 1 1092 0
 3084 0198 40F2FF50 		movw	r0, #1535
 3085 019c FFF7FEFF 		bl	SDIO_ClearFlag
 3086              	.LVL384:
 3087 01a0 2DE0     		b	.L200
 3088              	.LVL385:
 3089              	.L205:
1094:lib/ff/sdio_stm32f1.c ****   {
 3090              		.loc 1 1094 0
 3091 01a2 012A     		cmp	r2, #1
 3092 01a4 0CD1     		bne	.L216
1096:lib/ff/sdio_stm32f1.c ****     while ((TransferEnd == 0) && (TransferError == SD_OK))
 3093              		.loc 1 1096 0
 3094 01a6 48F22A30 		movw	r0, #33578
 3095 01aa 3946     		mov	r1, r7
 3096 01ac FFF7FEFF 		bl	SDIO_ITConfig
 3097              	.LVL386:
 3098              	.L218:
1097:lib/ff/sdio_stm32f1.c ****     {}
 3099              		.loc 1 1097 0 discriminator 1
 3100 01b0 154B     		ldr	r3, .L249+4
 3101 01b2 1968     		ldr	r1, [r3, #0]
 3102 01b4 134B     		ldr	r3, .L249
 3103 01b6 D9B9     		cbnz	r1, .L221
1097:lib/ff/sdio_stm32f1.c ****     {}
 3104              		.loc 1 1097 0 is_stmt 0 discriminator 2
 3105 01b8 1878     		ldrb	r0, [r3, #0]	@ zero_extendqisi2
 3106 01ba 2A28     		cmp	r0, #42
 3107 01bc F8D0     		beq	.L218
 3108 01be 17E0     		b	.L221
 3109              	.L216:
1104:lib/ff/sdio_stm32f1.c ****   {
 3110              		.loc 1 1104 0 is_stmt 1
 3111 01c0 EAB9     		cbnz	r2, .L200
1106:lib/ff/sdio_stm32f1.c ****     SDIO_DMACmd(ENABLE);
 3112              		.loc 1 1106 0
 3113 01c2 40F22A30 		movw	r0, #810
 3114 01c6 3946     		mov	r1, r7
 3115 01c8 FFF7FEFF 		bl	SDIO_ITConfig
 3116              	.LVL387:
1107:lib/ff/sdio_stm32f1.c ****     SD_LowLevel_DMA_RxConfig((uint32_t *)readbuff, BlockSize);
 3117              		.loc 1 1107 0
 3118 01cc 3846     		mov	r0, r7
 3119 01ce FFF7FEFF 		bl	SDIO_DMACmd
 3120              	.LVL388:
1108:lib/ff/sdio_stm32f1.c ****     while ((SD_DMAEndOfTransferStatus() == RESET) && (TransferEnd == 0) && (TransferError == SD_OK)
 3121              		.loc 1 1108 0
 3122 01d2 4046     		mov	r0, r8
 3123 01d4 3146     		mov	r1, r6
 3124 01d6 FFF7FEFF 		bl	SD_LowLevel_DMA_RxConfig
 3125              	.LVL389:
 3126              	.L222:
 3127              	.LBB46:
 3128              	.LBB47:
3138:lib/ff/sdio_stm32f1.c **** }
 3129              		.loc 1 3138 0 discriminator 1
 3130 01da 1548     		ldr	r0, .L249+44
 3131 01dc FFF7FEFF 		bl	DMA_GetFlagStatus
 3132              	.LVL390:
 3133 01e0 084B     		ldr	r3, .L249
 3134              	.LBE47:
 3135              	.LBE46:
1109:lib/ff/sdio_stm32f1.c ****     {}
 3136              		.loc 1 1109 0 discriminator 1
 3137 01e2 28B9     		cbnz	r0, .L221
1109:lib/ff/sdio_stm32f1.c ****     {}
 3138              		.loc 1 1109 0 is_stmt 0 discriminator 2
 3139 01e4 0849     		ldr	r1, .L249+4
 3140 01e6 0868     		ldr	r0, [r1, #0]
 3141 01e8 10B9     		cbnz	r0, .L221
1109:lib/ff/sdio_stm32f1.c ****     {}
 3142              		.loc 1 1109 0 discriminator 1
 3143 01ea 1A78     		ldrb	r2, [r3, #0]	@ zero_extendqisi2
 3144 01ec 2A2A     		cmp	r2, #42
 3145 01ee F4D0     		beq	.L222
 3146              	.L221:
1111:lib/ff/sdio_stm32f1.c ****     {
 3147              		.loc 1 1111 0 is_stmt 1
 3148 01f0 1A78     		ldrb	r2, [r3, #0]	@ zero_extendqisi2
 3149 01f2 2A2A     		cmp	r2, #42
 3150 01f4 03D0     		beq	.L200
1113:lib/ff/sdio_stm32f1.c ****     }
 3151              		.loc 1 1113 0
 3152 01f6 034C     		ldr	r4, .L249
 3153              	.LVL391:
 3154 01f8 2478     		ldrb	r4, [r4, #0]	@ zero_extendqisi2
 3155 01fa 00E0     		b	.L200
 3156              	.LVL392:
 3157              	.L223:
 986:lib/ff/sdio_stm32f1.c ****   }
 3158              		.loc 1 986 0
 3159 01fc 0E24     		movs	r4, #14
 3160              	.LVL393:
 3161              	.L200:
1117:lib/ff/sdio_stm32f1.c **** 
 3162              		.loc 1 1117 0
 3163 01fe 2046     		mov	r0, r4
 3164 0200 BDE8FE8F 		pop	{r1, r2, r3, r4, r5, r6, r7, r8, r9, sl, fp, pc}
 3165              	.L250:
 3166              		.align	2
 3167              	.L249:
 3168 0204 00000000 		.word	.LANCHOR9
 3169 0208 00000000 		.word	.LANCHOR10
 3170 020c 00000000 		.word	.LANCHOR11
 3171 0210 00000000 		.word	.LANCHOR2
 3172 0214 FFFF0F00 		.word	1048575
 3173 0218 00000000 		.word	.LANCHOR4
 3174 021c 00000000 		.word	.LANCHOR0
 3175 0220 00000000 		.word	.LANCHOR12
 3176 0224 00000000 		.word	.LANCHOR13
 3177 0228 00000000 		.word	.LANCHOR7
 3178 022c 00800140 		.word	1073840128
 3179 0230 00200010 		.word	268443648
 3180              		.cfi_endproc
 3181              	.LFE68:
 3183              		.section	.text.SD_ReadMultiBlocks,"ax",%progbits
 3184              		.align	1
 3185              		.global	SD_ReadMultiBlocks
 3186              		.thumb
 3187              		.thumb_func
 3189              	SD_ReadMultiBlocks:
 3190              	.LFB69:
1131:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
 3191              		.loc 1 1131 0
 3192              		.cfi_startproc
 3193              		@ args = 8, pretend = 0, frame = 8
 3194              		@ frame_needed = 0, uses_anonymous_args = 0
 3195              	.LVL394:
 3196 0000 2DE9F74F 		push	{r0, r1, r2, r4, r5, r6, r7, r8, r9, sl, fp, lr}
 3197              	.LCFI18:
 3198              		.cfi_def_cfa_offset 48
 3199              		.cfi_offset 0, -48
 3200              		.cfi_offset 1, -44
 3201              		.cfi_offset 2, -40
 3202              		.cfi_offset 4, -36
 3203              		.cfi_offset 5, -32
 3204              		.cfi_offset 6, -28
 3205              		.cfi_offset 7, -24
 3206              		.cfi_offset 8, -20
 3207              		.cfi_offset 9, -16
 3208              		.cfi_offset 10, -12
 3209              		.cfi_offset 11, -8
 3210              		.cfi_offset 14, -4
 3211 0004 9046     		mov	r8, r2
 3212 0006 1D46     		mov	r5, r3
 3213 0008 BDF830A0 		ldrh	sl, [sp, #48]
 3214              	.LVL395:
1136:lib/ff/sdio_stm32f1.c ****   {
 3215              		.loc 1 1136 0
 3216 000c 0746     		mov	r7, r0
 3217 000e 08B9     		cbnz	r0, .L252
 3218              	.LVL396:
 3219              	.L255:
1139:lib/ff/sdio_stm32f1.c ****   }
 3220              		.loc 1 1139 0
 3221 0010 2624     		movs	r4, #38
 3222 0012 22E1     		b	.L253
 3223              	.LVL397:
 3224              	.L252:
1142:lib/ff/sdio_stm32f1.c ****   TransferEnd = 0;
 3225              		.loc 1 1142 0
 3226 0014 2A22     		movs	r2, #42
 3227              	.LVL398:
 3228 0016 924B     		ldr	r3, .L315
 3229 0018 1A70     		strb	r2, [r3, #0]
1143:lib/ff/sdio_stm32f1.c ****   TotalNumberOfBytes = 0;
 3230              		.loc 1 1143 0
 3231 001a 0024     		movs	r4, #0
 3232 001c 9148     		ldr	r0, .L315+4
 3233              	.LVL399:
 3234 001e 0460     		str	r4, [r0, #0]
1144:lib/ff/sdio_stm32f1.c **** 
 3235              		.loc 1 1144 0
 3236 0020 9149     		ldr	r1, .L315+8
 3237 0022 0C60     		str	r4, [r1, #0]
1147:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataLength = 0;
 3238              		.loc 1 1147 0
 3239 0024 9148     		ldr	r0, .L315+12
 3240 0026 924B     		ldr	r3, .L315+16
1148:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataBlockSize = SDIO_DataBlockSize_1b;
 3241              		.loc 1 1148 0
 3242 0028 80E81800 		stmia	r0, {r3, r4}
1149:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToCard;
 3243              		.loc 1 1149 0
 3244 002c 8460     		str	r4, [r0, #8]
1150:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
 3245              		.loc 1 1150 0
 3246 002e C460     		str	r4, [r0, #12]
1151:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Disable;
 3247              		.loc 1 1151 0
 3248 0030 0461     		str	r4, [r0, #16]
1152:lib/ff/sdio_stm32f1.c ****   SDIO_DataConfig(&SDIO_DataInitStructure);
 3249              		.loc 1 1152 0
 3250 0032 4461     		str	r4, [r0, #20]
1153:lib/ff/sdio_stm32f1.c ****   SDIO_DMACmd(DISABLE);
 3251              		.loc 1 1153 0
 3252 0034 FFF7FEFF 		bl	SDIO_DataConfig
 3253              	.LVL400:
1154:lib/ff/sdio_stm32f1.c **** 
 3254              		.loc 1 1154 0
 3255 0038 2046     		mov	r0, r4
 3256 003a FFF7FEFF 		bl	SDIO_DMACmd
 3257              	.LVL401:
1156:lib/ff/sdio_stm32f1.c ****   {
 3258              		.loc 1 1156 0
 3259 003e 2046     		mov	r0, r4
 3260 0040 FFF7FEFF 		bl	SDIO_GetResponse
 3261              	.LVL402:
 3262 0044 8201     		lsls	r2, r0, #6
 3263 0046 00F10581 		bmi	.L279
1162:lib/ff/sdio_stm32f1.c ****   {
 3264              		.loc 1 1162 0
 3265 004a 8A4C     		ldr	r4, .L315+20
 3266 004c 2268     		ldr	r2, [r4, #0]
 3267 004e 022A     		cmp	r2, #2
 3268 0050 05D1     		bne	.L254
 3269              	.LVL403:
1165:lib/ff/sdio_stm32f1.c ****   }
 3270              		.loc 1 1165 0
 3271 0052 4FEA5828 		lsr	r8, r8, #9
 3272 0056 48EAC558 		orr	r8, r8, r5, lsl #23
 3273              	.LVL404:
1164:lib/ff/sdio_stm32f1.c ****     ReadAddr /= 512;
 3274              		.loc 1 1164 0
 3275 005a 4FF4007A 		mov	sl, #512
 3276              	.LVL405:
 3277              	.L254:
1168:lib/ff/sdio_stm32f1.c ****   {
 3278              		.loc 1 1168 0
 3279 005e 0AF1FF30 		add	r0, sl, #-1
 3280 0062 83B2     		uxth	r3, r0
 3281 0064 B3F5006F 		cmp	r3, #2048
 3282 0068 D2D2     		bcs	.L255
1168:lib/ff/sdio_stm32f1.c ****   {
 3283              		.loc 1 1168 0 is_stmt 0 discriminator 1
 3284 006a 10EA0A01 		ands	r1, r0, sl
 3285 006e CFD1     		bne	.L255
1168:lib/ff/sdio_stm32f1.c ****   {
 3286              		.loc 1 1168 0
 3287 0070 5646     		mov	r6, sl
 3288              	.L256:
 3289              	.LVL406:
 3290              	.LBB52:
 3291              	.LBB53:
3047:lib/ff/sdio_stm32f1.c ****   {
 3292              		.loc 1 3047 0 is_stmt 1
 3293 0072 012E     		cmp	r6, #1
 3294 0074 04D0     		beq	.L312
 3295              	.L257:
3049:lib/ff/sdio_stm32f1.c ****     count++;
 3296              		.loc 1 3049 0
 3297 0076 C6F34F06 		ubfx	r6, r6, #1, #16
 3298              	.LVL407:
3050:lib/ff/sdio_stm32f1.c ****   }
 3299              		.loc 1 3050 0
 3300 007a 4D1C     		adds	r5, r1, #1
 3301 007c E9B2     		uxtb	r1, r5
 3302              	.LVL408:
 3303 007e F8E7     		b	.L256
 3304              	.LVL409:
 3305              	.L312:
 3306              	.LBE53:
 3307              	.LBE52:
1173:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SET_BLOCKLEN;
 3308              		.loc 1 1173 0
 3309 0080 7D4D     		ldr	r5, .L315+24
 3310 0082 C5F800A0 		str	sl, [r5, #0]
1174:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 3311              		.loc 1 1174 0
 3312 0086 1024     		movs	r4, #16
 3313 0088 6C60     		str	r4, [r5, #4]
1175:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 3314              		.loc 1 1175 0
 3315 008a 4FF0400B 		mov	fp, #64
 3316 008e C5F808B0 		str	fp, [r5, #8]
1176:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 3317              		.loc 1 1176 0
 3318 0092 4FF00009 		mov	r9, #0
 3319 0096 C5F80C90 		str	r9, [r5, #12]
1177:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
 3320              		.loc 1 1177 0
 3321 009a 4FF48062 		mov	r2, #1024
 3322 009e 2A61     		str	r2, [r5, #16]
1178:lib/ff/sdio_stm32f1.c **** 
 3323              		.loc 1 1178 0
 3324 00a0 2846     		mov	r0, r5
 3325 00a2 0191     		str	r1, [sp, #4]
 3326 00a4 FFF7FEFF 		bl	SDIO_SendCommand
 3327              	.LVL410:
1180:lib/ff/sdio_stm32f1.c **** 
 3328              		.loc 1 1180 0
 3329 00a8 2046     		mov	r0, r4
 3330 00aa FFF7FEFF 		bl	CmdResp1Error
 3331              	.LVL411:
 3332 00ae 0446     		mov	r4, r0
 3333              	.LVL412:
1182:lib/ff/sdio_stm32f1.c ****     {
 3334              		.loc 1 1182 0
 3335 00b0 2A28     		cmp	r0, #42
 3336 00b2 019A     		ldr	r2, [sp, #4]
 3337 00b4 40F0D180 		bne	.L253
1193:lib/ff/sdio_stm32f1.c ****   {
 3338              		.loc 1 1193 0
 3339 00b8 0D98     		ldr	r0, [sp, #52]
 3340              	.LVL413:
 3341 00ba 0128     		cmp	r0, #1
 3342 00bc 40F2CD80 		bls	.L253
1196:lib/ff/sdio_stm32f1.c ****     {
 3343              		.loc 1 1196 0
 3344 00c0 00FB0AFA 		mul	sl, r0, sl
 3345              	.LVL414:
 3346 00c4 BAF1007F 		cmp	sl, #33554432
 3347 00c8 A2D2     		bcs	.L255
1202:lib/ff/sdio_stm32f1.c ****     StopCondition = 1;
 3348              		.loc 1 1202 0
 3349 00ca 674B     		ldr	r3, .L315+8
 3350 00cc C3F800A0 		str	sl, [r3, #0]
1203:lib/ff/sdio_stm32f1.c ****     DestBuffer = (uint32_t *)readbuff;
 3351              		.loc 1 1203 0
 3352 00d0 6A49     		ldr	r1, .L315+28
 3353 00d2 0E60     		str	r6, [r1, #0]
1204:lib/ff/sdio_stm32f1.c **** 
 3354              		.loc 1 1204 0
 3355 00d4 6A48     		ldr	r0, .L315+32
 3356 00d6 0760     		str	r7, [r0, #0]
1206:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_DataLength = NumberOfBlocks * BlockSize;
 3357              		.loc 1 1206 0
 3358 00d8 6448     		ldr	r0, .L315+12
 3359 00da 6549     		ldr	r1, .L315+16
1207:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_DataBlockSize = (uint32_t) power << 4;
 3360              		.loc 1 1207 0
 3361 00dc 80E80204 		stmia	r0, {r1, sl}
1208:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToSDIO;
 3362              		.loc 1 1208 0
 3363 00e0 1201     		lsls	r2, r2, #4
 3364 00e2 8260     		str	r2, [r0, #8]
1209:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
 3365              		.loc 1 1209 0
 3366 00e4 0223     		movs	r3, #2
 3367 00e6 C360     		str	r3, [r0, #12]
1210:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Enable;
 3368              		.loc 1 1210 0
 3369 00e8 C0F81090 		str	r9, [r0, #16]
1211:lib/ff/sdio_stm32f1.c ****     SDIO_DataConfig(&SDIO_DataInitStructure);
 3370              		.loc 1 1211 0
 3371 00ec 4661     		str	r6, [r0, #20]
1212:lib/ff/sdio_stm32f1.c **** 
 3372              		.loc 1 1212 0
 3373 00ee FFF7FEFF 		bl	SDIO_DataConfig
 3374              	.LVL415:
1215:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_READ_MULT_BLOCK;
 3375              		.loc 1 1215 0
 3376 00f2 C5F80080 		str	r8, [r5, #0]
1216:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 3377              		.loc 1 1216 0
 3378 00f6 4FF01208 		mov	r8, #18
 3379 00fa C5F80480 		str	r8, [r5, #4]
1217:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 3380              		.loc 1 1217 0
 3381 00fe C5F808B0 		str	fp, [r5, #8]
1218:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 3382              		.loc 1 1218 0
 3383 0102 C5F80C90 		str	r9, [r5, #12]
1219:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
 3384              		.loc 1 1219 0
 3385 0106 4FF48061 		mov	r1, #1024
 3386 010a 2961     		str	r1, [r5, #16]
1220:lib/ff/sdio_stm32f1.c **** 
 3387              		.loc 1 1220 0
 3388 010c 2846     		mov	r0, r5
 3389 010e FFF7FEFF 		bl	SDIO_SendCommand
 3390              	.LVL416:
1222:lib/ff/sdio_stm32f1.c **** 
 3391              		.loc 1 1222 0
 3392 0112 4046     		mov	r0, r8
 3393 0114 FFF7FEFF 		bl	CmdResp1Error
 3394              	.LVL417:
1224:lib/ff/sdio_stm32f1.c ****     {
 3395              		.loc 1 1224 0
 3396 0118 2A28     		cmp	r0, #42
 3397 011a 40F09D80 		bne	.L281
1229:lib/ff/sdio_stm32f1.c ****     {
 3398              		.loc 1 1229 0
 3399 011e 5948     		ldr	r0, .L315+36
 3400              	.LVL418:
 3401 0120 0268     		ldr	r2, [r0, #0]
 3402 0122 022A     		cmp	r2, #2
 3403 0124 69D1     		bne	.L259
 3404              	.LVL419:
 3405              	.L308:
1232:lib/ff/sdio_stm32f1.c ****       {
 3406              		.loc 1 1232 0 discriminator 1
 3407 0126 584B     		ldr	r3, .L315+40
 3408 0128 596B     		ldr	r1, [r3, #52]
 3409 012a 40F22A34 		movw	r4, #810
 3410 012e 0C40     		ands	r4, r4, r1
 3411 0130 6CB9     		cbnz	r4, .L313
 3412              	.L263:
1234:lib/ff/sdio_stm32f1.c ****         {
 3413              		.loc 1 1234 0
 3414 0132 4FF40040 		mov	r0, #32768
 3415 0136 FFF7FEFF 		bl	SDIO_GetFlagStatus
 3416              	.LVL420:
 3417 013a 0028     		cmp	r0, #0
 3418 013c F3D0     		beq	.L308
 3419              	.L262:
1238:lib/ff/sdio_stm32f1.c ****           }
 3420              		.loc 1 1238 0 discriminator 2
 3421 013e FFF7FEFF 		bl	SDIO_ReadData
 3422              	.LVL421:
 3423 0142 3851     		str	r0, [r7, r4]
 3424 0144 0434     		adds	r4, r4, #4
1236:lib/ff/sdio_stm32f1.c ****           {
 3425              		.loc 1 1236 0 discriminator 2
 3426 0146 202C     		cmp	r4, #32
 3427 0148 F9D1     		bne	.L262
1240:lib/ff/sdio_stm32f1.c ****         }
 3428              		.loc 1 1240 0
 3429 014a 2037     		adds	r7, r7, #32
 3430              	.LVL422:
 3431 014c EBE7     		b	.L308
 3432              	.L313:
1244:lib/ff/sdio_stm32f1.c ****       {
 3433              		.loc 1 1244 0
 3434 014e 0820     		movs	r0, #8
 3435 0150 FFF7FEFF 		bl	SDIO_GetFlagStatus
 3436              	.LVL423:
 3437 0154 20B1     		cbz	r0, .L264
1246:lib/ff/sdio_stm32f1.c ****         errorstatus = SD_DATA_TIMEOUT;
 3438              		.loc 1 1246 0
 3439 0156 0820     		movs	r0, #8
 3440 0158 FFF7FEFF 		bl	SDIO_ClearFlag
 3441              	.LVL424:
1248:lib/ff/sdio_stm32f1.c ****       }
 3442              		.loc 1 1248 0
 3443 015c 0424     		movs	r4, #4
 3444 015e 7CE0     		b	.L253
 3445              	.LVL425:
 3446              	.L264:
1250:lib/ff/sdio_stm32f1.c ****       {
 3447              		.loc 1 1250 0
 3448 0160 0220     		movs	r0, #2
 3449 0162 FFF7FEFF 		bl	SDIO_GetFlagStatus
 3450              	.LVL426:
 3451 0166 20B1     		cbz	r0, .L265
1252:lib/ff/sdio_stm32f1.c ****         errorstatus = SD_DATA_CRC_FAIL;
 3452              		.loc 1 1252 0
 3453 0168 0220     		movs	r0, #2
 3454 016a FFF7FEFF 		bl	SDIO_ClearFlag
 3455              	.LVL427:
1254:lib/ff/sdio_stm32f1.c ****       }
 3456              		.loc 1 1254 0
 3457 016e 0224     		movs	r4, #2
 3458 0170 73E0     		b	.L253
 3459              	.LVL428:
 3460              	.L265:
1256:lib/ff/sdio_stm32f1.c ****       {
 3461              		.loc 1 1256 0
 3462 0172 2020     		movs	r0, #32
 3463 0174 FFF7FEFF 		bl	SDIO_GetFlagStatus
 3464              	.LVL429:
 3465 0178 20B1     		cbz	r0, .L266
1258:lib/ff/sdio_stm32f1.c ****         errorstatus = SD_RX_OVERRUN;
 3466              		.loc 1 1258 0
 3467 017a 2020     		movs	r0, #32
 3468 017c FFF7FEFF 		bl	SDIO_ClearFlag
 3469              	.LVL430:
1260:lib/ff/sdio_stm32f1.c ****       }
 3470              		.loc 1 1260 0
 3471 0180 0624     		movs	r4, #6
 3472 0182 6AE0     		b	.L253
 3473              	.LVL431:
 3474              	.L266:
1262:lib/ff/sdio_stm32f1.c ****       {
 3475              		.loc 1 1262 0
 3476 0184 4FF40070 		mov	r0, #512
 3477 0188 FFF7FEFF 		bl	SDIO_GetFlagStatus
 3478              	.LVL432:
 3479 018c 28B1     		cbz	r0, .L309
1264:lib/ff/sdio_stm32f1.c ****         errorstatus = SD_START_BIT_ERR;
 3480              		.loc 1 1264 0
 3481 018e 4FF40070 		mov	r0, #512
 3482 0192 FFF7FEFF 		bl	SDIO_ClearFlag
 3483              	.LVL433:
1266:lib/ff/sdio_stm32f1.c ****       }
 3484              		.loc 1 1266 0
 3485 0196 0724     		movs	r4, #7
 3486 0198 5FE0     		b	.L253
 3487              	.LVL434:
 3488              	.L309:
1268:lib/ff/sdio_stm32f1.c ****       {
 3489              		.loc 1 1268 0 discriminator 1
 3490 019a 4FF40010 		mov	r0, #2097152
 3491 019e FFF7FEFF 		bl	SDIO_GetFlagStatus
 3492              	.LVL435:
 3493 01a2 20B1     		cbz	r0, .L314
 3494              	.L269:
1270:lib/ff/sdio_stm32f1.c ****         tempbuff++;
 3495              		.loc 1 1270 0
 3496 01a4 FFF7FEFF 		bl	SDIO_ReadData
 3497              	.LVL436:
 3498 01a8 47F8040B 		str	r0, [r7], #4
 3499              	.LVL437:
 3500 01ac F5E7     		b	.L309
 3501              	.LVL438:
 3502              	.L314:
1274:lib/ff/sdio_stm32f1.c ****       {
 3503              		.loc 1 1274 0
 3504 01ae 4FF48070 		mov	r0, #256
 3505 01b2 FFF7FEFF 		bl	SDIO_GetFlagStatus
 3506              	.LVL439:
 3507 01b6 28B9     		cbnz	r0, .L270
 3508              	.L272:
 3509              	.LVL440:
1296:lib/ff/sdio_stm32f1.c ****     }
 3510              		.loc 1 1296 0
 3511 01b8 40F2FF50 		movw	r0, #1535
 3512 01bc FFF7FEFF 		bl	SDIO_ClearFlag
 3513              	.LVL441:
 3514 01c0 2A24     		movs	r4, #42
 3515 01c2 4AE0     		b	.L253
 3516              	.LVL442:
 3517              	.L270:
1277:lib/ff/sdio_stm32f1.c ****         {
 3518              		.loc 1 1277 0
 3519 01c4 2B48     		ldr	r0, .L315+20
 3520 01c6 0268     		ldr	r2, [r0, #0]
 3521 01c8 1AB1     		cbz	r2, .L271
1277:lib/ff/sdio_stm32f1.c ****         {
 3522              		.loc 1 1277 0 is_stmt 0 discriminator 1
 3523 01ca 022A     		cmp	r2, #2
 3524 01cc 01D0     		beq	.L271
 3525 01ce 012A     		cmp	r2, #1
 3526 01d0 F2D1     		bne	.L272
 3527              	.L271:
1280:lib/ff/sdio_stm32f1.c ****           SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_STOP_TRANSMISSION;
 3528              		.loc 1 1280 0 is_stmt 1
 3529 01d2 2948     		ldr	r0, .L315+24
1281:lib/ff/sdio_stm32f1.c ****           SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 3530              		.loc 1 1281 0
 3531 01d4 0022     		movs	r2, #0
 3532 01d6 0C24     		movs	r4, #12
 3533 01d8 80E81400 		stmia	r0, {r2, r4}
1282:lib/ff/sdio_stm32f1.c ****           SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 3534              		.loc 1 1282 0
 3535 01dc 4023     		movs	r3, #64
 3536 01de 8360     		str	r3, [r0, #8]
1283:lib/ff/sdio_stm32f1.c ****           SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 3537              		.loc 1 1283 0
 3538 01e0 C260     		str	r2, [r0, #12]
1284:lib/ff/sdio_stm32f1.c ****           SDIO_SendCommand(&SDIO_CmdInitStructure);
 3539              		.loc 1 1284 0
 3540 01e2 4FF48061 		mov	r1, #1024
 3541 01e6 0161     		str	r1, [r0, #16]
1285:lib/ff/sdio_stm32f1.c **** 
 3542              		.loc 1 1285 0
 3543 01e8 FFF7FEFF 		bl	SDIO_SendCommand
 3544              	.LVL443:
1287:lib/ff/sdio_stm32f1.c **** 
 3545              		.loc 1 1287 0
 3546 01ec 2046     		mov	r0, r4
 3547 01ee FFF7FEFF 		bl	CmdResp1Error
 3548              	.LVL444:
 3549 01f2 0446     		mov	r4, r0
 3550              	.LVL445:
1289:lib/ff/sdio_stm32f1.c ****           {
 3551              		.loc 1 1289 0
 3552 01f4 2A28     		cmp	r0, #42
 3553 01f6 30D1     		bne	.L253
 3554 01f8 DEE7     		b	.L272
 3555              	.LVL446:
 3556              	.L259:
1298:lib/ff/sdio_stm32f1.c ****     {
 3557              		.loc 1 1298 0
 3558 01fa 012A     		cmp	r2, #1
 3559 01fc 0CD1     		bne	.L273
1300:lib/ff/sdio_stm32f1.c ****       while ((TransferEnd == 0) && (TransferError == SD_OK))
 3560              		.loc 1 1300 0
 3561 01fe 48F22A30 		movw	r0, #33578
 3562 0202 3146     		mov	r1, r6
 3563 0204 FFF7FEFF 		bl	SDIO_ITConfig
 3564              	.LVL447:
 3565              	.L275:
1301:lib/ff/sdio_stm32f1.c ****       {}
 3566              		.loc 1 1301 0 discriminator 1
 3567 0208 164B     		ldr	r3, .L315+4
 3568 020a 1968     		ldr	r1, [r3, #0]
 3569 020c 144B     		ldr	r3, .L315
 3570 020e D9B9     		cbnz	r1, .L277
1301:lib/ff/sdio_stm32f1.c ****       {}
 3571              		.loc 1 1301 0 is_stmt 0 discriminator 2
 3572 0210 1878     		ldrb	r0, [r3, #0]	@ zero_extendqisi2
 3573 0212 2A28     		cmp	r0, #42
 3574 0214 F8D0     		beq	.L275
 3575 0216 17E0     		b	.L277
 3576              	.L273:
1308:lib/ff/sdio_stm32f1.c ****     {
 3577              		.loc 1 1308 0 is_stmt 1
 3578 0218 FAB9     		cbnz	r2, .L253
1310:lib/ff/sdio_stm32f1.c ****       SDIO_DMACmd(ENABLE);
 3579              		.loc 1 1310 0
 3580 021a 40F22A30 		movw	r0, #810
 3581 021e 3146     		mov	r1, r6
 3582 0220 FFF7FEFF 		bl	SDIO_ITConfig
 3583              	.LVL448:
1311:lib/ff/sdio_stm32f1.c ****       SD_LowLevel_DMA_RxConfig((uint32_t *)readbuff, (NumberOfBlocks * BlockSize));
 3584              		.loc 1 1311 0
 3585 0224 3046     		mov	r0, r6
 3586 0226 FFF7FEFF 		bl	SDIO_DMACmd
 3587              	.LVL449:
1312:lib/ff/sdio_stm32f1.c ****       while ((SD_DMAEndOfTransferStatus() == RESET) && (TransferEnd == 0) && (TransferError == SD_O
 3588              		.loc 1 1312 0
 3589 022a 3846     		mov	r0, r7
 3590 022c 5146     		mov	r1, sl
 3591 022e FFF7FEFF 		bl	SD_LowLevel_DMA_RxConfig
 3592              	.LVL450:
 3593              	.L278:
 3594              	.LBB54:
 3595              	.LBB55:
3138:lib/ff/sdio_stm32f1.c **** }
 3596              		.loc 1 3138 0 discriminator 1
 3597 0232 1648     		ldr	r0, .L315+44
 3598 0234 FFF7FEFF 		bl	DMA_GetFlagStatus
 3599              	.LVL451:
 3600 0238 094B     		ldr	r3, .L315
 3601              	.LBE55:
 3602              	.LBE54:
1313:lib/ff/sdio_stm32f1.c ****       {}
 3603              		.loc 1 1313 0 discriminator 1
 3604 023a 28B9     		cbnz	r0, .L277
1313:lib/ff/sdio_stm32f1.c ****       {}
 3605              		.loc 1 1313 0 is_stmt 0 discriminator 2
 3606 023c 0949     		ldr	r1, .L315+4
 3607 023e 0868     		ldr	r0, [r1, #0]
 3608 0240 10B9     		cbnz	r0, .L277
1313:lib/ff/sdio_stm32f1.c ****       {}
 3609              		.loc 1 1313 0 discriminator 1
 3610 0242 1A78     		ldrb	r2, [r3, #0]	@ zero_extendqisi2
 3611 0244 2A2A     		cmp	r2, #42
 3612 0246 F4D0     		beq	.L278
 3613              	.L277:
1315:lib/ff/sdio_stm32f1.c ****       {
 3614              		.loc 1 1315 0 is_stmt 1
 3615 0248 1A78     		ldrb	r2, [r3, #0]	@ zero_extendqisi2
 3616 024a 2A2A     		cmp	r2, #42
 3617 024c 05D0     		beq	.L253
1317:lib/ff/sdio_stm32f1.c ****       }
 3618              		.loc 1 1317 0
 3619 024e 044C     		ldr	r4, .L315
 3620 0250 2478     		ldrb	r4, [r4, #0]	@ zero_extendqisi2
 3621 0252 02E0     		b	.L253
 3622              	.LVL452:
 3623              	.L279:
1159:lib/ff/sdio_stm32f1.c ****   }
 3624              		.loc 1 1159 0
 3625 0254 0E24     		movs	r4, #14
 3626 0256 00E0     		b	.L253
 3627              	.LVL453:
 3628              	.L281:
1224:lib/ff/sdio_stm32f1.c ****     {
 3629              		.loc 1 1224 0
 3630 0258 0446     		mov	r4, r0
 3631              	.LVL454:
 3632              	.L253:
1322:lib/ff/sdio_stm32f1.c **** 
 3633              		.loc 1 1322 0
 3634 025a 2046     		mov	r0, r4
 3635 025c BDE8FE8F 		pop	{r1, r2, r3, r4, r5, r6, r7, r8, r9, sl, fp, pc}
 3636              	.L316:
 3637              		.align	2
 3638              	.L315:
 3639 0260 00000000 		.word	.LANCHOR9
 3640 0264 00000000 		.word	.LANCHOR10
 3641 0268 00000000 		.word	.LANCHOR11
 3642 026c 00000000 		.word	.LANCHOR2
 3643 0270 FFFF0F00 		.word	1048575
 3644 0274 00000000 		.word	.LANCHOR4
 3645 0278 00000000 		.word	.LANCHOR0
 3646 027c 00000000 		.word	.LANCHOR12
 3647 0280 00000000 		.word	.LANCHOR13
 3648 0284 00000000 		.word	.LANCHOR7
 3649 0288 00800140 		.word	1073840128
 3650 028c 00200010 		.word	268443648
 3651              		.cfi_endproc
 3652              	.LFE69:
 3654              		.section	.text.SD_WriteBlock,"ax",%progbits
 3655              		.align	1
 3656              		.global	SD_WriteBlock
 3657              		.thumb
 3658              		.thumb_func
 3660              	SD_WriteBlock:
 3661              	.LFB70:
1335:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
 3662              		.loc 1 1335 0
 3663              		.cfi_startproc
 3664              		@ args = 4, pretend = 0, frame = 16
 3665              		@ frame_needed = 0, uses_anonymous_args = 0
 3666              	.LVL455:
 3667 0000 2DE9F04F 		push	{r4, r5, r6, r7, r8, r9, sl, fp, lr}
 3668              	.LCFI19:
 3669              		.cfi_def_cfa_offset 36
 3670              		.cfi_offset 4, -36
 3671              		.cfi_offset 5, -32
 3672              		.cfi_offset 6, -28
 3673              		.cfi_offset 7, -24
 3674              		.cfi_offset 8, -20
 3675              		.cfi_offset 9, -16
 3676              		.cfi_offset 10, -12
 3677              		.cfi_offset 11, -8
 3678              		.cfi_offset 14, -4
 3679 0004 85B0     		sub	sp, sp, #20
 3680              	.LCFI20:
 3681              		.cfi_def_cfa_offset 56
 3682 0006 1746     		mov	r7, r2
 3683 0008 9846     		mov	r8, r3
 3684 000a BDF83850 		ldrh	r5, [sp, #56]
 3685              	.LVL456:
1337:lib/ff/sdio_stm32f1.c ****   uint32_t timeout = 0, bytestransferred = 0;
 3686              		.loc 1 1337 0
 3687 000e 0024     		movs	r4, #0
 3688 0010 8DF80F40 		strb	r4, [sp, #15]
 3689              	.LVL457:
1342:lib/ff/sdio_stm32f1.c ****   {
 3690              		.loc 1 1342 0
 3691 0014 0646     		mov	r6, r0
 3692 0016 08B9     		cbnz	r0, .L318
 3693              	.LVL458:
 3694              	.L321:
1345:lib/ff/sdio_stm32f1.c ****   }
 3695              		.loc 1 1345 0
 3696 0018 2620     		movs	r0, #38
 3697 001a 52E1     		b	.L319
 3698              	.LVL459:
 3699              	.L318:
1348:lib/ff/sdio_stm32f1.c ****   TransferEnd = 0;
 3700              		.loc 1 1348 0
 3701 001c 2A22     		movs	r2, #42
 3702              	.LVL460:
 3703 001e AA4B     		ldr	r3, .L383
 3704 0020 1A70     		strb	r2, [r3, #0]
1349:lib/ff/sdio_stm32f1.c ****   TotalNumberOfBytes = 0;
 3705              		.loc 1 1349 0
 3706 0022 AA48     		ldr	r0, .L383+4
 3707              	.LVL461:
 3708 0024 0460     		str	r4, [r0, #0]
1350:lib/ff/sdio_stm32f1.c **** 
 3709              		.loc 1 1350 0
 3710 0026 AA49     		ldr	r1, .L383+8
 3711 0028 0C60     		str	r4, [r1, #0]
1352:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataLength = 0;
 3712              		.loc 1 1352 0
 3713 002a AA48     		ldr	r0, .L383+12
 3714 002c AA4B     		ldr	r3, .L383+16
1353:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataBlockSize = SDIO_DataBlockSize_1b;
 3715              		.loc 1 1353 0
 3716 002e 80E81800 		stmia	r0, {r3, r4}
1354:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToCard;
 3717              		.loc 1 1354 0
 3718 0032 8460     		str	r4, [r0, #8]
1355:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
 3719              		.loc 1 1355 0
 3720 0034 C460     		str	r4, [r0, #12]
1356:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Disable;
 3721              		.loc 1 1356 0
 3722 0036 0461     		str	r4, [r0, #16]
1357:lib/ff/sdio_stm32f1.c ****   SDIO_DataConfig(&SDIO_DataInitStructure);
 3723              		.loc 1 1357 0
 3724 0038 4461     		str	r4, [r0, #20]
1358:lib/ff/sdio_stm32f1.c ****   SDIO_DMACmd(DISABLE);
 3725              		.loc 1 1358 0
 3726 003a FFF7FEFF 		bl	SDIO_DataConfig
 3727              	.LVL462:
1359:lib/ff/sdio_stm32f1.c **** 
 3728              		.loc 1 1359 0
 3729 003e 2046     		mov	r0, r4
 3730 0040 FFF7FEFF 		bl	SDIO_DMACmd
 3731              	.LVL463:
1361:lib/ff/sdio_stm32f1.c ****   {
 3732              		.loc 1 1361 0
 3733 0044 2046     		mov	r0, r4
 3734 0046 FFF7FEFF 		bl	SDIO_GetResponse
 3735              	.LVL464:
 3736 004a 8101     		lsls	r1, r0, #6
 3737 004c 00F13681 		bmi	.L348
1367:lib/ff/sdio_stm32f1.c ****   {
 3738              		.loc 1 1367 0
 3739 0050 A24A     		ldr	r2, .L383+20
 3740 0052 1368     		ldr	r3, [r2, #0]
 3741 0054 022B     		cmp	r3, #2
 3742 0056 04D1     		bne	.L320
 3743              	.LVL465:
1370:lib/ff/sdio_stm32f1.c ****   }
 3744              		.loc 1 1370 0
 3745 0058 7F0A     		lsrs	r7, r7, #9
 3746 005a 47EAC857 		orr	r7, r7, r8, lsl #23
 3747              	.LVL466:
1369:lib/ff/sdio_stm32f1.c ****     WriteAddr /= 512;
 3748              		.loc 1 1369 0
 3749 005e 4FF40075 		mov	r5, #512
 3750              	.LVL467:
 3751              	.L320:
1374:lib/ff/sdio_stm32f1.c ****   {
 3752              		.loc 1 1374 0
 3753 0062 05F1FF38 		add	r8, r5, #-1
 3754 0066 1FFA88F0 		uxth	r0, r8
 3755 006a B0F5006F 		cmp	r0, #2048
 3756 006e D3D2     		bcs	.L321
1374:lib/ff/sdio_stm32f1.c ****   {
 3757              		.loc 1 1374 0 is_stmt 0 discriminator 1
 3758 0070 18EA0508 		ands	r8, r8, r5
 3759 0074 D0D1     		bne	.L321
1374:lib/ff/sdio_stm32f1.c ****   {
 3760              		.loc 1 1374 0
 3761 0076 2C46     		mov	r4, r5
 3762              	.L322:
 3763              	.LVL468:
 3764              	.LBB60:
 3765              	.LBB61:
3047:lib/ff/sdio_stm32f1.c ****   {
 3766              		.loc 1 3047 0 is_stmt 1
 3767 0078 012C     		cmp	r4, #1
 3768 007a 06D0     		beq	.L380
 3769              	.L323:
3049:lib/ff/sdio_stm32f1.c ****     count++;
 3770              		.loc 1 3049 0
 3771 007c C4F34F04 		ubfx	r4, r4, #1, #16
 3772              	.LVL469:
3050:lib/ff/sdio_stm32f1.c ****   }
 3773              		.loc 1 3050 0
 3774 0080 08F10108 		add	r8, r8, #1
 3775              	.LVL470:
 3776 0084 5FFA88F8 		uxtb	r8, r8
 3777              	.LVL471:
 3778 0088 F6E7     		b	.L322
 3779              	.L380:
 3780              	.LVL472:
 3781              	.LBE61:
 3782              	.LBE60:
1378:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SET_BLOCKLEN;
 3783              		.loc 1 1378 0
 3784 008a 954C     		ldr	r4, .L383+24
 3785              	.LVL473:
 3786 008c 2560     		str	r5, [r4, #0]
1379:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 3787              		.loc 1 1379 0
 3788 008e 4FF0100A 		mov	sl, #16
 3789 0092 C4F804A0 		str	sl, [r4, #4]
1380:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 3790              		.loc 1 1380 0
 3791 0096 4021     		movs	r1, #64
 3792 0098 A160     		str	r1, [r4, #8]
1381:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 3793              		.loc 1 1381 0
 3794 009a 4FF00009 		mov	r9, #0
 3795 009e C4F80C90 		str	r9, [r4, #12]
1382:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
 3796              		.loc 1 1382 0
 3797 00a2 4FF4806B 		mov	fp, #1024
 3798 00a6 C4F810B0 		str	fp, [r4, #16]
1383:lib/ff/sdio_stm32f1.c **** 
 3799              		.loc 1 1383 0
 3800 00aa 2046     		mov	r0, r4
 3801 00ac 0191     		str	r1, [sp, #4]
 3802 00ae FFF7FEFF 		bl	SDIO_SendCommand
 3803              	.LVL474:
1385:lib/ff/sdio_stm32f1.c **** 
 3804              		.loc 1 1385 0
 3805 00b2 5046     		mov	r0, sl
 3806 00b4 FFF7FEFF 		bl	CmdResp1Error
 3807              	.LVL475:
1387:lib/ff/sdio_stm32f1.c ****     {
 3808              		.loc 1 1387 0
 3809 00b8 2A28     		cmp	r0, #42
 3810 00ba 019B     		ldr	r3, [sp, #4]
 3811 00bc 40F00181 		bne	.L319
1399:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SEND_STATUS;
 3812              		.loc 1 1399 0
 3813 00c0 884A     		ldr	r2, .L383+28
 3814 00c2 1068     		ldr	r0, [r2, #0]
 3815              	.LVL476:
 3816 00c4 00FA0AF1 		lsl	r1, r0, sl
 3817 00c8 2160     		str	r1, [r4, #0]
1400:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 3818              		.loc 1 1400 0
 3819 00ca 4FF00D0A 		mov	sl, #13
 3820 00ce C4F804A0 		str	sl, [r4, #4]
1401:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 3821              		.loc 1 1401 0
 3822 00d2 A360     		str	r3, [r4, #8]
1402:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 3823              		.loc 1 1402 0
 3824 00d4 C4F80C90 		str	r9, [r4, #12]
1403:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 3825              		.loc 1 1403 0
 3826 00d8 C4F810B0 		str	fp, [r4, #16]
1404:lib/ff/sdio_stm32f1.c **** 
 3827              		.loc 1 1404 0
 3828 00dc 2046     		mov	r0, r4
 3829 00de FFF7FEFF 		bl	SDIO_SendCommand
 3830              	.LVL477:
1406:lib/ff/sdio_stm32f1.c **** 
 3831              		.loc 1 1406 0
 3832 00e2 5046     		mov	r0, sl
 3833 00e4 FFF7FEFF 		bl	CmdResp1Error
 3834              	.LVL478:
1408:lib/ff/sdio_stm32f1.c ****   {
 3835              		.loc 1 1408 0
 3836 00e8 2A28     		cmp	r0, #42
 3837 00ea 40F0EA80 		bne	.L319
1413:lib/ff/sdio_stm32f1.c **** 
 3838              		.loc 1 1413 0
 3839 00ee 4846     		mov	r0, r9
 3840              	.LVL479:
 3841 00f0 FFF7FEFF 		bl	SDIO_GetResponse
 3842              	.LVL480:
1415:lib/ff/sdio_stm32f1.c **** 
 3843              		.loc 1 1415 0
 3844 00f4 784C     		ldr	r4, .L383+16
 3845              	.LVL481:
 3846              	.L324:
1417:lib/ff/sdio_stm32f1.c ****   {
 3847              		.loc 1 1417 0 discriminator 1
 3848 00f6 10F48079 		ands	r9, r0, #256
 3849 00fa 1FD1     		bne	.L325
1417:lib/ff/sdio_stm32f1.c ****   {
 3850              		.loc 1 1417 0 is_stmt 0 discriminator 2
 3851 00fc 002C     		cmp	r4, #0
 3852 00fe 00F0DF80 		beq	.L350
 3853              	.L326:
1419:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) (RCA << 16);
 3854              		.loc 1 1419 0 is_stmt 1
 3855 0102 013C     		subs	r4, r4, #1
 3856              	.LVL482:
1420:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SEND_STATUS;
 3857              		.loc 1 1420 0
 3858 0104 7648     		ldr	r0, .L383+24
 3859              	.LVL483:
 3860 0106 774A     		ldr	r2, .L383+28
 3861 0108 1368     		ldr	r3, [r2, #0]
 3862 010a 1904     		lsls	r1, r3, #16
 3863 010c 0160     		str	r1, [r0, #0]
1421:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 3864              		.loc 1 1421 0
 3865 010e 4FF00D0A 		mov	sl, #13
 3866 0112 C0F804A0 		str	sl, [r0, #4]
1422:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 3867              		.loc 1 1422 0
 3868 0116 4022     		movs	r2, #64
 3869 0118 8260     		str	r2, [r0, #8]
1423:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 3870              		.loc 1 1423 0
 3871 011a C0F80C90 		str	r9, [r0, #12]
1424:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
 3872              		.loc 1 1424 0
 3873 011e 4FF48063 		mov	r3, #1024
 3874 0122 0361     		str	r3, [r0, #16]
1425:lib/ff/sdio_stm32f1.c **** 
 3875              		.loc 1 1425 0
 3876 0124 FFF7FEFF 		bl	SDIO_SendCommand
 3877              	.LVL484:
1427:lib/ff/sdio_stm32f1.c **** 
 3878              		.loc 1 1427 0
 3879 0128 5046     		mov	r0, sl
 3880 012a FFF7FEFF 		bl	CmdResp1Error
 3881              	.LVL485:
1429:lib/ff/sdio_stm32f1.c ****     {
 3882              		.loc 1 1429 0
 3883 012e 2A28     		cmp	r0, #42
 3884 0130 40F0C780 		bne	.L319
1433:lib/ff/sdio_stm32f1.c ****   }
 3885              		.loc 1 1433 0
 3886 0134 4846     		mov	r0, r9
 3887              	.LVL486:
 3888 0136 FFF7FEFF 		bl	SDIO_GetResponse
 3889              	.LVL487:
 3890 013a DCE7     		b	.L324
 3891              	.L325:
1436:lib/ff/sdio_stm32f1.c ****   {
 3892              		.loc 1 1436 0
 3893 013c 002C     		cmp	r4, #0
 3894 013e 00F0BF80 		beq	.L350
1442:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_WRITE_SINGLE_BLOCK;
 3895              		.loc 1 1442 0
 3896 0142 6748     		ldr	r0, .L383+24
 3897              	.LVL488:
 3898 0144 0760     		str	r7, [r0, #0]
1443:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 3899              		.loc 1 1443 0
 3900 0146 1824     		movs	r4, #24
 3901              	.LVL489:
 3902 0148 4460     		str	r4, [r0, #4]
1444:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 3903              		.loc 1 1444 0
 3904 014a 4027     		movs	r7, #64
 3905 014c 8760     		str	r7, [r0, #8]
1445:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 3906              		.loc 1 1445 0
 3907 014e 0027     		movs	r7, #0
 3908 0150 C760     		str	r7, [r0, #12]
1446:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 3909              		.loc 1 1446 0
 3910 0152 4FF48063 		mov	r3, #1024
 3911 0156 0361     		str	r3, [r0, #16]
1447:lib/ff/sdio_stm32f1.c **** 
 3912              		.loc 1 1447 0
 3913 0158 FFF7FEFF 		bl	SDIO_SendCommand
 3914              	.LVL490:
1449:lib/ff/sdio_stm32f1.c **** 
 3915              		.loc 1 1449 0
 3916 015c 2046     		mov	r0, r4
 3917 015e FFF7FEFF 		bl	CmdResp1Error
 3918              	.LVL491:
1451:lib/ff/sdio_stm32f1.c ****   {
 3919              		.loc 1 1451 0
 3920 0162 2A28     		cmp	r0, #42
 3921 0164 40F0AD80 		bne	.L319
1456:lib/ff/sdio_stm32f1.c ****   StopCondition = 0;
 3922              		.loc 1 1456 0
 3923 0168 594C     		ldr	r4, .L383+8
 3924 016a 2560     		str	r5, [r4, #0]
1457:lib/ff/sdio_stm32f1.c ****   SrcBuffer = (uint32_t *)writebuff;
 3925              		.loc 1 1457 0
 3926 016c 5E4A     		ldr	r2, .L383+32
 3927 016e 1760     		str	r7, [r2, #0]
1458:lib/ff/sdio_stm32f1.c **** 
 3928              		.loc 1 1458 0
 3929 0170 5E48     		ldr	r0, .L383+36
 3930              	.LVL492:
 3931 0172 0660     		str	r6, [r0, #0]
1460:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataLength = BlockSize;
 3932              		.loc 1 1460 0
 3933 0174 5748     		ldr	r0, .L383+12
 3934 0176 584A     		ldr	r2, .L383+16
1461:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataBlockSize = (uint32_t) power << 4;
 3935              		.loc 1 1461 0
 3936 0178 80E82400 		stmia	r0, {r2, r5}
1462:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToCard;
 3937              		.loc 1 1462 0
 3938 017c 4FEA0811 		lsl	r1, r8, #4
 3939 0180 8160     		str	r1, [r0, #8]
1463:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
 3940              		.loc 1 1463 0
 3941 0182 C760     		str	r7, [r0, #12]
1464:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Enable;
 3942              		.loc 1 1464 0
 3943 0184 0761     		str	r7, [r0, #16]
1465:lib/ff/sdio_stm32f1.c ****   SDIO_DataConfig(&SDIO_DataInitStructure);
 3944              		.loc 1 1465 0
 3945 0186 0124     		movs	r4, #1
 3946 0188 4461     		str	r4, [r0, #20]
1466:lib/ff/sdio_stm32f1.c **** 
 3947              		.loc 1 1466 0
 3948 018a FFF7FEFF 		bl	SDIO_DataConfig
 3949              	.LVL493:
1469:lib/ff/sdio_stm32f1.c ****   {
 3950              		.loc 1 1469 0
 3951 018e 584B     		ldr	r3, .L383+40
 3952 0190 1968     		ldr	r1, [r3, #0]
 3953 0192 0229     		cmp	r1, #2
 3954 0194 56D1     		bne	.L377
 3955 0196 3446     		mov	r4, r6
 3956 0198 3D46     		mov	r5, r7
 3957              	.LVL494:
 3958              	.L376:
1471:lib/ff/sdio_stm32f1.c ****     {
 3959              		.loc 1 1471 0 discriminator 1
 3960 019a 564E     		ldr	r6, .L383+44
 3961 019c 726B     		ldr	r2, [r6, #52]
 3962 019e 40F21A66 		movw	r6, #1562
 3963 01a2 1640     		ands	r6, r6, r2
 3964 01a4 3EBB     		cbnz	r6, .L381
 3965              	.L336:
1473:lib/ff/sdio_stm32f1.c ****       {
 3966              		.loc 1 1473 0
 3967 01a6 4FF48040 		mov	r0, #16384
 3968 01aa FFF7FEFF 		bl	SDIO_GetFlagStatus
 3969              	.LVL495:
 3970 01ae 0028     		cmp	r0, #0
 3971 01b0 F3D0     		beq	.L376
1475:lib/ff/sdio_stm32f1.c ****         {
 3972              		.loc 1 1475 0
 3973 01b2 4748     		ldr	r0, .L383+8
 3974 01b4 0268     		ldr	r2, [r0, #0]
 3975 01b6 531B     		subs	r3, r2, r5
 3976 01b8 1F2B     		cmp	r3, #31
 3977 01ba 13D8     		bhi	.L330
1477:lib/ff/sdio_stm32f1.c **** 
 3978              		.loc 1 1477 0
 3979 01bc 13F0030F 		tst	r3, #3
 3980 01c0 4FEA9307 		lsr	r7, r3, #2
 3981 01c4 18BF     		it	ne
 3982 01c6 0137     		addne	r7, r7, #1
 3983              	.LVL496:
1479:lib/ff/sdio_stm32f1.c ****           {
 3984              		.loc 1 1479 0
 3985 01c8 0026     		movs	r6, #0
 3986              	.LVL497:
 3987              	.L333:
1479:lib/ff/sdio_stm32f1.c ****           {
 3988              		.loc 1 1479 0 is_stmt 0 discriminator 1
 3989 01ca BE42     		cmp	r6, r7
 3990 01cc 4FEA8601 		lsl	r1, r6, #2
 3991 01d0 05D0     		beq	.L382
 3992              	.L334:
1481:lib/ff/sdio_stm32f1.c ****           }
 3993              		.loc 1 1481 0 is_stmt 1 discriminator 2
 3994 01d2 54F82600 		ldr	r0, [r4, r6, lsl #2]
 3995 01d6 FFF7FEFF 		bl	SDIO_WriteData
 3996              	.LVL498:
1479:lib/ff/sdio_stm32f1.c ****           {
 3997              		.loc 1 1479 0 discriminator 2
 3998 01da 0136     		adds	r6, r6, #1
 3999              	.LVL499:
 4000 01dc F5E7     		b	.L333
 4001              	.L382:
 4002 01de 6D18     		adds	r5, r5, r1
 4003 01e0 6418     		adds	r4, r4, r1
 4004 01e2 DAE7     		b	.L376
 4005              	.LVL500:
 4006              	.L330:
1488:lib/ff/sdio_stm32f1.c ****           }
 4007              		.loc 1 1488 0 discriminator 2
 4008 01e4 A059     		ldr	r0, [r4, r6]
 4009 01e6 FFF7FEFF 		bl	SDIO_WriteData
 4010              	.LVL501:
 4011 01ea 0436     		adds	r6, r6, #4
1486:lib/ff/sdio_stm32f1.c ****           {
 4012              		.loc 1 1486 0 discriminator 2
 4013 01ec 202E     		cmp	r6, #32
 4014 01ee F9D1     		bne	.L330
1490:lib/ff/sdio_stm32f1.c ****           bytestransferred += 32;
 4015              		.loc 1 1490 0
 4016 01f0 2034     		adds	r4, r4, #32
 4017              	.LVL502:
1491:lib/ff/sdio_stm32f1.c ****         }
 4018              		.loc 1 1491 0
 4019 01f2 2035     		adds	r5, r5, #32
 4020              	.LVL503:
 4021 01f4 D1E7     		b	.L376
 4022              	.L381:
1495:lib/ff/sdio_stm32f1.c ****     {
 4023              		.loc 1 1495 0
 4024 01f6 0820     		movs	r0, #8
 4025 01f8 FFF7FEFF 		bl	SDIO_GetFlagStatus
 4026              	.LVL504:
 4027 01fc 20B1     		cbz	r0, .L337
1497:lib/ff/sdio_stm32f1.c ****       errorstatus = SD_DATA_TIMEOUT;
 4028              		.loc 1 1497 0
 4029 01fe 0820     		movs	r0, #8
 4030 0200 FFF7FEFF 		bl	SDIO_ClearFlag
 4031              	.LVL505:
1499:lib/ff/sdio_stm32f1.c ****     }
 4032              		.loc 1 1499 0
 4033 0204 0420     		movs	r0, #4
 4034 0206 5CE0     		b	.L319
 4035              	.LVL506:
 4036              	.L337:
1501:lib/ff/sdio_stm32f1.c ****     {
 4037              		.loc 1 1501 0
 4038 0208 0220     		movs	r0, #2
 4039 020a FFF7FEFF 		bl	SDIO_GetFlagStatus
 4040              	.LVL507:
 4041 020e 20B1     		cbz	r0, .L338
1503:lib/ff/sdio_stm32f1.c ****       errorstatus = SD_DATA_CRC_FAIL;
 4042              		.loc 1 1503 0
 4043 0210 0220     		movs	r0, #2
 4044 0212 FFF7FEFF 		bl	SDIO_ClearFlag
 4045              	.LVL508:
1505:lib/ff/sdio_stm32f1.c ****     }
 4046              		.loc 1 1505 0
 4047 0216 0220     		movs	r0, #2
 4048 0218 53E0     		b	.L319
 4049              	.LVL509:
 4050              	.L338:
1507:lib/ff/sdio_stm32f1.c ****     {
 4051              		.loc 1 1507 0
 4052 021a 1020     		movs	r0, #16
 4053 021c FFF7FEFF 		bl	SDIO_GetFlagStatus
 4054              	.LVL510:
 4055 0220 20B1     		cbz	r0, .L339
1509:lib/ff/sdio_stm32f1.c ****       errorstatus = SD_TX_UNDERRUN;
 4056              		.loc 1 1509 0
 4057 0222 1020     		movs	r0, #16
 4058 0224 FFF7FEFF 		bl	SDIO_ClearFlag
 4059              	.LVL511:
1511:lib/ff/sdio_stm32f1.c ****     }
 4060              		.loc 1 1511 0
 4061 0228 0520     		movs	r0, #5
 4062 022a 4AE0     		b	.L319
 4063              	.LVL512:
 4064              	.L339:
1513:lib/ff/sdio_stm32f1.c ****     {
 4065              		.loc 1 1513 0
 4066 022c 4FF40070 		mov	r0, #512
 4067 0230 FFF7FEFF 		bl	SDIO_GetFlagStatus
 4068              	.LVL513:
 4069 0234 0028     		cmp	r0, #0
 4070 0236 31D0     		beq	.L340
1515:lib/ff/sdio_stm32f1.c ****       errorstatus = SD_START_BIT_ERR;
 4071              		.loc 1 1515 0
 4072 0238 4FF40070 		mov	r0, #512
 4073 023c FFF7FEFF 		bl	SDIO_ClearFlag
 4074              	.LVL514:
1517:lib/ff/sdio_stm32f1.c ****     }
 4075              		.loc 1 1517 0
 4076 0240 0720     		movs	r0, #7
 4077 0242 3EE0     		b	.L319
 4078              	.LVL515:
 4079              	.L377:
1520:lib/ff/sdio_stm32f1.c ****   {
 4080              		.loc 1 1520 0
 4081 0244 0129     		cmp	r1, #1
 4082 0246 0BD1     		bne	.L341
1522:lib/ff/sdio_stm32f1.c ****     while ((TransferEnd == 0) && (TransferError == SD_OK))
 4083              		.loc 1 1522 0
 4084 0248 44F21A30 		movw	r0, #17178
 4085 024c FFF7FEFF 		bl	SDIO_ITConfig
 4086              	.LVL516:
 4087              	.L343:
1523:lib/ff/sdio_stm32f1.c ****     {}
 4088              		.loc 1 1523 0 discriminator 1
 4089 0250 1E49     		ldr	r1, .L383+4
 4090 0252 0A68     		ldr	r2, [r1, #0]
 4091 0254 1C49     		ldr	r1, .L383
 4092 0256 DAB9     		cbnz	r2, .L344
1523:lib/ff/sdio_stm32f1.c ****     {}
 4093              		.loc 1 1523 0 is_stmt 0 discriminator 2
 4094 0258 0878     		ldrb	r0, [r1, #0]	@ zero_extendqisi2
 4095 025a 2A28     		cmp	r0, #42
 4096 025c F8D0     		beq	.L343
 4097 025e 17E0     		b	.L344
 4098              	.L341:
1530:lib/ff/sdio_stm32f1.c ****   {
 4099              		.loc 1 1530 0 is_stmt 1
 4100 0260 E1B9     		cbnz	r1, .L340
1532:lib/ff/sdio_stm32f1.c ****     SD_LowLevel_DMA_TxConfig((uint32_t *)writebuff, BlockSize);
 4101              		.loc 1 1532 0
 4102 0262 40F21A30 		movw	r0, #794
 4103 0266 2146     		mov	r1, r4
 4104 0268 FFF7FEFF 		bl	SDIO_ITConfig
 4105              	.LVL517:
1533:lib/ff/sdio_stm32f1.c ****     SDIO_DMACmd(ENABLE);
 4106              		.loc 1 1533 0
 4107 026c 3046     		mov	r0, r6
 4108 026e 2946     		mov	r1, r5
 4109 0270 FFF7FEFF 		bl	SD_LowLevel_DMA_TxConfig
 4110              	.LVL518:
1534:lib/ff/sdio_stm32f1.c ****     while ((SD_DMAEndOfTransferStatus() == RESET) && (TransferEnd == 0) && (TransferError == SD_OK)
 4111              		.loc 1 1534 0
 4112 0274 2046     		mov	r0, r4
 4113 0276 FFF7FEFF 		bl	SDIO_DMACmd
 4114              	.LVL519:
 4115              	.L345:
 4116              	.LBB62:
 4117              	.LBB63:
3138:lib/ff/sdio_stm32f1.c **** }
 4118              		.loc 1 3138 0 discriminator 1
 4119 027a 1F48     		ldr	r0, .L383+48
 4120 027c FFF7FEFF 		bl	DMA_GetFlagStatus
 4121              	.LVL520:
 4122 0280 1149     		ldr	r1, .L383
 4123              	.LBE63:
 4124              	.LBE62:
1535:lib/ff/sdio_stm32f1.c ****     {}
 4125              		.loc 1 1535 0 discriminator 1
 4126 0282 28B9     		cbnz	r0, .L344
1535:lib/ff/sdio_stm32f1.c ****     {}
 4127              		.loc 1 1535 0 is_stmt 0 discriminator 2
 4128 0284 114A     		ldr	r2, .L383+4
 4129 0286 1068     		ldr	r0, [r2, #0]
 4130 0288 10B9     		cbnz	r0, .L344
1535:lib/ff/sdio_stm32f1.c ****     {}
 4131              		.loc 1 1535 0 discriminator 1
 4132 028a 0B78     		ldrb	r3, [r1, #0]	@ zero_extendqisi2
 4133 028c 2A2B     		cmp	r3, #42
 4134 028e F4D0     		beq	.L345
 4135              	.L344:
1537:lib/ff/sdio_stm32f1.c ****     {
 4136              		.loc 1 1537 0 is_stmt 1
 4137 0290 0B78     		ldrb	r3, [r1, #0]	@ zero_extendqisi2
 4138 0292 2A2B     		cmp	r3, #42
 4139 0294 02D0     		beq	.L340
1539:lib/ff/sdio_stm32f1.c ****     }
 4140              		.loc 1 1539 0
 4141 0296 0C49     		ldr	r1, .L383
 4142 0298 0878     		ldrb	r0, [r1, #0]	@ zero_extendqisi2
 4143 029a 12E0     		b	.L319
 4144              	.LVL521:
 4145              	.L340:
1544:lib/ff/sdio_stm32f1.c **** 
 4146              		.loc 1 1544 0
 4147 029c 40F2FF50 		movw	r0, #1535
 4148 02a0 FFF7FEFF 		bl	SDIO_ClearFlag
 4149              	.LVL522:
 4150              	.L347:
1551:lib/ff/sdio_stm32f1.c ****   }
 4151              		.loc 1 1551 0
 4152 02a4 0DF10F00 		add	r0, sp, #15
 4153 02a8 FFF7FEFF 		bl	IsCardProgramming
 4154              	.LVL523:
1549:lib/ff/sdio_stm32f1.c ****   {
 4155              		.loc 1 1549 0
 4156 02ac 2A28     		cmp	r0, #42
 4157 02ae 08D1     		bne	.L319
1549:lib/ff/sdio_stm32f1.c ****   {
 4158              		.loc 1 1549 0 is_stmt 0 discriminator 2
 4159 02b0 9DF80F30 		ldrb	r3, [sp, #15]	@ zero_extendqisi2
 4160              	.LVL524:
 4161 02b4 991F     		subs	r1, r3, #6
 4162              	.LVL525:
 4163 02b6 0129     		cmp	r1, #1
 4164 02b8 F4D9     		bls	.L347
 4165 02ba 02E0     		b	.L319
 4166              	.LVL526:
 4167              	.L348:
1364:lib/ff/sdio_stm32f1.c ****   }
 4168              		.loc 1 1364 0 is_stmt 1
 4169 02bc 0E20     		movs	r0, #14
 4170 02be 00E0     		b	.L319
 4171              	.LVL527:
 4172              	.L350:
1438:lib/ff/sdio_stm32f1.c ****   }
 4173              		.loc 1 1438 0
 4174 02c0 2920     		movs	r0, #41
 4175              	.LVL528:
 4176              	.L319:
1555:lib/ff/sdio_stm32f1.c **** 
 4177              		.loc 1 1555 0
 4178 02c2 05B0     		add	sp, sp, #20
 4179 02c4 BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, sl, fp, pc}
 4180              	.L384:
 4181              		.align	2
 4182              	.L383:
 4183 02c8 00000000 		.word	.LANCHOR9
 4184 02cc 00000000 		.word	.LANCHOR10
 4185 02d0 00000000 		.word	.LANCHOR11
 4186 02d4 00000000 		.word	.LANCHOR2
 4187 02d8 FFFF0F00 		.word	1048575
 4188 02dc 00000000 		.word	.LANCHOR4
 4189 02e0 00000000 		.word	.LANCHOR0
 4190 02e4 00000000 		.word	.LANCHOR1
 4191 02e8 00000000 		.word	.LANCHOR12
 4192 02ec 00000000 		.word	.LANCHOR14
 4193 02f0 00000000 		.word	.LANCHOR7
 4194 02f4 00800140 		.word	1073840128
 4195 02f8 00200010 		.word	268443648
 4196              		.cfi_endproc
 4197              	.LFE70:
 4199              		.section	.text.SD_WriteMultiBlocks,"ax",%progbits
 4200              		.align	1
 4201              		.global	SD_WriteMultiBlocks
 4202              		.thumb
 4203              		.thumb_func
 4205              	SD_WriteMultiBlocks:
 4206              	.LFB71:
1569:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
 4207              		.loc 1 1569 0
 4208              		.cfi_startproc
 4209              		@ args = 8, pretend = 0, frame = 16
 4210              		@ frame_needed = 0, uses_anonymous_args = 0
 4211              	.LVL529:
 4212 0000 2DE9F04F 		push	{r4, r5, r6, r7, r8, r9, sl, fp, lr}
 4213              	.LCFI21:
 4214              		.cfi_def_cfa_offset 36
 4215              		.cfi_offset 4, -36
 4216              		.cfi_offset 5, -32
 4217              		.cfi_offset 6, -28
 4218              		.cfi_offset 7, -24
 4219              		.cfi_offset 8, -20
 4220              		.cfi_offset 9, -16
 4221              		.cfi_offset 10, -12
 4222              		.cfi_offset 11, -8
 4223              		.cfi_offset 14, -4
 4224 0004 85B0     		sub	sp, sp, #20
 4225              	.LCFI22:
 4226              		.cfi_def_cfa_offset 56
 4227 0006 9246     		mov	sl, r2
 4228 0008 1F46     		mov	r7, r3
 4229 000a BDF83840 		ldrh	r4, [sp, #56]
 4230              	.LVL530:
1571:lib/ff/sdio_stm32f1.c ****   uint32_t bytestransferred = 0;
 4231              		.loc 1 1571 0
 4232 000e 0026     		movs	r6, #0
 4233 0010 8DF80B60 		strb	r6, [sp, #11]
 4234              	.LVL531:
1575:lib/ff/sdio_stm32f1.c ****   
 4235              		.loc 1 1575 0
 4236 0014 0396     		str	r6, [sp, #12]
 4237              	.LVL532:
1577:lib/ff/sdio_stm32f1.c ****   {
 4238              		.loc 1 1577 0
 4239 0016 0190     		str	r0, [sp, #4]
 4240 0018 08B9     		cbnz	r0, .L386
 4241              	.LVL533:
 4242              	.L389:
1580:lib/ff/sdio_stm32f1.c ****   }
 4243              		.loc 1 1580 0
 4244 001a 2620     		movs	r0, #38
 4245 001c A9E1     		b	.L387
 4246              	.LVL534:
 4247              	.L386:
1583:lib/ff/sdio_stm32f1.c ****   TransferEnd = 0;
 4248              		.loc 1 1583 0
 4249 001e 2A22     		movs	r2, #42
 4250              	.LVL535:
 4251 0020 AB4B     		ldr	r3, .L457
 4252 0022 1A70     		strb	r2, [r3, #0]
1584:lib/ff/sdio_stm32f1.c ****   TotalNumberOfBytes = 0;
 4253              		.loc 1 1584 0
 4254 0024 AB48     		ldr	r0, .L457+4
 4255              	.LVL536:
 4256 0026 0660     		str	r6, [r0, #0]
1585:lib/ff/sdio_stm32f1.c **** 
 4257              		.loc 1 1585 0
 4258 0028 AB49     		ldr	r1, .L457+8
 4259 002a 0E60     		str	r6, [r1, #0]
1587:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataLength = 0;
 4260              		.loc 1 1587 0
 4261 002c AB48     		ldr	r0, .L457+12
 4262 002e AC4B     		ldr	r3, .L457+16
1588:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataBlockSize = SDIO_DataBlockSize_1b;
 4263              		.loc 1 1588 0
 4264 0030 80E84800 		stmia	r0, {r3, r6}
1589:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToCard;
 4265              		.loc 1 1589 0
 4266 0034 8660     		str	r6, [r0, #8]
1590:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
 4267              		.loc 1 1590 0
 4268 0036 C660     		str	r6, [r0, #12]
1591:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Disable;
 4269              		.loc 1 1591 0
 4270 0038 0661     		str	r6, [r0, #16]
1592:lib/ff/sdio_stm32f1.c ****   SDIO_DataConfig(&SDIO_DataInitStructure);
 4271              		.loc 1 1592 0
 4272 003a 4661     		str	r6, [r0, #20]
1593:lib/ff/sdio_stm32f1.c ****   SDIO_DMACmd(DISABLE);
 4273              		.loc 1 1593 0
 4274 003c FFF7FEFF 		bl	SDIO_DataConfig
 4275              	.LVL537:
1594:lib/ff/sdio_stm32f1.c **** 
 4276              		.loc 1 1594 0
 4277 0040 3046     		mov	r0, r6
 4278 0042 FFF7FEFF 		bl	SDIO_DMACmd
 4279              	.LVL538:
1596:lib/ff/sdio_stm32f1.c ****   {
 4280              		.loc 1 1596 0
 4281 0046 3046     		mov	r0, r6
 4282 0048 FFF7FEFF 		bl	SDIO_GetResponse
 4283              	.LVL539:
 4284 004c 8001     		lsls	r0, r0, #6
 4285 004e 00F18F81 		bmi	.L421
1602:lib/ff/sdio_stm32f1.c ****   {
 4286              		.loc 1 1602 0
 4287 0052 A44A     		ldr	r2, .L457+20
 4288 0054 1368     		ldr	r3, [r2, #0]
 4289 0056 022B     		cmp	r3, #2
 4290 0058 05D1     		bne	.L388
 4291              	.LVL540:
1605:lib/ff/sdio_stm32f1.c ****   }
 4292              		.loc 1 1605 0
 4293 005a 4FEA5A2A 		lsr	sl, sl, #9
 4294 005e 4AEAC75A 		orr	sl, sl, r7, lsl #23
 4295              	.LVL541:
1604:lib/ff/sdio_stm32f1.c ****     WriteAddr /= 512;
 4296              		.loc 1 1604 0
 4297 0062 4FF40074 		mov	r4, #512
 4298              	.LVL542:
 4299              	.L388:
1609:lib/ff/sdio_stm32f1.c ****   {
 4300              		.loc 1 1609 0
 4301 0066 04F1FF39 		add	r9, r4, #-1
 4302 006a 1FFA89F0 		uxth	r0, r9
 4303 006e B0F5006F 		cmp	r0, #2048
 4304 0072 D2D2     		bcs	.L389
1609:lib/ff/sdio_stm32f1.c ****   {
 4305              		.loc 1 1609 0 is_stmt 0 discriminator 1
 4306 0074 19EA0409 		ands	r9, r9, r4
 4307 0078 CFD1     		bne	.L389
1609:lib/ff/sdio_stm32f1.c ****   {
 4308              		.loc 1 1609 0
 4309 007a 2546     		mov	r5, r4
 4310              	.L390:
 4311              	.LVL543:
 4312              	.LBB68:
 4313              	.LBB69:
3047:lib/ff/sdio_stm32f1.c ****   {
 4314              		.loc 1 3047 0 is_stmt 1
 4315 007c 012D     		cmp	r5, #1
 4316 007e 06D0     		beq	.L452
 4317              	.L391:
3049:lib/ff/sdio_stm32f1.c ****     count++;
 4318              		.loc 1 3049 0
 4319 0080 C5F34F05 		ubfx	r5, r5, #1, #16
 4320              	.LVL544:
3050:lib/ff/sdio_stm32f1.c ****   }
 4321              		.loc 1 3050 0
 4322 0084 09F10109 		add	r9, r9, #1
 4323              	.LVL545:
 4324 0088 5FFA89F9 		uxtb	r9, r9
 4325              	.LVL546:
 4326 008c F6E7     		b	.L390
 4327              	.L452:
 4328              	.LVL547:
 4329              	.LBE69:
 4330              	.LBE68:
1613:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SET_BLOCKLEN;
 4331              		.loc 1 1613 0
 4332 008e 964D     		ldr	r5, .L457+24
 4333              	.LVL548:
 4334 0090 2C60     		str	r4, [r5, #0]
1614:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 4335              		.loc 1 1614 0
 4336 0092 4FF0100B 		mov	fp, #16
 4337 0096 C5F804B0 		str	fp, [r5, #4]
1615:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 4338              		.loc 1 1615 0
 4339 009a 4FF04008 		mov	r8, #64
 4340 009e C5F80880 		str	r8, [r5, #8]
1616:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 4341              		.loc 1 1616 0
 4342 00a2 0027     		movs	r7, #0
 4343 00a4 EF60     		str	r7, [r5, #12]
1617:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
 4344              		.loc 1 1617 0
 4345 00a6 4FF48066 		mov	r6, #1024
 4346 00aa 2E61     		str	r6, [r5, #16]
1618:lib/ff/sdio_stm32f1.c **** 
 4347              		.loc 1 1618 0
 4348 00ac 2846     		mov	r0, r5
 4349 00ae FFF7FEFF 		bl	SDIO_SendCommand
 4350              	.LVL549:
1620:lib/ff/sdio_stm32f1.c **** 
 4351              		.loc 1 1620 0
 4352 00b2 5846     		mov	r0, fp
 4353 00b4 FFF7FEFF 		bl	CmdResp1Error
 4354              	.LVL550:
1622:lib/ff/sdio_stm32f1.c ****     {
 4355              		.loc 1 1622 0
 4356 00b8 2A28     		cmp	r0, #42
 4357 00ba 40F05A81 		bne	.L387
1634:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SEND_STATUS;
 4358              		.loc 1 1634 0
 4359 00be DFF83CB2 		ldr	fp, .L457+44
 4360 00c2 DBF80010 		ldr	r1, [fp, #0]
 4361 00c6 0A04     		lsls	r2, r1, #16
 4362 00c8 2A60     		str	r2, [r5, #0]
1635:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 4363              		.loc 1 1635 0
 4364 00ca 0D23     		movs	r3, #13
 4365 00cc 6B60     		str	r3, [r5, #4]
1636:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 4366              		.loc 1 1636 0
 4367 00ce C5F80880 		str	r8, [r5, #8]
1637:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 4368              		.loc 1 1637 0
 4369 00d2 EF60     		str	r7, [r5, #12]
1638:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 4370              		.loc 1 1638 0
 4371 00d4 2E61     		str	r6, [r5, #16]
1639:lib/ff/sdio_stm32f1.c **** 
 4372              		.loc 1 1639 0
 4373 00d6 2846     		mov	r0, r5
 4374              	.LVL551:
 4375 00d8 0093     		str	r3, [sp, #0]
 4376 00da FFF7FEFF 		bl	SDIO_SendCommand
 4377              	.LVL552:
1641:lib/ff/sdio_stm32f1.c **** 
 4378              		.loc 1 1641 0
 4379 00de 0098     		ldr	r0, [sp, #0]
 4380 00e0 FFF7FEFF 		bl	CmdResp1Error
 4381              	.LVL553:
1643:lib/ff/sdio_stm32f1.c ****   {
 4382              		.loc 1 1643 0
 4383 00e4 2A28     		cmp	r0, #42
 4384 00e6 40F04481 		bne	.L387
1648:lib/ff/sdio_stm32f1.c ****   {
 4385              		.loc 1 1648 0
 4386 00ea 0F99     		ldr	r1, [sp, #60]
 4387 00ec 0129     		cmp	r1, #1
 4388 00ee 40F22581 		bls	.L392
1651:lib/ff/sdio_stm32f1.c ****     {
 4389              		.loc 1 1651 0
 4390 00f2 4C43     		muls	r4, r1, r4
 4391              	.LVL554:
 4392 00f4 B4F1007F 		cmp	r4, #33554432
 4393 00f8 8FD2     		bcs	.L389
1657:lib/ff/sdio_stm32f1.c ****     {
 4394              		.loc 1 1657 0
 4395 00fa 7A4A     		ldr	r2, .L457+20
 4396 00fc 1368     		ldr	r3, [r2, #0]
 4397 00fe 022B     		cmp	r3, #2
 4398 0100 14D9     		bls	.L393
 4399              	.LVL555:
 4400              	.L395:
1691:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_WRITE_MULT_BLOCK;
 4401              		.loc 1 1691 0
 4402 0102 7948     		ldr	r0, .L457+24
 4403 0104 C0F800A0 		str	sl, [r0, #0]
1692:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 4404              		.loc 1 1692 0
 4405 0108 1927     		movs	r7, #25
 4406 010a 4760     		str	r7, [r0, #4]
1693:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 4407              		.loc 1 1693 0
 4408 010c 4026     		movs	r6, #64
 4409 010e 8660     		str	r6, [r0, #8]
1694:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 4410              		.loc 1 1694 0
 4411 0110 0026     		movs	r6, #0
 4412 0112 C660     		str	r6, [r0, #12]
1695:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
 4413              		.loc 1 1695 0
 4414 0114 4FF48063 		mov	r3, #1024
 4415 0118 0361     		str	r3, [r0, #16]
1696:lib/ff/sdio_stm32f1.c **** 
 4416              		.loc 1 1696 0
 4417 011a FFF7FEFF 		bl	SDIO_SendCommand
 4418              	.LVL556:
1698:lib/ff/sdio_stm32f1.c **** 
 4419              		.loc 1 1698 0
 4420 011e 3846     		mov	r0, r7
 4421 0120 FFF7FEFF 		bl	CmdResp1Error
 4422              	.LVL557:
1700:lib/ff/sdio_stm32f1.c ****     {
 4423              		.loc 1 1700 0
 4424 0124 2A28     		cmp	r0, #42
 4425 0126 40F02481 		bne	.L387
 4426 012a 28E0     		b	.L453
 4427              	.L393:
1660:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_CMD;
 4428              		.loc 1 1660 0
 4429 012c DBF80000 		ldr	r0, [fp, #0]
 4430              	.LVL558:
 4431 0130 0104     		lsls	r1, r0, #16
 4432 0132 2960     		str	r1, [r5, #0]
1661:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 4433              		.loc 1 1661 0
 4434 0134 4FF0370B 		mov	fp, #55
 4435 0138 C5F804B0 		str	fp, [r5, #4]
1662:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 4436              		.loc 1 1662 0
 4437 013c C5F80880 		str	r8, [r5, #8]
1663:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 4438              		.loc 1 1663 0
 4439 0140 EF60     		str	r7, [r5, #12]
1664:lib/ff/sdio_stm32f1.c ****       SDIO_SendCommand(&SDIO_CmdInitStructure);
 4440              		.loc 1 1664 0
 4441 0142 2E61     		str	r6, [r5, #16]
1665:lib/ff/sdio_stm32f1.c **** 
 4442              		.loc 1 1665 0
 4443 0144 2846     		mov	r0, r5
 4444 0146 FFF7FEFF 		bl	SDIO_SendCommand
 4445              	.LVL559:
1668:lib/ff/sdio_stm32f1.c **** 
 4446              		.loc 1 1668 0
 4447 014a 5846     		mov	r0, fp
 4448 014c FFF7FEFF 		bl	CmdResp1Error
 4449              	.LVL560:
1670:lib/ff/sdio_stm32f1.c ****       {
 4450              		.loc 1 1670 0
 4451 0150 2A28     		cmp	r0, #42
 4452 0152 40F00E81 		bne	.L387
1675:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SET_BLOCK_COUNT;
 4453              		.loc 1 1675 0
 4454 0156 0F9A     		ldr	r2, [sp, #60]
 4455 0158 2A60     		str	r2, [r5, #0]
1676:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 4456              		.loc 1 1676 0
 4457 015a 4FF0170B 		mov	fp, #23
 4458 015e C5F804B0 		str	fp, [r5, #4]
1677:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 4459              		.loc 1 1677 0
 4460 0162 C5F80880 		str	r8, [r5, #8]
1678:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 4461              		.loc 1 1678 0
 4462 0166 EF60     		str	r7, [r5, #12]
1679:lib/ff/sdio_stm32f1.c ****       SDIO_SendCommand(&SDIO_CmdInitStructure);
 4463              		.loc 1 1679 0
 4464 0168 2E61     		str	r6, [r5, #16]
1680:lib/ff/sdio_stm32f1.c **** 
 4465              		.loc 1 1680 0
 4466 016a 2846     		mov	r0, r5
 4467              	.LVL561:
 4468 016c FFF7FEFF 		bl	SDIO_SendCommand
 4469              	.LVL562:
1682:lib/ff/sdio_stm32f1.c **** 
 4470              		.loc 1 1682 0
 4471 0170 5846     		mov	r0, fp
 4472 0172 FFF7FEFF 		bl	CmdResp1Error
 4473              	.LVL563:
1684:lib/ff/sdio_stm32f1.c ****       {
 4474              		.loc 1 1684 0
 4475 0176 2A28     		cmp	r0, #42
 4476 0178 40F0FB80 		bne	.L387
 4477 017c C1E7     		b	.L395
 4478              	.L453:
1705:lib/ff/sdio_stm32f1.c ****     StopCondition = 1;
 4479              		.loc 1 1705 0
 4480 017e 564F     		ldr	r7, .L457+8
 4481 0180 3C60     		str	r4, [r7, #0]
1706:lib/ff/sdio_stm32f1.c ****     SrcBuffer = (uint32_t *)writebuff;
 4482              		.loc 1 1706 0
 4483 0182 0127     		movs	r7, #1
 4484 0184 5948     		ldr	r0, .L457+28
 4485              	.LVL564:
 4486 0186 0760     		str	r7, [r0, #0]
1707:lib/ff/sdio_stm32f1.c **** 
 4487              		.loc 1 1707 0
 4488 0188 5949     		ldr	r1, .L457+32
 4489 018a 019A     		ldr	r2, [sp, #4]
 4490 018c 0A60     		str	r2, [r1, #0]
1709:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_DataLength = NumberOfBlocks * BlockSize;
 4491              		.loc 1 1709 0
 4492 018e 5348     		ldr	r0, .L457+12
 4493 0190 534A     		ldr	r2, .L457+16
1710:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_DataBlockSize = (uint32_t) power << 4;
 4494              		.loc 1 1710 0
 4495 0192 80E81400 		stmia	r0, {r2, r4}
1711:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToCard;
 4496              		.loc 1 1711 0
 4497 0196 4FEA0913 		lsl	r3, r9, #4
 4498 019a 8360     		str	r3, [r0, #8]
1712:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
 4499              		.loc 1 1712 0
 4500 019c C660     		str	r6, [r0, #12]
1713:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Enable;
 4501              		.loc 1 1713 0
 4502 019e 0661     		str	r6, [r0, #16]
1714:lib/ff/sdio_stm32f1.c ****     SDIO_DataConfig(&SDIO_DataInitStructure);
 4503              		.loc 1 1714 0
 4504 01a0 4761     		str	r7, [r0, #20]
1715:lib/ff/sdio_stm32f1.c **** 
 4505              		.loc 1 1715 0
 4506 01a2 FFF7FEFF 		bl	SDIO_DataConfig
 4507              	.LVL565:
1717:lib/ff/sdio_stm32f1.c ****     {
 4508              		.loc 1 1717 0
 4509 01a6 5348     		ldr	r0, .L457+36
 4510 01a8 0168     		ldr	r1, [r0, #0]
 4511 01aa 0229     		cmp	r1, #2
 4512 01ac 40F08180 		bne	.L448
 4513 01b0 019D     		ldr	r5, [sp, #4]
 4514              	.LVL566:
 4515              	.L446:
1719:lib/ff/sdio_stm32f1.c ****       {
 4516              		.loc 1 1719 0 discriminator 1
 4517 01b2 514C     		ldr	r4, .L457+40
 4518 01b4 626B     		ldr	r2, [r4, #52]
 4519 01b6 40F21A34 		movw	r4, #794
 4520 01ba 1440     		ands	r4, r4, r2
 4521 01bc 002C     		cmp	r4, #0
 4522 01be 35D1     		bne	.L454
 4523              	.L407:
1721:lib/ff/sdio_stm32f1.c ****         {
 4524              		.loc 1 1721 0
 4525 01c0 4FF48040 		mov	r0, #16384
 4526 01c4 FFF7FEFF 		bl	SDIO_GetFlagStatus
 4527              	.LVL567:
 4528 01c8 0028     		cmp	r0, #0
 4529 01ca F2D0     		beq	.L446
1723:lib/ff/sdio_stm32f1.c ****           {
 4530              		.loc 1 1723 0
 4531 01cc 4249     		ldr	r1, .L457+8
 4532 01ce 0A68     		ldr	r2, [r1, #0]
 4533 01d0 901B     		subs	r0, r2, r6
 4534 01d2 1F28     		cmp	r0, #31
 4535 01d4 11D9     		bls	.L399
1725:lib/ff/sdio_stm32f1.c ****             {
 4536              		.loc 1 1725 0
 4537 01d6 0394     		str	r4, [sp, #12]
 4538              	.L400:
1725:lib/ff/sdio_stm32f1.c ****             {
 4539              		.loc 1 1725 0 is_stmt 0 discriminator 1
 4540 01d8 0399     		ldr	r1, [sp, #12]
 4541 01da 0729     		cmp	r1, #7
 4542 01dc 08D8     		bhi	.L455
 4543              	.L401:
1727:lib/ff/sdio_stm32f1.c ****             }
 4544              		.loc 1 1727 0 is_stmt 1 discriminator 2
 4545 01de 039A     		ldr	r2, [sp, #12]
 4546 01e0 55F82200 		ldr	r0, [r5, r2, lsl #2]
 4547 01e4 FFF7FEFF 		bl	SDIO_WriteData
 4548              	.LVL568:
1725:lib/ff/sdio_stm32f1.c ****             {
 4549              		.loc 1 1725 0 discriminator 2
 4550 01e8 039C     		ldr	r4, [sp, #12]
 4551 01ea 601C     		adds	r0, r4, #1
 4552              	.LVL569:
 4553 01ec 0390     		str	r0, [sp, #12]
 4554              	.LVL570:
 4555 01ee F3E7     		b	.L400
 4556              	.L455:
1729:lib/ff/sdio_stm32f1.c ****             bytestransferred += SD_HALFFIFOBYTES;
 4557              		.loc 1 1729 0
 4558 01f0 05F12004 		add	r4, r5, #32
 4559              	.LVL571:
1730:lib/ff/sdio_stm32f1.c ****           }
 4560              		.loc 1 1730 0
 4561 01f4 06F12001 		add	r1, r6, #32
 4562              	.LVL572:
 4563 01f8 15E0     		b	.L402
 4564              	.LVL573:
 4565              	.L399:
1734:lib/ff/sdio_stm32f1.c ****                         ((TotalNumberOfBytes - bytestransferred) / 4 + 1);
 4566              		.loc 1 1734 0
 4567 01fa 10F0030F 		tst	r0, #3
 4568 01fe 4FEA9007 		lsr	r7, r0, #2
 4569 0202 18BF     		it	ne
 4570 0204 0137     		addne	r7, r7, #1
 4571              	.LVL574:
1737:lib/ff/sdio_stm32f1.c ****             {
 4572              		.loc 1 1737 0
 4573 0206 0024     		movs	r4, #0
 4574 0208 0394     		str	r4, [sp, #12]
 4575 020a 2C46     		mov	r4, r5
 4576              	.LVL575:
 4577              	.L405:
1568:lib/ff/sdio_stm32f1.c **** {
 4578              		.loc 1 1568 0 discriminator 1
 4579 020c 731B     		subs	r3, r6, r5
 4580 020e E118     		adds	r1, r4, r3
1737:lib/ff/sdio_stm32f1.c ****             {
 4581              		.loc 1 1737 0 discriminator 1
 4582 0210 039A     		ldr	r2, [sp, #12]
 4583 0212 BA42     		cmp	r2, r7
 4584 0214 07D2     		bcs	.L402
 4585              	.L406:
1739:lib/ff/sdio_stm32f1.c ****             }
 4586              		.loc 1 1739 0 discriminator 2
 4587 0216 54F8040B 		ldr	r0, [r4], #4
 4588              	.LVL576:
 4589 021a FFF7FEFF 		bl	SDIO_WriteData
 4590              	.LVL577:
1737:lib/ff/sdio_stm32f1.c ****             {
 4591              		.loc 1 1737 0 discriminator 2
 4592 021e 0398     		ldr	r0, [sp, #12]
 4593 0220 431C     		adds	r3, r0, #1
 4594              	.LVL578:
 4595 0222 0393     		str	r3, [sp, #12]
 4596              	.LVL579:
 4597 0224 F2E7     		b	.L405
 4598              	.LVL580:
 4599              	.L402:
1717:lib/ff/sdio_stm32f1.c ****     {
 4600              		.loc 1 1717 0 discriminator 1
 4601 0226 2546     		mov	r5, r4
 4602 0228 0E46     		mov	r6, r1
 4603 022a C2E7     		b	.L446
 4604              	.LVL581:
 4605              	.L454:
1745:lib/ff/sdio_stm32f1.c ****       {
 4606              		.loc 1 1745 0
 4607 022c 0820     		movs	r0, #8
 4608 022e FFF7FEFF 		bl	SDIO_GetFlagStatus
 4609              	.LVL582:
 4610 0232 20B1     		cbz	r0, .L408
1747:lib/ff/sdio_stm32f1.c ****         errorstatus = SD_DATA_TIMEOUT;
 4611              		.loc 1 1747 0
 4612 0234 0820     		movs	r0, #8
 4613 0236 FFF7FEFF 		bl	SDIO_ClearFlag
 4614              	.LVL583:
1749:lib/ff/sdio_stm32f1.c ****       }
 4615              		.loc 1 1749 0
 4616 023a 0420     		movs	r0, #4
 4617 023c 99E0     		b	.L387
 4618              	.LVL584:
 4619              	.L408:
1751:lib/ff/sdio_stm32f1.c ****       {
 4620              		.loc 1 1751 0
 4621 023e 0220     		movs	r0, #2
 4622 0240 FFF7FEFF 		bl	SDIO_GetFlagStatus
 4623              	.LVL585:
 4624 0244 20B1     		cbz	r0, .L409
1753:lib/ff/sdio_stm32f1.c ****         errorstatus = SD_DATA_CRC_FAIL;
 4625              		.loc 1 1753 0
 4626 0246 0220     		movs	r0, #2
 4627 0248 FFF7FEFF 		bl	SDIO_ClearFlag
 4628              	.LVL586:
1755:lib/ff/sdio_stm32f1.c ****       }
 4629              		.loc 1 1755 0
 4630 024c 0220     		movs	r0, #2
 4631 024e 90E0     		b	.L387
 4632              	.LVL587:
 4633              	.L409:
1757:lib/ff/sdio_stm32f1.c ****       {
 4634              		.loc 1 1757 0
 4635 0250 1020     		movs	r0, #16
 4636 0252 FFF7FEFF 		bl	SDIO_GetFlagStatus
 4637              	.LVL588:
 4638 0256 20B1     		cbz	r0, .L410
1759:lib/ff/sdio_stm32f1.c ****         errorstatus = SD_TX_UNDERRUN;
 4639              		.loc 1 1759 0
 4640 0258 1020     		movs	r0, #16
 4641 025a FFF7FEFF 		bl	SDIO_ClearFlag
 4642              	.LVL589:
1761:lib/ff/sdio_stm32f1.c ****       }
 4643              		.loc 1 1761 0
 4644 025e 0520     		movs	r0, #5
 4645 0260 87E0     		b	.L387
 4646              	.LVL590:
 4647              	.L410:
1763:lib/ff/sdio_stm32f1.c ****       {
 4648              		.loc 1 1763 0
 4649 0262 4FF40070 		mov	r0, #512
 4650 0266 FFF7FEFF 		bl	SDIO_GetFlagStatus
 4651              	.LVL591:
 4652 026a 0446     		mov	r4, r0
 4653 026c 28B1     		cbz	r0, .L411
1765:lib/ff/sdio_stm32f1.c ****         errorstatus = SD_START_BIT_ERR;
 4654              		.loc 1 1765 0
 4655 026e 4FF40070 		mov	r0, #512
 4656 0272 FFF7FEFF 		bl	SDIO_ClearFlag
 4657              	.LVL592:
1767:lib/ff/sdio_stm32f1.c ****       }
 4658              		.loc 1 1767 0
 4659 0276 0720     		movs	r0, #7
 4660 0278 7BE0     		b	.L387
 4661              	.LVL593:
 4662              	.L411:
1770:lib/ff/sdio_stm32f1.c ****       {
 4663              		.loc 1 1770 0
 4664 027a 4FF48070 		mov	r0, #256
 4665 027e FFF7FEFF 		bl	SDIO_GetFlagStatus
 4666              	.LVL594:
 4667 0282 0028     		cmp	r0, #0
 4668 0284 5AD0     		beq	.L392
1772:lib/ff/sdio_stm32f1.c ****         {
 4669              		.loc 1 1772 0
 4670 0286 174B     		ldr	r3, .L457+20
 4671 0288 1868     		ldr	r0, [r3, #0]
 4672 028a 0228     		cmp	r0, #2
 4673 028c 56D8     		bhi	.L392
1775:lib/ff/sdio_stm32f1.c ****           SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_STOP_TRANSMISSION;
 4674              		.loc 1 1775 0
 4675 028e 1648     		ldr	r0, .L457+24
 4676 0290 0460     		str	r4, [r0, #0]
1776:lib/ff/sdio_stm32f1.c ****           SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 4677              		.loc 1 1776 0
 4678 0292 0C25     		movs	r5, #12
 4679              	.LVL595:
 4680 0294 4560     		str	r5, [r0, #4]
1777:lib/ff/sdio_stm32f1.c ****           SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 4681              		.loc 1 1777 0
 4682 0296 4021     		movs	r1, #64
 4683 0298 8160     		str	r1, [r0, #8]
1778:lib/ff/sdio_stm32f1.c ****           SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 4684              		.loc 1 1778 0
 4685 029a C460     		str	r4, [r0, #12]
1779:lib/ff/sdio_stm32f1.c ****           SDIO_SendCommand(&SDIO_CmdInitStructure);
 4686              		.loc 1 1779 0
 4687 029c 4FF48062 		mov	r2, #1024
 4688 02a0 0261     		str	r2, [r0, #16]
1780:lib/ff/sdio_stm32f1.c **** 
 4689              		.loc 1 1780 0
 4690 02a2 FFF7FEFF 		bl	SDIO_SendCommand
 4691              	.LVL596:
1783:lib/ff/sdio_stm32f1.c **** 
 4692              		.loc 1 1783 0
 4693 02a6 2846     		mov	r0, r5
 4694 02a8 FFF7FEFF 		bl	CmdResp1Error
 4695              	.LVL597:
1785:lib/ff/sdio_stm32f1.c ****           {
 4696              		.loc 1 1785 0
 4697 02ac 2A28     		cmp	r0, #42
 4698 02ae 60D1     		bne	.L387
 4699 02b0 44E0     		b	.L392
 4700              	.LVL598:
 4701              	.L448:
1792:lib/ff/sdio_stm32f1.c ****     {
 4702              		.loc 1 1792 0
 4703 02b2 0129     		cmp	r1, #1
 4704 02b4 24D1     		bne	.L412
1794:lib/ff/sdio_stm32f1.c ****       while ((TransferEnd == 0) && (TransferError == SD_OK))
 4705              		.loc 1 1794 0
 4706 02b6 44F21A30 		movw	r0, #17178
 4707 02ba FFF7FEFF 		bl	SDIO_ITConfig
 4708              	.LVL599:
 4709              	.L414:
1795:lib/ff/sdio_stm32f1.c ****       {}
 4710              		.loc 1 1795 0 discriminator 1
 4711 02be 0549     		ldr	r1, .L457+4
 4712 02c0 0A68     		ldr	r2, [r1, #0]
 4713 02c2 0349     		ldr	r1, .L457
 4714 02c4 002A     		cmp	r2, #0
 4715 02c6 33D1     		bne	.L415
1795:lib/ff/sdio_stm32f1.c ****       {}
 4716              		.loc 1 1795 0 is_stmt 0 discriminator 2
 4717 02c8 0B78     		ldrb	r3, [r1, #0]	@ zero_extendqisi2
 4718 02ca 2A2B     		cmp	r3, #42
 4719 02cc F7D0     		beq	.L414
 4720 02ce 2FE0     		b	.L415
 4721              	.L458:
 4722              		.align	2
 4723              	.L457:
 4724 02d0 00000000 		.word	.LANCHOR9
 4725 02d4 00000000 		.word	.LANCHOR10
 4726 02d8 00000000 		.word	.LANCHOR11
 4727 02dc 00000000 		.word	.LANCHOR2
 4728 02e0 FFFF0F00 		.word	1048575
 4729 02e4 00000000 		.word	.LANCHOR4
 4730 02e8 00000000 		.word	.LANCHOR0
 4731 02ec 00000000 		.word	.LANCHOR12
 4732 02f0 00000000 		.word	.LANCHOR14
 4733 02f4 00000000 		.word	.LANCHOR7
 4734 02f8 00800140 		.word	1073840128
 4735 02fc 00000000 		.word	.LANCHOR1
 4736              	.L412:
1802:lib/ff/sdio_stm32f1.c ****     {
 4737              		.loc 1 1802 0 is_stmt 1
 4738 0300 E1B9     		cbnz	r1, .L392
1804:lib/ff/sdio_stm32f1.c ****       SDIO_DMACmd(ENABLE);
 4739              		.loc 1 1804 0
 4740 0302 40F21A30 		movw	r0, #794
 4741 0306 3946     		mov	r1, r7
 4742 0308 FFF7FEFF 		bl	SDIO_ITConfig
 4743              	.LVL600:
1805:lib/ff/sdio_stm32f1.c ****       SD_LowLevel_DMA_TxConfig((uint32_t *)writebuff, (NumberOfBlocks * BlockSize));
 4744              		.loc 1 1805 0
 4745 030c 3846     		mov	r0, r7
 4746 030e FFF7FEFF 		bl	SDIO_DMACmd
 4747              	.LVL601:
1806:lib/ff/sdio_stm32f1.c ****       while ((SD_DMAEndOfTransferStatus() == RESET) && (TransferEnd == 0) && (TransferError == SD_O
 4748              		.loc 1 1806 0
 4749 0312 0198     		ldr	r0, [sp, #4]
 4750 0314 2146     		mov	r1, r4
 4751 0316 FFF7FEFF 		bl	SD_LowLevel_DMA_TxConfig
 4752              	.LVL602:
 4753              	.L416:
 4754              	.LBB70:
 4755              	.LBB71:
3138:lib/ff/sdio_stm32f1.c **** }
 4756              		.loc 1 3138 0 discriminator 1
 4757 031a 1748     		ldr	r0, .L459
 4758 031c FFF7FEFF 		bl	DMA_GetFlagStatus
 4759              	.LVL603:
 4760 0320 1649     		ldr	r1, .L459+4
 4761              	.LBE71:
 4762              	.LBE70:
1807:lib/ff/sdio_stm32f1.c ****       {}
 4763              		.loc 1 1807 0 discriminator 1
 4764 0322 28B9     		cbnz	r0, .L415
1807:lib/ff/sdio_stm32f1.c ****       {}
 4765              		.loc 1 1807 0 is_stmt 0 discriminator 2
 4766 0324 164A     		ldr	r2, .L459+8
 4767 0326 1368     		ldr	r3, [r2, #0]
 4768 0328 13B9     		cbnz	r3, .L415
1807:lib/ff/sdio_stm32f1.c ****       {}
 4769              		.loc 1 1807 0 discriminator 1
 4770 032a 0878     		ldrb	r0, [r1, #0]	@ zero_extendqisi2
 4771 032c 2A28     		cmp	r0, #42
 4772 032e F4D0     		beq	.L416
 4773              	.L415:
1809:lib/ff/sdio_stm32f1.c ****       {
 4774              		.loc 1 1809 0 is_stmt 1
 4775 0330 0878     		ldrb	r0, [r1, #0]	@ zero_extendqisi2
 4776 0332 2A28     		cmp	r0, #42
 4777 0334 02D0     		beq	.L392
1811:lib/ff/sdio_stm32f1.c ****       }
 4778              		.loc 1 1811 0
 4779 0336 1149     		ldr	r1, .L459+4
 4780 0338 0878     		ldrb	r0, [r1, #0]	@ zero_extendqisi2
 4781 033a 1AE0     		b	.L387
 4782              	.LVL604:
 4783              	.L392:
1816:lib/ff/sdio_stm32f1.c ****   
 4784              		.loc 1 1816 0
 4785 033c 40F2FF50 		movw	r0, #1535
 4786 0340 FFF7FEFF 		bl	SDIO_ClearFlag
 4787              	.LVL605:
1819:lib/ff/sdio_stm32f1.c ****   {
 4788              		.loc 1 1819 0
 4789 0344 0023     		movs	r3, #0
 4790              	.L449:
1819:lib/ff/sdio_stm32f1.c ****   {
 4791              		.loc 1 1819 0 is_stmt 0 discriminator 2
 4792 0346 0393     		str	r3, [sp, #12]
 4793 0348 0398     		ldr	r0, [sp, #12]
 4794 034a 4FF6FE73 		movw	r3, #65534
 4795 034e 9842     		cmp	r0, r3
 4796 0350 07D8     		bhi	.L420
 4797              	.L418:
 4798 0352 0398     		ldr	r0, [sp, #12]
 4799 0354 431C     		adds	r3, r0, #1
 4800              	.LVL606:
 4801 0356 F6E7     		b	.L449
 4802              	.LVL607:
 4803              	.L456:
1825:lib/ff/sdio_stm32f1.c ****   {
 4804              		.loc 1 1825 0 is_stmt 1 discriminator 2
 4805 0358 9DF80B10 		ldrb	r1, [sp, #11]	@ zero_extendqisi2
 4806              	.LVL608:
 4807 035c 8A1F     		subs	r2, r1, #6
 4808              	.LVL609:
 4809 035e 012A     		cmp	r2, #1
 4810 0360 07D8     		bhi	.L387
 4811              	.LVL610:
 4812              	.L420:
1827:lib/ff/sdio_stm32f1.c ****   }
 4813              		.loc 1 1827 0
 4814 0362 0DF10B00 		add	r0, sp, #11
 4815 0366 FFF7FEFF 		bl	IsCardProgramming
 4816              	.LVL611:
1825:lib/ff/sdio_stm32f1.c ****   {
 4817              		.loc 1 1825 0
 4818 036a 2A28     		cmp	r0, #42
 4819 036c F4D0     		beq	.L456
 4820 036e 00E0     		b	.L387
 4821              	.LVL612:
 4822              	.L421:
1599:lib/ff/sdio_stm32f1.c ****   }
 4823              		.loc 1 1599 0
 4824 0370 0E20     		movs	r0, #14
 4825              	.LVL613:
 4826              	.L387:
1831:lib/ff/sdio_stm32f1.c **** 
 4827              		.loc 1 1831 0
 4828 0372 05B0     		add	sp, sp, #20
 4829 0374 BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, sl, fp, pc}
 4830              	.L460:
 4831              		.align	2
 4832              	.L459:
 4833 0378 00200010 		.word	268443648
 4834 037c 00000000 		.word	.LANCHOR9
 4835 0380 00000000 		.word	.LANCHOR10
 4836              		.cfi_endproc
 4837              	.LFE71:
 4839              		.section	.text.SD_GetTransferState,"ax",%progbits
 4840              		.align	1
 4841              		.global	SD_GetTransferState
 4842              		.thumb
 4843              		.thumb_func
 4845              	SD_GetTransferState:
 4846              	.LFB72:
1845:lib/ff/sdio_stm32f1.c ****   if (SDIO->STA & (SDIO_FLAG_TXACT | SDIO_FLAG_RXACT))
 4847              		.loc 1 1845 0
 4848              		.cfi_startproc
 4849              		@ args = 0, pretend = 0, frame = 0
 4850              		@ frame_needed = 0, uses_anonymous_args = 0
 4851              		@ link register save eliminated.
1846:lib/ff/sdio_stm32f1.c ****   {
 4852              		.loc 1 1846 0
 4853 0000 034B     		ldr	r3, .L462
 4854 0002 586B     		ldr	r0, [r3, #52]
 4855 0004 10F4405F 		tst	r0, #12288
1854:lib/ff/sdio_stm32f1.c **** 
 4856              		.loc 1 1854 0
 4857 0008 0CBF     		ite	eq
 4858 000a 0020     		moveq	r0, #0
 4859 000c 0120     		movne	r0, #1
 4860 000e 7047     		bx	lr
 4861              	.L463:
 4862              		.align	2
 4863              	.L462:
 4864 0010 00800140 		.word	1073840128
 4865              		.cfi_endproc
 4866              	.LFE72:
 4868              		.section	.text.SD_StopTransfer,"ax",%progbits
 4869              		.align	1
 4870              		.global	SD_StopTransfer
 4871              		.thumb
 4872              		.thumb_func
 4874              	SD_StopTransfer:
 4875              	.LFB73:
1865:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
 4876              		.loc 1 1865 0
 4877              		.cfi_startproc
 4878              		@ args = 0, pretend = 0, frame = 0
 4879              		@ frame_needed = 0, uses_anonymous_args = 0
 4880 0000 10B5     		push	{r4, lr}
 4881              	.LCFI23:
 4882              		.cfi_def_cfa_offset 8
 4883              		.cfi_offset 4, -8
 4884              		.cfi_offset 14, -4
 4885              	.LVL614:
1869:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_STOP_TRANSMISSION;
 4886              		.loc 1 1869 0
 4887 0002 0948     		ldr	r0, .L465
1870:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 4888              		.loc 1 1870 0
 4889 0004 0022     		movs	r2, #0
 4890 0006 0C24     		movs	r4, #12
 4891 0008 80E81400 		stmia	r0, {r2, r4}
1871:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 4892              		.loc 1 1871 0
 4893 000c 4021     		movs	r1, #64
 4894 000e 8160     		str	r1, [r0, #8]
1872:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 4895              		.loc 1 1872 0
 4896 0010 C260     		str	r2, [r0, #12]
1873:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 4897              		.loc 1 1873 0
 4898 0012 4FF48062 		mov	r2, #1024
 4899 0016 0261     		str	r2, [r0, #16]
1874:lib/ff/sdio_stm32f1.c **** 
 4900              		.loc 1 1874 0
 4901 0018 FFF7FEFF 		bl	SDIO_SendCommand
 4902              	.LVL615:
1876:lib/ff/sdio_stm32f1.c **** 
 4903              		.loc 1 1876 0
 4904 001c 2046     		mov	r0, r4
1879:lib/ff/sdio_stm32f1.c **** 
 4905              		.loc 1 1879 0
 4906 001e BDE81040 		pop	{r4, lr}
1876:lib/ff/sdio_stm32f1.c **** 
 4907              		.loc 1 1876 0
 4908 0022 FFF7FEBF 		b	CmdResp1Error
 4909              	.LVL616:
 4910              	.L466:
 4911 0026 00BF     		.align	2
 4912              	.L465:
 4913 0028 00000000 		.word	.LANCHOR0
 4914              		.cfi_endproc
 4915              	.LFE73:
 4917              		.section	.text.SD_Erase,"ax",%progbits
 4918              		.align	1
 4919              		.global	SD_Erase
 4920              		.thumb
 4921              		.thumb_func
 4923              	SD_Erase:
 4924              	.LFB74:
1891:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
 4925              		.loc 1 1891 0
 4926              		.cfi_startproc
 4927              		@ args = 0, pretend = 0, frame = 8
 4928              		@ frame_needed = 0, uses_anonymous_args = 0
 4929              	.LVL617:
 4930 0000 2DE9F743 		push	{r0, r1, r2, r4, r5, r6, r7, r8, r9, lr}
 4931              	.LCFI24:
 4932              		.cfi_def_cfa_offset 40
 4933              		.cfi_offset 0, -40
 4934              		.cfi_offset 1, -36
 4935              		.cfi_offset 2, -32
 4936              		.cfi_offset 4, -28
 4937              		.cfi_offset 5, -24
 4938              		.cfi_offset 6, -20
 4939              		.cfi_offset 7, -16
 4940              		.cfi_offset 8, -12
 4941              		.cfi_offset 9, -8
 4942              		.cfi_offset 14, -4
 4943 0004 0546     		mov	r5, r0
 4944 0006 0C46     		mov	r4, r1
 4945 0008 1646     		mov	r6, r2
 4946 000a 1F46     		mov	r7, r3
 4947              	.LVL618:
1894:lib/ff/sdio_stm32f1.c ****   uint8_t cardstate = 0;
 4948              		.loc 1 1894 0
 4949 000c 0020     		movs	r0, #0
 4950              	.LVL619:
 4951 000e 0190     		str	r0, [sp, #4]
 4952              	.LVL620:
1895:lib/ff/sdio_stm32f1.c **** 
 4953              		.loc 1 1895 0
 4954 0010 8DF80300 		strb	r0, [sp, #3]
 4955              	.LVL621:
1898:lib/ff/sdio_stm32f1.c ****   {
 4956              		.loc 1 1898 0
 4957 0014 364B     		ldr	r3, .L479
 4958 0016 5968     		ldr	r1, [r3, #4]
 4959 0018 8A01     		lsls	r2, r1, #6
 4960              	.LVL622:
 4961 001a 63D5     		bpl	.L476
1904:lib/ff/sdio_stm32f1.c **** 
 4962              		.loc 1 1904 0
 4963 001c 354A     		ldr	r2, .L479+4
 4964 001e 5368     		ldr	r3, [r2, #4]
 4965 0020 D9B2     		uxtb	r1, r3
 4966 0022 8B1C     		adds	r3, r1, #2
 4967 0024 344A     		ldr	r2, .L479+8
 4968 0026 B2FBF3F1 		udiv	r1, r2, r3
 4969              	.LVL623:
 4970 002a 0191     		str	r1, [sp, #4]
 4971              	.LVL624:
1906:lib/ff/sdio_stm32f1.c ****   {
 4972              		.loc 1 1906 0
 4973 002c FFF7FEFF 		bl	SDIO_GetResponse
 4974              	.LVL625:
 4975 0030 8301     		lsls	r3, r0, #6
 4976 0032 59D4     		bmi	.L477
1912:lib/ff/sdio_stm32f1.c ****   {
 4977              		.loc 1 1912 0
 4978 0034 3148     		ldr	r0, .L479+12
 4979 0036 0368     		ldr	r3, [r0, #0]
 4980 0038 022B     		cmp	r3, #2
 4981 003a 06D1     		bne	.L469
1914:lib/ff/sdio_stm32f1.c ****     endaddr /= 512;
 4982              		.loc 1 1914 0
 4983 003c 6D0A     		lsrs	r5, r5, #9
 4984 003e 45EAC455 		orr	r5, r5, r4, lsl #23
 4985              	.LVL626:
1915:lib/ff/sdio_stm32f1.c ****   }
 4986              		.loc 1 1915 0
 4987 0042 760A     		lsrs	r6, r6, #9
 4988 0044 46EAC756 		orr	r6, r6, r7, lsl #23
 4989              	.LVL627:
 4990 0048 13E0     		b	.L470
 4991              	.LVL628:
 4992              	.L469:
1919:lib/ff/sdio_stm32f1.c ****   {
 4993              		.loc 1 1919 0
 4994 004a 12D9     		bls	.L470
 4995              	.LVL629:
 4996              	.L472:
1951:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_ERASE;
 4997              		.loc 1 1951 0
 4998 004c 2C48     		ldr	r0, .L479+16
1952:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 4999              		.loc 1 1952 0
 5000 004e 0024     		movs	r4, #0
 5001 0050 2625     		movs	r5, #38
 5002 0052 80E83000 		stmia	r0, {r4, r5}
1953:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 5003              		.loc 1 1953 0
 5004 0056 4022     		movs	r2, #64
 5005 0058 8260     		str	r2, [r0, #8]
1954:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 5006              		.loc 1 1954 0
 5007 005a C460     		str	r4, [r0, #12]
1955:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 5008              		.loc 1 1955 0
 5009 005c 4FF48061 		mov	r1, #1024
 5010 0060 0161     		str	r1, [r0, #16]
1956:lib/ff/sdio_stm32f1.c **** 
 5011              		.loc 1 1956 0
 5012 0062 FFF7FEFF 		bl	SDIO_SendCommand
 5013              	.LVL630:
1958:lib/ff/sdio_stm32f1.c **** 
 5014              		.loc 1 1958 0
 5015 0066 2846     		mov	r0, r5
 5016 0068 FFF7FEFF 		bl	CmdResp1Error
 5017              	.LVL631:
1960:lib/ff/sdio_stm32f1.c ****   {
 5018              		.loc 1 1960 0
 5019 006c 2A28     		cmp	r0, #42
 5020 006e 3CD1     		bne	.L468
 5021 0070 27E0     		b	.L471
 5022              	.LVL632:
 5023              	.L470:
1922:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SD_ERASE_GRP_START;
 5024              		.loc 1 1922 0
 5025 0072 234C     		ldr	r4, .L479+16
 5026 0074 2560     		str	r5, [r4, #0]
1923:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 5027              		.loc 1 1923 0
 5028 0076 2025     		movs	r5, #32
 5029 0078 6560     		str	r5, [r4, #4]
1924:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 5030              		.loc 1 1924 0
 5031 007a 4FF04009 		mov	r9, #64
 5032 007e C4F80890 		str	r9, [r4, #8]
1925:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 5033              		.loc 1 1925 0
 5034 0082 4FF00008 		mov	r8, #0
 5035 0086 C4F80C80 		str	r8, [r4, #12]
1926:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
 5036              		.loc 1 1926 0
 5037 008a 4FF48067 		mov	r7, #1024
 5038 008e 2761     		str	r7, [r4, #16]
1927:lib/ff/sdio_stm32f1.c **** 
 5039              		.loc 1 1927 0
 5040 0090 2046     		mov	r0, r4
 5041 0092 FFF7FEFF 		bl	SDIO_SendCommand
 5042              	.LVL633:
1929:lib/ff/sdio_stm32f1.c ****     if (errorstatus != SD_OK)
 5043              		.loc 1 1929 0
 5044 0096 2846     		mov	r0, r5
 5045 0098 FFF7FEFF 		bl	CmdResp1Error
 5046              	.LVL634:
1930:lib/ff/sdio_stm32f1.c ****     {
 5047              		.loc 1 1930 0
 5048 009c 2A28     		cmp	r0, #42
 5049 009e 24D1     		bne	.L468
1936:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SD_ERASE_GRP_END;
 5050              		.loc 1 1936 0
 5051 00a0 2660     		str	r6, [r4, #0]
1937:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 5052              		.loc 1 1937 0
 5053 00a2 2125     		movs	r5, #33
 5054 00a4 6560     		str	r5, [r4, #4]
1938:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 5055              		.loc 1 1938 0
 5056 00a6 C4F80890 		str	r9, [r4, #8]
1939:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 5057              		.loc 1 1939 0
 5058 00aa C4F80C80 		str	r8, [r4, #12]
1940:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
 5059              		.loc 1 1940 0
 5060 00ae 2761     		str	r7, [r4, #16]
1941:lib/ff/sdio_stm32f1.c **** 
 5061              		.loc 1 1941 0
 5062 00b0 2046     		mov	r0, r4
 5063              	.LVL635:
 5064 00b2 FFF7FEFF 		bl	SDIO_SendCommand
 5065              	.LVL636:
1943:lib/ff/sdio_stm32f1.c ****     if (errorstatus != SD_OK)
 5066              		.loc 1 1943 0
 5067 00b6 2846     		mov	r0, r5
 5068 00b8 FFF7FEFF 		bl	CmdResp1Error
 5069              	.LVL637:
1944:lib/ff/sdio_stm32f1.c ****     {
 5070              		.loc 1 1944 0
 5071 00bc 2A28     		cmp	r0, #42
 5072 00be 14D1     		bne	.L468
 5073 00c0 C4E7     		b	.L472
 5074              	.LVL638:
 5075              	.L471:
1965:lib/ff/sdio_stm32f1.c ****   {}
 5076              		.loc 1 1965 0 discriminator 1
 5077 00c2 0198     		ldr	r0, [sp, #4]
 5078 00c4 8442     		cmp	r4, r0
 5079 00c6 06D2     		bcs	.L475
 5080              	.L473:
1965:lib/ff/sdio_stm32f1.c ****   {}
 5081              		.loc 1 1965 0 is_stmt 0 discriminator 2
 5082 00c8 0134     		adds	r4, r4, #1
 5083              	.LVL639:
 5084 00ca FAE7     		b	.L471
 5085              	.LVL640:
 5086              	.L478:
1971:lib/ff/sdio_stm32f1.c ****   {
 5087              		.loc 1 1971 0 is_stmt 1 discriminator 2
 5088 00cc 9DF80330 		ldrb	r3, [sp, #3]	@ zero_extendqisi2
 5089              	.LVL641:
 5090 00d0 9A1F     		subs	r2, r3, #6
 5091              	.LVL642:
 5092 00d2 012A     		cmp	r2, #1
 5093 00d4 09D8     		bhi	.L468
 5094              	.LVL643:
 5095              	.L475:
1973:lib/ff/sdio_stm32f1.c ****   }
 5096              		.loc 1 1973 0
 5097 00d6 0DF10300 		add	r0, sp, #3
 5098 00da FFF7FEFF 		bl	IsCardProgramming
 5099              	.LVL644:
1971:lib/ff/sdio_stm32f1.c ****   {
 5100              		.loc 1 1971 0
 5101 00de 2A28     		cmp	r0, #42
 5102 00e0 F4D0     		beq	.L478
 5103 00e2 02E0     		b	.L468
 5104              	.LVL645:
 5105              	.L476:
1901:lib/ff/sdio_stm32f1.c ****   }
 5106              		.loc 1 1901 0
 5107 00e4 2520     		movs	r0, #37
 5108 00e6 00E0     		b	.L468
 5109              	.L477:
1909:lib/ff/sdio_stm32f1.c ****   }
 5110              		.loc 1 1909 0
 5111 00e8 0E20     		movs	r0, #14
 5112              	.LVL646:
 5113              	.L468:
1977:lib/ff/sdio_stm32f1.c **** 
 5114              		.loc 1 1977 0
 5115 00ea BDE8FE83 		pop	{r1, r2, r3, r4, r5, r6, r7, r8, r9, pc}
 5116              	.L480:
 5117 00ee 00BF     		.align	2
 5118              	.L479:
 5119 00f0 00000000 		.word	.LANCHOR6
 5120 00f4 00800140 		.word	1073840128
 5121 00f8 C0D40100 		.word	120000
 5122 00fc 00000000 		.word	.LANCHOR4
 5123 0100 00000000 		.word	.LANCHOR0
 5124              		.cfi_endproc
 5125              	.LFE74:
 5127              		.section	.text.SD_SendStatus,"ax",%progbits
 5128              		.align	1
 5129              		.global	SD_SendStatus
 5130              		.thumb
 5131              		.thumb_func
 5133              	SD_SendStatus:
 5134              	.LFB75:
1989:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
 5135              		.loc 1 1989 0
 5136              		.cfi_startproc
 5137              		@ args = 0, pretend = 0, frame = 0
 5138              		@ frame_needed = 0, uses_anonymous_args = 0
 5139              	.LVL647:
 5140 0000 70B5     		push	{r4, r5, r6, lr}
 5141              	.LCFI25:
 5142              		.cfi_def_cfa_offset 16
 5143              		.cfi_offset 4, -16
 5144              		.cfi_offset 5, -12
 5145              		.cfi_offset 6, -8
 5146              		.cfi_offset 14, -4
 5147              	.LVL648:
1992:lib/ff/sdio_stm32f1.c ****   {
 5148              		.loc 1 1992 0
 5149 0002 0546     		mov	r5, r0
 5150 0004 D0B1     		cbz	r0, .L483
1998:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SEND_STATUS;
 5151              		.loc 1 1998 0
 5152 0006 0F48     		ldr	r0, .L484
 5153              	.LVL649:
 5154 0008 0F4A     		ldr	r2, .L484+4
 5155 000a 1168     		ldr	r1, [r2, #0]
 5156 000c 0B04     		lsls	r3, r1, #16
 5157 000e 0360     		str	r3, [r0, #0]
1999:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 5158              		.loc 1 1999 0
 5159 0010 0D24     		movs	r4, #13
 5160 0012 4460     		str	r4, [r0, #4]
2000:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 5161              		.loc 1 2000 0
 5162 0014 4026     		movs	r6, #64
 5163 0016 8660     		str	r6, [r0, #8]
2001:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 5164              		.loc 1 2001 0
 5165 0018 0026     		movs	r6, #0
 5166 001a C660     		str	r6, [r0, #12]
2002:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 5167              		.loc 1 2002 0
 5168 001c 4FF48062 		mov	r2, #1024
 5169 0020 0261     		str	r2, [r0, #16]
2003:lib/ff/sdio_stm32f1.c **** 
 5170              		.loc 1 2003 0
 5171 0022 FFF7FEFF 		bl	SDIO_SendCommand
 5172              	.LVL650:
2006:lib/ff/sdio_stm32f1.c **** 
 5173              		.loc 1 2006 0
 5174 0026 2046     		mov	r0, r4
 5175 0028 FFF7FEFF 		bl	CmdResp1Error
 5176              	.LVL651:
 5177 002c 0446     		mov	r4, r0
 5178              	.LVL652:
2008:lib/ff/sdio_stm32f1.c ****   {
 5179              		.loc 1 2008 0
 5180 002e 2A28     		cmp	r0, #42
 5181 0030 05D1     		bne	.L482
2013:lib/ff/sdio_stm32f1.c **** 
 5182              		.loc 1 2013 0
 5183 0032 3046     		mov	r0, r6
 5184              	.LVL653:
 5185 0034 FFF7FEFF 		bl	SDIO_GetResponse
 5186              	.LVL654:
 5187 0038 2860     		str	r0, [r5, #0]
2015:lib/ff/sdio_stm32f1.c **** }
 5188              		.loc 1 2015 0
 5189 003a 00E0     		b	.L482
 5190              	.LVL655:
 5191              	.L483:
1995:lib/ff/sdio_stm32f1.c ****   }
 5192              		.loc 1 1995 0
 5193 003c 2624     		movs	r4, #38
 5194              	.LVL656:
 5195              	.L482:
2016:lib/ff/sdio_stm32f1.c **** 
 5196              		.loc 1 2016 0
 5197 003e 2046     		mov	r0, r4
 5198 0040 70BD     		pop	{r4, r5, r6, pc}
 5199              	.L485:
 5200 0042 00BF     		.align	2
 5201              	.L484:
 5202 0044 00000000 		.word	.LANCHOR0
 5203 0048 00000000 		.word	.LANCHOR1
 5204              		.cfi_endproc
 5205              	.LFE75:
 5207              		.section	.text.SD_GetState,"ax",%progbits
 5208              		.align	1
 5209              		.global	SD_GetState
 5210              		.thumb
 5211              		.thumb_func
 5213              	SD_GetState:
 5214              	.LFB59:
 313:lib/ff/sdio_stm32f1.c ****   uint32_t resp1 = 0;
 5215              		.loc 1 313 0
 5216              		.cfi_startproc
 5217              		@ args = 0, pretend = 0, frame = 8
 5218              		@ frame_needed = 0, uses_anonymous_args = 0
 5219 0000 07B5     		push	{r0, r1, r2, lr}
 5220              	.LCFI26:
 5221              		.cfi_def_cfa_offset 16
 5222              		.cfi_offset 0, -16
 5223              		.cfi_offset 1, -12
 5224              		.cfi_offset 2, -8
 5225              		.cfi_offset 14, -4
 314:lib/ff/sdio_stm32f1.c ****   
 5226              		.loc 1 314 0
 5227 0002 0023     		movs	r3, #0
 5228 0004 0193     		str	r3, [sp, #4]
 5229              	.LVL657:
 5230              	.LBB72:
 5231              	.LBB73:
 343:lib/ff/sdio_stm32f1.c **** 
 5232              		.loc 1 343 0
 5233 0006 0120     		movs	r0, #1
 5234 0008 8DF80300 		strb	r0, [sp, #3]
 5235              	.LVL658:
 353:lib/ff/sdio_stm32f1.c **** }
 5236              		.loc 1 353 0
 5237 000c 9DF80310 		ldrb	r1, [sp, #3]	@ zero_extendqisi2
 5238              	.LVL659:
 5239              	.LBE73:
 5240              	.LBE72:
 316:lib/ff/sdio_stm32f1.c ****   {
 5241              		.loc 1 316 0
 5242 0010 0129     		cmp	r1, #1
 5243 0012 01D0     		beq	.L487
 5244              	.L489:
 329:lib/ff/sdio_stm32f1.c ****   }
 5245              		.loc 1 329 0
 5246 0014 FF20     		movs	r0, #255
 5247 0016 07E0     		b	.L488
 5248              	.L487:
 318:lib/ff/sdio_stm32f1.c ****     {
 5249              		.loc 1 318 0
 5250 0018 01A8     		add	r0, sp, #4
 5251 001a FFF7FEFF 		bl	SD_SendStatus
 5252              	.LVL660:
 5253 001e 2A28     		cmp	r0, #42
 5254 0020 F8D1     		bne	.L489
 324:lib/ff/sdio_stm32f1.c ****     }
 5255              		.loc 1 324 0
 5256 0022 019A     		ldr	r2, [sp, #4]
 5257 0024 C2F34320 		ubfx	r0, r2, #9, #4
 5258              	.LVL661:
 5259              	.L488:
 331:lib/ff/sdio_stm32f1.c **** 
 5260              		.loc 1 331 0
 5261 0028 0EBD     		pop	{r1, r2, r3, pc}
 5262              		.cfi_endproc
 5263              	.LFE59:
 5265              		.section	.text.SD_GetStatus,"ax",%progbits
 5266              		.align	1
 5267              		.global	SD_GetStatus
 5268              		.thumb
 5269              		.thumb_func
 5271              	SD_GetStatus:
 5272              	.LFB58:
 285:lib/ff/sdio_stm32f1.c ****   SDCardState cardstate =  SD_CARD_TRANSFER;
 5273              		.loc 1 285 0
 5274              		.cfi_startproc
 5275              		@ args = 0, pretend = 0, frame = 0
 5276              		@ frame_needed = 0, uses_anonymous_args = 0
 5277 0000 08B5     		push	{r3, lr}
 5278              	.LCFI27:
 5279              		.cfi_def_cfa_offset 8
 5280              		.cfi_offset 3, -8
 5281              		.cfi_offset 14, -4
 5282              	.LVL662:
 288:lib/ff/sdio_stm32f1.c ****   
 5283              		.loc 1 288 0
 5284 0002 FFF7FEFF 		bl	SD_GetState
 5285              	.LVL663:
 290:lib/ff/sdio_stm32f1.c ****   {
 5286              		.loc 1 290 0
 5287 0006 0428     		cmp	r0, #4
 5288 0008 04D0     		beq	.L492
 296:lib/ff/sdio_stm32f1.c ****   }
 5289              		.loc 1 296 0
 5290 000a FF28     		cmp	r0, #255
 5291 000c 14BF     		ite	ne
 5292 000e 0120     		movne	r0, #1
 5293 0010 0220     		moveq	r0, #2
 5294              	.LVL664:
 5295 0012 08BD     		pop	{r3, pc}
 5296              	.LVL665:
 5297              	.L492:
 292:lib/ff/sdio_stm32f1.c ****   }
 5298              		.loc 1 292 0
 5299 0014 0020     		movs	r0, #0
 5300              	.LVL666:
 302:lib/ff/sdio_stm32f1.c **** 
 5301              		.loc 1 302 0
 5302 0016 08BD     		pop	{r3, pc}
 5303              		.cfi_endproc
 5304              	.LFE58:
 5306              		.section	.text.SD_SendSDStatus,"ax",%progbits
 5307              		.align	1
 5308              		.global	SD_SendSDStatus
 5309              		.thumb
 5310              		.thumb_func
 5312              	SD_SendSDStatus:
 5313              	.LFB76:
2028:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
 5314              		.loc 1 2028 0
 5315              		.cfi_startproc
 5316              		@ args = 0, pretend = 0, frame = 0
 5317              		@ frame_needed = 0, uses_anonymous_args = 0
 5318              	.LVL667:
 5319 0000 2DE9F843 		push	{r3, r4, r5, r6, r7, r8, r9, lr}
 5320              	.LCFI28:
 5321              		.cfi_def_cfa_offset 32
 5322              		.cfi_offset 3, -32
 5323              		.cfi_offset 4, -28
 5324              		.cfi_offset 5, -24
 5325              		.cfi_offset 6, -20
 5326              		.cfi_offset 7, -16
 5327              		.cfi_offset 8, -12
 5328              		.cfi_offset 9, -8
 5329              		.cfi_offset 14, -4
 5330 0004 0646     		mov	r6, r0
 5331              	.LVL668:
2032:lib/ff/sdio_stm32f1.c ****   {
 5332              		.loc 1 2032 0
 5333 0006 0020     		movs	r0, #0
 5334              	.LVL669:
 5335 0008 FFF7FEFF 		bl	SDIO_GetResponse
 5336              	.LVL670:
 5337 000c 10F00077 		ands	r7, r0, #33554432
 5338 0010 40F09B80 		bne	.L507
2039:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SET_BLOCKLEN;
 5339              		.loc 1 2039 0
 5340 0014 4F4C     		ldr	r4, .L519
 5341 0016 4FF04008 		mov	r8, #64
 5342 001a C4F80080 		str	r8, [r4, #0]
2040:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 5343              		.loc 1 2040 0
 5344 001e 1025     		movs	r5, #16
 5345 0020 6560     		str	r5, [r4, #4]
2041:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 5346              		.loc 1 2041 0
 5347 0022 C4F80880 		str	r8, [r4, #8]
2042:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 5348              		.loc 1 2042 0
 5349 0026 E760     		str	r7, [r4, #12]
2043:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 5350              		.loc 1 2043 0
 5351 0028 4FF48069 		mov	r9, #1024
 5352 002c C4F81090 		str	r9, [r4, #16]
2044:lib/ff/sdio_stm32f1.c **** 
 5353              		.loc 1 2044 0
 5354 0030 2046     		mov	r0, r4
 5355 0032 FFF7FEFF 		bl	SDIO_SendCommand
 5356              	.LVL671:
2046:lib/ff/sdio_stm32f1.c **** 
 5357              		.loc 1 2046 0
 5358 0036 2846     		mov	r0, r5
 5359 0038 FFF7FEFF 		bl	CmdResp1Error
 5360              	.LVL672:
 5361 003c 0546     		mov	r5, r0
 5362              	.LVL673:
2048:lib/ff/sdio_stm32f1.c ****   {
 5363              		.loc 1 2048 0
 5364 003e 2A28     		cmp	r0, #42
 5365 0040 40F08480 		bne	.L495
2054:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_CMD;
 5366              		.loc 1 2054 0
 5367 0044 444B     		ldr	r3, .L519+4
 5368 0046 1868     		ldr	r0, [r3, #0]
 5369              	.LVL674:
 5370 0048 0104     		lsls	r1, r0, #16
 5371 004a 2160     		str	r1, [r4, #0]
2055:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 5372              		.loc 1 2055 0
 5373 004c 3725     		movs	r5, #55
 5374              	.LVL675:
 5375 004e 6560     		str	r5, [r4, #4]
2056:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 5376              		.loc 1 2056 0
 5377 0050 C4F80880 		str	r8, [r4, #8]
2057:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 5378              		.loc 1 2057 0
 5379 0054 E760     		str	r7, [r4, #12]
2058:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 5380              		.loc 1 2058 0
 5381 0056 C4F81090 		str	r9, [r4, #16]
2059:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_APP_CMD);
 5382              		.loc 1 2059 0
 5383 005a 2046     		mov	r0, r4
 5384 005c FFF7FEFF 		bl	SDIO_SendCommand
 5385              	.LVL676:
2060:lib/ff/sdio_stm32f1.c **** 
 5386              		.loc 1 2060 0
 5387 0060 2846     		mov	r0, r5
 5388 0062 FFF7FEFF 		bl	CmdResp1Error
 5389              	.LVL677:
 5390 0066 0546     		mov	r5, r0
 5391              	.LVL678:
2062:lib/ff/sdio_stm32f1.c ****   {
 5392              		.loc 1 2062 0
 5393 0068 2A28     		cmp	r0, #42
 5394 006a 6FD1     		bne	.L495
2067:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataLength = 64;
 5395              		.loc 1 2067 0
 5396 006c 3B48     		ldr	r0, .L519+8
 5397              	.LVL679:
 5398 006e 3C4B     		ldr	r3, .L519+12
2068:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataBlockSize = SDIO_DataBlockSize_64b;
 5399              		.loc 1 2068 0
 5400 0070 80E80801 		stmia	r0, {r3, r8}
2069:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToSDIO;
 5401              		.loc 1 2069 0
 5402 0074 6022     		movs	r2, #96
 5403 0076 8260     		str	r2, [r0, #8]
2070:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
 5404              		.loc 1 2070 0
 5405 0078 0223     		movs	r3, #2
 5406 007a C360     		str	r3, [r0, #12]
2071:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Enable;
 5407              		.loc 1 2071 0
 5408 007c 0761     		str	r7, [r0, #16]
2072:lib/ff/sdio_stm32f1.c ****   SDIO_DataConfig(&SDIO_DataInitStructure);
 5409              		.loc 1 2072 0
 5410 007e 0121     		movs	r1, #1
 5411 0080 4161     		str	r1, [r0, #20]
2073:lib/ff/sdio_stm32f1.c **** 
 5412              		.loc 1 2073 0
 5413 0082 FFF7FEFF 		bl	SDIO_DataConfig
 5414              	.LVL680:
2076:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SD_APP_STAUS;
 5415              		.loc 1 2076 0
 5416 0086 2760     		str	r7, [r4, #0]
2077:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 5417              		.loc 1 2077 0
 5418 0088 0D25     		movs	r5, #13
 5419              	.LVL681:
 5420 008a 6560     		str	r5, [r4, #4]
2078:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 5421              		.loc 1 2078 0
 5422 008c C4F80880 		str	r8, [r4, #8]
2079:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 5423              		.loc 1 2079 0
 5424 0090 E760     		str	r7, [r4, #12]
2080:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 5425              		.loc 1 2080 0
 5426 0092 C4F81090 		str	r9, [r4, #16]
2081:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_SD_APP_STAUS);
 5427              		.loc 1 2081 0
 5428 0096 2046     		mov	r0, r4
 5429 0098 FFF7FEFF 		bl	SDIO_SendCommand
 5430              	.LVL682:
2082:lib/ff/sdio_stm32f1.c **** 
 5431              		.loc 1 2082 0
 5432 009c 2846     		mov	r0, r5
 5433 009e FFF7FEFF 		bl	CmdResp1Error
 5434              	.LVL683:
 5435 00a2 0546     		mov	r5, r0
 5436              	.LVL684:
2084:lib/ff/sdio_stm32f1.c ****   {
 5437              		.loc 1 2084 0
 5438 00a4 2A28     		cmp	r0, #42
 5439 00a6 51D1     		bne	.L495
 5440              	.LVL685:
 5441              	.L515:
2089:lib/ff/sdio_stm32f1.c ****   {
 5442              		.loc 1 2089 0 discriminator 1
 5443 00a8 2E4C     		ldr	r4, .L519+16
 5444 00aa 606B     		ldr	r0, [r4, #52]
 5445 00ac 40F22A64 		movw	r4, #1578
 5446 00b0 0440     		ands	r4, r4, r0
 5447 00b2 6CB9     		cbnz	r4, .L517
 5448              	.L499:
2091:lib/ff/sdio_stm32f1.c ****     {
 5449              		.loc 1 2091 0
 5450 00b4 4FF40040 		mov	r0, #32768
 5451 00b8 FFF7FEFF 		bl	SDIO_GetFlagStatus
 5452              	.LVL686:
 5453 00bc 0028     		cmp	r0, #0
 5454 00be F3D0     		beq	.L515
 5455              	.L498:
2095:lib/ff/sdio_stm32f1.c ****       }
 5456              		.loc 1 2095 0 discriminator 2
 5457 00c0 FFF7FEFF 		bl	SDIO_ReadData
 5458              	.LVL687:
 5459 00c4 3051     		str	r0, [r6, r4]
 5460 00c6 0434     		adds	r4, r4, #4
2093:lib/ff/sdio_stm32f1.c ****       {
 5461              		.loc 1 2093 0 discriminator 2
 5462 00c8 202C     		cmp	r4, #32
 5463 00ca F9D1     		bne	.L498
2097:lib/ff/sdio_stm32f1.c ****     }
 5464              		.loc 1 2097 0
 5465 00cc 2036     		adds	r6, r6, #32
 5466              	.LVL688:
 5467 00ce EBE7     		b	.L515
 5468              	.L517:
2101:lib/ff/sdio_stm32f1.c ****   {
 5469              		.loc 1 2101 0
 5470 00d0 0820     		movs	r0, #8
 5471 00d2 FFF7FEFF 		bl	SDIO_GetFlagStatus
 5472              	.LVL689:
 5473 00d6 20B1     		cbz	r0, .L500
2103:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_DATA_TIMEOUT;
 5474              		.loc 1 2103 0
 5475 00d8 0820     		movs	r0, #8
 5476 00da FFF7FEFF 		bl	SDIO_ClearFlag
 5477              	.LVL690:
2105:lib/ff/sdio_stm32f1.c ****   }
 5478              		.loc 1 2105 0
 5479 00de 0425     		movs	r5, #4
 5480 00e0 34E0     		b	.L495
 5481              	.LVL691:
 5482              	.L500:
2107:lib/ff/sdio_stm32f1.c ****   {
 5483              		.loc 1 2107 0
 5484 00e2 0220     		movs	r0, #2
 5485 00e4 FFF7FEFF 		bl	SDIO_GetFlagStatus
 5486              	.LVL692:
 5487 00e8 20B1     		cbz	r0, .L501
2109:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_DATA_CRC_FAIL;
 5488              		.loc 1 2109 0
 5489 00ea 0220     		movs	r0, #2
 5490 00ec FFF7FEFF 		bl	SDIO_ClearFlag
 5491              	.LVL693:
2111:lib/ff/sdio_stm32f1.c ****   }
 5492              		.loc 1 2111 0
 5493 00f0 0225     		movs	r5, #2
 5494 00f2 2BE0     		b	.L495
 5495              	.LVL694:
 5496              	.L501:
2113:lib/ff/sdio_stm32f1.c ****   {
 5497              		.loc 1 2113 0
 5498 00f4 2020     		movs	r0, #32
 5499 00f6 FFF7FEFF 		bl	SDIO_GetFlagStatus
 5500              	.LVL695:
 5501 00fa 20B1     		cbz	r0, .L502
2115:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_RX_OVERRUN;
 5502              		.loc 1 2115 0
 5503 00fc 2020     		movs	r0, #32
 5504 00fe FFF7FEFF 		bl	SDIO_ClearFlag
 5505              	.LVL696:
2117:lib/ff/sdio_stm32f1.c ****   }
 5506              		.loc 1 2117 0
 5507 0102 0625     		movs	r5, #6
 5508 0104 22E0     		b	.L495
 5509              	.LVL697:
 5510              	.L502:
2119:lib/ff/sdio_stm32f1.c ****   {
 5511              		.loc 1 2119 0
 5512 0106 4FF40070 		mov	r0, #512
 5513 010a FFF7FEFF 		bl	SDIO_GetFlagStatus
 5514              	.LVL698:
 5515 010e 28B1     		cbz	r0, .L516
2121:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_START_BIT_ERR;
 5516              		.loc 1 2121 0
 5517 0110 4FF40070 		mov	r0, #512
 5518 0114 FFF7FEFF 		bl	SDIO_ClearFlag
 5519              	.LVL699:
2123:lib/ff/sdio_stm32f1.c ****   }
 5520              		.loc 1 2123 0
 5521 0118 0725     		movs	r5, #7
 5522 011a 17E0     		b	.L495
 5523              	.LVL700:
 5524              	.L516:
2126:lib/ff/sdio_stm32f1.c ****   {
 5525              		.loc 1 2126 0 discriminator 1
 5526 011c 4FF40010 		mov	r0, #2097152
 5527 0120 FFF7FEFF 		bl	SDIO_GetFlagStatus
 5528              	.LVL701:
 5529 0124 20B1     		cbz	r0, .L518
 5530              	.L505:
2128:lib/ff/sdio_stm32f1.c ****     psdstatus++;
 5531              		.loc 1 2128 0
 5532 0126 FFF7FEFF 		bl	SDIO_ReadData
 5533              	.LVL702:
 5534 012a 46F8040B 		str	r0, [r6], #4
 5535              	.LVL703:
 5536 012e F5E7     		b	.L516
 5537              	.LVL704:
 5538              	.L518:
2133:lib/ff/sdio_stm32f1.c ****   psdstatus -= 16;
 5539              		.loc 1 2133 0
 5540 0130 40F2FF50 		movw	r0, #1535
 5541 0134 FFF7FEFF 		bl	SDIO_ClearFlag
 5542              	.LVL705:
2134:lib/ff/sdio_stm32f1.c ****   for (count = 0; count < 16; count++)
 5543              		.loc 1 2134 0
 5544 0138 A6F14003 		sub	r3, r6, #64
 5545              	.LVL706:
 5546              	.L506:
2137:lib/ff/sdio_stm32f1.c ****                        ((psdstatus[count] & SD_16TO23BITS) >> 8) |((psdstatus[count] & SD_24TO31BIT
 5547              		.loc 1 2137 0 discriminator 2
 5548 013c 1A68     		ldr	r2, [r3, #0]
 5549 013e 11BA     		rev	r1, r2
 5550 0140 43F8041B 		str	r1, [r3], #4
2135:lib/ff/sdio_stm32f1.c ****   {
 5551              		.loc 1 2135 0 discriminator 2
 5552 0144 B342     		cmp	r3, r6
 5553 0146 F9D1     		bne	.L506
 5554 0148 00E0     		b	.L495
 5555              	.LVL707:
 5556              	.L507:
2035:lib/ff/sdio_stm32f1.c ****   }
 5557              		.loc 1 2035 0
 5558 014a 0E25     		movs	r5, #14
 5559              	.LVL708:
 5560              	.L495:
2141:lib/ff/sdio_stm32f1.c **** 
 5561              		.loc 1 2141 0
 5562 014c 2846     		mov	r0, r5
 5563 014e BDE8F883 		pop	{r3, r4, r5, r6, r7, r8, r9, pc}
 5564              	.L520:
 5565 0152 00BF     		.align	2
 5566              	.L519:
 5567 0154 00000000 		.word	.LANCHOR0
 5568 0158 00000000 		.word	.LANCHOR1
 5569 015c 00000000 		.word	.LANCHOR2
 5570 0160 FFFF0F00 		.word	1048575
 5571 0164 00800140 		.word	1073840128
 5572              		.cfi_endproc
 5573              	.LFE76:
 5575              		.section	.text.SD_ProcessIRQSrc,"ax",%progbits
 5576              		.align	1
 5577              		.global	SD_ProcessIRQSrc
 5578              		.thumb
 5579              		.thumb_func
 5581              	SD_ProcessIRQSrc:
 5582              	.LFB77:
2152:lib/ff/sdio_stm32f1.c ****   uint32_t count = 0, restwords = 0;
 5583              		.loc 1 2152 0
 5584              		.cfi_startproc
 5585              		@ args = 0, pretend = 0, frame = 0
 5586              		@ frame_needed = 0, uses_anonymous_args = 0
 5587 0000 70B5     		push	{r4, r5, r6, lr}
 5588              	.LCFI29:
 5589              		.cfi_def_cfa_offset 16
 5590              		.cfi_offset 4, -16
 5591              		.cfi_offset 5, -12
 5592              		.cfi_offset 6, -8
 5593              		.cfi_offset 14, -4
 5594              	.LVL709:
2155:lib/ff/sdio_stm32f1.c ****   {
 5595              		.loc 1 2155 0
 5596 0002 724B     		ldr	r3, .L559
 5597 0004 1868     		ldr	r0, [r3, #0]
 5598 0006 0128     		cmp	r0, #1
 5599 0008 47D1     		bne	.L523
2157:lib/ff/sdio_stm32f1.c ****     {
 5600              		.loc 1 2157 0
 5601 000a 4FF40040 		mov	r0, #32768
 5602 000e FFF7FEFF 		bl	SDIO_GetITStatus
 5603              	.LVL710:
 5604 0012 0446     		mov	r4, r0
 5605 0014 48B1     		cbz	r0, .L524
 5606 0016 0024     		movs	r4, #0
 5607              	.LVL711:
 5608              	.L525:
2161:lib/ff/sdio_stm32f1.c ****       }
 5609              		.loc 1 2161 0 discriminator 2
 5610 0018 6D4D     		ldr	r5, .L559+4
 5611 001a 2E68     		ldr	r6, [r5, #0]
 5612 001c FFF7FEFF 		bl	SDIO_ReadData
 5613              	.LVL712:
 5614 0020 3051     		str	r0, [r6, r4]
 5615 0022 0434     		adds	r4, r4, #4
2159:lib/ff/sdio_stm32f1.c ****       {
 5616              		.loc 1 2159 0 discriminator 2
 5617 0024 202C     		cmp	r4, #32
 5618 0026 F7D1     		bne	.L525
 5619 0028 30E0     		b	.L556
 5620              	.LVL713:
 5621              	.L524:
2166:lib/ff/sdio_stm32f1.c ****     {
 5622              		.loc 1 2166 0
 5623 002a 4FF48040 		mov	r0, #16384
 5624 002e FFF7FEFF 		bl	SDIO_GetITStatus
 5625              	.LVL714:
 5626 0032 0028     		cmp	r0, #0
 5627 0034 31D0     		beq	.L523
2168:lib/ff/sdio_stm32f1.c ****       {
 5628              		.loc 1 2168 0
 5629 0036 6749     		ldr	r1, .L559+8
 5630 0038 0B68     		ldr	r3, [r1, #0]
 5631 003a 674A     		ldr	r2, .L559+12
 5632 003c 1068     		ldr	r0, [r2, #0]
 5633 003e 191A     		subs	r1, r3, r0
 5634 0040 1F29     		cmp	r1, #31
 5635 0042 1BD8     		bhi	.L527
2170:lib/ff/sdio_stm32f1.c ****                     ((TotalNumberOfBytes - NumberOfBytes) / 4) :
 5636              		.loc 1 2170 0
 5637 0044 1668     		ldr	r6, [r2, #0]
 5638 0046 981B     		subs	r0, r3, r6
2171:lib/ff/sdio_stm32f1.c ****                     ((TotalNumberOfBytes - NumberOfBytes) / 4 + 1);
 5639              		.loc 1 2171 0
 5640 0048 1268     		ldr	r2, [r2, #0]
 5641 004a 8107     		lsls	r1, r0, #30
 5642 004c 02D1     		bne	.L528
2171:lib/ff/sdio_stm32f1.c ****                     ((TotalNumberOfBytes - NumberOfBytes) / 4 + 1);
 5643              		.loc 1 2171 0 is_stmt 0 discriminator 1
 5644 004e 9C1A     		subs	r4, r3, r2
 5645 0050 A608     		lsrs	r6, r4, #2
 5646 0052 02E0     		b	.L529
 5647              	.L528:
2172:lib/ff/sdio_stm32f1.c **** 
 5648              		.loc 1 2172 0 is_stmt 1 discriminator 2
 5649 0054 991A     		subs	r1, r3, r2
 5650 0056 8B08     		lsrs	r3, r1, #2
2171:lib/ff/sdio_stm32f1.c ****                     ((TotalNumberOfBytes - NumberOfBytes) / 4 + 1);
 5651              		.loc 1 2171 0 discriminator 2
 5652 0058 5E1C     		adds	r6, r3, #1
 5653              	.L529:
 5654              	.LVL715:
2174:lib/ff/sdio_stm32f1.c ****         {
 5655              		.loc 1 2174 0
 5656 005a 0024     		movs	r4, #0
 5657              	.LVL716:
 5658              	.L530:
2174:lib/ff/sdio_stm32f1.c ****         {
 5659              		.loc 1 2174 0 is_stmt 0 discriminator 1
 5660 005c B442     		cmp	r4, r6
 5661 005e 1CD0     		beq	.L523
 5662              	.L531:
2176:lib/ff/sdio_stm32f1.c ****         }
 5663              		.loc 1 2176 0 is_stmt 1 discriminator 2
 5664 0060 5E4D     		ldr	r5, .L559+16
 5665 0062 2868     		ldr	r0, [r5, #0]
 5666 0064 0068     		ldr	r0, [r0, #0]
 5667 0066 FFF7FEFF 		bl	SDIO_WriteData
 5668              	.LVL717:
2174:lib/ff/sdio_stm32f1.c ****         {
 5669              		.loc 1 2174 0 discriminator 2
 5670 006a 0134     		adds	r4, r4, #1
 5671              	.LVL718:
 5672 006c 2A68     		ldr	r2, [r5, #0]
 5673 006e 111D     		adds	r1, r2, #4
 5674 0070 2960     		str	r1, [r5, #0]
 5675 0072 594B     		ldr	r3, .L559+12
 5676 0074 1868     		ldr	r0, [r3, #0]
 5677 0076 021D     		adds	r2, r0, #4
 5678 0078 1A60     		str	r2, [r3, #0]
 5679 007a EFE7     		b	.L530
 5680              	.LVL719:
 5681              	.L527:
2183:lib/ff/sdio_stm32f1.c ****         }
 5682              		.loc 1 2183 0 discriminator 2
 5683 007c 574D     		ldr	r5, .L559+16
 5684 007e 2B68     		ldr	r3, [r5, #0]
 5685 0080 1859     		ldr	r0, [r3, r4]
 5686 0082 FFF7FEFF 		bl	SDIO_WriteData
 5687              	.LVL720:
 5688 0086 0434     		adds	r4, r4, #4
2181:lib/ff/sdio_stm32f1.c ****         {
 5689              		.loc 1 2181 0 discriminator 2
 5690 0088 202C     		cmp	r4, #32
 5691 008a F7D1     		bne	.L527
 5692              	.L556:
2186:lib/ff/sdio_stm32f1.c ****         NumberOfBytes += SD_HALFFIFOBYTES;
 5693              		.loc 1 2186 0
 5694 008c 2968     		ldr	r1, [r5, #0]
 5695 008e 2031     		adds	r1, r1, #32
 5696 0090 2960     		str	r1, [r5, #0]
2187:lib/ff/sdio_stm32f1.c ****       }
 5697              		.loc 1 2187 0
 5698 0092 514B     		ldr	r3, .L559+12
 5699 0094 1868     		ldr	r0, [r3, #0]
 5700 0096 2030     		adds	r0, r0, #32
 5701 0098 1860     		str	r0, [r3, #0]
 5702              	.LVL721:
 5703              	.L523:
2192:lib/ff/sdio_stm32f1.c ****   {
 5704              		.loc 1 2192 0
 5705 009a 4FF48070 		mov	r0, #256
 5706 009e FFF7FEFF 		bl	SDIO_GetITStatus
 5707              	.LVL722:
 5708 00a2 0446     		mov	r4, r0
 5709 00a4 0028     		cmp	r0, #0
 5710 00a6 37D0     		beq	.L532
2194:lib/ff/sdio_stm32f1.c ****     {
 5711              		.loc 1 2194 0
 5712 00a8 484C     		ldr	r4, .L559
 5713 00aa 2368     		ldr	r3, [r4, #0]
 5714 00ac CBB9     		cbnz	r3, .L552
 5715              	.L536:
2204:lib/ff/sdio_stm32f1.c ****     {
 5716              		.loc 1 2204 0
 5717 00ae 4C4B     		ldr	r3, .L559+20
 5718 00b0 1C68     		ldr	r4, [r3, #0]
 5719 00b2 012C     		cmp	r4, #1
 5720 00b4 4B4C     		ldr	r4, .L559+24
 5721 00b6 1BD1     		bne	.L555
2206:lib/ff/sdio_stm32f1.c ****     }
 5722              		.loc 1 2206 0
 5723 00b8 FFF7FEFF 		bl	SD_StopTransfer
 5724              	.LVL723:
 5725 00bc 2070     		strb	r0, [r4, #0]
 5726 00be 19E0     		b	.L538
 5727              	.L558:
2196:lib/ff/sdio_stm32f1.c ****       {
 5728              		.loc 1 2196 0 discriminator 2
 5729 00c0 454C     		ldr	r4, .L559+12
 5730 00c2 2068     		ldr	r0, [r4, #0]
 5731 00c4 434A     		ldr	r2, .L559+8
 5732 00c6 1168     		ldr	r1, [r2, #0]
 5733 00c8 8842     		cmp	r0, r1
 5734 00ca F0D2     		bcs	.L536
 5735              	.L537:
2198:lib/ff/sdio_stm32f1.c ****         DestBuffer++;
 5736              		.loc 1 2198 0
 5737 00cc 404D     		ldr	r5, .L559+4
 5738 00ce 2E68     		ldr	r6, [r5, #0]
 5739 00d0 FFF7FEFF 		bl	SDIO_ReadData
 5740              	.LVL724:
 5741 00d4 3060     		str	r0, [r6, #0]
2199:lib/ff/sdio_stm32f1.c ****         NumberOfBytes += 4;
 5742              		.loc 1 2199 0
 5743 00d6 2968     		ldr	r1, [r5, #0]
 5744 00d8 081D     		adds	r0, r1, #4
 5745 00da 2860     		str	r0, [r5, #0]
2200:lib/ff/sdio_stm32f1.c ****       }
 5746              		.loc 1 2200 0
 5747 00dc 2368     		ldr	r3, [r4, #0]
 5748 00de 1A1D     		adds	r2, r3, #4
 5749 00e0 2260     		str	r2, [r4, #0]
 5750              	.L552:
2196:lib/ff/sdio_stm32f1.c ****       {
 5751              		.loc 1 2196 0 discriminator 1
 5752 00e2 4FF40010 		mov	r0, #2097152
 5753 00e6 FFF7FEFF 		bl	SDIO_GetFlagStatus
 5754              	.LVL725:
 5755 00ea 0028     		cmp	r0, #0
 5756 00ec E8D1     		bne	.L558
 5757 00ee DEE7     		b	.L536
 5758              	.L555:
2210:lib/ff/sdio_stm32f1.c ****     }
 5759              		.loc 1 2210 0
 5760 00f0 2A20     		movs	r0, #42
 5761 00f2 2070     		strb	r0, [r4, #0]
 5762              	.L538:
2212:lib/ff/sdio_stm32f1.c ****     SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND |
 5763              		.loc 1 2212 0
 5764 00f4 4FF48070 		mov	r0, #256
 5765 00f8 FFF7FEFF 		bl	SDIO_ClearITPendingBit
 5766              	.LVL726:
2213:lib/ff/sdio_stm32f1.c ****                   SDIO_IT_TXFIFOHE | SDIO_IT_RXFIFOHF | SDIO_IT_TXUNDERR |
 5767              		.loc 1 2213 0
 5768 00fc 4CF23A30 		movw	r0, #49978
 5769 0100 0021     		movs	r1, #0
 5770 0102 FFF7FEFF 		bl	SDIO_ITConfig
 5771              	.LVL727:
2216:lib/ff/sdio_stm32f1.c ****     NumberOfBytes = 0;
 5772              		.loc 1 2216 0
 5773 0106 0122     		movs	r2, #1
 5774 0108 3749     		ldr	r1, .L559+28
 5775 010a 0A60     		str	r2, [r1, #0]
2217:lib/ff/sdio_stm32f1.c ****     return(TransferError);
 5776              		.loc 1 2217 0
 5777 010c 0020     		movs	r0, #0
 5778 010e 324B     		ldr	r3, .L559+12
 5779 0110 1860     		str	r0, [r3, #0]
2218:lib/ff/sdio_stm32f1.c ****   }
 5780              		.loc 1 2218 0
 5781 0112 344A     		ldr	r2, .L559+24
 5782 0114 1078     		ldrb	r0, [r2, #0]	@ zero_extendqisi2
 5783 0116 70BD     		pop	{r4, r5, r6, pc}
 5784              	.L532:
2221:lib/ff/sdio_stm32f1.c ****   {
 5785              		.loc 1 2221 0
 5786 0118 0220     		movs	r0, #2
 5787 011a FFF7FEFF 		bl	SDIO_GetITStatus
 5788              	.LVL728:
 5789 011e 0546     		mov	r5, r0
 5790 0120 58B1     		cbz	r0, .L540
2223:lib/ff/sdio_stm32f1.c ****     SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND |
 5791              		.loc 1 2223 0
 5792 0122 0220     		movs	r0, #2
 5793 0124 FFF7FEFF 		bl	SDIO_ClearITPendingBit
 5794              	.LVL729:
2224:lib/ff/sdio_stm32f1.c ****                   SDIO_IT_TXFIFOHE | SDIO_IT_RXFIFOHF | SDIO_IT_TXUNDERR |
 5795              		.loc 1 2224 0
 5796 0128 4CF23A30 		movw	r0, #49978
 5797 012c 2146     		mov	r1, r4
 5798 012e FFF7FEFF 		bl	SDIO_ITConfig
 5799              	.LVL730:
2227:lib/ff/sdio_stm32f1.c ****     TransferError = SD_DATA_CRC_FAIL;
 5800              		.loc 1 2227 0
 5801 0132 294A     		ldr	r2, .L559+12
 5802 0134 1460     		str	r4, [r2, #0]
2228:lib/ff/sdio_stm32f1.c ****     return(SD_DATA_CRC_FAIL);
 5803              		.loc 1 2228 0
 5804 0136 0220     		movs	r0, #2
 5805 0138 43E0     		b	.L557
 5806              	.L540:
2232:lib/ff/sdio_stm32f1.c ****   {
 5807              		.loc 1 2232 0
 5808 013a 0820     		movs	r0, #8
 5809 013c FFF7FEFF 		bl	SDIO_GetITStatus
 5810              	.LVL731:
 5811 0140 0446     		mov	r4, r0
 5812 0142 58B1     		cbz	r0, .L541
2234:lib/ff/sdio_stm32f1.c ****     SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND |
 5813              		.loc 1 2234 0
 5814 0144 0820     		movs	r0, #8
 5815 0146 FFF7FEFF 		bl	SDIO_ClearITPendingBit
 5816              	.LVL732:
2235:lib/ff/sdio_stm32f1.c ****                   SDIO_IT_TXFIFOHE | SDIO_IT_RXFIFOHF | SDIO_IT_TXUNDERR |
 5817              		.loc 1 2235 0
 5818 014a 4CF23A30 		movw	r0, #49978
 5819 014e 2946     		mov	r1, r5
 5820 0150 FFF7FEFF 		bl	SDIO_ITConfig
 5821              	.LVL733:
2238:lib/ff/sdio_stm32f1.c ****     TransferError = SD_DATA_TIMEOUT;
 5822              		.loc 1 2238 0
 5823 0154 2048     		ldr	r0, .L559+12
 5824 0156 0560     		str	r5, [r0, #0]
2239:lib/ff/sdio_stm32f1.c ****     return(SD_DATA_TIMEOUT);
 5825              		.loc 1 2239 0
 5826 0158 0420     		movs	r0, #4
 5827 015a 32E0     		b	.L557
 5828              	.L541:
2243:lib/ff/sdio_stm32f1.c ****   {
 5829              		.loc 1 2243 0
 5830 015c 2020     		movs	r0, #32
 5831 015e FFF7FEFF 		bl	SDIO_GetITStatus
 5832              	.LVL734:
 5833 0162 0546     		mov	r5, r0
 5834 0164 58B1     		cbz	r0, .L542
2245:lib/ff/sdio_stm32f1.c ****     SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND |
 5835              		.loc 1 2245 0
 5836 0166 2020     		movs	r0, #32
 5837 0168 FFF7FEFF 		bl	SDIO_ClearITPendingBit
 5838              	.LVL735:
2246:lib/ff/sdio_stm32f1.c ****                   SDIO_IT_TXFIFOHE | SDIO_IT_RXFIFOHF | SDIO_IT_TXUNDERR |
 5839              		.loc 1 2246 0
 5840 016c 4CF23A30 		movw	r0, #49978
 5841 0170 2146     		mov	r1, r4
 5842 0172 FFF7FEFF 		bl	SDIO_ITConfig
 5843              	.LVL736:
2249:lib/ff/sdio_stm32f1.c ****     TransferError = SD_RX_OVERRUN;
 5844              		.loc 1 2249 0
 5845 0176 184B     		ldr	r3, .L559+12
 5846 0178 1C60     		str	r4, [r3, #0]
2250:lib/ff/sdio_stm32f1.c ****     return(SD_RX_OVERRUN);
 5847              		.loc 1 2250 0
 5848 017a 0620     		movs	r0, #6
 5849 017c 21E0     		b	.L557
 5850              	.L542:
2254:lib/ff/sdio_stm32f1.c ****   {
 5851              		.loc 1 2254 0
 5852 017e 1020     		movs	r0, #16
 5853 0180 FFF7FEFF 		bl	SDIO_GetITStatus
 5854              	.LVL737:
 5855 0184 0446     		mov	r4, r0
 5856 0186 58B1     		cbz	r0, .L543
2256:lib/ff/sdio_stm32f1.c ****     SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND |
 5857              		.loc 1 2256 0
 5858 0188 1020     		movs	r0, #16
 5859 018a FFF7FEFF 		bl	SDIO_ClearITPendingBit
 5860              	.LVL738:
2257:lib/ff/sdio_stm32f1.c ****                   SDIO_IT_TXFIFOHE | SDIO_IT_RXFIFOHF | SDIO_IT_TXUNDERR |
 5861              		.loc 1 2257 0
 5862 018e 4CF23A30 		movw	r0, #49978
 5863 0192 2946     		mov	r1, r5
 5864 0194 FFF7FEFF 		bl	SDIO_ITConfig
 5865              	.LVL739:
2260:lib/ff/sdio_stm32f1.c ****     TransferError = SD_TX_UNDERRUN;
 5866              		.loc 1 2260 0
 5867 0198 0F49     		ldr	r1, .L559+12
 5868 019a 0D60     		str	r5, [r1, #0]
2261:lib/ff/sdio_stm32f1.c ****     return(SD_TX_UNDERRUN);
 5869              		.loc 1 2261 0
 5870 019c 0520     		movs	r0, #5
 5871 019e 10E0     		b	.L557
 5872              	.L543:
2265:lib/ff/sdio_stm32f1.c ****   {
 5873              		.loc 1 2265 0
 5874 01a0 4FF40070 		mov	r0, #512
 5875 01a4 FFF7FEFF 		bl	SDIO_GetITStatus
 5876              	.LVL740:
 5877 01a8 70B1     		cbz	r0, .L545
2267:lib/ff/sdio_stm32f1.c ****     SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND |
 5878              		.loc 1 2267 0
 5879 01aa 4FF40070 		mov	r0, #512
 5880 01ae FFF7FEFF 		bl	SDIO_ClearITPendingBit
 5881              	.LVL741:
2268:lib/ff/sdio_stm32f1.c ****                   SDIO_IT_TXFIFOHE | SDIO_IT_RXFIFOHF | SDIO_IT_TXUNDERR |
 5882              		.loc 1 2268 0
 5883 01b2 4CF23A30 		movw	r0, #49978
 5884 01b6 2146     		mov	r1, r4
 5885 01b8 FFF7FEFF 		bl	SDIO_ITConfig
 5886              	.LVL742:
2271:lib/ff/sdio_stm32f1.c ****     TransferError = SD_START_BIT_ERR;
 5887              		.loc 1 2271 0
 5888 01bc 064A     		ldr	r2, .L559+12
 5889 01be 1460     		str	r4, [r2, #0]
2272:lib/ff/sdio_stm32f1.c ****     return(SD_START_BIT_ERR);
 5890              		.loc 1 2272 0
 5891 01c0 0720     		movs	r0, #7
 5892              	.L557:
 5893 01c2 0849     		ldr	r1, .L559+24
 5894 01c4 0870     		strb	r0, [r1, #0]
2273:lib/ff/sdio_stm32f1.c ****   }
 5895              		.loc 1 2273 0
 5896 01c6 70BD     		pop	{r4, r5, r6, pc}
 5897              	.L545:
2276:lib/ff/sdio_stm32f1.c **** }
 5898              		.loc 1 2276 0
 5899 01c8 2A20     		movs	r0, #42
2277:lib/ff/sdio_stm32f1.c **** 
 5900              		.loc 1 2277 0
 5901 01ca 70BD     		pop	{r4, r5, r6, pc}
 5902              	.L560:
 5903              		.align	2
 5904              	.L559:
 5905 01cc 00000000 		.word	.LANCHOR7
 5906 01d0 00000000 		.word	.LANCHOR13
 5907 01d4 00000000 		.word	.LANCHOR11
 5908 01d8 00000000 		.word	.LANCHOR15
 5909 01dc 00000000 		.word	.LANCHOR14
 5910 01e0 00000000 		.word	.LANCHOR12
 5911 01e4 00000000 		.word	.LANCHOR9
 5912 01e8 00000000 		.word	.LANCHOR10
 5913              		.cfi_endproc
 5914              	.LFE77:
 5916              		.section	.text.SDIO_IRQHandler,"ax",%progbits
 5917              		.align	1
 5918              		.global	SDIO_IRQHandler
 5919              		.thumb
 5920              		.thumb_func
 5922              	SDIO_IRQHandler:
 5923              	.LFB91:
3150:lib/ff/sdio_stm32f1.c ****   /* Process All SDIO Interrupt Sources */
 5924              		.loc 1 3150 0
 5925              		.cfi_startproc
 5926              		@ args = 0, pretend = 0, frame = 0
 5927              		@ frame_needed = 0, uses_anonymous_args = 0
 5928              		@ link register save eliminated.
3153:lib/ff/sdio_stm32f1.c **** 
 5929              		.loc 1 3153 0
3152:lib/ff/sdio_stm32f1.c **** }
 5930              		.loc 1 3152 0
 5931 0000 FFF7FEBF 		b	SD_ProcessIRQSrc
 5932              	.LVL743:
 5933              		.cfi_endproc
 5934              	.LFE91:
 5936              		.section	.text.SD_GetCardStatus,"ax",%progbits
 5937              		.align	1
 5938              		.global	SD_GetCardStatus
 5939              		.thumb
 5940              		.thumb_func
 5942              	SD_GetCardStatus:
 5943              	.LFB92:
3166:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
 5944              		.loc 1 3166 0
 5945              		.cfi_startproc
 5946              		@ args = 0, pretend = 0, frame = 0
 5947              		@ frame_needed = 0, uses_anonymous_args = 0
 5948              	.LVL744:
 5949 0000 38B5     		push	{r3, r4, r5, lr}
 5950              	.LCFI30:
 5951              		.cfi_def_cfa_offset 16
 5952              		.cfi_offset 3, -16
 5953              		.cfi_offset 4, -12
 5954              		.cfi_offset 5, -8
 5955              		.cfi_offset 14, -4
 5956 0002 0446     		mov	r4, r0
 5957              	.LVL745:
3170:lib/ff/sdio_stm32f1.c **** 
 5958              		.loc 1 3170 0
 5959 0004 1E4D     		ldr	r5, .L564
 5960 0006 2846     		mov	r0, r5
 5961              	.LVL746:
 5962 0008 FFF7FEFF 		bl	SD_SendSDStatus
 5963              	.LVL747:
3172:lib/ff/sdio_stm32f1.c ****   {
 5964              		.loc 1 3172 0
 5965 000c 2A28     		cmp	r0, #42
 5966 000e 35D1     		bne	.L563
3178:lib/ff/sdio_stm32f1.c ****   cardstatus->DAT_BUS_WIDTH = tmp;
 5967              		.loc 1 3178 0
 5968 0010 2B78     		ldrb	r3, [r5, #0]	@ zero_extendqisi2
 5969 0012 9909     		lsrs	r1, r3, #6
 5970              	.LVL748:
3179:lib/ff/sdio_stm32f1.c **** 
 5971              		.loc 1 3179 0
 5972 0014 2170     		strb	r1, [r4, #0]
3182:lib/ff/sdio_stm32f1.c ****   cardstatus->SECURED_MODE = tmp;
 5973              		.loc 1 3182 0
 5974 0016 2A78     		ldrb	r2, [r5, #0]	@ zero_extendqisi2
 5975 0018 C2F34013 		ubfx	r3, r2, #5, #1
 5976              	.LVL749:
3183:lib/ff/sdio_stm32f1.c **** 
 5977              		.loc 1 3183 0
 5978 001c 6370     		strb	r3, [r4, #1]
 5979              	.LVL750:
3187:lib/ff/sdio_stm32f1.c **** 
 5980              		.loc 1 3187 0
 5981 001e A978     		ldrb	r1, [r5, #2]	@ zero_extendqisi2
 5982 0020 0A02     		lsls	r2, r1, #8
 5983 0022 6280     		strh	r2, [r4, #2]	@ movhi
 5984              	.LVL751:
3191:lib/ff/sdio_stm32f1.c **** 
 5985              		.loc 1 3191 0
 5986 0024 6388     		ldrh	r3, [r4, #2]
 5987 0026 99B2     		uxth	r1, r3
 5988 0028 EA78     		ldrb	r2, [r5, #3]	@ zero_extendqisi2
 5989 002a 1143     		orrs	r1, r1, r2
 5990 002c 6180     		strh	r1, [r4, #2]	@ movhi
 5991              	.LVL752:
3195:lib/ff/sdio_stm32f1.c **** 
 5992              		.loc 1 3195 0
 5993 002e 2B79     		ldrb	r3, [r5, #4]	@ zero_extendqisi2
 5994 0030 1906     		lsls	r1, r3, #24
 5995 0032 6160     		str	r1, [r4, #4]
 5996              	.LVL753:
3199:lib/ff/sdio_stm32f1.c **** 
 5997              		.loc 1 3199 0
 5998 0034 6368     		ldr	r3, [r4, #4]
 5999 0036 6A79     		ldrb	r2, [r5, #5]	@ zero_extendqisi2
 6000 0038 43EA0241 		orr	r1, r3, r2, lsl #16
 6001 003c 6160     		str	r1, [r4, #4]
 6002              	.LVL754:
3203:lib/ff/sdio_stm32f1.c **** 
 6003              		.loc 1 3203 0
 6004 003e 6368     		ldr	r3, [r4, #4]
 6005 0040 AA79     		ldrb	r2, [r5, #6]	@ zero_extendqisi2
 6006 0042 43EA0221 		orr	r1, r3, r2, lsl #8
 6007 0046 6160     		str	r1, [r4, #4]
 6008              	.LVL755:
3207:lib/ff/sdio_stm32f1.c **** 
 6009              		.loc 1 3207 0
 6010 0048 6368     		ldr	r3, [r4, #4]
 6011 004a EA79     		ldrb	r2, [r5, #7]	@ zero_extendqisi2
 6012 004c 42EA0301 		orr	r1, r2, r3
 6013 0050 6160     		str	r1, [r4, #4]
3210:lib/ff/sdio_stm32f1.c ****   cardstatus->SPEED_CLASS = tmp;
 6014              		.loc 1 3210 0
 6015 0052 2B7A     		ldrb	r3, [r5, #8]	@ zero_extendqisi2
 6016              	.LVL756:
3211:lib/ff/sdio_stm32f1.c **** 
 6017              		.loc 1 3211 0
 6018 0054 2372     		strb	r3, [r4, #8]
3214:lib/ff/sdio_stm32f1.c ****   cardstatus->PERFORMANCE_MOVE = tmp;
 6019              		.loc 1 3214 0
 6020 0056 6A7A     		ldrb	r2, [r5, #9]	@ zero_extendqisi2
 6021              	.LVL757:
3215:lib/ff/sdio_stm32f1.c **** 
 6022              		.loc 1 3215 0
 6023 0058 6272     		strb	r2, [r4, #9]
3218:lib/ff/sdio_stm32f1.c ****   cardstatus->AU_SIZE = tmp;
 6024              		.loc 1 3218 0
 6025 005a A97A     		ldrb	r1, [r5, #10]	@ zero_extendqisi2
 6026 005c 0B09     		lsrs	r3, r1, #4
 6027              	.LVL758:
3219:lib/ff/sdio_stm32f1.c **** 
 6028              		.loc 1 3219 0
 6029 005e A372     		strb	r3, [r4, #10]
 6030              	.LVL759:
3223:lib/ff/sdio_stm32f1.c **** 
 6031              		.loc 1 3223 0
 6032 0060 EA7A     		ldrb	r2, [r5, #11]	@ zero_extendqisi2
 6033 0062 1102     		lsls	r1, r2, #8
 6034 0064 A181     		strh	r1, [r4, #12]	@ movhi
 6035              	.LVL760:
3227:lib/ff/sdio_stm32f1.c **** 
 6036              		.loc 1 3227 0
 6037 0066 A389     		ldrh	r3, [r4, #12]
 6038 0068 99B2     		uxth	r1, r3
 6039 006a 2A7B     		ldrb	r2, [r5, #12]	@ zero_extendqisi2
 6040 006c 1143     		orrs	r1, r1, r2
 6041 006e A181     		strh	r1, [r4, #12]	@ movhi
3230:lib/ff/sdio_stm32f1.c ****   cardstatus->ERASE_TIMEOUT = tmp;
 6042              		.loc 1 3230 0
 6043 0070 6B7B     		ldrb	r3, [r5, #13]	@ zero_extendqisi2
 6044 0072 9908     		lsrs	r1, r3, #2
 6045              	.LVL761:
3231:lib/ff/sdio_stm32f1.c **** 
 6046              		.loc 1 3231 0
 6047 0074 A173     		strb	r1, [r4, #14]
3234:lib/ff/sdio_stm32f1.c ****   cardstatus->ERASE_OFFSET = tmp;
 6048              		.loc 1 3234 0
 6049 0076 03F00302 		and	r2, r3, #3
 6050              	.LVL762:
3235:lib/ff/sdio_stm32f1.c ****  
 6051              		.loc 1 3235 0
 6052 007a E273     		strb	r2, [r4, #15]
 6053              	.LVL763:
 6054              	.L563:
 6055              		.loc 1 3238 0
 6056 007c 38BD     		pop	{r3, r4, r5, pc}
 6057              	.L565:
 6058 007e 00BF     		.align	2
 6059              	.L564:
 6060 0080 00000000 		.word	.LANCHOR16
 6061              		.cfi_endproc
 6062              	.LFE92:
 6064              		.global	SDIO_DataInitStructure
 6065              		.global	SDIO_CmdInitStructure
 6066              		.global	SDIO_InitStructure
 6067              		.global	SDCardInfo
 6068              		.global	NumberOfBytes
 6069              		.global	TransferEnd
 6070              		.global	TransferError
 6071              		.global	DestBuffer
 6072              		.global	SrcBuffer
 6073              		.section	.bss.SDIO_DataInitStructure,"aw",%nobits
 6074              		.align	2
 6075              		.set	.LANCHOR2,. + 0
 6078              	SDIO_DataInitStructure:
 6079 0000 00000000 		.space	24
 6079      00000000 
 6079      00000000 
 6079      00000000 
 6079      00000000 
 6080              		.section	.bss.CSD_Tab,"aw",%nobits
 6081              		.align	2
 6082              		.set	.LANCHOR6,. + 0
 6085              	CSD_Tab:
 6086 0000 00000000 		.space	16
 6086      00000000 
 6086      00000000 
 6086      00000000 
 6087              		.section	.bss.SDCardInfo,"aw",%nobits
 6088              		.align	3
 6089              		.set	.LANCHOR8,. + 0
 6092              	SDCardInfo:
 6093 0000 00000000 		.space	88
 6093      00000000 
 6093      00000000 
 6093      00000000 
 6093      00000000 
 6094              		.section	.bss.NumberOfBytes,"aw",%nobits
 6095              		.align	2
 6096              		.set	.LANCHOR15,. + 0
 6099              	NumberOfBytes:
 6100 0000 00000000 		.space	4
 6101              		.section	.bss.SDSTATUS_Tab,"aw",%nobits
 6102              		.set	.LANCHOR16,. + 0
 6105              	SDSTATUS_Tab:
 6106 0000 00000000 		.space	16
 6106      00000000 
 6106      00000000 
 6106      00000000 
 6107              		.section	.bss.CardType,"aw",%nobits
 6108              		.align	2
 6109              		.set	.LANCHOR4,. + 0
 6112              	CardType:
 6113 0000 00000000 		.space	4
 6114              		.section	.bss.CID_Tab,"aw",%nobits
 6115              		.align	2
 6116              		.set	.LANCHOR5,. + 0
 6119              	CID_Tab:
 6120 0000 00000000 		.space	16
 6120      00000000 
 6120      00000000 
 6120      00000000 
 6121              		.section	.bss.TransferEnd,"aw",%nobits
 6122              		.align	2
 6123              		.set	.LANCHOR10,. + 0
 6126              	TransferEnd:
 6127 0000 00000000 		.space	4
 6128              		.section	.bss.DestBuffer,"aw",%nobits
 6129              		.align	2
 6130              		.set	.LANCHOR13,. + 0
 6133              	DestBuffer:
 6134 0000 00000000 		.space	4
 6135              		.section	.bss.SDIO_InitStructure,"aw",%nobits
 6136              		.align	2
 6137              		.set	.LANCHOR3,. + 0
 6140              	SDIO_InitStructure:
 6141 0000 00000000 		.space	24
 6141      00000000 
 6141      00000000 
 6141      00000000 
 6141      00000000 
 6142              		.section	.bss.SrcBuffer,"aw",%nobits
 6143              		.align	2
 6144              		.set	.LANCHOR14,. + 0
 6147              	SrcBuffer:
 6148 0000 00000000 		.space	4
 6149              		.section	.bss.RCA,"aw",%nobits
 6150              		.align	2
 6151              		.set	.LANCHOR1,. + 0
 6154              	RCA:
 6155 0000 00000000 		.space	4
 6156              		.section	.data.TransferError,"aw",%progbits
 6157              		.set	.LANCHOR9,. + 0
 6160              	TransferError:
 6161 0000 2A       		.byte	42
 6162              		.section	.bss.TotalNumberOfBytes,"aw",%nobits
 6163              		.align	2
 6164              		.set	.LANCHOR11,. + 0
 6167              	TotalNumberOfBytes:
 6168 0000 00000000 		.space	4
 6169              		.section	.bss.SDIO_CmdInitStructure,"aw",%nobits
 6170              		.align	2
 6171              		.set	.LANCHOR0,. + 0
 6174              	SDIO_CmdInitStructure:
 6175 0000 00000000 		.space	20
 6175      00000000 
 6175      00000000 
 6175      00000000 
 6175      00000000 
 6176              		.section	.data.DeviceMode,"aw",%progbits
 6177              		.align	2
 6178              		.set	.LANCHOR7,. + 0
 6181              	DeviceMode:
 6182 0000 02000000 		.word	2
 6183              		.section	.bss.StopCondition,"aw",%nobits
 6184              		.align	2
 6185              		.set	.LANCHOR12,. + 0
 6188              	StopCondition:
 6189 0000 00000000 		.space	4
 6190              		.text
 6191              	.Letext0:
 6192              		.file 2 "c:\\devz\\arm\\bleeding-edge\\bin\\../lib/gcc/arm-none-eabi/4.7.3/include/stdint-gcc.h"
 6193              		.file 3 "./lib/CMSIS/Device/ST/STM32F10x/Include/stm32f10x.h"
 6194              		.file 4 "./lib/STM32F10x_StdPeriph_Driver/inc/stm32f10x_dma.h"
 6195              		.file 5 "./lib/STM32F10x_StdPeriph_Driver/inc/stm32f10x_gpio.h"
 6196              		.file 6 "./lib/STM32F10x_StdPeriph_Driver/inc/stm32f10x_sdio.h"
 6197              		.file 7 "./lib/STM32F10x_StdPeriph_Driver/inc/misc.h"
 6198              		.file 8 "lib/ff/sdio_stm32f1.h"
 6199              		.file 9 "./lib/CMSIS/Include/core_cm3.h"
 6200              		.file 10 "./lib/STM32F10x_StdPeriph_Driver/inc/stm32f10x_rcc.h"
DEFINED SYMBOLS
                            *ABS*:0000000000000000 sdio_stm32f1.c
  R:\TEMP\ccqdxTrJ.s:19     .text.CmdResp2Error:0000000000000000 $t
  R:\TEMP\ccqdxTrJ.s:23     .text.CmdResp2Error:0000000000000000 CmdResp2Error
  R:\TEMP\ccqdxTrJ.s:83     .text.CmdResp2Error:0000000000000034 $d
  R:\TEMP\ccqdxTrJ.s:88     .text.IsCardProgramming:0000000000000000 $t
  R:\TEMP\ccqdxTrJ.s:92     .text.IsCardProgramming:0000000000000000 IsCardProgramming
  R:\TEMP\ccqdxTrJ.s:367    .text.IsCardProgramming:000000000000014c $d
  R:\TEMP\ccqdxTrJ.s:375    .text.unlikely.SD_LowLevel_DMA_TxConfig:0000000000000000 $t
  R:\TEMP\ccqdxTrJ.s:379    .text.unlikely.SD_LowLevel_DMA_TxConfig:0000000000000000 SD_LowLevel_DMA_TxConfig
  R:\TEMP\ccqdxTrJ.s:456    .text.unlikely.SD_LowLevel_DMA_TxConfig:0000000000000058 $d
  R:\TEMP\ccqdxTrJ.s:463    .text.unlikely.SD_LowLevel_DMA_RxConfig:0000000000000000 $t
  R:\TEMP\ccqdxTrJ.s:467    .text.unlikely.SD_LowLevel_DMA_RxConfig:0000000000000000 SD_LowLevel_DMA_RxConfig
  R:\TEMP\ccqdxTrJ.s:543    .text.unlikely.SD_LowLevel_DMA_RxConfig:0000000000000058 $d
  R:\TEMP\ccqdxTrJ.s:550    .text.CmdResp1Error:0000000000000000 $t
  R:\TEMP\ccqdxTrJ.s:554    .text.CmdResp1Error:0000000000000000 CmdResp1Error
  R:\TEMP\ccqdxTrJ.s:806    .text.CmdResp1Error:00000000000000ec $d
  R:\TEMP\ccqdxTrJ.s:812    .text.SDEnWideBus:0000000000000000 $t
  R:\TEMP\ccqdxTrJ.s:816    .text.SDEnWideBus:0000000000000000 SDEnWideBus
  R:\TEMP\ccqdxTrJ.s:1166   .text.SDEnWideBus:00000000000001dc $d
  R:\TEMP\ccqdxTrJ.s:1175   .text.SD_DeInit:0000000000000000 $t
  R:\TEMP\ccqdxTrJ.s:1180   .text.SD_DeInit:0000000000000000 SD_DeInit
  R:\TEMP\ccqdxTrJ.s:1232   .text.SD_DeInit:0000000000000044 $d
  R:\TEMP\ccqdxTrJ.s:1238   .text.SD_Detect:0000000000000000 $t
  R:\TEMP\ccqdxTrJ.s:1243   .text.SD_Detect:0000000000000000 SD_Detect
  R:\TEMP\ccqdxTrJ.s:1268   .text.SD_PowerON:0000000000000000 $t
  R:\TEMP\ccqdxTrJ.s:1273   .text.SD_PowerON:0000000000000000 SD_PowerON
  R:\TEMP\ccqdxTrJ.s:1622   .text.SD_PowerON:000000000000019c $d
  R:\TEMP\ccqdxTrJ.s:1630   .text.SD_PowerOFF:0000000000000000 $t
  R:\TEMP\ccqdxTrJ.s:1635   .text.SD_PowerOFF:0000000000000000 SD_PowerOFF
  R:\TEMP\ccqdxTrJ.s:1658   .text.SD_InitializeCards:0000000000000000 $t
  R:\TEMP\ccqdxTrJ.s:1663   .text.SD_InitializeCards:0000000000000000 SD_InitializeCards
  R:\TEMP\ccqdxTrJ.s:1942   .text.SD_InitializeCards:000000000000014c $d
  R:\TEMP\ccqdxTrJ.s:1952   .text.SD_GetCardInfo:0000000000000000 $t
  R:\TEMP\ccqdxTrJ.s:1957   .text.SD_GetCardInfo:0000000000000000 SD_GetCardInfo
  R:\TEMP\ccqdxTrJ.s:2384   .text.SD_GetCardInfo:0000000000000288 $d
  R:\TEMP\ccqdxTrJ.s:2392   .text.SD_EnableWideBusOperation:0000000000000000 $t
  R:\TEMP\ccqdxTrJ.s:2397   .text.SD_EnableWideBusOperation:0000000000000000 SD_EnableWideBusOperation
  R:\TEMP\ccqdxTrJ.s:2503   .text.SD_EnableWideBusOperation:000000000000006c $d
  R:\TEMP\ccqdxTrJ.s:2509   .text.SD_SetDeviceMode:0000000000000000 $t
  R:\TEMP\ccqdxTrJ.s:2514   .text.SD_SetDeviceMode:0000000000000000 SD_SetDeviceMode
  R:\TEMP\ccqdxTrJ.s:2543   .text.SD_SetDeviceMode:0000000000000010 $d
  R:\TEMP\ccqdxTrJ.s:2548   .text.SD_SelectDeselect:0000000000000000 $t
  R:\TEMP\ccqdxTrJ.s:2553   .text.SD_SelectDeselect:0000000000000000 SD_SelectDeselect
  R:\TEMP\ccqdxTrJ.s:2596   .text.SD_SelectDeselect:0000000000000028 $d
  R:\TEMP\ccqdxTrJ.s:2601   .text.SD_Init:0000000000000000 $t
  R:\TEMP\ccqdxTrJ.s:2606   .text.SD_Init:0000000000000000 SD_Init
  R:\TEMP\ccqdxTrJ.s:2758   .text.SD_Init:00000000000000cc $d
  R:\TEMP\ccqdxTrJ.s:2768   .text.SD_ReadBlock:0000000000000000 $t
  R:\TEMP\ccqdxTrJ.s:2773   .text.SD_ReadBlock:0000000000000000 SD_ReadBlock
  R:\TEMP\ccqdxTrJ.s:3168   .text.SD_ReadBlock:0000000000000204 $d
  R:\TEMP\ccqdxTrJ.s:3184   .text.SD_ReadMultiBlocks:0000000000000000 $t
  R:\TEMP\ccqdxTrJ.s:3189   .text.SD_ReadMultiBlocks:0000000000000000 SD_ReadMultiBlocks
  R:\TEMP\ccqdxTrJ.s:3639   .text.SD_ReadMultiBlocks:0000000000000260 $d
  R:\TEMP\ccqdxTrJ.s:3655   .text.SD_WriteBlock:0000000000000000 $t
  R:\TEMP\ccqdxTrJ.s:3660   .text.SD_WriteBlock:0000000000000000 SD_WriteBlock
  R:\TEMP\ccqdxTrJ.s:4183   .text.SD_WriteBlock:00000000000002c8 $d
  R:\TEMP\ccqdxTrJ.s:4200   .text.SD_WriteMultiBlocks:0000000000000000 $t
  R:\TEMP\ccqdxTrJ.s:4205   .text.SD_WriteMultiBlocks:0000000000000000 SD_WriteMultiBlocks
  R:\TEMP\ccqdxTrJ.s:4724   .text.SD_WriteMultiBlocks:00000000000002d0 $d
  R:\TEMP\ccqdxTrJ.s:4738   .text.SD_WriteMultiBlocks:0000000000000300 $t
  R:\TEMP\ccqdxTrJ.s:4833   .text.SD_WriteMultiBlocks:0000000000000378 $d
  R:\TEMP\ccqdxTrJ.s:4840   .text.SD_GetTransferState:0000000000000000 $t
  R:\TEMP\ccqdxTrJ.s:4845   .text.SD_GetTransferState:0000000000000000 SD_GetTransferState
  R:\TEMP\ccqdxTrJ.s:4864   .text.SD_GetTransferState:0000000000000010 $d
  R:\TEMP\ccqdxTrJ.s:4869   .text.SD_StopTransfer:0000000000000000 $t
  R:\TEMP\ccqdxTrJ.s:4874   .text.SD_StopTransfer:0000000000000000 SD_StopTransfer
  R:\TEMP\ccqdxTrJ.s:4913   .text.SD_StopTransfer:0000000000000028 $d
  R:\TEMP\ccqdxTrJ.s:4918   .text.SD_Erase:0000000000000000 $t
  R:\TEMP\ccqdxTrJ.s:4923   .text.SD_Erase:0000000000000000 SD_Erase
  R:\TEMP\ccqdxTrJ.s:5119   .text.SD_Erase:00000000000000f0 $d
  R:\TEMP\ccqdxTrJ.s:5128   .text.SD_SendStatus:0000000000000000 $t
  R:\TEMP\ccqdxTrJ.s:5133   .text.SD_SendStatus:0000000000000000 SD_SendStatus
  R:\TEMP\ccqdxTrJ.s:5202   .text.SD_SendStatus:0000000000000044 $d
  R:\TEMP\ccqdxTrJ.s:5208   .text.SD_GetState:0000000000000000 $t
  R:\TEMP\ccqdxTrJ.s:5213   .text.SD_GetState:0000000000000000 SD_GetState
  R:\TEMP\ccqdxTrJ.s:5266   .text.SD_GetStatus:0000000000000000 $t
  R:\TEMP\ccqdxTrJ.s:5271   .text.SD_GetStatus:0000000000000000 SD_GetStatus
  R:\TEMP\ccqdxTrJ.s:5307   .text.SD_SendSDStatus:0000000000000000 $t
  R:\TEMP\ccqdxTrJ.s:5312   .text.SD_SendSDStatus:0000000000000000 SD_SendSDStatus
  R:\TEMP\ccqdxTrJ.s:5567   .text.SD_SendSDStatus:0000000000000154 $d
  R:\TEMP\ccqdxTrJ.s:5576   .text.SD_ProcessIRQSrc:0000000000000000 $t
  R:\TEMP\ccqdxTrJ.s:5581   .text.SD_ProcessIRQSrc:0000000000000000 SD_ProcessIRQSrc
  R:\TEMP\ccqdxTrJ.s:5905   .text.SD_ProcessIRQSrc:00000000000001cc $d
  R:\TEMP\ccqdxTrJ.s:5917   .text.SDIO_IRQHandler:0000000000000000 $t
  R:\TEMP\ccqdxTrJ.s:5922   .text.SDIO_IRQHandler:0000000000000000 SDIO_IRQHandler
  R:\TEMP\ccqdxTrJ.s:5937   .text.SD_GetCardStatus:0000000000000000 $t
  R:\TEMP\ccqdxTrJ.s:5942   .text.SD_GetCardStatus:0000000000000000 SD_GetCardStatus
  R:\TEMP\ccqdxTrJ.s:6060   .text.SD_GetCardStatus:0000000000000080 $d
  R:\TEMP\ccqdxTrJ.s:6078   .bss.SDIO_DataInitStructure:0000000000000000 SDIO_DataInitStructure
  R:\TEMP\ccqdxTrJ.s:6174   .bss.SDIO_CmdInitStructure:0000000000000000 SDIO_CmdInitStructure
  R:\TEMP\ccqdxTrJ.s:6140   .bss.SDIO_InitStructure:0000000000000000 SDIO_InitStructure
  R:\TEMP\ccqdxTrJ.s:6092   .bss.SDCardInfo:0000000000000000 SDCardInfo
  R:\TEMP\ccqdxTrJ.s:6099   .bss.NumberOfBytes:0000000000000000 NumberOfBytes
  R:\TEMP\ccqdxTrJ.s:6126   .bss.TransferEnd:0000000000000000 TransferEnd
  R:\TEMP\ccqdxTrJ.s:6160   .data.TransferError:0000000000000000 TransferError
  R:\TEMP\ccqdxTrJ.s:6133   .bss.DestBuffer:0000000000000000 DestBuffer
  R:\TEMP\ccqdxTrJ.s:6147   .bss.SrcBuffer:0000000000000000 SrcBuffer
  R:\TEMP\ccqdxTrJ.s:6074   .bss.SDIO_DataInitStructure:0000000000000000 $d
  R:\TEMP\ccqdxTrJ.s:6081   .bss.CSD_Tab:0000000000000000 $d
  R:\TEMP\ccqdxTrJ.s:6085   .bss.CSD_Tab:0000000000000000 CSD_Tab
  R:\TEMP\ccqdxTrJ.s:6088   .bss.SDCardInfo:0000000000000000 $d
  R:\TEMP\ccqdxTrJ.s:6095   .bss.NumberOfBytes:0000000000000000 $d
  R:\TEMP\ccqdxTrJ.s:6105   .bss.SDSTATUS_Tab:0000000000000000 SDSTATUS_Tab
  R:\TEMP\ccqdxTrJ.s:6106   .bss.SDSTATUS_Tab:0000000000000000 $d
  R:\TEMP\ccqdxTrJ.s:6108   .bss.CardType:0000000000000000 $d
  R:\TEMP\ccqdxTrJ.s:6112   .bss.CardType:0000000000000000 CardType
  R:\TEMP\ccqdxTrJ.s:6115   .bss.CID_Tab:0000000000000000 $d
  R:\TEMP\ccqdxTrJ.s:6119   .bss.CID_Tab:0000000000000000 CID_Tab
  R:\TEMP\ccqdxTrJ.s:6122   .bss.TransferEnd:0000000000000000 $d
  R:\TEMP\ccqdxTrJ.s:6129   .bss.DestBuffer:0000000000000000 $d
  R:\TEMP\ccqdxTrJ.s:6136   .bss.SDIO_InitStructure:0000000000000000 $d
  R:\TEMP\ccqdxTrJ.s:6143   .bss.SrcBuffer:0000000000000000 $d
  R:\TEMP\ccqdxTrJ.s:6150   .bss.RCA:0000000000000000 $d
  R:\TEMP\ccqdxTrJ.s:6154   .bss.RCA:0000000000000000 RCA
  R:\TEMP\ccqdxTrJ.s:6163   .bss.TotalNumberOfBytes:0000000000000000 $d
  R:\TEMP\ccqdxTrJ.s:6167   .bss.TotalNumberOfBytes:0000000000000000 TotalNumberOfBytes
  R:\TEMP\ccqdxTrJ.s:6170   .bss.SDIO_CmdInitStructure:0000000000000000 $d
  R:\TEMP\ccqdxTrJ.s:6177   .data.DeviceMode:0000000000000000 $d
  R:\TEMP\ccqdxTrJ.s:6181   .data.DeviceMode:0000000000000000 DeviceMode
  R:\TEMP\ccqdxTrJ.s:6184   .bss.StopCondition:0000000000000000 $d
  R:\TEMP\ccqdxTrJ.s:6188   .bss.StopCondition:0000000000000000 StopCondition
                     .debug_frame:0000000000000010 $d

UNDEFINED SYMBOLS
SDIO_ClearFlag
SDIO_SendCommand
SDIO_GetCommandResponse
SDIO_GetResponse
DMA_ClearFlag
DMA_Cmd
DMA_Init
SDIO_DataConfig
SDIO_GetFlagStatus
SDIO_ReadData
SDIO_ClockCmd
SDIO_SetPowerState
SDIO_DeInit
RCC_AHBPeriphClockCmd
GPIO_Init
SDIO_Init
SDIO_GetPowerState
RCC_APB2PeriphClockCmd
NVIC_Init
SDIO_DMACmd
SDIO_ITConfig
DMA_GetFlagStatus
SDIO_WriteData
SDIO_GetITStatus
SDIO_ClearITPendingBit
