   1              		.syntax unified
   2              		.cpu cortex-m3
   3              		.fpu softvfp
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 4
  11              		.eabi_attribute 34, 0
  12              		.eabi_attribute 18, 4
  13              		.thumb
  14              		.file	"sdio_stm32f1.c"
  15              		.text
  16              	.Ltext0:
  17              		.cfi_sections	.debug_frame
  18              		.section	.text.CmdResp2Error,"ax",%progbits
  19              		.align	1
  20              		.thumb
  21              		.thumb_func
  23              	CmdResp2Error:
  24              	.LFB82:
  25              		.file 1 "lib/ff/sdio_stm32f1.c"
   1:lib/ff/sdio_stm32f1.c **** /********************************************************************************/
   2:lib/ff/sdio_stm32f1.c **** /*!
   3:lib/ff/sdio_stm32f1.c **** 	@file			sdio_stm32f1.c
   4:lib/ff/sdio_stm32f1.c **** 	@author         Nemui Trinomius (http://nemuisan.blog.bai.ne.jp)
   5:lib/ff/sdio_stm32f1.c ****     @version        4.00
   6:lib/ff/sdio_stm32f1.c ****     @date           2012.09.22
   7:lib/ff/sdio_stm32f1.c **** 	@brief          SDIO Driver For STM32 HighDensity Devices				@n
   8:lib/ff/sdio_stm32f1.c **** 					Based on STM32F10x_StdPeriph_Driver V3.4.0.				@n
   9:lib/ff/sdio_stm32f1.c **** 
  10:lib/ff/sdio_stm32f1.c ****     @section HISTORY
  11:lib/ff/sdio_stm32f1.c **** 		2011.01.20	V1.00 Start Here.
  12:lib/ff/sdio_stm32f1.c **** 		2011.03.10	V2.00 C++ Ready.
  13:lib/ff/sdio_stm32f1.c **** 		2012.04.17	V2.00 Added SD_GetCardStatus().
  14:lib/ff/sdio_stm32f1.c **** 		2012.09.22  V3.00 Updated Support grater than 32GB Cards.
  15:lib/ff/sdio_stm32f1.c **** 
  16:lib/ff/sdio_stm32f1.c ****     @section LICENSE
  17:lib/ff/sdio_stm32f1.c **** 		BSD License. See Copyright.txt
  18:lib/ff/sdio_stm32f1.c **** */
  19:lib/ff/sdio_stm32f1.c **** /********************************************************************************/
  20:lib/ff/sdio_stm32f1.c **** 
  21:lib/ff/sdio_stm32f1.c **** /* Includes ------------------------------------------------------------------*/
  22:lib/ff/sdio_stm32f1.c **** #include "sdio_stm32f1.h"
  23:lib/ff/sdio_stm32f1.c **** 
  24:lib/ff/sdio_stm32f1.c **** /* Defines -------------------------------------------------------------------*/
  25:lib/ff/sdio_stm32f1.c **** /** 
  26:lib/ff/sdio_stm32f1.c ****   * @brief  SDIO Static flags, TimeOut, FIFO Address  
  27:lib/ff/sdio_stm32f1.c ****   */
  28:lib/ff/sdio_stm32f1.c **** #define NULL 0
  29:lib/ff/sdio_stm32f1.c **** #define SDIO_STATIC_FLAGS               ((uint32_t)0x000005FF)
  30:lib/ff/sdio_stm32f1.c **** #define SDIO_CMD0TIMEOUT                ((uint32_t)0x00010000)
  31:lib/ff/sdio_stm32f1.c **** 
  32:lib/ff/sdio_stm32f1.c **** /** 
  33:lib/ff/sdio_stm32f1.c ****   * @brief  Mask for errors Card Status R1 (OCR Register) 
  34:lib/ff/sdio_stm32f1.c ****   */
  35:lib/ff/sdio_stm32f1.c **** #define SD_OCR_ADDR_OUT_OF_RANGE        ((uint32_t)0x80000000)
  36:lib/ff/sdio_stm32f1.c **** #define SD_OCR_ADDR_MISALIGNED          ((uint32_t)0x40000000)
  37:lib/ff/sdio_stm32f1.c **** #define SD_OCR_BLOCK_LEN_ERR            ((uint32_t)0x20000000)
  38:lib/ff/sdio_stm32f1.c **** #define SD_OCR_ERASE_SEQ_ERR            ((uint32_t)0x10000000)
  39:lib/ff/sdio_stm32f1.c **** #define SD_OCR_BAD_ERASE_PARAM          ((uint32_t)0x08000000)
  40:lib/ff/sdio_stm32f1.c **** #define SD_OCR_WRITE_PROT_VIOLATION     ((uint32_t)0x04000000)
  41:lib/ff/sdio_stm32f1.c **** #define SD_OCR_LOCK_UNLOCK_FAILED       ((uint32_t)0x01000000)
  42:lib/ff/sdio_stm32f1.c **** #define SD_OCR_COM_CRC_FAILED           ((uint32_t)0x00800000)
  43:lib/ff/sdio_stm32f1.c **** #define SD_OCR_ILLEGAL_CMD              ((uint32_t)0x00400000)
  44:lib/ff/sdio_stm32f1.c **** #define SD_OCR_CARD_ECC_FAILED          ((uint32_t)0x00200000)
  45:lib/ff/sdio_stm32f1.c **** #define SD_OCR_CC_ERROR                 ((uint32_t)0x00100000)
  46:lib/ff/sdio_stm32f1.c **** #define SD_OCR_GENERAL_UNKNOWN_ERROR    ((uint32_t)0x00080000)
  47:lib/ff/sdio_stm32f1.c **** #define SD_OCR_STREAM_READ_UNDERRUN     ((uint32_t)0x00040000)
  48:lib/ff/sdio_stm32f1.c **** #define SD_OCR_STREAM_WRITE_OVERRUN     ((uint32_t)0x00020000)
  49:lib/ff/sdio_stm32f1.c **** #define SD_OCR_CID_CSD_OVERWRIETE       ((uint32_t)0x00010000)
  50:lib/ff/sdio_stm32f1.c **** #define SD_OCR_WP_ERASE_SKIP            ((uint32_t)0x00008000)
  51:lib/ff/sdio_stm32f1.c **** #define SD_OCR_CARD_ECC_DISABLED        ((uint32_t)0x00004000)
  52:lib/ff/sdio_stm32f1.c **** #define SD_OCR_ERASE_RESET              ((uint32_t)0x00002000)
  53:lib/ff/sdio_stm32f1.c **** #define SD_OCR_AKE_SEQ_ERROR            ((uint32_t)0x00000008)
  54:lib/ff/sdio_stm32f1.c **** #define SD_OCR_ERRORBITS                ((uint32_t)0xFDFFE008)
  55:lib/ff/sdio_stm32f1.c **** 
  56:lib/ff/sdio_stm32f1.c **** /** 
  57:lib/ff/sdio_stm32f1.c ****   * @brief  Masks for R6 Response 
  58:lib/ff/sdio_stm32f1.c ****   */
  59:lib/ff/sdio_stm32f1.c **** #define SD_R6_GENERAL_UNKNOWN_ERROR     ((uint32_t)0x00002000)
  60:lib/ff/sdio_stm32f1.c **** #define SD_R6_ILLEGAL_CMD               ((uint32_t)0x00004000)
  61:lib/ff/sdio_stm32f1.c **** #define SD_R6_COM_CRC_FAILED            ((uint32_t)0x00008000)
  62:lib/ff/sdio_stm32f1.c **** 
  63:lib/ff/sdio_stm32f1.c **** #define SD_VOLTAGE_WINDOW_SD            ((uint32_t)0x80100000)
  64:lib/ff/sdio_stm32f1.c **** #define SD_HIGH_CAPACITY                ((uint32_t)0x40000000)
  65:lib/ff/sdio_stm32f1.c **** #define SD_STD_CAPACITY                 ((uint32_t)0x00000000)
  66:lib/ff/sdio_stm32f1.c **** #define SD_CHECK_PATTERN                ((uint32_t)0x000001AA)
  67:lib/ff/sdio_stm32f1.c **** 
  68:lib/ff/sdio_stm32f1.c **** #define SD_MAX_VOLT_TRIAL               ((uint32_t)0x0000FFFF)
  69:lib/ff/sdio_stm32f1.c **** #define SD_ALLZERO                      ((uint32_t)0x00000000)
  70:lib/ff/sdio_stm32f1.c **** 
  71:lib/ff/sdio_stm32f1.c **** #define SD_WIDE_BUS_SUPPORT             ((uint32_t)0x00040000)
  72:lib/ff/sdio_stm32f1.c **** #define SD_SINGLE_BUS_SUPPORT           ((uint32_t)0x00010000)
  73:lib/ff/sdio_stm32f1.c **** #define SD_CARD_LOCKED                  ((uint32_t)0x02000000)
  74:lib/ff/sdio_stm32f1.c **** 
  75:lib/ff/sdio_stm32f1.c **** #define SD_DATATIMEOUT                  ((uint32_t)0x000FFFFF)
  76:lib/ff/sdio_stm32f1.c **** #define SD_0TO7BITS                     ((uint32_t)0x000000FF)
  77:lib/ff/sdio_stm32f1.c **** #define SD_8TO15BITS                    ((uint32_t)0x0000FF00)
  78:lib/ff/sdio_stm32f1.c **** #define SD_16TO23BITS                   ((uint32_t)0x00FF0000)
  79:lib/ff/sdio_stm32f1.c **** #define SD_24TO31BITS                   ((uint32_t)0xFF000000)
  80:lib/ff/sdio_stm32f1.c **** #define SD_MAX_DATA_LENGTH              ((uint32_t)0x01FFFFFF)
  81:lib/ff/sdio_stm32f1.c **** 
  82:lib/ff/sdio_stm32f1.c **** #define SD_HALFFIFO                     ((uint32_t)0x00000008)
  83:lib/ff/sdio_stm32f1.c **** #define SD_HALFFIFOBYTES                ((uint32_t)0x00000020)
  84:lib/ff/sdio_stm32f1.c **** 
  85:lib/ff/sdio_stm32f1.c **** /** 
  86:lib/ff/sdio_stm32f1.c ****   * @brief  Command Class Supported 
  87:lib/ff/sdio_stm32f1.c ****   */
  88:lib/ff/sdio_stm32f1.c **** #define SD_CCCC_LOCK_UNLOCK             ((uint32_t)0x00000080)
  89:lib/ff/sdio_stm32f1.c **** #define SD_CCCC_WRITE_PROT              ((uint32_t)0x00000040)
  90:lib/ff/sdio_stm32f1.c **** #define SD_CCCC_ERASE                   ((uint32_t)0x00000020)
  91:lib/ff/sdio_stm32f1.c **** 
  92:lib/ff/sdio_stm32f1.c **** /** 
  93:lib/ff/sdio_stm32f1.c ****   * @brief  Following commands are SD Card Specific commands.
  94:lib/ff/sdio_stm32f1.c ****   *         SDIO_APP_CMD should be sent before sending these commands. 
  95:lib/ff/sdio_stm32f1.c ****   */
  96:lib/ff/sdio_stm32f1.c **** #define SDIO_SEND_IF_COND               ((uint32_t)0x00000008)
  97:lib/ff/sdio_stm32f1.c **** 
  98:lib/ff/sdio_stm32f1.c **** 
  99:lib/ff/sdio_stm32f1.c **** /* Variables -----------------------------------------------------------------*/
 100:lib/ff/sdio_stm32f1.c **** static uint32_t CardType =  SDIO_STD_CAPACITY_SD_CARD_V1_1;
 101:lib/ff/sdio_stm32f1.c **** static uint32_t CSD_Tab[4], CID_Tab[4], RCA = 0;
 102:lib/ff/sdio_stm32f1.c **** static uint8_t SDSTATUS_Tab[16];
 103:lib/ff/sdio_stm32f1.c **** static uint32_t DeviceMode = SD_POLLING_MODE;
 104:lib/ff/sdio_stm32f1.c **** static uint32_t TotalNumberOfBytes = 0, StopCondition = 0;
 105:lib/ff/sdio_stm32f1.c **** uint32_t *SrcBuffer, *DestBuffer;
 106:lib/ff/sdio_stm32f1.c **** __IO SD_Error TransferError = SD_OK;
 107:lib/ff/sdio_stm32f1.c **** __IO uint32_t TransferEnd = 0;
 108:lib/ff/sdio_stm32f1.c **** __IO uint32_t NumberOfBytes = 0;
 109:lib/ff/sdio_stm32f1.c **** SD_CardInfo SDCardInfo;
 110:lib/ff/sdio_stm32f1.c **** SDIO_InitTypeDef SDIO_InitStructure;
 111:lib/ff/sdio_stm32f1.c **** SDIO_CmdInitTypeDef SDIO_CmdInitStructure;
 112:lib/ff/sdio_stm32f1.c **** SDIO_DataInitTypeDef SDIO_DataInitStructure;   
 113:lib/ff/sdio_stm32f1.c **** 
 114:lib/ff/sdio_stm32f1.c **** /* Constants -----------------------------------------------------------------*/
 115:lib/ff/sdio_stm32f1.c **** 
 116:lib/ff/sdio_stm32f1.c **** /* Function prototypes -------------------------------------------------------*/
 117:lib/ff/sdio_stm32f1.c **** static SD_Error CmdError(void);
 118:lib/ff/sdio_stm32f1.c **** static SD_Error CmdResp1Error(uint8_t cmd);
 119:lib/ff/sdio_stm32f1.c **** static SD_Error CmdResp7Error(void);
 120:lib/ff/sdio_stm32f1.c **** static SD_Error CmdResp3Error(void);
 121:lib/ff/sdio_stm32f1.c **** static SD_Error CmdResp2Error(void);
 122:lib/ff/sdio_stm32f1.c **** static SD_Error CmdResp6Error(uint8_t cmd, uint16_t *prca);
 123:lib/ff/sdio_stm32f1.c **** static SD_Error SDEnWideBus(FunctionalState NewState);
 124:lib/ff/sdio_stm32f1.c **** static SD_Error IsCardProgramming(uint8_t *pstatus);
 125:lib/ff/sdio_stm32f1.c **** static SD_Error FindSCR(uint16_t rca, uint32_t *pscr);
 126:lib/ff/sdio_stm32f1.c **** static uint8_t convert_from_bytes_to_power_of_two(uint16_t NumberOfBytes);
 127:lib/ff/sdio_stm32f1.c **** static void SD_LowLevel_DMA_TxConfig(uint32_t *BufferSRC, uint32_t BufferSize);
 128:lib/ff/sdio_stm32f1.c **** static void SD_LowLevel_DMA_RxConfig(uint32_t *BufferDST, uint32_t BufferSize);
 129:lib/ff/sdio_stm32f1.c **** static uint32_t SD_DMAEndOfTransferStatus(void);
 130:lib/ff/sdio_stm32f1.c **** 
 131:lib/ff/sdio_stm32f1.c **** /* Functions -----------------------------------------------------------------*/
 132:lib/ff/sdio_stm32f1.c **** 
 133:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 134:lib/ff/sdio_stm32f1.c **** /*! 
 135:lib/ff/sdio_stm32f1.c ****     @brief DeInitializes the SDIO interface.
 136:lib/ff/sdio_stm32f1.c **** 	@param  None
 137:lib/ff/sdio_stm32f1.c ****     @retval : None
 138:lib/ff/sdio_stm32f1.c **** */
 139:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 140:lib/ff/sdio_stm32f1.c **** void SD_DeInit(void)
 141:lib/ff/sdio_stm32f1.c **** { 
 142:lib/ff/sdio_stm32f1.c ****   GPIO_InitTypeDef  GPIO_InitStructure;
 143:lib/ff/sdio_stm32f1.c ****   
 144:lib/ff/sdio_stm32f1.c ****   /*!< Disable SDIO Clock */
 145:lib/ff/sdio_stm32f1.c ****   SDIO_ClockCmd(DISABLE);
 146:lib/ff/sdio_stm32f1.c ****   
 147:lib/ff/sdio_stm32f1.c ****   /*!< Set Power State to OFF */
 148:lib/ff/sdio_stm32f1.c ****   SDIO_SetPowerState(SDIO_PowerState_OFF);
 149:lib/ff/sdio_stm32f1.c **** 
 150:lib/ff/sdio_stm32f1.c ****   /*!< DeInitializes the SDIO peripheral */
 151:lib/ff/sdio_stm32f1.c ****   SDIO_DeInit();
 152:lib/ff/sdio_stm32f1.c ****   
 153:lib/ff/sdio_stm32f1.c ****   /*!< Disable the SDIO AHB Clock */
 154:lib/ff/sdio_stm32f1.c ****   RCC_AHBPeriphClockCmd(RCC_AHBPeriph_SDIO, DISABLE);
 155:lib/ff/sdio_stm32f1.c **** 
 156:lib/ff/sdio_stm32f1.c ****   /*!< Configure PC.08, PC.09, PC.10, PC.11, PC.12 pin: D0, D1, D2, D3, CLK pin */
 157:lib/ff/sdio_stm32f1.c ****   GPIO_InitStructure.GPIO_Pin = GPIO_Pin_8 | GPIO_Pin_9 | GPIO_Pin_10 | GPIO_Pin_11 | GPIO_Pin_12;
 158:lib/ff/sdio_stm32f1.c ****   GPIO_InitStructure.GPIO_Mode = GPIO_Mode_IN_FLOATING;
 159:lib/ff/sdio_stm32f1.c ****   GPIO_Init(GPIOC, &GPIO_InitStructure);
 160:lib/ff/sdio_stm32f1.c **** 
 161:lib/ff/sdio_stm32f1.c ****   /*!< Configure PD.02 CMD line */
 162:lib/ff/sdio_stm32f1.c ****   GPIO_InitStructure.GPIO_Pin = GPIO_Pin_2;
 163:lib/ff/sdio_stm32f1.c ****   GPIO_Init(GPIOD, &GPIO_InitStructure);
 164:lib/ff/sdio_stm32f1.c **** }
 165:lib/ff/sdio_stm32f1.c **** 
 166:lib/ff/sdio_stm32f1.c **** 
 167:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 168:lib/ff/sdio_stm32f1.c **** /*! 
 169:lib/ff/sdio_stm32f1.c ****     @brief  Initializes the SD Card and put it into StandBy State (Ready for data 
 170:lib/ff/sdio_stm32f1.c ****             transfer).
 171:lib/ff/sdio_stm32f1.c **** 	@param  None
 172:lib/ff/sdio_stm32f1.c ****     @retval SD_Error: SD Card Error code.
 173:lib/ff/sdio_stm32f1.c **** */
 174:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 175:lib/ff/sdio_stm32f1.c **** SD_Error SD_Init(void)
 176:lib/ff/sdio_stm32f1.c **** {
 177:lib/ff/sdio_stm32f1.c ****   GPIO_InitTypeDef  GPIO_InitStructure;
 178:lib/ff/sdio_stm32f1.c ****   NVIC_InitTypeDef NVIC_InitStructure;
 179:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
 180:lib/ff/sdio_stm32f1.c ****  
 181:lib/ff/sdio_stm32f1.c ****   /* SDIO Peripheral Low Level Init */
 182:lib/ff/sdio_stm32f1.c ****   /*!< GPIOC and GPIOD Periph clock enable */
 183:lib/ff/sdio_stm32f1.c ****   RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOC | RCC_APB2Periph_GPIOD | SD_DETECT_GPIO_CLK, ENABLE);
 184:lib/ff/sdio_stm32f1.c **** 
 185:lib/ff/sdio_stm32f1.c ****   /*!< Configure PC.08, PC.09, PC.10, PC.11, PC.12 pin: D0, D1, D2, D3, CLK pin */
 186:lib/ff/sdio_stm32f1.c ****   GPIO_InitStructure.GPIO_Pin = GPIO_Pin_8 | GPIO_Pin_9 | GPIO_Pin_10 | GPIO_Pin_11 | GPIO_Pin_12;
 187:lib/ff/sdio_stm32f1.c ****   GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;
 188:lib/ff/sdio_stm32f1.c ****   GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF_PP;
 189:lib/ff/sdio_stm32f1.c ****   GPIO_Init(GPIOC, &GPIO_InitStructure);
 190:lib/ff/sdio_stm32f1.c **** 
 191:lib/ff/sdio_stm32f1.c ****   /*!< Configure PD.02 CMD line */
 192:lib/ff/sdio_stm32f1.c ****   GPIO_InitStructure.GPIO_Pin = GPIO_Pin_2;
 193:lib/ff/sdio_stm32f1.c ****   GPIO_Init(GPIOD, &GPIO_InitStructure);
 194:lib/ff/sdio_stm32f1.c **** 
 195:lib/ff/sdio_stm32f1.c ****   /*!< Configure SD_SPI_DETECT_PIN pin: SD Card detect pin */
 196:lib/ff/sdio_stm32f1.c ****   GPIO_InitStructure.GPIO_Pin = SD_DETECT_PIN;
 197:lib/ff/sdio_stm32f1.c ****   GPIO_InitStructure.GPIO_Mode = GPIO_Mode_IPU;
 198:lib/ff/sdio_stm32f1.c ****   GPIO_Init(SD_DETECT_GPIO_PORT, &GPIO_InitStructure);
 199:lib/ff/sdio_stm32f1.c ****   
 200:lib/ff/sdio_stm32f1.c ****   /*!< Enable the SDIO AHB Clock */
 201:lib/ff/sdio_stm32f1.c ****   RCC_AHBPeriphClockCmd(RCC_AHBPeriph_SDIO, ENABLE);
 202:lib/ff/sdio_stm32f1.c **** 
 203:lib/ff/sdio_stm32f1.c ****   /*!< Enable the DMA2 Clock */
 204:lib/ff/sdio_stm32f1.c ****   RCC_AHBPeriphClockCmd(RCC_AHBPeriph_DMA2, ENABLE);
 205:lib/ff/sdio_stm32f1.c ****   /* End of LowLevel Init */
 206:lib/ff/sdio_stm32f1.c **** 
 207:lib/ff/sdio_stm32f1.c **** 
 208:lib/ff/sdio_stm32f1.c ****   SDIO_DeInit();
 209:lib/ff/sdio_stm32f1.c **** 
 210:lib/ff/sdio_stm32f1.c ****   errorstatus = SD_PowerON();
 211:lib/ff/sdio_stm32f1.c **** 
 212:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
 213:lib/ff/sdio_stm32f1.c ****   {
 214:lib/ff/sdio_stm32f1.c ****     /*!< CMD Response TimeOut (wait for CMDSENT flag) */
 215:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 216:lib/ff/sdio_stm32f1.c ****   }
 217:lib/ff/sdio_stm32f1.c **** 
 218:lib/ff/sdio_stm32f1.c ****   errorstatus = SD_InitializeCards();
 219:lib/ff/sdio_stm32f1.c **** 
 220:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
 221:lib/ff/sdio_stm32f1.c ****   {
 222:lib/ff/sdio_stm32f1.c ****     /*!< CMD Response TimeOut (wait for CMDSENT flag) */
 223:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 224:lib/ff/sdio_stm32f1.c ****   }
 225:lib/ff/sdio_stm32f1.c **** 
 226:lib/ff/sdio_stm32f1.c ****   /*!< Configure the SDIO peripheral */
 227:lib/ff/sdio_stm32f1.c ****   /*!< SDIOCLK = HCLK, SDIO_CK = HCLK/(2 + SDIO_TRANSFER_CLK_DIV) */ 
 228:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_ClockDiv = SDIO_TRANSFER_CLK_DIV; 
 229:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_ClockEdge = SDIO_ClockEdge_Rising;
 230:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_ClockBypass = SDIO_ClockBypass_Disable;
 231:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_ClockPowerSave = SDIO_ClockPowerSave_Disable;
 232:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_BusWide = SDIO_BusWide_1b;
 233:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_HardwareFlowControl = SDIO_HardwareFlowControl_Disable;
 234:lib/ff/sdio_stm32f1.c ****   SDIO_Init(&SDIO_InitStructure);
 235:lib/ff/sdio_stm32f1.c **** 
 236:lib/ff/sdio_stm32f1.c ****   /*!< Enable the SDIO Interrupt */
 237:lib/ff/sdio_stm32f1.c ****   NVIC_InitStructure.NVIC_IRQChannel = SDIO_IRQn;
 238:lib/ff/sdio_stm32f1.c ****   NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 0;
 239:lib/ff/sdio_stm32f1.c ****   NVIC_InitStructure.NVIC_IRQChannelSubPriority = 0;
 240:lib/ff/sdio_stm32f1.c ****   NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;
 241:lib/ff/sdio_stm32f1.c ****   NVIC_Init(&NVIC_InitStructure);
 242:lib/ff/sdio_stm32f1.c **** 
 243:lib/ff/sdio_stm32f1.c ****   if (errorstatus == SD_OK)
 244:lib/ff/sdio_stm32f1.c ****   {
 245:lib/ff/sdio_stm32f1.c ****     /*----------------- Read CSD/CID MSD registers ------------------*/
 246:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_GetCardInfo(&SDCardInfo);
 247:lib/ff/sdio_stm32f1.c ****   }
 248:lib/ff/sdio_stm32f1.c **** 
 249:lib/ff/sdio_stm32f1.c ****   if (errorstatus == SD_OK)
 250:lib/ff/sdio_stm32f1.c ****   {
 251:lib/ff/sdio_stm32f1.c ****     /*----------------- Select Card --------------------------------*/
 252:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_SelectDeselect((uint32_t) (SDCardInfo.RCA << 16));
 253:lib/ff/sdio_stm32f1.c ****   }
 254:lib/ff/sdio_stm32f1.c **** 
 255:lib/ff/sdio_stm32f1.c ****   if (errorstatus == SD_OK)
 256:lib/ff/sdio_stm32f1.c ****   {
 257:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_EnableWideBusOperation(SDIO_BusWide_4b);
 258:lib/ff/sdio_stm32f1.c ****   }  
 259:lib/ff/sdio_stm32f1.c **** 
 260:lib/ff/sdio_stm32f1.c ****   /* Set Device Transfer Mode to DMA */
 261:lib/ff/sdio_stm32f1.c ****   if (errorstatus == SD_OK)
 262:lib/ff/sdio_stm32f1.c ****   {  
 263:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_SetDeviceMode(SD_DMA_MODE);
 264:lib/ff/sdio_stm32f1.c ****   }
 265:lib/ff/sdio_stm32f1.c **** 
 266:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
 267:lib/ff/sdio_stm32f1.c **** }
 268:lib/ff/sdio_stm32f1.c **** 
 269:lib/ff/sdio_stm32f1.c ****   
 270:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 271:lib/ff/sdio_stm32f1.c **** /*! 
 272:lib/ff/sdio_stm32f1.c ****     @brief  Gets the cuurent sd card data transfer status.
 273:lib/ff/sdio_stm32f1.c **** 	@param  None
 274:lib/ff/sdio_stm32f1.c ****     @retval SDTransferState: Data Transfer state.
 275:lib/ff/sdio_stm32f1.c **** 			This value can be: 
 276:lib/ff/sdio_stm32f1.c **** 			- SD_TRANSFER_OK: No data transfer is acting
 277:lib/ff/sdio_stm32f1.c **** 			- SD_TRANSFER_BUSY: Data transfer is acting
 278:lib/ff/sdio_stm32f1.c **** */
 279:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 280:lib/ff/sdio_stm32f1.c **** SDTransferState SD_GetStatus(void)
 281:lib/ff/sdio_stm32f1.c **** {
 282:lib/ff/sdio_stm32f1.c ****   SDCardState cardstate =  SD_CARD_TRANSFER;
 283:lib/ff/sdio_stm32f1.c **** 
 284:lib/ff/sdio_stm32f1.c ****   cardstate = SD_GetState();
 285:lib/ff/sdio_stm32f1.c ****   
 286:lib/ff/sdio_stm32f1.c ****   if (cardstate == SD_CARD_TRANSFER)
 287:lib/ff/sdio_stm32f1.c ****   {
 288:lib/ff/sdio_stm32f1.c ****     return(SD_TRANSFER_OK);
 289:lib/ff/sdio_stm32f1.c ****   }
 290:lib/ff/sdio_stm32f1.c ****   else if(cardstate == SD_CARD_ERROR)
 291:lib/ff/sdio_stm32f1.c ****   {
 292:lib/ff/sdio_stm32f1.c ****     return (SD_TRANSFER_ERROR);
 293:lib/ff/sdio_stm32f1.c ****   }
 294:lib/ff/sdio_stm32f1.c ****   else
 295:lib/ff/sdio_stm32f1.c ****   {
 296:lib/ff/sdio_stm32f1.c ****     return(SD_TRANSFER_BUSY);
 297:lib/ff/sdio_stm32f1.c ****   }
 298:lib/ff/sdio_stm32f1.c **** }
 299:lib/ff/sdio_stm32f1.c **** 
 300:lib/ff/sdio_stm32f1.c **** 
 301:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 302:lib/ff/sdio_stm32f1.c **** /*! 
 303:lib/ff/sdio_stm32f1.c ****     @brief  Returns the current card's state.
 304:lib/ff/sdio_stm32f1.c **** 	@param  None
 305:lib/ff/sdio_stm32f1.c ****     @retval SDCardState: SD Card Error or SD Card Current State.
 306:lib/ff/sdio_stm32f1.c **** */
 307:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 308:lib/ff/sdio_stm32f1.c **** SDCardState SD_GetState(void)
 309:lib/ff/sdio_stm32f1.c **** {
 310:lib/ff/sdio_stm32f1.c ****   uint32_t resp1 = 0;
 311:lib/ff/sdio_stm32f1.c ****   
 312:lib/ff/sdio_stm32f1.c ****   if(SD_Detect()== SD_PRESENT)
 313:lib/ff/sdio_stm32f1.c ****   {
 314:lib/ff/sdio_stm32f1.c ****     if (SD_SendStatus(&resp1) != SD_OK)
 315:lib/ff/sdio_stm32f1.c ****     {
 316:lib/ff/sdio_stm32f1.c ****       return SD_CARD_ERROR;
 317:lib/ff/sdio_stm32f1.c ****     }
 318:lib/ff/sdio_stm32f1.c ****     else
 319:lib/ff/sdio_stm32f1.c ****     {
 320:lib/ff/sdio_stm32f1.c ****       return (SDCardState)((resp1 >> 9) & 0x0F);
 321:lib/ff/sdio_stm32f1.c ****     }
 322:lib/ff/sdio_stm32f1.c ****   }
 323:lib/ff/sdio_stm32f1.c ****   else
 324:lib/ff/sdio_stm32f1.c ****   {
 325:lib/ff/sdio_stm32f1.c ****     return SD_CARD_ERROR;
 326:lib/ff/sdio_stm32f1.c ****   }
 327:lib/ff/sdio_stm32f1.c **** }
 328:lib/ff/sdio_stm32f1.c **** 
 329:lib/ff/sdio_stm32f1.c **** 
 330:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 331:lib/ff/sdio_stm32f1.c **** /*! 
 332:lib/ff/sdio_stm32f1.c ****     @brief  Detect if SD card is correctly plugged in the memory slot.
 333:lib/ff/sdio_stm32f1.c **** 	@param  None
 334:lib/ff/sdio_stm32f1.c ****     @retval Return if SD is detected or not
 335:lib/ff/sdio_stm32f1.c **** */
 336:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 337:lib/ff/sdio_stm32f1.c **** uint8_t SD_Detect(void)
 338:lib/ff/sdio_stm32f1.c **** {
 339:lib/ff/sdio_stm32f1.c ****   __IO uint8_t status = SD_PRESENT;
 340:lib/ff/sdio_stm32f1.c **** 
 341:lib/ff/sdio_stm32f1.c ****   /*!< Check GPIO to detect SD */
 342:lib/ff/sdio_stm32f1.c ****   /* Nemui added: NO SD_DETECT Pport on@STM32Primer2's MicroSD Card Slot! */
 343:lib/ff/sdio_stm32f1.c ****   /*
 344:lib/ff/sdio_stm32f1.c ****   if (GPIO_ReadInputDataBit(SD_DETECT_GPIO_PORT, SD_DETECT_PIN) != Bit_RESET)
 345:lib/ff/sdio_stm32f1.c ****   {
 346:lib/ff/sdio_stm32f1.c ****     status = SD_NOT_PRESENT;
 347:lib/ff/sdio_stm32f1.c ****   }
 348:lib/ff/sdio_stm32f1.c ****   */
 349:lib/ff/sdio_stm32f1.c ****   return status;
 350:lib/ff/sdio_stm32f1.c **** }
 351:lib/ff/sdio_stm32f1.c **** 
 352:lib/ff/sdio_stm32f1.c **** 
 353:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 354:lib/ff/sdio_stm32f1.c **** /*! 
 355:lib/ff/sdio_stm32f1.c ****     @brief  Enquires cards about their operating voltage and configures 
 356:lib/ff/sdio_stm32f1.c **** 			clock controls.
 357:lib/ff/sdio_stm32f1.c **** 	@param  None
 358:lib/ff/sdio_stm32f1.c ****     @retval SD_Error: SD Card Error code.
 359:lib/ff/sdio_stm32f1.c **** */
 360:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 361:lib/ff/sdio_stm32f1.c **** SD_Error SD_PowerON(void)
 362:lib/ff/sdio_stm32f1.c **** {
 363:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
 364:lib/ff/sdio_stm32f1.c ****   uint32_t response = 0, count = 0, validvoltage = 0;
 365:lib/ff/sdio_stm32f1.c ****   uint32_t SDType = SD_STD_CAPACITY;
 366:lib/ff/sdio_stm32f1.c **** 
 367:lib/ff/sdio_stm32f1.c ****   /*!< Power ON Sequence -----------------------------------------------------*/
 368:lib/ff/sdio_stm32f1.c ****   /*!< Configure the SDIO peripheral */
 369:lib/ff/sdio_stm32f1.c ****   /*!< SDIOCLK = HCLK, SDIO_CK = HCLK/(2 + SDIO_INIT_CLK_DIV) */
 370:lib/ff/sdio_stm32f1.c ****   /*!< SDIO_CK for initialization should not exceed 400 KHz */  
 371:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_ClockDiv = SDIO_INIT_CLK_DIV;
 372:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_ClockEdge = SDIO_ClockEdge_Rising;
 373:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_ClockBypass = SDIO_ClockBypass_Disable;
 374:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_ClockPowerSave = SDIO_ClockPowerSave_Disable;
 375:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_BusWide = SDIO_BusWide_1b;
 376:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_HardwareFlowControl = SDIO_HardwareFlowControl_Disable;
 377:lib/ff/sdio_stm32f1.c ****   SDIO_Init(&SDIO_InitStructure);
 378:lib/ff/sdio_stm32f1.c **** 
 379:lib/ff/sdio_stm32f1.c ****   /*!< Set Power State to ON */
 380:lib/ff/sdio_stm32f1.c ****   SDIO_SetPowerState(SDIO_PowerState_ON);
 381:lib/ff/sdio_stm32f1.c **** 
 382:lib/ff/sdio_stm32f1.c ****   /*!< Enable SDIO Clock */
 383:lib/ff/sdio_stm32f1.c ****   SDIO_ClockCmd(ENABLE);
 384:lib/ff/sdio_stm32f1.c **** 
 385:lib/ff/sdio_stm32f1.c ****   /*!< CMD0: GO_IDLE_STATE ---------------------------------------------------*/
 386:lib/ff/sdio_stm32f1.c ****   /*!< No CMD response required */
 387:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = 0x0;
 388:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_GO_IDLE_STATE;
 389:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_No;
 390:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 391:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 392:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 393:lib/ff/sdio_stm32f1.c **** 
 394:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdError();
 395:lib/ff/sdio_stm32f1.c **** 
 396:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
 397:lib/ff/sdio_stm32f1.c ****   {
 398:lib/ff/sdio_stm32f1.c ****     /*!< CMD Response TimeOut (wait for CMDSENT flag) */
 399:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 400:lib/ff/sdio_stm32f1.c ****   }
 401:lib/ff/sdio_stm32f1.c **** 
 402:lib/ff/sdio_stm32f1.c ****   /*!< CMD8: SEND_IF_COND ----------------------------------------------------*/
 403:lib/ff/sdio_stm32f1.c ****   /*!< Send CMD8 to verify SD card interface operating condition */
 404:lib/ff/sdio_stm32f1.c ****   /*!< Argument: - [31:12]: Reserved (shall be set to '0')
 405:lib/ff/sdio_stm32f1.c ****                - [11:8]: Supply Voltage (VHS) 0x1 (Range: 2.7-3.6 V)
 406:lib/ff/sdio_stm32f1.c ****                - [7:0]: Check Pattern (recommended 0xAA) */
 407:lib/ff/sdio_stm32f1.c ****   /*!< CMD Response: R7 */
 408:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = SD_CHECK_PATTERN;
 409:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SDIO_SEND_IF_COND;
 410:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 411:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 412:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 413:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 414:lib/ff/sdio_stm32f1.c **** 
 415:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp7Error();
 416:lib/ff/sdio_stm32f1.c **** 
 417:lib/ff/sdio_stm32f1.c ****   if (errorstatus == SD_OK)
 418:lib/ff/sdio_stm32f1.c ****   {
 419:lib/ff/sdio_stm32f1.c ****     CardType = SDIO_STD_CAPACITY_SD_CARD_V2_0; /*!< SD Card 2.0 */
 420:lib/ff/sdio_stm32f1.c ****     SDType = SD_HIGH_CAPACITY;
 421:lib/ff/sdio_stm32f1.c ****   }
 422:lib/ff/sdio_stm32f1.c ****   else
 423:lib/ff/sdio_stm32f1.c ****   {
 424:lib/ff/sdio_stm32f1.c ****     /*!< CMD55 */
 425:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Argument = 0x00;
 426:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_CMD;
 427:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 428:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 429:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 430:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
 431:lib/ff/sdio_stm32f1.c ****     errorstatus = CmdResp1Error(SD_CMD_APP_CMD);
 432:lib/ff/sdio_stm32f1.c ****   }
 433:lib/ff/sdio_stm32f1.c ****   /*!< CMD55 */
 434:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = 0x00;
 435:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_CMD;
 436:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 437:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 438:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 439:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 440:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_APP_CMD);
 441:lib/ff/sdio_stm32f1.c **** 
 442:lib/ff/sdio_stm32f1.c ****   /*!< If errorstatus is Command TimeOut, it is a MMC card */
 443:lib/ff/sdio_stm32f1.c ****   /*!< If errorstatus is SD_OK it is a SD card: SD card 2.0 (voltage range mismatch)
 444:lib/ff/sdio_stm32f1.c ****      or SD card 1.x */
 445:lib/ff/sdio_stm32f1.c ****   if (errorstatus == SD_OK)
 446:lib/ff/sdio_stm32f1.c ****   {
 447:lib/ff/sdio_stm32f1.c ****     /*!< SD CARD */
 448:lib/ff/sdio_stm32f1.c ****     /*!< Send ACMD41 SD_APP_OP_COND with Argument 0x80100000 */
 449:lib/ff/sdio_stm32f1.c ****     while ((!validvoltage) && (count < SD_MAX_VOLT_TRIAL))
 450:lib/ff/sdio_stm32f1.c ****     {
 451:lib/ff/sdio_stm32f1.c **** 
 452:lib/ff/sdio_stm32f1.c ****       /*!< SEND CMD55 APP_CMD with RCA as 0 */
 453:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Argument = 0x00;
 454:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_CMD;
 455:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 456:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 457:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 458:lib/ff/sdio_stm32f1.c ****       SDIO_SendCommand(&SDIO_CmdInitStructure);
 459:lib/ff/sdio_stm32f1.c **** 
 460:lib/ff/sdio_stm32f1.c ****       errorstatus = CmdResp1Error(SD_CMD_APP_CMD);
 461:lib/ff/sdio_stm32f1.c **** 
 462:lib/ff/sdio_stm32f1.c ****       if (errorstatus != SD_OK)
 463:lib/ff/sdio_stm32f1.c ****       {
 464:lib/ff/sdio_stm32f1.c ****         return(errorstatus);
 465:lib/ff/sdio_stm32f1.c ****       }
 466:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Argument = SD_VOLTAGE_WINDOW_SD | SDType;
 467:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SD_APP_OP_COND;
 468:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 469:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 470:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 471:lib/ff/sdio_stm32f1.c ****       SDIO_SendCommand(&SDIO_CmdInitStructure);
 472:lib/ff/sdio_stm32f1.c **** 
 473:lib/ff/sdio_stm32f1.c ****       errorstatus = CmdResp3Error();
 474:lib/ff/sdio_stm32f1.c ****       if (errorstatus != SD_OK)
 475:lib/ff/sdio_stm32f1.c ****       {
 476:lib/ff/sdio_stm32f1.c ****         return(errorstatus);
 477:lib/ff/sdio_stm32f1.c ****       }
 478:lib/ff/sdio_stm32f1.c **** 
 479:lib/ff/sdio_stm32f1.c ****       response = SDIO_GetResponse(SDIO_RESP1);
 480:lib/ff/sdio_stm32f1.c ****       validvoltage = (((response >> 31) == 1) ? 1 : 0);
 481:lib/ff/sdio_stm32f1.c ****       count++;
 482:lib/ff/sdio_stm32f1.c ****     }
 483:lib/ff/sdio_stm32f1.c ****     if (count >= SD_MAX_VOLT_TRIAL)
 484:lib/ff/sdio_stm32f1.c ****     {
 485:lib/ff/sdio_stm32f1.c ****       errorstatus = SD_INVALID_VOLTRANGE;
 486:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
 487:lib/ff/sdio_stm32f1.c ****     }
 488:lib/ff/sdio_stm32f1.c **** 
 489:lib/ff/sdio_stm32f1.c ****     if (response &= SD_HIGH_CAPACITY)
 490:lib/ff/sdio_stm32f1.c ****     {
 491:lib/ff/sdio_stm32f1.c ****       CardType = SDIO_HIGH_CAPACITY_SD_CARD;
 492:lib/ff/sdio_stm32f1.c ****     }
 493:lib/ff/sdio_stm32f1.c **** 
 494:lib/ff/sdio_stm32f1.c ****   }/*!< else MMC Card */
 495:lib/ff/sdio_stm32f1.c **** 
 496:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
 497:lib/ff/sdio_stm32f1.c **** }
 498:lib/ff/sdio_stm32f1.c **** 
 499:lib/ff/sdio_stm32f1.c **** 
 500:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 501:lib/ff/sdio_stm32f1.c **** /*! 
 502:lib/ff/sdio_stm32f1.c ****     @brief  Turns the SDIO output signals off.
 503:lib/ff/sdio_stm32f1.c **** 	@param  None
 504:lib/ff/sdio_stm32f1.c ****     @retval SD_Error: SD Card Error code.
 505:lib/ff/sdio_stm32f1.c **** */
 506:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 507:lib/ff/sdio_stm32f1.c **** SD_Error SD_PowerOFF(void)
 508:lib/ff/sdio_stm32f1.c **** {
 509:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
 510:lib/ff/sdio_stm32f1.c **** 
 511:lib/ff/sdio_stm32f1.c ****   /*!< Set Power State to OFF */
 512:lib/ff/sdio_stm32f1.c ****   SDIO_SetPowerState(SDIO_PowerState_OFF);
 513:lib/ff/sdio_stm32f1.c **** 
 514:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
 515:lib/ff/sdio_stm32f1.c **** }
 516:lib/ff/sdio_stm32f1.c **** 
 517:lib/ff/sdio_stm32f1.c **** 
 518:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 519:lib/ff/sdio_stm32f1.c **** /*! 
 520:lib/ff/sdio_stm32f1.c ****     @brief  Intialises all cards or single card as the case may be Card(s) come 
 521:lib/ff/sdio_stm32f1.c **** 			into standby state.
 522:lib/ff/sdio_stm32f1.c **** 	@param  None
 523:lib/ff/sdio_stm32f1.c ****     @retval SD_Error: SD Card Error code.
 524:lib/ff/sdio_stm32f1.c **** */
 525:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 526:lib/ff/sdio_stm32f1.c **** SD_Error SD_InitializeCards(void)
 527:lib/ff/sdio_stm32f1.c **** {
 528:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
 529:lib/ff/sdio_stm32f1.c ****   uint16_t rca = 0x01;
 530:lib/ff/sdio_stm32f1.c **** 
 531:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetPowerState() == SDIO_PowerState_OFF)
 532:lib/ff/sdio_stm32f1.c ****   {
 533:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_REQUEST_NOT_APPLICABLE;
 534:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 535:lib/ff/sdio_stm32f1.c ****   }
 536:lib/ff/sdio_stm32f1.c **** 
 537:lib/ff/sdio_stm32f1.c ****   if (SDIO_SECURE_DIGITAL_IO_CARD != CardType)
 538:lib/ff/sdio_stm32f1.c ****   {
 539:lib/ff/sdio_stm32f1.c ****     /*!< Send CMD2 ALL_SEND_CID */
 540:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Argument = 0x0;
 541:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_ALL_SEND_CID;
 542:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Long;
 543:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 544:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 545:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
 546:lib/ff/sdio_stm32f1.c **** 
 547:lib/ff/sdio_stm32f1.c ****     errorstatus = CmdResp2Error();
 548:lib/ff/sdio_stm32f1.c **** 
 549:lib/ff/sdio_stm32f1.c ****     if (SD_OK != errorstatus)
 550:lib/ff/sdio_stm32f1.c ****     {
 551:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
 552:lib/ff/sdio_stm32f1.c ****     }
 553:lib/ff/sdio_stm32f1.c **** 
 554:lib/ff/sdio_stm32f1.c ****     CID_Tab[0] = SDIO_GetResponse(SDIO_RESP1);
 555:lib/ff/sdio_stm32f1.c ****     CID_Tab[1] = SDIO_GetResponse(SDIO_RESP2);
 556:lib/ff/sdio_stm32f1.c ****     CID_Tab[2] = SDIO_GetResponse(SDIO_RESP3);
 557:lib/ff/sdio_stm32f1.c ****     CID_Tab[3] = SDIO_GetResponse(SDIO_RESP4);
 558:lib/ff/sdio_stm32f1.c ****   }
 559:lib/ff/sdio_stm32f1.c ****   if ((SDIO_STD_CAPACITY_SD_CARD_V1_1 == CardType) ||  (SDIO_STD_CAPACITY_SD_CARD_V2_0 == CardType)
 560:lib/ff/sdio_stm32f1.c ****       ||  (SDIO_HIGH_CAPACITY_SD_CARD == CardType))
 561:lib/ff/sdio_stm32f1.c ****   {
 562:lib/ff/sdio_stm32f1.c ****     /*!< Send CMD3 SET_REL_ADDR with argument 0 */
 563:lib/ff/sdio_stm32f1.c ****     /*!< SD Card publishes its RCA. */
 564:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Argument = 0x00;
 565:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SET_REL_ADDR;
 566:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 567:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 568:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 569:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
 570:lib/ff/sdio_stm32f1.c **** 
 571:lib/ff/sdio_stm32f1.c ****     errorstatus = CmdResp6Error(SD_CMD_SET_REL_ADDR, &rca);
 572:lib/ff/sdio_stm32f1.c **** 
 573:lib/ff/sdio_stm32f1.c ****     if (SD_OK != errorstatus)
 574:lib/ff/sdio_stm32f1.c ****     {
 575:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
 576:lib/ff/sdio_stm32f1.c ****     }
 577:lib/ff/sdio_stm32f1.c ****   }
 578:lib/ff/sdio_stm32f1.c **** 
 579:lib/ff/sdio_stm32f1.c ****   if (SDIO_SECURE_DIGITAL_IO_CARD != CardType)
 580:lib/ff/sdio_stm32f1.c ****   {
 581:lib/ff/sdio_stm32f1.c ****     RCA = rca;
 582:lib/ff/sdio_stm32f1.c **** 
 583:lib/ff/sdio_stm32f1.c ****     /*!< Send CMD9 SEND_CSD with argument as card's RCA */
 584:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Argument = (uint32_t)(rca << 16);
 585:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SEND_CSD;
 586:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Long;
 587:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 588:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 589:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
 590:lib/ff/sdio_stm32f1.c **** 
 591:lib/ff/sdio_stm32f1.c ****     errorstatus = CmdResp2Error();
 592:lib/ff/sdio_stm32f1.c **** 
 593:lib/ff/sdio_stm32f1.c ****     if (SD_OK != errorstatus)
 594:lib/ff/sdio_stm32f1.c ****     {
 595:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
 596:lib/ff/sdio_stm32f1.c ****     }
 597:lib/ff/sdio_stm32f1.c **** 
 598:lib/ff/sdio_stm32f1.c ****     CSD_Tab[0] = SDIO_GetResponse(SDIO_RESP1);
 599:lib/ff/sdio_stm32f1.c ****     CSD_Tab[1] = SDIO_GetResponse(SDIO_RESP2);
 600:lib/ff/sdio_stm32f1.c ****     CSD_Tab[2] = SDIO_GetResponse(SDIO_RESP3);
 601:lib/ff/sdio_stm32f1.c ****     CSD_Tab[3] = SDIO_GetResponse(SDIO_RESP4);
 602:lib/ff/sdio_stm32f1.c ****   }
 603:lib/ff/sdio_stm32f1.c **** 
 604:lib/ff/sdio_stm32f1.c ****   errorstatus = SD_OK; /*!< All cards get intialized */
 605:lib/ff/sdio_stm32f1.c **** 
 606:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
 607:lib/ff/sdio_stm32f1.c **** }
 608:lib/ff/sdio_stm32f1.c **** 
 609:lib/ff/sdio_stm32f1.c **** 
 610:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 611:lib/ff/sdio_stm32f1.c **** /*! 
 612:lib/ff/sdio_stm32f1.c ****     @brief  Returns information about specific card.
 613:lib/ff/sdio_stm32f1.c **** 	@param  cardinfo: pointer to a SD_CardInfo structure that contains all SD card 
 614:lib/ff/sdio_stm32f1.c **** 			information.
 615:lib/ff/sdio_stm32f1.c ****     @retval SD_Error: SD Card Error code.
 616:lib/ff/sdio_stm32f1.c **** */
 617:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 618:lib/ff/sdio_stm32f1.c **** SD_Error SD_GetCardInfo(SD_CardInfo *cardinfo)
 619:lib/ff/sdio_stm32f1.c **** {
 620:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
 621:lib/ff/sdio_stm32f1.c ****   uint8_t tmp = 0;
 622:lib/ff/sdio_stm32f1.c **** 
 623:lib/ff/sdio_stm32f1.c ****   cardinfo->CardType = (uint8_t)CardType;
 624:lib/ff/sdio_stm32f1.c ****   cardinfo->RCA = (uint16_t)RCA;
 625:lib/ff/sdio_stm32f1.c **** 
 626:lib/ff/sdio_stm32f1.c ****   /*!< Byte 0 */
 627:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CSD_Tab[0] & 0xFF000000) >> 24);
 628:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.CSDStruct = (tmp & 0xC0) >> 6;
 629:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.SysSpecVersion = (tmp & 0x3C) >> 2;
 630:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.Reserved1 = tmp & 0x03;
 631:lib/ff/sdio_stm32f1.c **** 
 632:lib/ff/sdio_stm32f1.c ****   /*!< Byte 1 */
 633:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CSD_Tab[0] & 0x00FF0000) >> 16);
 634:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.TAAC = tmp;
 635:lib/ff/sdio_stm32f1.c **** 
 636:lib/ff/sdio_stm32f1.c ****   /*!< Byte 2 */
 637:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CSD_Tab[0] & 0x0000FF00) >> 8);
 638:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.NSAC = tmp;
 639:lib/ff/sdio_stm32f1.c **** 
 640:lib/ff/sdio_stm32f1.c ****   /*!< Byte 3 */
 641:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)(CSD_Tab[0] & 0x000000FF);
 642:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.MaxBusClkFrec = tmp;
 643:lib/ff/sdio_stm32f1.c **** 
 644:lib/ff/sdio_stm32f1.c ****   /*!< Byte 4 */
 645:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CSD_Tab[1] & 0xFF000000) >> 24);
 646:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.CardComdClasses = tmp << 4;
 647:lib/ff/sdio_stm32f1.c **** 
 648:lib/ff/sdio_stm32f1.c ****   /*!< Byte 5 */
 649:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CSD_Tab[1] & 0x00FF0000) >> 16);
 650:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.CardComdClasses |= (tmp & 0xF0) >> 4;
 651:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.RdBlockLen = tmp & 0x0F;
 652:lib/ff/sdio_stm32f1.c **** 
 653:lib/ff/sdio_stm32f1.c ****   /*!< Byte 6 */
 654:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CSD_Tab[1] & 0x0000FF00) >> 8);
 655:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.PartBlockRead = (tmp & 0x80) >> 7;
 656:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.WrBlockMisalign = (tmp & 0x40) >> 6;
 657:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.RdBlockMisalign = (tmp & 0x20) >> 5;
 658:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.DSRImpl = (tmp & 0x10) >> 4;
 659:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.Reserved2 = 0; /*!< Reserved */
 660:lib/ff/sdio_stm32f1.c **** 
 661:lib/ff/sdio_stm32f1.c ****   if ((CardType == SDIO_STD_CAPACITY_SD_CARD_V1_1) || (CardType == SDIO_STD_CAPACITY_SD_CARD_V2_0))
 662:lib/ff/sdio_stm32f1.c ****   {
 663:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.DeviceSize = (tmp & 0x03) << 10;
 664:lib/ff/sdio_stm32f1.c **** 
 665:lib/ff/sdio_stm32f1.c ****     /*!< Byte 7 */
 666:lib/ff/sdio_stm32f1.c ****     tmp = (uint8_t)(CSD_Tab[1] & 0x000000FF);
 667:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.DeviceSize |= (tmp) << 2;
 668:lib/ff/sdio_stm32f1.c **** 
 669:lib/ff/sdio_stm32f1.c ****     /*!< Byte 8 */
 670:lib/ff/sdio_stm32f1.c ****     tmp = (uint8_t)((CSD_Tab[2] & 0xFF000000) >> 24);
 671:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.DeviceSize |= (tmp & 0xC0) >> 6;
 672:lib/ff/sdio_stm32f1.c **** 
 673:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.MaxRdCurrentVDDMin = (tmp & 0x38) >> 3;
 674:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.MaxRdCurrentVDDMax = (tmp & 0x07);
 675:lib/ff/sdio_stm32f1.c **** 
 676:lib/ff/sdio_stm32f1.c ****     /*!< Byte 9 */
 677:lib/ff/sdio_stm32f1.c ****     tmp = (uint8_t)((CSD_Tab[2] & 0x00FF0000) >> 16);
 678:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.MaxWrCurrentVDDMin = (tmp & 0xE0) >> 5;
 679:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.MaxWrCurrentVDDMax = (tmp & 0x1C) >> 2;
 680:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.DeviceSizeMul = (tmp & 0x03) << 1;
 681:lib/ff/sdio_stm32f1.c ****     /*!< Byte 10 */
 682:lib/ff/sdio_stm32f1.c ****     tmp = (uint8_t)((CSD_Tab[2] & 0x0000FF00) >> 8);
 683:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.DeviceSizeMul |= (tmp & 0x80) >> 7;
 684:lib/ff/sdio_stm32f1.c ****     
 685:lib/ff/sdio_stm32f1.c ****     cardinfo->CardCapacity = (cardinfo->SD_csd.DeviceSize + 1) ;
 686:lib/ff/sdio_stm32f1.c ****     cardinfo->CardCapacity *= (1 << (cardinfo->SD_csd.DeviceSizeMul + 2));
 687:lib/ff/sdio_stm32f1.c ****     cardinfo->CardBlockSize = 1 << (cardinfo->SD_csd.RdBlockLen);
 688:lib/ff/sdio_stm32f1.c ****     cardinfo->CardCapacity *= cardinfo->CardBlockSize;
 689:lib/ff/sdio_stm32f1.c ****   }
 690:lib/ff/sdio_stm32f1.c ****   else if (CardType == SDIO_HIGH_CAPACITY_SD_CARD)
 691:lib/ff/sdio_stm32f1.c ****   {
 692:lib/ff/sdio_stm32f1.c ****     /*!< Byte 7 */
 693:lib/ff/sdio_stm32f1.c ****     tmp = (uint8_t)(CSD_Tab[1] & 0x000000FF);
 694:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.DeviceSize = (tmp & 0x3F) << 16;
 695:lib/ff/sdio_stm32f1.c **** 
 696:lib/ff/sdio_stm32f1.c ****     /*!< Byte 8 */
 697:lib/ff/sdio_stm32f1.c ****     tmp = (uint8_t)((CSD_Tab[2] & 0xFF000000) >> 24);
 698:lib/ff/sdio_stm32f1.c **** 
 699:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.DeviceSize |= (tmp << 8);
 700:lib/ff/sdio_stm32f1.c **** 
 701:lib/ff/sdio_stm32f1.c ****     /*!< Byte 9 */
 702:lib/ff/sdio_stm32f1.c ****     tmp = (uint8_t)((CSD_Tab[2] & 0x00FF0000) >> 16);
 703:lib/ff/sdio_stm32f1.c **** 
 704:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.DeviceSize |= (tmp);
 705:lib/ff/sdio_stm32f1.c **** 
 706:lib/ff/sdio_stm32f1.c ****     /*!< Byte 10 */
 707:lib/ff/sdio_stm32f1.c ****     tmp = (uint8_t)((CSD_Tab[2] & 0x0000FF00) >> 8);
 708:lib/ff/sdio_stm32f1.c ****     /* nemui fixed due to SD2.00 Capacity fomula is Size = (C_SIZE+1)~2^19 */
 709:lib/ff/sdio_stm32f1.c ****     cardinfo->CardCapacity = (uint64_t)(cardinfo->SD_csd.DeviceSize + 1) * 512 * 1024;
 710:lib/ff/sdio_stm32f1.c ****     cardinfo->CardBlockSize = 512;    
 711:lib/ff/sdio_stm32f1.c ****   }
 712:lib/ff/sdio_stm32f1.c **** 
 713:lib/ff/sdio_stm32f1.c **** 
 714:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.EraseGrSize = (tmp & 0x40) >> 6;
 715:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.EraseGrMul = (tmp & 0x3F) << 1;
 716:lib/ff/sdio_stm32f1.c **** 
 717:lib/ff/sdio_stm32f1.c ****   /*!< Byte 11 */
 718:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)(CSD_Tab[2] & 0x000000FF);
 719:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.EraseGrMul |= (tmp & 0x80) >> 7;
 720:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.WrProtectGrSize = (tmp & 0x7F);
 721:lib/ff/sdio_stm32f1.c **** 
 722:lib/ff/sdio_stm32f1.c ****   /*!< Byte 12 */
 723:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CSD_Tab[3] & 0xFF000000) >> 24);
 724:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.WrProtectGrEnable = (tmp & 0x80) >> 7;
 725:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.ManDeflECC = (tmp & 0x60) >> 5;
 726:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.WrSpeedFact = (tmp & 0x1C) >> 2;
 727:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.MaxWrBlockLen = (tmp & 0x03) << 2;
 728:lib/ff/sdio_stm32f1.c **** 
 729:lib/ff/sdio_stm32f1.c ****   /*!< Byte 13 */
 730:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CSD_Tab[3] & 0x00FF0000) >> 16);
 731:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.MaxWrBlockLen |= (tmp & 0xC0) >> 6;
 732:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.WriteBlockPaPartial = (tmp & 0x20) >> 5;
 733:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.Reserved3 = 0;
 734:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.ContentProtectAppli = (tmp & 0x01);
 735:lib/ff/sdio_stm32f1.c **** 
 736:lib/ff/sdio_stm32f1.c ****   /*!< Byte 14 */
 737:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CSD_Tab[3] & 0x0000FF00) >> 8);
 738:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.FileFormatGrouop = (tmp & 0x80) >> 7;
 739:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.CopyFlag = (tmp & 0x40) >> 6;
 740:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.PermWrProtect = (tmp & 0x20) >> 5;
 741:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.TempWrProtect = (tmp & 0x10) >> 4;
 742:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.FileFormat = (tmp & 0x0C) >> 2;
 743:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.ECC = (tmp & 0x03);
 744:lib/ff/sdio_stm32f1.c **** 
 745:lib/ff/sdio_stm32f1.c ****   /*!< Byte 15 */
 746:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)(CSD_Tab[3] & 0x000000FF);
 747:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.CSD_CRC = (tmp & 0xFE) >> 1;
 748:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.Reserved4 = 1;
 749:lib/ff/sdio_stm32f1.c **** 
 750:lib/ff/sdio_stm32f1.c **** 
 751:lib/ff/sdio_stm32f1.c ****   /*!< Byte 0 */
 752:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CID_Tab[0] & 0xFF000000) >> 24);
 753:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ManufacturerID = tmp;
 754:lib/ff/sdio_stm32f1.c **** 
 755:lib/ff/sdio_stm32f1.c ****   /*!< Byte 1 */
 756:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CID_Tab[0] & 0x00FF0000) >> 16);
 757:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.OEM_AppliID = tmp << 8;
 758:lib/ff/sdio_stm32f1.c **** 
 759:lib/ff/sdio_stm32f1.c ****   /*!< Byte 2 */
 760:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CID_Tab[0] & 0x000000FF00) >> 8);
 761:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.OEM_AppliID |= tmp;
 762:lib/ff/sdio_stm32f1.c **** 
 763:lib/ff/sdio_stm32f1.c ****   /*!< Byte 3 */
 764:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)(CID_Tab[0] & 0x000000FF);
 765:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdName1 = tmp << 24;
 766:lib/ff/sdio_stm32f1.c **** 
 767:lib/ff/sdio_stm32f1.c ****   /*!< Byte 4 */
 768:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CID_Tab[1] & 0xFF000000) >> 24);
 769:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdName1 |= tmp << 16;
 770:lib/ff/sdio_stm32f1.c **** 
 771:lib/ff/sdio_stm32f1.c ****   /*!< Byte 5 */
 772:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CID_Tab[1] & 0x00FF0000) >> 16);
 773:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdName1 |= tmp << 8;
 774:lib/ff/sdio_stm32f1.c **** 
 775:lib/ff/sdio_stm32f1.c ****   /*!< Byte 6 */
 776:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CID_Tab[1] & 0x0000FF00) >> 8);
 777:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdName1 |= tmp;
 778:lib/ff/sdio_stm32f1.c **** 
 779:lib/ff/sdio_stm32f1.c ****   /*!< Byte 7 */
 780:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)(CID_Tab[1] & 0x000000FF);
 781:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdName2 = tmp;
 782:lib/ff/sdio_stm32f1.c **** 
 783:lib/ff/sdio_stm32f1.c ****   /*!< Byte 8 */
 784:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CID_Tab[2] & 0xFF000000) >> 24);
 785:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdRev = tmp;
 786:lib/ff/sdio_stm32f1.c **** 
 787:lib/ff/sdio_stm32f1.c ****   /*!< Byte 9 */
 788:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CID_Tab[2] & 0x00FF0000) >> 16);
 789:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdSN = tmp << 24;
 790:lib/ff/sdio_stm32f1.c **** 
 791:lib/ff/sdio_stm32f1.c ****   /*!< Byte 10 */
 792:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CID_Tab[2] & 0x0000FF00) >> 8);
 793:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdSN |= tmp << 16;
 794:lib/ff/sdio_stm32f1.c **** 
 795:lib/ff/sdio_stm32f1.c ****   /*!< Byte 11 */
 796:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)(CID_Tab[2] & 0x000000FF);
 797:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdSN |= tmp << 8;
 798:lib/ff/sdio_stm32f1.c **** 
 799:lib/ff/sdio_stm32f1.c ****   /*!< Byte 12 */
 800:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CID_Tab[3] & 0xFF000000) >> 24);
 801:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdSN |= tmp;
 802:lib/ff/sdio_stm32f1.c **** 
 803:lib/ff/sdio_stm32f1.c ****   /*!< Byte 13 */
 804:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CID_Tab[3] & 0x00FF0000) >> 16);
 805:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.Reserved1 |= (tmp & 0xF0) >> 4;
 806:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ManufactDate = (tmp & 0x0F) << 8;
 807:lib/ff/sdio_stm32f1.c **** 
 808:lib/ff/sdio_stm32f1.c ****   /*!< Byte 14 */
 809:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CID_Tab[3] & 0x0000FF00) >> 8);
 810:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ManufactDate |= tmp;
 811:lib/ff/sdio_stm32f1.c **** 
 812:lib/ff/sdio_stm32f1.c ****   /*!< Byte 15 */
 813:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)(CID_Tab[3] & 0x000000FF);
 814:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.CID_CRC = (tmp & 0xFE) >> 1;
 815:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.Reserved2 = 1;
 816:lib/ff/sdio_stm32f1.c ****   
 817:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
 818:lib/ff/sdio_stm32f1.c **** }
 819:lib/ff/sdio_stm32f1.c **** 
 820:lib/ff/sdio_stm32f1.c **** 
 821:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 822:lib/ff/sdio_stm32f1.c **** /*! 
 823:lib/ff/sdio_stm32f1.c **** 	@brief  Enables wide bus opeartion for the requeseted card if supported by 
 824:lib/ff/sdio_stm32f1.c **** 			card.
 825:lib/ff/sdio_stm32f1.c **** 	@param  WideMode: Specifies the SD card wide bus mode. 
 826:lib/ff/sdio_stm32f1.c **** 		This parameter can be one of the following values:
 827:lib/ff/sdio_stm32f1.c **** 		@arg SDIO_BusWide_8b: 8-bit data transfer (Only for MMC)
 828:lib/ff/sdio_stm32f1.c **** 		@arg SDIO_BusWide_4b: 4-bit data transfer
 829:lib/ff/sdio_stm32f1.c **** 		@arg SDIO_BusWide_1b: 1-bit data transfer
 830:lib/ff/sdio_stm32f1.c ****     @retval SD_Error: SD Card Error code.
 831:lib/ff/sdio_stm32f1.c **** */
 832:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 833:lib/ff/sdio_stm32f1.c **** SD_Error SD_EnableWideBusOperation(uint32_t WideMode)
 834:lib/ff/sdio_stm32f1.c **** {
 835:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
 836:lib/ff/sdio_stm32f1.c **** 
 837:lib/ff/sdio_stm32f1.c ****   /*!< MMC Card doesn't support this feature */
 838:lib/ff/sdio_stm32f1.c ****   if (SDIO_MULTIMEDIA_CARD == CardType)
 839:lib/ff/sdio_stm32f1.c ****   {
 840:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_UNSUPPORTED_FEATURE;
 841:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 842:lib/ff/sdio_stm32f1.c ****   }
 843:lib/ff/sdio_stm32f1.c ****   else if ((SDIO_STD_CAPACITY_SD_CARD_V1_1 == CardType) || (SDIO_STD_CAPACITY_SD_CARD_V2_0 == CardT
 844:lib/ff/sdio_stm32f1.c ****   {
 845:lib/ff/sdio_stm32f1.c ****     if (SDIO_BusWide_8b == WideMode)
 846:lib/ff/sdio_stm32f1.c ****     {
 847:lib/ff/sdio_stm32f1.c ****       errorstatus = SD_UNSUPPORTED_FEATURE;
 848:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
 849:lib/ff/sdio_stm32f1.c ****     }
 850:lib/ff/sdio_stm32f1.c ****     else if (SDIO_BusWide_4b == WideMode)
 851:lib/ff/sdio_stm32f1.c ****     {
 852:lib/ff/sdio_stm32f1.c ****       errorstatus = SDEnWideBus(ENABLE);
 853:lib/ff/sdio_stm32f1.c **** 
 854:lib/ff/sdio_stm32f1.c ****       if (SD_OK == errorstatus)
 855:lib/ff/sdio_stm32f1.c ****       {
 856:lib/ff/sdio_stm32f1.c ****         /*!< Configure the SDIO peripheral */
 857:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_ClockDiv = SDIO_TRANSFER_CLK_DIV; 
 858:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_ClockEdge = SDIO_ClockEdge_Rising;
 859:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_ClockBypass = SDIO_ClockBypass_Disable;
 860:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_ClockPowerSave = SDIO_ClockPowerSave_Disable;
 861:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_BusWide = SDIO_BusWide_4b;
 862:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_HardwareFlowControl = SDIO_HardwareFlowControl_Disable;
 863:lib/ff/sdio_stm32f1.c ****         SDIO_Init(&SDIO_InitStructure);
 864:lib/ff/sdio_stm32f1.c ****       }
 865:lib/ff/sdio_stm32f1.c ****     }
 866:lib/ff/sdio_stm32f1.c ****     else
 867:lib/ff/sdio_stm32f1.c ****     {
 868:lib/ff/sdio_stm32f1.c ****       errorstatus = SDEnWideBus(DISABLE);
 869:lib/ff/sdio_stm32f1.c **** 
 870:lib/ff/sdio_stm32f1.c ****       if (SD_OK == errorstatus)
 871:lib/ff/sdio_stm32f1.c ****       {
 872:lib/ff/sdio_stm32f1.c ****         /*!< Configure the SDIO peripheral */
 873:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_ClockDiv = SDIO_TRANSFER_CLK_DIV; 
 874:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_ClockEdge = SDIO_ClockEdge_Rising;
 875:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_ClockBypass = SDIO_ClockBypass_Disable;
 876:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_ClockPowerSave = SDIO_ClockPowerSave_Disable;
 877:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_BusWide = SDIO_BusWide_1b;
 878:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_HardwareFlowControl = SDIO_HardwareFlowControl_Disable;
 879:lib/ff/sdio_stm32f1.c ****         SDIO_Init(&SDIO_InitStructure);
 880:lib/ff/sdio_stm32f1.c ****       }
 881:lib/ff/sdio_stm32f1.c ****     }
 882:lib/ff/sdio_stm32f1.c ****   }
 883:lib/ff/sdio_stm32f1.c **** 
 884:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
 885:lib/ff/sdio_stm32f1.c **** }
 886:lib/ff/sdio_stm32f1.c **** 
 887:lib/ff/sdio_stm32f1.c **** 
 888:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 889:lib/ff/sdio_stm32f1.c **** /*! 
 890:lib/ff/sdio_stm32f1.c **** 	@brief  Sets device mode whether to operate in Polling, Interrupt or DMA mode.
 891:lib/ff/sdio_stm32f1.c **** 	@param  Mode: Specifies the Data Transfer mode.
 892:lib/ff/sdio_stm32f1.c **** 		This parameter can be one of the following values:
 893:lib/ff/sdio_stm32f1.c **** 		@arg SD_DMA_MODE: Data transfer using DMA.
 894:lib/ff/sdio_stm32f1.c **** 		@arg SD_INTERRUPT_MODE: Data transfer using interrupts.
 895:lib/ff/sdio_stm32f1.c **** 		@arg SD_POLLING_MODE: Data transfer using flags.
 896:lib/ff/sdio_stm32f1.c ****     @retval SD_Error: SD Card Error code.
 897:lib/ff/sdio_stm32f1.c **** */
 898:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 899:lib/ff/sdio_stm32f1.c **** SD_Error SD_SetDeviceMode(uint32_t Mode)
 900:lib/ff/sdio_stm32f1.c **** {
 901:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
 902:lib/ff/sdio_stm32f1.c **** 
 903:lib/ff/sdio_stm32f1.c ****   if ((Mode == SD_DMA_MODE) || (Mode == SD_INTERRUPT_MODE) || (Mode == SD_POLLING_MODE))
 904:lib/ff/sdio_stm32f1.c ****   {
 905:lib/ff/sdio_stm32f1.c ****     DeviceMode = Mode;
 906:lib/ff/sdio_stm32f1.c ****   }
 907:lib/ff/sdio_stm32f1.c ****   else
 908:lib/ff/sdio_stm32f1.c ****   {
 909:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_INVALID_PARAMETER;
 910:lib/ff/sdio_stm32f1.c ****   }
 911:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
 912:lib/ff/sdio_stm32f1.c **** 
 913:lib/ff/sdio_stm32f1.c **** }
 914:lib/ff/sdio_stm32f1.c **** 
 915:lib/ff/sdio_stm32f1.c **** 
 916:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 917:lib/ff/sdio_stm32f1.c **** /*! 
 918:lib/ff/sdio_stm32f1.c **** 	@brief  Selects od Deselects the corresponding card.
 919:lib/ff/sdio_stm32f1.c **** 	@param  addr: Address of the Card to be selected.
 920:lib/ff/sdio_stm32f1.c **** 	@retval SD_Error: SD Card Error code.
 921:lib/ff/sdio_stm32f1.c **** */
 922:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 923:lib/ff/sdio_stm32f1.c **** SD_Error SD_SelectDeselect(uint32_t addr)
 924:lib/ff/sdio_stm32f1.c **** {
 925:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
 926:lib/ff/sdio_stm32f1.c **** 
 927:lib/ff/sdio_stm32f1.c ****   /*!< Send CMD7 SDIO_SEL_DESEL_CARD */
 928:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument =  addr;
 929:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SEL_DESEL_CARD;
 930:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 931:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 932:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 933:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 934:lib/ff/sdio_stm32f1.c **** 
 935:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_SEL_DESEL_CARD);
 936:lib/ff/sdio_stm32f1.c **** 
 937:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
 938:lib/ff/sdio_stm32f1.c **** }
 939:lib/ff/sdio_stm32f1.c **** 
 940:lib/ff/sdio_stm32f1.c **** 
 941:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 942:lib/ff/sdio_stm32f1.c **** /*! 
 943:lib/ff/sdio_stm32f1.c **** 	@brief  Allows to read one block from a specified address in a card.
 944:lib/ff/sdio_stm32f1.c **** 	@param  readbuff: pointer to the buffer that will contain the received data
 945:lib/ff/sdio_stm32f1.c **** 	@param  ReadAddr: Address from where data are to be read.  
 946:lib/ff/sdio_stm32f1.c **** 	@param  BlockSize: the SD card Data block size.
 947:lib/ff/sdio_stm32f1.c **** 	@retval SD_Error: SD Card Error code.
 948:lib/ff/sdio_stm32f1.c **** */
 949:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
 950:lib/ff/sdio_stm32f1.c **** SD_Error SD_ReadBlock(uint8_t *readbuff, uint32_t ReadAddr, uint16_t BlockSize)
 951:lib/ff/sdio_stm32f1.c **** {
 952:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
 953:lib/ff/sdio_stm32f1.c ****   uint32_t count = 0, *tempbuff = (uint32_t *)readbuff;
 954:lib/ff/sdio_stm32f1.c ****   uint8_t power = 0;
 955:lib/ff/sdio_stm32f1.c **** 
 956:lib/ff/sdio_stm32f1.c ****   if (NULL == readbuff)
 957:lib/ff/sdio_stm32f1.c ****   {
 958:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_INVALID_PARAMETER;
 959:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 960:lib/ff/sdio_stm32f1.c ****   }
 961:lib/ff/sdio_stm32f1.c **** 
 962:lib/ff/sdio_stm32f1.c ****   TransferError = SD_OK;
 963:lib/ff/sdio_stm32f1.c ****   TransferEnd = 0;
 964:lib/ff/sdio_stm32f1.c ****   TotalNumberOfBytes = 0;
 965:lib/ff/sdio_stm32f1.c **** 
 966:lib/ff/sdio_stm32f1.c ****   /*!< Clear all DPSM configuration */
 967:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataTimeOut = SD_DATATIMEOUT;
 968:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataLength = 0;
 969:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataBlockSize = SDIO_DataBlockSize_1b;
 970:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToCard;
 971:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
 972:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Disable;
 973:lib/ff/sdio_stm32f1.c ****   SDIO_DataConfig(&SDIO_DataInitStructure);
 974:lib/ff/sdio_stm32f1.c ****   SDIO_DMACmd(DISABLE);
 975:lib/ff/sdio_stm32f1.c **** 
 976:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetResponse(SDIO_RESP1) & SD_CARD_LOCKED)
 977:lib/ff/sdio_stm32f1.c ****   {
 978:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_LOCK_UNLOCK_FAILED;
 979:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 980:lib/ff/sdio_stm32f1.c ****   }
 981:lib/ff/sdio_stm32f1.c ****   
 982:lib/ff/sdio_stm32f1.c ****   if (CardType == SDIO_HIGH_CAPACITY_SD_CARD)
 983:lib/ff/sdio_stm32f1.c ****   {
 984:lib/ff/sdio_stm32f1.c ****     BlockSize = 512;
 985:lib/ff/sdio_stm32f1.c ****     ReadAddr /= 512;
 986:lib/ff/sdio_stm32f1.c ****   }
 987:lib/ff/sdio_stm32f1.c ****   if ((BlockSize > 0) && (BlockSize <= 2048) && ((BlockSize & (BlockSize - 1)) == 0))
 988:lib/ff/sdio_stm32f1.c ****   {
 989:lib/ff/sdio_stm32f1.c ****     power = convert_from_bytes_to_power_of_two(BlockSize);
 990:lib/ff/sdio_stm32f1.c **** 
 991:lib/ff/sdio_stm32f1.c ****     /*!< Set Block Size for Card */
 992:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) BlockSize;
 993:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SET_BLOCKLEN;
 994:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 995:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 996:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 997:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
 998:lib/ff/sdio_stm32f1.c **** 
 999:lib/ff/sdio_stm32f1.c ****     errorstatus = CmdResp1Error(SD_CMD_SET_BLOCKLEN);
1000:lib/ff/sdio_stm32f1.c **** 
1001:lib/ff/sdio_stm32f1.c ****     if (SD_OK != errorstatus)
1002:lib/ff/sdio_stm32f1.c ****     {
1003:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
1004:lib/ff/sdio_stm32f1.c ****     }
1005:lib/ff/sdio_stm32f1.c ****   }
1006:lib/ff/sdio_stm32f1.c ****   else
1007:lib/ff/sdio_stm32f1.c ****   {
1008:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_INVALID_PARAMETER;
1009:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
1010:lib/ff/sdio_stm32f1.c ****   }
1011:lib/ff/sdio_stm32f1.c **** 
1012:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataTimeOut = SD_DATATIMEOUT;
1013:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataLength = BlockSize;
1014:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataBlockSize = (uint32_t) power << 4;
1015:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToSDIO;
1016:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
1017:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Enable;
1018:lib/ff/sdio_stm32f1.c ****   SDIO_DataConfig(&SDIO_DataInitStructure);
1019:lib/ff/sdio_stm32f1.c **** 
1020:lib/ff/sdio_stm32f1.c ****   TotalNumberOfBytes = BlockSize;
1021:lib/ff/sdio_stm32f1.c ****   StopCondition = 0;
1022:lib/ff/sdio_stm32f1.c ****   DestBuffer = (uint32_t *)readbuff;
1023:lib/ff/sdio_stm32f1.c **** 
1024:lib/ff/sdio_stm32f1.c ****   /*!< Send CMD17 READ_SINGLE_BLOCK */
1025:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = (uint32_t)ReadAddr;
1026:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_READ_SINGLE_BLOCK;
1027:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
1028:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
1029:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
1030:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
1031:lib/ff/sdio_stm32f1.c **** 
1032:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_READ_SINGLE_BLOCK);
1033:lib/ff/sdio_stm32f1.c **** 
1034:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
1035:lib/ff/sdio_stm32f1.c ****   {
1036:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
1037:lib/ff/sdio_stm32f1.c ****   }
1038:lib/ff/sdio_stm32f1.c ****   /*!< In case of single block transfer, no need of stop transfer at all.*/
1039:lib/ff/sdio_stm32f1.c ****   if (DeviceMode == SD_POLLING_MODE)
1040:lib/ff/sdio_stm32f1.c ****   {
1041:lib/ff/sdio_stm32f1.c ****     /*!< Polling mode */
1042:lib/ff/sdio_stm32f1.c ****     while (!(SDIO->STA &(SDIO_FLAG_RXOVERR | SDIO_FLAG_DCRCFAIL | SDIO_FLAG_DTIMEOUT | SDIO_FLAG_DB
1043:lib/ff/sdio_stm32f1.c ****     {
1044:lib/ff/sdio_stm32f1.c ****       if (SDIO_GetFlagStatus(SDIO_FLAG_RXFIFOHF) != RESET)
1045:lib/ff/sdio_stm32f1.c ****       {
1046:lib/ff/sdio_stm32f1.c ****         for (count = 0; count < 8; count++)
1047:lib/ff/sdio_stm32f1.c ****         {
1048:lib/ff/sdio_stm32f1.c ****           *(tempbuff + count) = SDIO_ReadData();
1049:lib/ff/sdio_stm32f1.c ****         }
1050:lib/ff/sdio_stm32f1.c ****         tempbuff += 8;
1051:lib/ff/sdio_stm32f1.c ****       }
1052:lib/ff/sdio_stm32f1.c ****     }
1053:lib/ff/sdio_stm32f1.c **** 
1054:lib/ff/sdio_stm32f1.c ****     if (SDIO_GetFlagStatus(SDIO_FLAG_DTIMEOUT) != RESET)
1055:lib/ff/sdio_stm32f1.c ****     {
1056:lib/ff/sdio_stm32f1.c ****       SDIO_ClearFlag(SDIO_FLAG_DTIMEOUT);
1057:lib/ff/sdio_stm32f1.c ****       errorstatus = SD_DATA_TIMEOUT;
1058:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
1059:lib/ff/sdio_stm32f1.c ****     }
1060:lib/ff/sdio_stm32f1.c ****     else if (SDIO_GetFlagStatus(SDIO_FLAG_DCRCFAIL) != RESET)
1061:lib/ff/sdio_stm32f1.c ****     {
1062:lib/ff/sdio_stm32f1.c ****       SDIO_ClearFlag(SDIO_FLAG_DCRCFAIL);
1063:lib/ff/sdio_stm32f1.c ****       errorstatus = SD_DATA_CRC_FAIL;
1064:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
1065:lib/ff/sdio_stm32f1.c ****     }
1066:lib/ff/sdio_stm32f1.c ****     else if (SDIO_GetFlagStatus(SDIO_FLAG_RXOVERR) != RESET)
1067:lib/ff/sdio_stm32f1.c ****     {
1068:lib/ff/sdio_stm32f1.c ****       SDIO_ClearFlag(SDIO_FLAG_RXOVERR);
1069:lib/ff/sdio_stm32f1.c ****       errorstatus = SD_RX_OVERRUN;
1070:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
1071:lib/ff/sdio_stm32f1.c ****     }
1072:lib/ff/sdio_stm32f1.c ****     else if (SDIO_GetFlagStatus(SDIO_FLAG_STBITERR) != RESET)
1073:lib/ff/sdio_stm32f1.c ****     {
1074:lib/ff/sdio_stm32f1.c ****       SDIO_ClearFlag(SDIO_FLAG_STBITERR);
1075:lib/ff/sdio_stm32f1.c ****       errorstatus = SD_START_BIT_ERR;
1076:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
1077:lib/ff/sdio_stm32f1.c ****     }
1078:lib/ff/sdio_stm32f1.c ****     while (SDIO_GetFlagStatus(SDIO_FLAG_RXDAVL) != RESET)
1079:lib/ff/sdio_stm32f1.c ****     {
1080:lib/ff/sdio_stm32f1.c ****       *tempbuff = SDIO_ReadData();
1081:lib/ff/sdio_stm32f1.c ****       tempbuff++;
1082:lib/ff/sdio_stm32f1.c ****     }
1083:lib/ff/sdio_stm32f1.c **** 
1084:lib/ff/sdio_stm32f1.c ****     /*!< Clear all the static flags */
1085:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_STATIC_FLAGS);
1086:lib/ff/sdio_stm32f1.c ****   }
1087:lib/ff/sdio_stm32f1.c ****   else if (DeviceMode == SD_INTERRUPT_MODE)
1088:lib/ff/sdio_stm32f1.c ****   {
1089:lib/ff/sdio_stm32f1.c ****     SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND | SDIO_IT_RXOVERR | SDIO_IT
1090:lib/ff/sdio_stm32f1.c ****     while ((TransferEnd == 0) && (TransferError == SD_OK))
1091:lib/ff/sdio_stm32f1.c ****     {}
1092:lib/ff/sdio_stm32f1.c ****     if (TransferError != SD_OK)
1093:lib/ff/sdio_stm32f1.c ****     {
1094:lib/ff/sdio_stm32f1.c ****       return(TransferError);
1095:lib/ff/sdio_stm32f1.c ****     }
1096:lib/ff/sdio_stm32f1.c ****   }
1097:lib/ff/sdio_stm32f1.c ****   else if (DeviceMode == SD_DMA_MODE)
1098:lib/ff/sdio_stm32f1.c ****   {
1099:lib/ff/sdio_stm32f1.c ****     SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND | SDIO_IT_RXOVERR | SDIO_IT
1100:lib/ff/sdio_stm32f1.c ****     SDIO_DMACmd(ENABLE);
1101:lib/ff/sdio_stm32f1.c ****     SD_LowLevel_DMA_RxConfig((uint32_t *)readbuff, BlockSize);
1102:lib/ff/sdio_stm32f1.c ****     while ((SD_DMAEndOfTransferStatus() == RESET) && (TransferEnd == 0) && (TransferError == SD_OK)
1103:lib/ff/sdio_stm32f1.c ****     {}
1104:lib/ff/sdio_stm32f1.c ****     if (TransferError != SD_OK)
1105:lib/ff/sdio_stm32f1.c ****     {
1106:lib/ff/sdio_stm32f1.c ****       return(TransferError);
1107:lib/ff/sdio_stm32f1.c ****     }
1108:lib/ff/sdio_stm32f1.c ****   }
1109:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
1110:lib/ff/sdio_stm32f1.c **** }
1111:lib/ff/sdio_stm32f1.c **** 
1112:lib/ff/sdio_stm32f1.c **** 
1113:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
1114:lib/ff/sdio_stm32f1.c **** /*! 
1115:lib/ff/sdio_stm32f1.c **** 	@brief  Allows to read blocks from a specified address  in a card.
1116:lib/ff/sdio_stm32f1.c **** 	@param  readbuff: pointer to the buffer that will contain the received data.
1117:lib/ff/sdio_stm32f1.c **** 	@param  ReadAddr: Address from where data are to be read.
1118:lib/ff/sdio_stm32f1.c **** 	@param  BlockSize: the SD card Data block size.
1119:lib/ff/sdio_stm32f1.c **** 	@param  NumberOfBlocks: number of blocks to be read.
1120:lib/ff/sdio_stm32f1.c **** 	@retval SD_Error: SD Card Error code.
1121:lib/ff/sdio_stm32f1.c **** */
1122:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
1123:lib/ff/sdio_stm32f1.c **** SD_Error SD_ReadMultiBlocks(uint8_t *readbuff, uint32_t ReadAddr, uint16_t BlockSize, uint32_t Numb
1124:lib/ff/sdio_stm32f1.c **** {
1125:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
1126:lib/ff/sdio_stm32f1.c ****   uint32_t count = 0, *tempbuff = (uint32_t *)readbuff;
1127:lib/ff/sdio_stm32f1.c ****   uint8_t power = 0;
1128:lib/ff/sdio_stm32f1.c **** 
1129:lib/ff/sdio_stm32f1.c ****   if (NULL == readbuff)
1130:lib/ff/sdio_stm32f1.c ****   {
1131:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_INVALID_PARAMETER;
1132:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
1133:lib/ff/sdio_stm32f1.c ****   }
1134:lib/ff/sdio_stm32f1.c **** 
1135:lib/ff/sdio_stm32f1.c ****   TransferError = SD_OK;
1136:lib/ff/sdio_stm32f1.c ****   TransferEnd = 0;
1137:lib/ff/sdio_stm32f1.c ****   TotalNumberOfBytes = 0;
1138:lib/ff/sdio_stm32f1.c **** 
1139:lib/ff/sdio_stm32f1.c ****   /*!< Clear all DPSM configuration */
1140:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataTimeOut = SD_DATATIMEOUT;
1141:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataLength = 0;
1142:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataBlockSize = SDIO_DataBlockSize_1b;
1143:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToCard;
1144:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
1145:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Disable;
1146:lib/ff/sdio_stm32f1.c ****   SDIO_DataConfig(&SDIO_DataInitStructure);
1147:lib/ff/sdio_stm32f1.c ****   SDIO_DMACmd(DISABLE);
1148:lib/ff/sdio_stm32f1.c **** 
1149:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetResponse(SDIO_RESP1) & SD_CARD_LOCKED)
1150:lib/ff/sdio_stm32f1.c ****   {
1151:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_LOCK_UNLOCK_FAILED;
1152:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
1153:lib/ff/sdio_stm32f1.c ****   }
1154:lib/ff/sdio_stm32f1.c **** 
1155:lib/ff/sdio_stm32f1.c ****   if (CardType == SDIO_HIGH_CAPACITY_SD_CARD)
1156:lib/ff/sdio_stm32f1.c ****   {
1157:lib/ff/sdio_stm32f1.c ****     BlockSize = 512;
1158:lib/ff/sdio_stm32f1.c ****     ReadAddr /= 512;
1159:lib/ff/sdio_stm32f1.c ****   }
1160:lib/ff/sdio_stm32f1.c ****   
1161:lib/ff/sdio_stm32f1.c ****   if ((BlockSize > 0) && (BlockSize <= 2048) && (0 == (BlockSize & (BlockSize - 1))))
1162:lib/ff/sdio_stm32f1.c ****   {
1163:lib/ff/sdio_stm32f1.c ****     power = convert_from_bytes_to_power_of_two(BlockSize);
1164:lib/ff/sdio_stm32f1.c **** 
1165:lib/ff/sdio_stm32f1.c ****     /*!< Set Block Size for Card */
1166:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) BlockSize;
1167:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SET_BLOCKLEN;
1168:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
1169:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
1170:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
1171:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
1172:lib/ff/sdio_stm32f1.c **** 
1173:lib/ff/sdio_stm32f1.c ****     errorstatus = CmdResp1Error(SD_CMD_SET_BLOCKLEN);
1174:lib/ff/sdio_stm32f1.c **** 
1175:lib/ff/sdio_stm32f1.c ****     if (SD_OK != errorstatus)
1176:lib/ff/sdio_stm32f1.c ****     {
1177:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
1178:lib/ff/sdio_stm32f1.c ****     }
1179:lib/ff/sdio_stm32f1.c ****   }
1180:lib/ff/sdio_stm32f1.c ****   else
1181:lib/ff/sdio_stm32f1.c ****   {
1182:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_INVALID_PARAMETER;
1183:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
1184:lib/ff/sdio_stm32f1.c ****   }
1185:lib/ff/sdio_stm32f1.c **** 
1186:lib/ff/sdio_stm32f1.c ****   if (NumberOfBlocks > 1)
1187:lib/ff/sdio_stm32f1.c ****   {
1188:lib/ff/sdio_stm32f1.c ****     /*!< Common to all modes */
1189:lib/ff/sdio_stm32f1.c ****     if (NumberOfBlocks * BlockSize > SD_MAX_DATA_LENGTH)
1190:lib/ff/sdio_stm32f1.c ****     {
1191:lib/ff/sdio_stm32f1.c ****       errorstatus = SD_INVALID_PARAMETER;
1192:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
1193:lib/ff/sdio_stm32f1.c ****     }
1194:lib/ff/sdio_stm32f1.c **** 
1195:lib/ff/sdio_stm32f1.c ****     TotalNumberOfBytes = NumberOfBlocks * BlockSize;
1196:lib/ff/sdio_stm32f1.c ****     StopCondition = 1;
1197:lib/ff/sdio_stm32f1.c ****     DestBuffer = (uint32_t *)readbuff;
1198:lib/ff/sdio_stm32f1.c **** 
1199:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_DataTimeOut = SD_DATATIMEOUT;
1200:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_DataLength = NumberOfBlocks * BlockSize;
1201:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_DataBlockSize = (uint32_t) power << 4;
1202:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToSDIO;
1203:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
1204:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Enable;
1205:lib/ff/sdio_stm32f1.c ****     SDIO_DataConfig(&SDIO_DataInitStructure);
1206:lib/ff/sdio_stm32f1.c **** 
1207:lib/ff/sdio_stm32f1.c ****     /*!< Send CMD18 READ_MULT_BLOCK with argument data address */
1208:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Argument = (uint32_t)ReadAddr;
1209:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_READ_MULT_BLOCK;
1210:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
1211:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
1212:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
1213:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
1214:lib/ff/sdio_stm32f1.c **** 
1215:lib/ff/sdio_stm32f1.c ****     errorstatus = CmdResp1Error(SD_CMD_READ_MULT_BLOCK);
1216:lib/ff/sdio_stm32f1.c **** 
1217:lib/ff/sdio_stm32f1.c ****     if (errorstatus != SD_OK)
1218:lib/ff/sdio_stm32f1.c ****     {
1219:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
1220:lib/ff/sdio_stm32f1.c ****     }
1221:lib/ff/sdio_stm32f1.c **** 
1222:lib/ff/sdio_stm32f1.c ****     if (DeviceMode == SD_POLLING_MODE)
1223:lib/ff/sdio_stm32f1.c ****     {
1224:lib/ff/sdio_stm32f1.c ****       /*!< Polling mode */
1225:lib/ff/sdio_stm32f1.c ****       while (!(SDIO->STA &(SDIO_FLAG_RXOVERR | SDIO_FLAG_DCRCFAIL | SDIO_FLAG_DATAEND | SDIO_FLAG_D
1226:lib/ff/sdio_stm32f1.c ****       {
1227:lib/ff/sdio_stm32f1.c ****         if (SDIO_GetFlagStatus(SDIO_FLAG_RXFIFOHF) != RESET)
1228:lib/ff/sdio_stm32f1.c ****         {
1229:lib/ff/sdio_stm32f1.c ****           for (count = 0; count < SD_HALFFIFO; count++)
1230:lib/ff/sdio_stm32f1.c ****           {
1231:lib/ff/sdio_stm32f1.c ****             *(tempbuff + count) = SDIO_ReadData();
1232:lib/ff/sdio_stm32f1.c ****           }
1233:lib/ff/sdio_stm32f1.c ****           tempbuff += SD_HALFFIFO;
1234:lib/ff/sdio_stm32f1.c ****         }
1235:lib/ff/sdio_stm32f1.c ****       }
1236:lib/ff/sdio_stm32f1.c **** 
1237:lib/ff/sdio_stm32f1.c ****       if (SDIO_GetFlagStatus(SDIO_FLAG_DTIMEOUT) != RESET)
1238:lib/ff/sdio_stm32f1.c ****       {
1239:lib/ff/sdio_stm32f1.c ****         SDIO_ClearFlag(SDIO_FLAG_DTIMEOUT);
1240:lib/ff/sdio_stm32f1.c ****         errorstatus = SD_DATA_TIMEOUT;
1241:lib/ff/sdio_stm32f1.c ****         return(errorstatus);
1242:lib/ff/sdio_stm32f1.c ****       }
1243:lib/ff/sdio_stm32f1.c ****       else if (SDIO_GetFlagStatus(SDIO_FLAG_DCRCFAIL) != RESET)
1244:lib/ff/sdio_stm32f1.c ****       {
1245:lib/ff/sdio_stm32f1.c ****         SDIO_ClearFlag(SDIO_FLAG_DCRCFAIL);
1246:lib/ff/sdio_stm32f1.c ****         errorstatus = SD_DATA_CRC_FAIL;
1247:lib/ff/sdio_stm32f1.c ****         return(errorstatus);
1248:lib/ff/sdio_stm32f1.c ****       }
1249:lib/ff/sdio_stm32f1.c ****       else if (SDIO_GetFlagStatus(SDIO_FLAG_RXOVERR) != RESET)
1250:lib/ff/sdio_stm32f1.c ****       {
1251:lib/ff/sdio_stm32f1.c ****         SDIO_ClearFlag(SDIO_FLAG_RXOVERR);
1252:lib/ff/sdio_stm32f1.c ****         errorstatus = SD_RX_OVERRUN;
1253:lib/ff/sdio_stm32f1.c ****         return(errorstatus);
1254:lib/ff/sdio_stm32f1.c ****       }
1255:lib/ff/sdio_stm32f1.c ****       else if (SDIO_GetFlagStatus(SDIO_FLAG_STBITERR) != RESET)
1256:lib/ff/sdio_stm32f1.c ****       {
1257:lib/ff/sdio_stm32f1.c ****         SDIO_ClearFlag(SDIO_FLAG_STBITERR);
1258:lib/ff/sdio_stm32f1.c ****         errorstatus = SD_START_BIT_ERR;
1259:lib/ff/sdio_stm32f1.c ****         return(errorstatus);
1260:lib/ff/sdio_stm32f1.c ****       }
1261:lib/ff/sdio_stm32f1.c ****       while (SDIO_GetFlagStatus(SDIO_FLAG_RXDAVL) != RESET)
1262:lib/ff/sdio_stm32f1.c ****       {
1263:lib/ff/sdio_stm32f1.c ****         *tempbuff = SDIO_ReadData();
1264:lib/ff/sdio_stm32f1.c ****         tempbuff++;
1265:lib/ff/sdio_stm32f1.c ****       }
1266:lib/ff/sdio_stm32f1.c **** 
1267:lib/ff/sdio_stm32f1.c ****       if (SDIO_GetFlagStatus(SDIO_FLAG_DATAEND) != RESET)
1268:lib/ff/sdio_stm32f1.c ****       {
1269:lib/ff/sdio_stm32f1.c ****         /*!< In Case Of SD-CARD Send Command STOP_TRANSMISSION */
1270:lib/ff/sdio_stm32f1.c ****         if ((SDIO_STD_CAPACITY_SD_CARD_V1_1 == CardType) || (SDIO_HIGH_CAPACITY_SD_CARD == CardType
1271:lib/ff/sdio_stm32f1.c ****         {
1272:lib/ff/sdio_stm32f1.c ****           /*!< Send CMD12 STOP_TRANSMISSION */
1273:lib/ff/sdio_stm32f1.c ****           SDIO_CmdInitStructure.SDIO_Argument = 0x0;
1274:lib/ff/sdio_stm32f1.c ****           SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_STOP_TRANSMISSION;
1275:lib/ff/sdio_stm32f1.c ****           SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
1276:lib/ff/sdio_stm32f1.c ****           SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
1277:lib/ff/sdio_stm32f1.c ****           SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
1278:lib/ff/sdio_stm32f1.c ****           SDIO_SendCommand(&SDIO_CmdInitStructure);
1279:lib/ff/sdio_stm32f1.c **** 
1280:lib/ff/sdio_stm32f1.c ****           errorstatus = CmdResp1Error(SD_CMD_STOP_TRANSMISSION);
1281:lib/ff/sdio_stm32f1.c **** 
1282:lib/ff/sdio_stm32f1.c ****           if (errorstatus != SD_OK)
1283:lib/ff/sdio_stm32f1.c ****           {
1284:lib/ff/sdio_stm32f1.c ****             return(errorstatus);
1285:lib/ff/sdio_stm32f1.c ****           }
1286:lib/ff/sdio_stm32f1.c ****         }
1287:lib/ff/sdio_stm32f1.c ****       }
1288:lib/ff/sdio_stm32f1.c ****       /*!< Clear all the static flags */
1289:lib/ff/sdio_stm32f1.c ****       SDIO_ClearFlag(SDIO_STATIC_FLAGS);
1290:lib/ff/sdio_stm32f1.c ****     }
1291:lib/ff/sdio_stm32f1.c ****     else if (DeviceMode == SD_INTERRUPT_MODE)
1292:lib/ff/sdio_stm32f1.c ****     {
1293:lib/ff/sdio_stm32f1.c ****       SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND | SDIO_IT_RXOVERR | SDIO_
1294:lib/ff/sdio_stm32f1.c ****       while ((TransferEnd == 0) && (TransferError == SD_OK))
1295:lib/ff/sdio_stm32f1.c ****       {}
1296:lib/ff/sdio_stm32f1.c ****       if (TransferError != SD_OK)
1297:lib/ff/sdio_stm32f1.c ****       {
1298:lib/ff/sdio_stm32f1.c ****         return(TransferError);
1299:lib/ff/sdio_stm32f1.c ****       }
1300:lib/ff/sdio_stm32f1.c ****     }
1301:lib/ff/sdio_stm32f1.c ****     else if (DeviceMode == SD_DMA_MODE)
1302:lib/ff/sdio_stm32f1.c ****     {
1303:lib/ff/sdio_stm32f1.c ****       SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND | SDIO_IT_RXOVERR | SDIO_
1304:lib/ff/sdio_stm32f1.c ****       SDIO_DMACmd(ENABLE);
1305:lib/ff/sdio_stm32f1.c ****       SD_LowLevel_DMA_RxConfig((uint32_t *)readbuff, (NumberOfBlocks * BlockSize));
1306:lib/ff/sdio_stm32f1.c ****       while ((SD_DMAEndOfTransferStatus() == RESET) && (TransferEnd == 0) && (TransferError == SD_O
1307:lib/ff/sdio_stm32f1.c ****       {}
1308:lib/ff/sdio_stm32f1.c ****       if (TransferError != SD_OK)
1309:lib/ff/sdio_stm32f1.c ****       {
1310:lib/ff/sdio_stm32f1.c ****         return(TransferError);
1311:lib/ff/sdio_stm32f1.c ****       }
1312:lib/ff/sdio_stm32f1.c ****     }
1313:lib/ff/sdio_stm32f1.c ****   }
1314:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
1315:lib/ff/sdio_stm32f1.c **** }
1316:lib/ff/sdio_stm32f1.c **** 
1317:lib/ff/sdio_stm32f1.c **** 
1318:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
1319:lib/ff/sdio_stm32f1.c **** /*! 
1320:lib/ff/sdio_stm32f1.c **** 	@brief  Allows to write one block starting from a specified address in a card.
1321:lib/ff/sdio_stm32f1.c **** 	@param  writebuff: pointer to the buffer that contain the data to be transferred.
1322:lib/ff/sdio_stm32f1.c **** 	@param  WriteAddr: Address from where data are to be read.   
1323:lib/ff/sdio_stm32f1.c **** 	@param  BlockSize: the SD card Data block size.
1324:lib/ff/sdio_stm32f1.c **** 	@retval SD_Error: SD Card Error code.
1325:lib/ff/sdio_stm32f1.c **** */
1326:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
1327:lib/ff/sdio_stm32f1.c **** SD_Error SD_WriteBlock(uint8_t *writebuff, uint32_t WriteAddr, uint16_t BlockSize)
1328:lib/ff/sdio_stm32f1.c **** {
1329:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
1330:lib/ff/sdio_stm32f1.c ****   uint8_t  power = 0, cardstate = 0;
1331:lib/ff/sdio_stm32f1.c ****   uint32_t timeout = 0, bytestransferred = 0;
1332:lib/ff/sdio_stm32f1.c ****   uint32_t cardstatus = 0, count = 0, restwords = 0;
1333:lib/ff/sdio_stm32f1.c ****   uint32_t *tempbuff = (uint32_t *)writebuff;
1334:lib/ff/sdio_stm32f1.c **** 
1335:lib/ff/sdio_stm32f1.c ****   if (writebuff == NULL)
1336:lib/ff/sdio_stm32f1.c ****   {
1337:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_INVALID_PARAMETER;
1338:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
1339:lib/ff/sdio_stm32f1.c ****   }
1340:lib/ff/sdio_stm32f1.c **** 
1341:lib/ff/sdio_stm32f1.c ****   TransferError = SD_OK;
1342:lib/ff/sdio_stm32f1.c ****   TransferEnd = 0;
1343:lib/ff/sdio_stm32f1.c ****   TotalNumberOfBytes = 0;
1344:lib/ff/sdio_stm32f1.c **** 
1345:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataTimeOut = SD_DATATIMEOUT;
1346:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataLength = 0;
1347:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataBlockSize = SDIO_DataBlockSize_1b;
1348:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToCard;
1349:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
1350:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Disable;
1351:lib/ff/sdio_stm32f1.c ****   SDIO_DataConfig(&SDIO_DataInitStructure);
1352:lib/ff/sdio_stm32f1.c ****   SDIO_DMACmd(DISABLE);
1353:lib/ff/sdio_stm32f1.c **** 
1354:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetResponse(SDIO_RESP1) & SD_CARD_LOCKED)
1355:lib/ff/sdio_stm32f1.c ****   {
1356:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_LOCK_UNLOCK_FAILED;
1357:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
1358:lib/ff/sdio_stm32f1.c ****   }
1359:lib/ff/sdio_stm32f1.c **** 
1360:lib/ff/sdio_stm32f1.c ****   if (CardType == SDIO_HIGH_CAPACITY_SD_CARD)
1361:lib/ff/sdio_stm32f1.c ****   {
1362:lib/ff/sdio_stm32f1.c ****     BlockSize = 512;
1363:lib/ff/sdio_stm32f1.c ****     WriteAddr /= 512;
1364:lib/ff/sdio_stm32f1.c ****   }
1365:lib/ff/sdio_stm32f1.c ****   
1366:lib/ff/sdio_stm32f1.c ****   /*!< Set the block size, both on controller and card */
1367:lib/ff/sdio_stm32f1.c ****   if ((BlockSize > 0) && (BlockSize <= 2048) && ((BlockSize & (BlockSize - 1)) == 0))
1368:lib/ff/sdio_stm32f1.c ****   {
1369:lib/ff/sdio_stm32f1.c ****     power = convert_from_bytes_to_power_of_two(BlockSize);
1370:lib/ff/sdio_stm32f1.c **** 
1371:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) BlockSize;
1372:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SET_BLOCKLEN;
1373:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
1374:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
1375:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
1376:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
1377:lib/ff/sdio_stm32f1.c **** 
1378:lib/ff/sdio_stm32f1.c ****     errorstatus = CmdResp1Error(SD_CMD_SET_BLOCKLEN);
1379:lib/ff/sdio_stm32f1.c **** 
1380:lib/ff/sdio_stm32f1.c ****     if (errorstatus != SD_OK)
1381:lib/ff/sdio_stm32f1.c ****     {
1382:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
1383:lib/ff/sdio_stm32f1.c ****     }
1384:lib/ff/sdio_stm32f1.c ****   }
1385:lib/ff/sdio_stm32f1.c ****   else
1386:lib/ff/sdio_stm32f1.c ****   {
1387:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_INVALID_PARAMETER;
1388:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
1389:lib/ff/sdio_stm32f1.c ****   }
1390:lib/ff/sdio_stm32f1.c **** 
1391:lib/ff/sdio_stm32f1.c ****   /*!< Wait till card is ready for data Added */
1392:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) (RCA << 16);
1393:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SEND_STATUS;
1394:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
1395:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
1396:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
1397:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
1398:lib/ff/sdio_stm32f1.c **** 
1399:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_SEND_STATUS);
1400:lib/ff/sdio_stm32f1.c **** 
1401:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
1402:lib/ff/sdio_stm32f1.c ****   {
1403:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
1404:lib/ff/sdio_stm32f1.c ****   }
1405:lib/ff/sdio_stm32f1.c **** 
1406:lib/ff/sdio_stm32f1.c ****   cardstatus = SDIO_GetResponse(SDIO_RESP1);
1407:lib/ff/sdio_stm32f1.c **** 
1408:lib/ff/sdio_stm32f1.c ****   timeout = SD_DATATIMEOUT;
1409:lib/ff/sdio_stm32f1.c **** 
1410:lib/ff/sdio_stm32f1.c ****   while (((cardstatus & 0x00000100) == 0) && (timeout > 0))
1411:lib/ff/sdio_stm32f1.c ****   {
1412:lib/ff/sdio_stm32f1.c ****     timeout--;
1413:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) (RCA << 16);
1414:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SEND_STATUS;
1415:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
1416:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
1417:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
1418:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
1419:lib/ff/sdio_stm32f1.c **** 
1420:lib/ff/sdio_stm32f1.c ****     errorstatus = CmdResp1Error(SD_CMD_SEND_STATUS);
1421:lib/ff/sdio_stm32f1.c **** 
1422:lib/ff/sdio_stm32f1.c ****     if (errorstatus != SD_OK)
1423:lib/ff/sdio_stm32f1.c ****     {
1424:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
1425:lib/ff/sdio_stm32f1.c ****     }
1426:lib/ff/sdio_stm32f1.c ****     cardstatus = SDIO_GetResponse(SDIO_RESP1);
1427:lib/ff/sdio_stm32f1.c ****   }
1428:lib/ff/sdio_stm32f1.c **** 
1429:lib/ff/sdio_stm32f1.c ****   if (timeout == 0)
1430:lib/ff/sdio_stm32f1.c ****   {
1431:lib/ff/sdio_stm32f1.c ****     return(SD_ERROR);
1432:lib/ff/sdio_stm32f1.c ****   }
1433:lib/ff/sdio_stm32f1.c **** 
1434:lib/ff/sdio_stm32f1.c ****   /*!< Send CMD24 WRITE_SINGLE_BLOCK */
1435:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = WriteAddr;
1436:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_WRITE_SINGLE_BLOCK;
1437:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
1438:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
1439:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
1440:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
1441:lib/ff/sdio_stm32f1.c **** 
1442:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_WRITE_SINGLE_BLOCK);
1443:lib/ff/sdio_stm32f1.c **** 
1444:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
1445:lib/ff/sdio_stm32f1.c ****   {
1446:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
1447:lib/ff/sdio_stm32f1.c ****   }
1448:lib/ff/sdio_stm32f1.c **** 
1449:lib/ff/sdio_stm32f1.c ****   TotalNumberOfBytes = BlockSize;
1450:lib/ff/sdio_stm32f1.c ****   StopCondition = 0;
1451:lib/ff/sdio_stm32f1.c ****   SrcBuffer = (uint32_t *)writebuff;
1452:lib/ff/sdio_stm32f1.c **** 
1453:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataTimeOut = SD_DATATIMEOUT;
1454:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataLength = BlockSize;
1455:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataBlockSize = (uint32_t) power << 4;
1456:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToCard;
1457:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
1458:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Enable;
1459:lib/ff/sdio_stm32f1.c ****   SDIO_DataConfig(&SDIO_DataInitStructure);
1460:lib/ff/sdio_stm32f1.c **** 
1461:lib/ff/sdio_stm32f1.c ****   /*!< In case of single data block transfer no need of stop command at all */
1462:lib/ff/sdio_stm32f1.c ****   if (DeviceMode == SD_POLLING_MODE)
1463:lib/ff/sdio_stm32f1.c ****   {
1464:lib/ff/sdio_stm32f1.c ****     while (!(SDIO->STA & (SDIO_FLAG_DBCKEND | SDIO_FLAG_TXUNDERR | SDIO_FLAG_DCRCFAIL | SDIO_FLAG_D
1465:lib/ff/sdio_stm32f1.c ****     {
1466:lib/ff/sdio_stm32f1.c ****       if (SDIO_GetFlagStatus(SDIO_FLAG_TXFIFOHE) != RESET)
1467:lib/ff/sdio_stm32f1.c ****       {
1468:lib/ff/sdio_stm32f1.c ****         if ((TotalNumberOfBytes - bytestransferred) < 32)
1469:lib/ff/sdio_stm32f1.c ****         {
1470:lib/ff/sdio_stm32f1.c ****           restwords = ((TotalNumberOfBytes - bytestransferred) % 4 == 0) ? ((TotalNumberOfBytes - b
1471:lib/ff/sdio_stm32f1.c **** 
1472:lib/ff/sdio_stm32f1.c ****           for (count = 0; count < restwords; count++, tempbuff++, bytestransferred += 4)
1473:lib/ff/sdio_stm32f1.c ****           {
1474:lib/ff/sdio_stm32f1.c ****             SDIO_WriteData(*tempbuff);
1475:lib/ff/sdio_stm32f1.c ****           }
1476:lib/ff/sdio_stm32f1.c ****         }
1477:lib/ff/sdio_stm32f1.c ****         else
1478:lib/ff/sdio_stm32f1.c ****         {
1479:lib/ff/sdio_stm32f1.c ****           for (count = 0; count < 8; count++)
1480:lib/ff/sdio_stm32f1.c ****           {
1481:lib/ff/sdio_stm32f1.c ****             SDIO_WriteData(*(tempbuff + count));
1482:lib/ff/sdio_stm32f1.c ****           }
1483:lib/ff/sdio_stm32f1.c ****           tempbuff += 8;
1484:lib/ff/sdio_stm32f1.c ****           bytestransferred += 32;
1485:lib/ff/sdio_stm32f1.c ****         }
1486:lib/ff/sdio_stm32f1.c ****       }
1487:lib/ff/sdio_stm32f1.c ****     }
1488:lib/ff/sdio_stm32f1.c ****     if (SDIO_GetFlagStatus(SDIO_FLAG_DTIMEOUT) != RESET)
1489:lib/ff/sdio_stm32f1.c ****     {
1490:lib/ff/sdio_stm32f1.c ****       SDIO_ClearFlag(SDIO_FLAG_DTIMEOUT);
1491:lib/ff/sdio_stm32f1.c ****       errorstatus = SD_DATA_TIMEOUT;
1492:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
1493:lib/ff/sdio_stm32f1.c ****     }
1494:lib/ff/sdio_stm32f1.c ****     else if (SDIO_GetFlagStatus(SDIO_FLAG_DCRCFAIL) != RESET)
1495:lib/ff/sdio_stm32f1.c ****     {
1496:lib/ff/sdio_stm32f1.c ****       SDIO_ClearFlag(SDIO_FLAG_DCRCFAIL);
1497:lib/ff/sdio_stm32f1.c ****       errorstatus = SD_DATA_CRC_FAIL;
1498:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
1499:lib/ff/sdio_stm32f1.c ****     }
1500:lib/ff/sdio_stm32f1.c ****     else if (SDIO_GetFlagStatus(SDIO_FLAG_TXUNDERR) != RESET)
1501:lib/ff/sdio_stm32f1.c ****     {
1502:lib/ff/sdio_stm32f1.c ****       SDIO_ClearFlag(SDIO_FLAG_TXUNDERR);
1503:lib/ff/sdio_stm32f1.c ****       errorstatus = SD_TX_UNDERRUN;
1504:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
1505:lib/ff/sdio_stm32f1.c ****     }
1506:lib/ff/sdio_stm32f1.c ****     else if (SDIO_GetFlagStatus(SDIO_FLAG_STBITERR) != RESET)
1507:lib/ff/sdio_stm32f1.c ****     {
1508:lib/ff/sdio_stm32f1.c ****       SDIO_ClearFlag(SDIO_FLAG_STBITERR);
1509:lib/ff/sdio_stm32f1.c ****       errorstatus = SD_START_BIT_ERR;
1510:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
1511:lib/ff/sdio_stm32f1.c ****     }
1512:lib/ff/sdio_stm32f1.c ****   }
1513:lib/ff/sdio_stm32f1.c ****   else if (DeviceMode == SD_INTERRUPT_MODE)
1514:lib/ff/sdio_stm32f1.c ****   {
1515:lib/ff/sdio_stm32f1.c ****     SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND | SDIO_FLAG_TXFIFOHE | SDIO
1516:lib/ff/sdio_stm32f1.c ****     while ((TransferEnd == 0) && (TransferError == SD_OK))
1517:lib/ff/sdio_stm32f1.c ****     {}
1518:lib/ff/sdio_stm32f1.c ****     if (TransferError != SD_OK)
1519:lib/ff/sdio_stm32f1.c ****     {
1520:lib/ff/sdio_stm32f1.c ****       return(TransferError);
1521:lib/ff/sdio_stm32f1.c ****     }
1522:lib/ff/sdio_stm32f1.c ****   }
1523:lib/ff/sdio_stm32f1.c ****   else if (DeviceMode == SD_DMA_MODE)
1524:lib/ff/sdio_stm32f1.c ****   {
1525:lib/ff/sdio_stm32f1.c ****     SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND | SDIO_IT_TXUNDERR | SDIO_I
1526:lib/ff/sdio_stm32f1.c ****     SD_LowLevel_DMA_TxConfig((uint32_t *)writebuff, BlockSize);
1527:lib/ff/sdio_stm32f1.c ****     SDIO_DMACmd(ENABLE);
1528:lib/ff/sdio_stm32f1.c ****     while ((SD_DMAEndOfTransferStatus() == RESET) && (TransferEnd == 0) && (TransferError == SD_OK)
1529:lib/ff/sdio_stm32f1.c ****     {}
1530:lib/ff/sdio_stm32f1.c ****     if (TransferError != SD_OK)
1531:lib/ff/sdio_stm32f1.c ****     {
1532:lib/ff/sdio_stm32f1.c ****       return(TransferError);
1533:lib/ff/sdio_stm32f1.c ****     }
1534:lib/ff/sdio_stm32f1.c ****   }
1535:lib/ff/sdio_stm32f1.c **** 
1536:lib/ff/sdio_stm32f1.c ****   /*!< Clear all the static flags */
1537:lib/ff/sdio_stm32f1.c ****   SDIO_ClearFlag(SDIO_STATIC_FLAGS);
1538:lib/ff/sdio_stm32f1.c **** 
1539:lib/ff/sdio_stm32f1.c ****   /*!< Wait till the card is in programming state */
1540:lib/ff/sdio_stm32f1.c ****   errorstatus = IsCardProgramming(&cardstate);
1541:lib/ff/sdio_stm32f1.c **** 
1542:lib/ff/sdio_stm32f1.c ****   while ((errorstatus == SD_OK) && ((cardstate == SD_CARD_PROGRAMMING) || (cardstate == SD_CARD_REC
1543:lib/ff/sdio_stm32f1.c ****   {
1544:lib/ff/sdio_stm32f1.c ****     errorstatus = IsCardProgramming(&cardstate);
1545:lib/ff/sdio_stm32f1.c ****   }
1546:lib/ff/sdio_stm32f1.c **** 
1547:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
1548:lib/ff/sdio_stm32f1.c **** }
1549:lib/ff/sdio_stm32f1.c **** 
1550:lib/ff/sdio_stm32f1.c **** 
1551:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
1552:lib/ff/sdio_stm32f1.c **** /*! 
1553:lib/ff/sdio_stm32f1.c **** 	@brief  Allows to write blocks starting from a specified address in a card.
1554:lib/ff/sdio_stm32f1.c **** 	@param  WriteAddr: Address from where data are to be read.
1555:lib/ff/sdio_stm32f1.c **** 	@param  writebuff: pointer to the buffer that contain the data to be transferred.
1556:lib/ff/sdio_stm32f1.c **** 	@param  BlockSize: the SD card Data block size.
1557:lib/ff/sdio_stm32f1.c **** 	@param  NumberOfBlocks: number of blocks to be written.
1558:lib/ff/sdio_stm32f1.c **** 	@retval SD_Error: SD Card Error code.
1559:lib/ff/sdio_stm32f1.c **** */
1560:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
1561:lib/ff/sdio_stm32f1.c **** SD_Error SD_WriteMultiBlocks(uint8_t *writebuff, uint32_t WriteAddr, uint16_t BlockSize, uint32_t N
1562:lib/ff/sdio_stm32f1.c **** {
1563:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
1564:lib/ff/sdio_stm32f1.c ****   uint8_t  power = 0, cardstate = 0;
1565:lib/ff/sdio_stm32f1.c ****   uint32_t bytestransferred = 0;
1566:lib/ff/sdio_stm32f1.c ****   uint32_t restwords = 0;
1567:lib/ff/sdio_stm32f1.c ****   uint32_t *tempbuff = (uint32_t *)writebuff;
1568:lib/ff/sdio_stm32f1.c ****   __IO uint32_t count = 0;
1569:lib/ff/sdio_stm32f1.c ****   
1570:lib/ff/sdio_stm32f1.c ****   if (writebuff == NULL)
1571:lib/ff/sdio_stm32f1.c ****   {
1572:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_INVALID_PARAMETER;
1573:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
1574:lib/ff/sdio_stm32f1.c ****   }
1575:lib/ff/sdio_stm32f1.c **** 
1576:lib/ff/sdio_stm32f1.c ****   TransferError = SD_OK;
1577:lib/ff/sdio_stm32f1.c ****   TransferEnd = 0;
1578:lib/ff/sdio_stm32f1.c ****   TotalNumberOfBytes = 0;
1579:lib/ff/sdio_stm32f1.c **** 
1580:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataTimeOut = SD_DATATIMEOUT;
1581:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataLength = 0;
1582:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataBlockSize = SDIO_DataBlockSize_1b;
1583:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToCard;
1584:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
1585:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Disable;
1586:lib/ff/sdio_stm32f1.c ****   SDIO_DataConfig(&SDIO_DataInitStructure);
1587:lib/ff/sdio_stm32f1.c ****   SDIO_DMACmd(DISABLE);
1588:lib/ff/sdio_stm32f1.c **** 
1589:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetResponse(SDIO_RESP1) & SD_CARD_LOCKED)
1590:lib/ff/sdio_stm32f1.c ****   {
1591:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_LOCK_UNLOCK_FAILED;
1592:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
1593:lib/ff/sdio_stm32f1.c ****   }
1594:lib/ff/sdio_stm32f1.c **** 
1595:lib/ff/sdio_stm32f1.c ****   if (CardType == SDIO_HIGH_CAPACITY_SD_CARD)
1596:lib/ff/sdio_stm32f1.c ****   {
1597:lib/ff/sdio_stm32f1.c ****     BlockSize = 512;
1598:lib/ff/sdio_stm32f1.c ****     WriteAddr /= 512;
1599:lib/ff/sdio_stm32f1.c ****   }
1600:lib/ff/sdio_stm32f1.c ****   
1601:lib/ff/sdio_stm32f1.c ****   /*!< Set the block size, both on controller and card */
1602:lib/ff/sdio_stm32f1.c ****   if ((BlockSize > 0) && (BlockSize <= 2048) && ((BlockSize & (BlockSize - 1)) == 0))
1603:lib/ff/sdio_stm32f1.c ****   {
1604:lib/ff/sdio_stm32f1.c ****     power = convert_from_bytes_to_power_of_two(BlockSize);
1605:lib/ff/sdio_stm32f1.c **** 
1606:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) BlockSize;
1607:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SET_BLOCKLEN;
1608:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
1609:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
1610:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
1611:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
1612:lib/ff/sdio_stm32f1.c **** 
1613:lib/ff/sdio_stm32f1.c ****     errorstatus = CmdResp1Error(SD_CMD_SET_BLOCKLEN);
1614:lib/ff/sdio_stm32f1.c **** 
1615:lib/ff/sdio_stm32f1.c ****     if (errorstatus != SD_OK)
1616:lib/ff/sdio_stm32f1.c ****     {
1617:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
1618:lib/ff/sdio_stm32f1.c ****     }
1619:lib/ff/sdio_stm32f1.c ****   }
1620:lib/ff/sdio_stm32f1.c ****   else
1621:lib/ff/sdio_stm32f1.c ****   {
1622:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_INVALID_PARAMETER;
1623:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
1624:lib/ff/sdio_stm32f1.c ****   }
1625:lib/ff/sdio_stm32f1.c **** 
1626:lib/ff/sdio_stm32f1.c ****   /*!< Wait till card is ready for data Added */
1627:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) (RCA << 16);
1628:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SEND_STATUS;
1629:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
1630:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
1631:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
1632:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
1633:lib/ff/sdio_stm32f1.c **** 
1634:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_SEND_STATUS);
1635:lib/ff/sdio_stm32f1.c **** 
1636:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
1637:lib/ff/sdio_stm32f1.c ****   {
1638:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
1639:lib/ff/sdio_stm32f1.c ****   }
1640:lib/ff/sdio_stm32f1.c **** 
1641:lib/ff/sdio_stm32f1.c ****   if (NumberOfBlocks > 1)
1642:lib/ff/sdio_stm32f1.c ****   {
1643:lib/ff/sdio_stm32f1.c ****     /*!< Common to all modes */
1644:lib/ff/sdio_stm32f1.c ****     if (NumberOfBlocks * BlockSize > SD_MAX_DATA_LENGTH)
1645:lib/ff/sdio_stm32f1.c ****     {
1646:lib/ff/sdio_stm32f1.c ****       errorstatus = SD_INVALID_PARAMETER;
1647:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
1648:lib/ff/sdio_stm32f1.c ****     }
1649:lib/ff/sdio_stm32f1.c **** 
1650:lib/ff/sdio_stm32f1.c ****     if ((SDIO_STD_CAPACITY_SD_CARD_V1_1 == CardType) || (SDIO_STD_CAPACITY_SD_CARD_V2_0 == CardType
1651:lib/ff/sdio_stm32f1.c ****     {
1652:lib/ff/sdio_stm32f1.c ****       /*!< To improve performance */
1653:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) (RCA << 16);
1654:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_CMD;
1655:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
1656:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
1657:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
1658:lib/ff/sdio_stm32f1.c ****       SDIO_SendCommand(&SDIO_CmdInitStructure);
1659:lib/ff/sdio_stm32f1.c **** 
1660:lib/ff/sdio_stm32f1.c **** 
1661:lib/ff/sdio_stm32f1.c ****       errorstatus = CmdResp1Error(SD_CMD_APP_CMD);
1662:lib/ff/sdio_stm32f1.c **** 
1663:lib/ff/sdio_stm32f1.c ****       if (errorstatus != SD_OK)
1664:lib/ff/sdio_stm32f1.c ****       {
1665:lib/ff/sdio_stm32f1.c ****         return(errorstatus);
1666:lib/ff/sdio_stm32f1.c ****       }
1667:lib/ff/sdio_stm32f1.c ****       /*!< To improve performance */
1668:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Argument = (uint32_t)NumberOfBlocks;
1669:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SET_BLOCK_COUNT;
1670:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
1671:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
1672:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
1673:lib/ff/sdio_stm32f1.c ****       SDIO_SendCommand(&SDIO_CmdInitStructure);
1674:lib/ff/sdio_stm32f1.c **** 
1675:lib/ff/sdio_stm32f1.c ****       errorstatus = CmdResp1Error(SD_CMD_SET_BLOCK_COUNT);
1676:lib/ff/sdio_stm32f1.c **** 
1677:lib/ff/sdio_stm32f1.c ****       if (errorstatus != SD_OK)
1678:lib/ff/sdio_stm32f1.c ****       {
1679:lib/ff/sdio_stm32f1.c ****         return(errorstatus);
1680:lib/ff/sdio_stm32f1.c ****       }
1681:lib/ff/sdio_stm32f1.c ****     }
1682:lib/ff/sdio_stm32f1.c **** 
1683:lib/ff/sdio_stm32f1.c ****     /*!< Send CMD25 WRITE_MULT_BLOCK with argument data address */
1684:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Argument = (uint32_t)WriteAddr;
1685:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_WRITE_MULT_BLOCK;
1686:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
1687:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
1688:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
1689:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
1690:lib/ff/sdio_stm32f1.c **** 
1691:lib/ff/sdio_stm32f1.c ****     errorstatus = CmdResp1Error(SD_CMD_WRITE_MULT_BLOCK);
1692:lib/ff/sdio_stm32f1.c **** 
1693:lib/ff/sdio_stm32f1.c ****     if (SD_OK != errorstatus)
1694:lib/ff/sdio_stm32f1.c ****     {
1695:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
1696:lib/ff/sdio_stm32f1.c ****     }
1697:lib/ff/sdio_stm32f1.c **** 
1698:lib/ff/sdio_stm32f1.c ****     TotalNumberOfBytes = NumberOfBlocks * BlockSize;
1699:lib/ff/sdio_stm32f1.c ****     StopCondition = 1;
1700:lib/ff/sdio_stm32f1.c ****     SrcBuffer = (uint32_t *)writebuff;
1701:lib/ff/sdio_stm32f1.c **** 
1702:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_DataTimeOut = SD_DATATIMEOUT;
1703:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_DataLength = NumberOfBlocks * BlockSize;
1704:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_DataBlockSize = (uint32_t) power << 4;
1705:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToCard;
1706:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
1707:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Enable;
1708:lib/ff/sdio_stm32f1.c ****     SDIO_DataConfig(&SDIO_DataInitStructure);
1709:lib/ff/sdio_stm32f1.c **** 
1710:lib/ff/sdio_stm32f1.c ****     if (DeviceMode == SD_POLLING_MODE)
1711:lib/ff/sdio_stm32f1.c ****     {
1712:lib/ff/sdio_stm32f1.c ****       while (!(SDIO->STA & (SDIO_FLAG_TXUNDERR | SDIO_FLAG_DCRCFAIL | SDIO_FLAG_DATAEND | SDIO_FLAG
1713:lib/ff/sdio_stm32f1.c ****       {
1714:lib/ff/sdio_stm32f1.c ****         if (SDIO_GetFlagStatus(SDIO_FLAG_TXFIFOHE) != RESET)
1715:lib/ff/sdio_stm32f1.c ****         {
1716:lib/ff/sdio_stm32f1.c ****           if (!((TotalNumberOfBytes - bytestransferred) < SD_HALFFIFOBYTES))
1717:lib/ff/sdio_stm32f1.c ****           {
1718:lib/ff/sdio_stm32f1.c ****             for (count = 0; count < SD_HALFFIFO; count++)
1719:lib/ff/sdio_stm32f1.c ****             {
1720:lib/ff/sdio_stm32f1.c ****               SDIO_WriteData(*(tempbuff + count));
1721:lib/ff/sdio_stm32f1.c ****             }
1722:lib/ff/sdio_stm32f1.c ****             tempbuff += SD_HALFFIFO;
1723:lib/ff/sdio_stm32f1.c ****             bytestransferred += SD_HALFFIFOBYTES;
1724:lib/ff/sdio_stm32f1.c ****           }
1725:lib/ff/sdio_stm32f1.c ****           else
1726:lib/ff/sdio_stm32f1.c ****           {
1727:lib/ff/sdio_stm32f1.c ****             restwords = ((TotalNumberOfBytes - bytestransferred) % 4 == 0) ? ((TotalNumberOfBytes -
1728:lib/ff/sdio_stm32f1.c ****                         ((TotalNumberOfBytes - bytestransferred) / 4 + 1);
1729:lib/ff/sdio_stm32f1.c **** 
1730:lib/ff/sdio_stm32f1.c ****             for (count = 0; count < restwords; count++, tempbuff++, bytestransferred += 4)
1731:lib/ff/sdio_stm32f1.c ****             {
1732:lib/ff/sdio_stm32f1.c ****               SDIO_WriteData(*tempbuff);
1733:lib/ff/sdio_stm32f1.c ****             }
1734:lib/ff/sdio_stm32f1.c ****           }
1735:lib/ff/sdio_stm32f1.c ****         }
1736:lib/ff/sdio_stm32f1.c ****       }
1737:lib/ff/sdio_stm32f1.c **** 
1738:lib/ff/sdio_stm32f1.c ****       if (SDIO_GetFlagStatus(SDIO_FLAG_DTIMEOUT) != RESET)
1739:lib/ff/sdio_stm32f1.c ****       {
1740:lib/ff/sdio_stm32f1.c ****         SDIO_ClearFlag(SDIO_FLAG_DTIMEOUT);
1741:lib/ff/sdio_stm32f1.c ****         errorstatus = SD_DATA_TIMEOUT;
1742:lib/ff/sdio_stm32f1.c ****         return(errorstatus);
1743:lib/ff/sdio_stm32f1.c ****       }
1744:lib/ff/sdio_stm32f1.c ****       else if (SDIO_GetFlagStatus(SDIO_FLAG_DCRCFAIL) != RESET)
1745:lib/ff/sdio_stm32f1.c ****       {
1746:lib/ff/sdio_stm32f1.c ****         SDIO_ClearFlag(SDIO_FLAG_DCRCFAIL);
1747:lib/ff/sdio_stm32f1.c ****         errorstatus = SD_DATA_CRC_FAIL;
1748:lib/ff/sdio_stm32f1.c ****         return(errorstatus);
1749:lib/ff/sdio_stm32f1.c ****       }
1750:lib/ff/sdio_stm32f1.c ****       else if (SDIO_GetFlagStatus(SDIO_FLAG_TXUNDERR) != RESET)
1751:lib/ff/sdio_stm32f1.c ****       {
1752:lib/ff/sdio_stm32f1.c ****         SDIO_ClearFlag(SDIO_FLAG_TXUNDERR);
1753:lib/ff/sdio_stm32f1.c ****         errorstatus = SD_TX_UNDERRUN;
1754:lib/ff/sdio_stm32f1.c ****         return(errorstatus);
1755:lib/ff/sdio_stm32f1.c ****       }
1756:lib/ff/sdio_stm32f1.c ****       else if (SDIO_GetFlagStatus(SDIO_FLAG_STBITERR) != RESET)
1757:lib/ff/sdio_stm32f1.c ****       {
1758:lib/ff/sdio_stm32f1.c ****         SDIO_ClearFlag(SDIO_FLAG_STBITERR);
1759:lib/ff/sdio_stm32f1.c ****         errorstatus = SD_START_BIT_ERR;
1760:lib/ff/sdio_stm32f1.c ****         return(errorstatus);
1761:lib/ff/sdio_stm32f1.c ****       }
1762:lib/ff/sdio_stm32f1.c **** 
1763:lib/ff/sdio_stm32f1.c ****       if (SDIO_GetFlagStatus(SDIO_FLAG_DATAEND) != RESET)
1764:lib/ff/sdio_stm32f1.c ****       {
1765:lib/ff/sdio_stm32f1.c ****        if ((SDIO_STD_CAPACITY_SD_CARD_V1_1 == CardType) || (SDIO_STD_CAPACITY_SD_CARD_V2_0 == CardT
1766:lib/ff/sdio_stm32f1.c ****         {
1767:lib/ff/sdio_stm32f1.c ****           /*!< Send CMD12 STOP_TRANSMISSION */
1768:lib/ff/sdio_stm32f1.c ****           SDIO_CmdInitStructure.SDIO_Argument = 0x0;
1769:lib/ff/sdio_stm32f1.c ****           SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_STOP_TRANSMISSION;
1770:lib/ff/sdio_stm32f1.c ****           SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
1771:lib/ff/sdio_stm32f1.c ****           SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
1772:lib/ff/sdio_stm32f1.c ****           SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
1773:lib/ff/sdio_stm32f1.c ****           SDIO_SendCommand(&SDIO_CmdInitStructure);
1774:lib/ff/sdio_stm32f1.c **** 
1775:lib/ff/sdio_stm32f1.c **** 
1776:lib/ff/sdio_stm32f1.c ****           errorstatus = CmdResp1Error(SD_CMD_STOP_TRANSMISSION);
1777:lib/ff/sdio_stm32f1.c **** 
1778:lib/ff/sdio_stm32f1.c ****           if (errorstatus != SD_OK)
1779:lib/ff/sdio_stm32f1.c ****           {
1780:lib/ff/sdio_stm32f1.c ****             return(errorstatus);
1781:lib/ff/sdio_stm32f1.c ****           }
1782:lib/ff/sdio_stm32f1.c ****         }
1783:lib/ff/sdio_stm32f1.c ****       }
1784:lib/ff/sdio_stm32f1.c ****     }
1785:lib/ff/sdio_stm32f1.c ****     else if (DeviceMode == SD_INTERRUPT_MODE)
1786:lib/ff/sdio_stm32f1.c ****     {
1787:lib/ff/sdio_stm32f1.c ****       SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND | SDIO_IT_TXFIFOHE | SDIO
1788:lib/ff/sdio_stm32f1.c ****       while ((TransferEnd == 0) && (TransferError == SD_OK))
1789:lib/ff/sdio_stm32f1.c ****       {}
1790:lib/ff/sdio_stm32f1.c ****       if (TransferError != SD_OK)
1791:lib/ff/sdio_stm32f1.c ****       {
1792:lib/ff/sdio_stm32f1.c ****         return(TransferError);
1793:lib/ff/sdio_stm32f1.c ****       }
1794:lib/ff/sdio_stm32f1.c ****     }
1795:lib/ff/sdio_stm32f1.c ****     else if (DeviceMode == SD_DMA_MODE)
1796:lib/ff/sdio_stm32f1.c ****     {
1797:lib/ff/sdio_stm32f1.c ****       SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND | SDIO_IT_TXUNDERR | SDIO
1798:lib/ff/sdio_stm32f1.c ****       SDIO_DMACmd(ENABLE);
1799:lib/ff/sdio_stm32f1.c ****       SD_LowLevel_DMA_TxConfig((uint32_t *)writebuff, (NumberOfBlocks * BlockSize));
1800:lib/ff/sdio_stm32f1.c ****       while ((SD_DMAEndOfTransferStatus() == RESET) && (TransferEnd == 0) && (TransferError == SD_O
1801:lib/ff/sdio_stm32f1.c ****       {}
1802:lib/ff/sdio_stm32f1.c ****       if (TransferError != SD_OK)
1803:lib/ff/sdio_stm32f1.c ****       {
1804:lib/ff/sdio_stm32f1.c ****         return(TransferError);
1805:lib/ff/sdio_stm32f1.c ****       }
1806:lib/ff/sdio_stm32f1.c ****     }
1807:lib/ff/sdio_stm32f1.c ****   }
1808:lib/ff/sdio_stm32f1.c ****   /*!< Clear all the static flags */
1809:lib/ff/sdio_stm32f1.c ****   SDIO_ClearFlag(SDIO_STATIC_FLAGS);
1810:lib/ff/sdio_stm32f1.c ****   
1811:lib/ff/sdio_stm32f1.c ****   /*!< Add some delay before checking the Card Status */
1812:lib/ff/sdio_stm32f1.c ****   for(count = 0; count < 0xFFFF; count++)
1813:lib/ff/sdio_stm32f1.c ****   {
1814:lib/ff/sdio_stm32f1.c ****   }
1815:lib/ff/sdio_stm32f1.c ****   /*!< Wait till the card is in programming state */
1816:lib/ff/sdio_stm32f1.c ****   errorstatus = IsCardProgramming(&cardstate);
1817:lib/ff/sdio_stm32f1.c **** 
1818:lib/ff/sdio_stm32f1.c ****   while ((errorstatus == SD_OK) && ((cardstate == SD_CARD_PROGRAMMING) || (cardstate == SD_CARD_REC
1819:lib/ff/sdio_stm32f1.c ****   {
1820:lib/ff/sdio_stm32f1.c ****     errorstatus = IsCardProgramming(&cardstate);
1821:lib/ff/sdio_stm32f1.c ****   }
1822:lib/ff/sdio_stm32f1.c **** 
1823:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
1824:lib/ff/sdio_stm32f1.c **** }
1825:lib/ff/sdio_stm32f1.c **** 
1826:lib/ff/sdio_stm32f1.c **** 
1827:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
1828:lib/ff/sdio_stm32f1.c **** /*! 
1829:lib/ff/sdio_stm32f1.c **** 	@brief  Gets the cuurent data transfer state.
1830:lib/ff/sdio_stm32f1.c **** 	@param  None
1831:lib/ff/sdio_stm32f1.c **** 	@retval SDTransferState: Data Transfer state.
1832:lib/ff/sdio_stm32f1.c **** 			This value can be: 
1833:lib/ff/sdio_stm32f1.c **** 			- SD_TRANSFER_OK: No data transfer is acting
1834:lib/ff/sdio_stm32f1.c **** 			- SD_TRANSFER_BUSY: Data transfer is acting
1835:lib/ff/sdio_stm32f1.c **** */
1836:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
1837:lib/ff/sdio_stm32f1.c **** SDTransferState SD_GetTransferState(void)
1838:lib/ff/sdio_stm32f1.c **** {
1839:lib/ff/sdio_stm32f1.c ****   if (SDIO->STA & (SDIO_FLAG_TXACT | SDIO_FLAG_RXACT))
1840:lib/ff/sdio_stm32f1.c ****   {
1841:lib/ff/sdio_stm32f1.c ****     return(SD_TRANSFER_BUSY);
1842:lib/ff/sdio_stm32f1.c ****   }
1843:lib/ff/sdio_stm32f1.c ****   else
1844:lib/ff/sdio_stm32f1.c ****   {
1845:lib/ff/sdio_stm32f1.c ****     return(SD_TRANSFER_OK);
1846:lib/ff/sdio_stm32f1.c ****   }
1847:lib/ff/sdio_stm32f1.c **** }
1848:lib/ff/sdio_stm32f1.c **** 
1849:lib/ff/sdio_stm32f1.c **** 
1850:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
1851:lib/ff/sdio_stm32f1.c **** /*! 
1852:lib/ff/sdio_stm32f1.c **** 	@brief  Aborts an ongoing data transfer.
1853:lib/ff/sdio_stm32f1.c **** 	@param  None
1854:lib/ff/sdio_stm32f1.c **** 	@retval SD_Error: SD Card Error code.
1855:lib/ff/sdio_stm32f1.c **** */
1856:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
1857:lib/ff/sdio_stm32f1.c **** SD_Error SD_StopTransfer(void)
1858:lib/ff/sdio_stm32f1.c **** {
1859:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
1860:lib/ff/sdio_stm32f1.c **** 
1861:lib/ff/sdio_stm32f1.c ****   /*!< Send CMD12 STOP_TRANSMISSION  */
1862:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = 0x0;
1863:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_STOP_TRANSMISSION;
1864:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
1865:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
1866:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
1867:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
1868:lib/ff/sdio_stm32f1.c **** 
1869:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_STOP_TRANSMISSION);
1870:lib/ff/sdio_stm32f1.c **** 
1871:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
1872:lib/ff/sdio_stm32f1.c **** }
1873:lib/ff/sdio_stm32f1.c **** 
1874:lib/ff/sdio_stm32f1.c **** 
1875:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
1876:lib/ff/sdio_stm32f1.c **** /*! 
1877:lib/ff/sdio_stm32f1.c **** 	@brief  Allows to erase memory area specified for the given card.
1878:lib/ff/sdio_stm32f1.c **** 	@param  startaddr: the start address.
1879:lib/ff/sdio_stm32f1.c **** 	@param  endaddr: the end address.
1880:lib/ff/sdio_stm32f1.c **** 	@retval SD_Error: SD Card Error code.
1881:lib/ff/sdio_stm32f1.c **** */
1882:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
1883:lib/ff/sdio_stm32f1.c **** SD_Error SD_Erase(uint32_t startaddr, uint32_t endaddr)
1884:lib/ff/sdio_stm32f1.c **** {
1885:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
1886:lib/ff/sdio_stm32f1.c ****   uint32_t delay = 0;
1887:lib/ff/sdio_stm32f1.c ****   __IO uint32_t maxdelay = 0;
1888:lib/ff/sdio_stm32f1.c ****   uint8_t cardstate = 0;
1889:lib/ff/sdio_stm32f1.c **** 
1890:lib/ff/sdio_stm32f1.c ****   /*!< Check if the card coomnd class supports erase command */
1891:lib/ff/sdio_stm32f1.c ****   if (((CSD_Tab[1] >> 20) & SD_CCCC_ERASE) == 0)
1892:lib/ff/sdio_stm32f1.c ****   {
1893:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_REQUEST_NOT_APPLICABLE;
1894:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
1895:lib/ff/sdio_stm32f1.c ****   }
1896:lib/ff/sdio_stm32f1.c **** 
1897:lib/ff/sdio_stm32f1.c ****   maxdelay = 120000 / ((SDIO->CLKCR & 0xFF) + 2);
1898:lib/ff/sdio_stm32f1.c **** 
1899:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetResponse(SDIO_RESP1) & SD_CARD_LOCKED)
1900:lib/ff/sdio_stm32f1.c ****   {
1901:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_LOCK_UNLOCK_FAILED;
1902:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
1903:lib/ff/sdio_stm32f1.c ****   }
1904:lib/ff/sdio_stm32f1.c **** 
1905:lib/ff/sdio_stm32f1.c ****   if (CardType == SDIO_HIGH_CAPACITY_SD_CARD)
1906:lib/ff/sdio_stm32f1.c ****   {
1907:lib/ff/sdio_stm32f1.c ****     startaddr /= 512;
1908:lib/ff/sdio_stm32f1.c ****     endaddr /= 512;
1909:lib/ff/sdio_stm32f1.c ****   }
1910:lib/ff/sdio_stm32f1.c ****   
1911:lib/ff/sdio_stm32f1.c ****   /*!< According to sd-card spec 1.0 ERASE_GROUP_START (CMD32) and erase_group_end(CMD33) */
1912:lib/ff/sdio_stm32f1.c ****   if ((SDIO_STD_CAPACITY_SD_CARD_V1_1 == CardType) || (SDIO_STD_CAPACITY_SD_CARD_V2_0 == CardType) 
1913:lib/ff/sdio_stm32f1.c ****   {
1914:lib/ff/sdio_stm32f1.c ****     /*!< Send CMD32 SD_ERASE_GRP_START with argument as addr  */
1915:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Argument = startaddr;
1916:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SD_ERASE_GRP_START;
1917:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
1918:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
1919:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
1920:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
1921:lib/ff/sdio_stm32f1.c **** 
1922:lib/ff/sdio_stm32f1.c ****     errorstatus = CmdResp1Error(SD_CMD_SD_ERASE_GRP_START);
1923:lib/ff/sdio_stm32f1.c ****     if (errorstatus != SD_OK)
1924:lib/ff/sdio_stm32f1.c ****     {
1925:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
1926:lib/ff/sdio_stm32f1.c ****     }
1927:lib/ff/sdio_stm32f1.c **** 
1928:lib/ff/sdio_stm32f1.c ****     /*!< Send CMD33 SD_ERASE_GRP_END with argument as addr  */
1929:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Argument = endaddr;
1930:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SD_ERASE_GRP_END;
1931:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
1932:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
1933:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
1934:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
1935:lib/ff/sdio_stm32f1.c **** 
1936:lib/ff/sdio_stm32f1.c ****     errorstatus = CmdResp1Error(SD_CMD_SD_ERASE_GRP_END);
1937:lib/ff/sdio_stm32f1.c ****     if (errorstatus != SD_OK)
1938:lib/ff/sdio_stm32f1.c ****     {
1939:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
1940:lib/ff/sdio_stm32f1.c ****     }
1941:lib/ff/sdio_stm32f1.c ****   }
1942:lib/ff/sdio_stm32f1.c **** 
1943:lib/ff/sdio_stm32f1.c ****   /*!< Send CMD38 ERASE */
1944:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = 0;
1945:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_ERASE;
1946:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
1947:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
1948:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
1949:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
1950:lib/ff/sdio_stm32f1.c **** 
1951:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_ERASE);
1952:lib/ff/sdio_stm32f1.c **** 
1953:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
1954:lib/ff/sdio_stm32f1.c ****   {
1955:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
1956:lib/ff/sdio_stm32f1.c ****   }
1957:lib/ff/sdio_stm32f1.c **** 
1958:lib/ff/sdio_stm32f1.c ****   for (delay = 0; delay < maxdelay; delay++)
1959:lib/ff/sdio_stm32f1.c ****   {}
1960:lib/ff/sdio_stm32f1.c **** 
1961:lib/ff/sdio_stm32f1.c ****   /*!< Wait till the card is in programming state */
1962:lib/ff/sdio_stm32f1.c ****   errorstatus = IsCardProgramming(&cardstate);
1963:lib/ff/sdio_stm32f1.c **** 
1964:lib/ff/sdio_stm32f1.c ****   while ((errorstatus == SD_OK) && ((SD_CARD_PROGRAMMING == cardstate) || (SD_CARD_RECEIVING == car
1965:lib/ff/sdio_stm32f1.c ****   {
1966:lib/ff/sdio_stm32f1.c ****     errorstatus = IsCardProgramming(&cardstate);
1967:lib/ff/sdio_stm32f1.c ****   }
1968:lib/ff/sdio_stm32f1.c **** 
1969:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
1970:lib/ff/sdio_stm32f1.c **** }
1971:lib/ff/sdio_stm32f1.c **** 
1972:lib/ff/sdio_stm32f1.c **** 
1973:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
1974:lib/ff/sdio_stm32f1.c **** /*! 
1975:lib/ff/sdio_stm32f1.c **** 	@brief  Returns the current card's status.
1976:lib/ff/sdio_stm32f1.c **** 	@param  pcardstatus: pointer to the buffer that will contain the SD card 
1977:lib/ff/sdio_stm32f1.c **** 			status (Card Status register).
1978:lib/ff/sdio_stm32f1.c **** 	@retval SD_Error: SD Card Error code.
1979:lib/ff/sdio_stm32f1.c **** */
1980:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
1981:lib/ff/sdio_stm32f1.c **** SD_Error SD_SendStatus(uint32_t *pcardstatus)
1982:lib/ff/sdio_stm32f1.c **** {
1983:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
1984:lib/ff/sdio_stm32f1.c **** 
1985:lib/ff/sdio_stm32f1.c ****   if (pcardstatus == NULL)
1986:lib/ff/sdio_stm32f1.c ****   {
1987:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_INVALID_PARAMETER;
1988:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
1989:lib/ff/sdio_stm32f1.c ****   }
1990:lib/ff/sdio_stm32f1.c **** 
1991:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) RCA << 16;
1992:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SEND_STATUS;
1993:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
1994:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
1995:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
1996:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
1997:lib/ff/sdio_stm32f1.c **** 
1998:lib/ff/sdio_stm32f1.c **** 
1999:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_SEND_STATUS);
2000:lib/ff/sdio_stm32f1.c **** 
2001:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
2002:lib/ff/sdio_stm32f1.c ****   {
2003:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2004:lib/ff/sdio_stm32f1.c ****   }
2005:lib/ff/sdio_stm32f1.c **** 
2006:lib/ff/sdio_stm32f1.c ****   *pcardstatus = SDIO_GetResponse(SDIO_RESP1);
2007:lib/ff/sdio_stm32f1.c **** 
2008:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
2009:lib/ff/sdio_stm32f1.c **** }
2010:lib/ff/sdio_stm32f1.c **** 
2011:lib/ff/sdio_stm32f1.c **** 
2012:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2013:lib/ff/sdio_stm32f1.c **** /*! 
2014:lib/ff/sdio_stm32f1.c **** 	@brief  Returns the current SD card's status.
2015:lib/ff/sdio_stm32f1.c **** 	@param  psdstatus: pointer to the buffer that will contain the SD card status 
2016:lib/ff/sdio_stm32f1.c **** 			(SD Status register).
2017:lib/ff/sdio_stm32f1.c **** 	@retval SD_Error: SD Card Error code.
2018:lib/ff/sdio_stm32f1.c **** */
2019:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2020:lib/ff/sdio_stm32f1.c **** SD_Error SD_SendSDStatus(uint32_t *psdstatus)
2021:lib/ff/sdio_stm32f1.c **** {
2022:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
2023:lib/ff/sdio_stm32f1.c ****   uint32_t count = 0;
2024:lib/ff/sdio_stm32f1.c **** 
2025:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetResponse(SDIO_RESP1) & SD_CARD_LOCKED)
2026:lib/ff/sdio_stm32f1.c ****   {
2027:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_LOCK_UNLOCK_FAILED;
2028:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2029:lib/ff/sdio_stm32f1.c ****   }
2030:lib/ff/sdio_stm32f1.c **** 
2031:lib/ff/sdio_stm32f1.c ****   /*!< Set block size for card if it is not equal to current block size for card. */
2032:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = 64;
2033:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SET_BLOCKLEN;
2034:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
2035:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
2036:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
2037:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
2038:lib/ff/sdio_stm32f1.c **** 
2039:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_SET_BLOCKLEN);
2040:lib/ff/sdio_stm32f1.c **** 
2041:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
2042:lib/ff/sdio_stm32f1.c ****   {
2043:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2044:lib/ff/sdio_stm32f1.c ****   }
2045:lib/ff/sdio_stm32f1.c **** 
2046:lib/ff/sdio_stm32f1.c ****   /*!< CMD55 */
2047:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) RCA << 16;
2048:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_CMD;
2049:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
2050:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
2051:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
2052:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
2053:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_APP_CMD);
2054:lib/ff/sdio_stm32f1.c **** 
2055:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
2056:lib/ff/sdio_stm32f1.c ****   {
2057:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2058:lib/ff/sdio_stm32f1.c ****   }
2059:lib/ff/sdio_stm32f1.c **** 
2060:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataTimeOut = SD_DATATIMEOUT;
2061:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataLength = 64;
2062:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataBlockSize = SDIO_DataBlockSize_64b;
2063:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToSDIO;
2064:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
2065:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Enable;
2066:lib/ff/sdio_stm32f1.c ****   SDIO_DataConfig(&SDIO_DataInitStructure);
2067:lib/ff/sdio_stm32f1.c **** 
2068:lib/ff/sdio_stm32f1.c ****   /*!< Send ACMD13 SD_APP_STAUS  with argument as card's RCA.*/
2069:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = 0;
2070:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SD_APP_STAUS;
2071:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
2072:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
2073:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
2074:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
2075:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_SD_APP_STAUS);
2076:lib/ff/sdio_stm32f1.c **** 
2077:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
2078:lib/ff/sdio_stm32f1.c ****   {
2079:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2080:lib/ff/sdio_stm32f1.c ****   }
2081:lib/ff/sdio_stm32f1.c **** 
2082:lib/ff/sdio_stm32f1.c ****   while (!(SDIO->STA &(SDIO_FLAG_RXOVERR | SDIO_FLAG_DCRCFAIL | SDIO_FLAG_DTIMEOUT | SDIO_FLAG_DBCK
2083:lib/ff/sdio_stm32f1.c ****   {
2084:lib/ff/sdio_stm32f1.c ****     if (SDIO_GetFlagStatus(SDIO_FLAG_RXFIFOHF) != RESET)
2085:lib/ff/sdio_stm32f1.c ****     {
2086:lib/ff/sdio_stm32f1.c ****       for (count = 0; count < 8; count++)
2087:lib/ff/sdio_stm32f1.c ****       {
2088:lib/ff/sdio_stm32f1.c ****         *(psdstatus + count) = SDIO_ReadData();
2089:lib/ff/sdio_stm32f1.c ****       }
2090:lib/ff/sdio_stm32f1.c ****       psdstatus += 8;
2091:lib/ff/sdio_stm32f1.c ****     }
2092:lib/ff/sdio_stm32f1.c ****   }
2093:lib/ff/sdio_stm32f1.c **** 
2094:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetFlagStatus(SDIO_FLAG_DTIMEOUT) != RESET)
2095:lib/ff/sdio_stm32f1.c ****   {
2096:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_DTIMEOUT);
2097:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_DATA_TIMEOUT;
2098:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2099:lib/ff/sdio_stm32f1.c ****   }
2100:lib/ff/sdio_stm32f1.c ****   else if (SDIO_GetFlagStatus(SDIO_FLAG_DCRCFAIL) != RESET)
2101:lib/ff/sdio_stm32f1.c ****   {
2102:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_DCRCFAIL);
2103:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_DATA_CRC_FAIL;
2104:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2105:lib/ff/sdio_stm32f1.c ****   }
2106:lib/ff/sdio_stm32f1.c ****   else if (SDIO_GetFlagStatus(SDIO_FLAG_RXOVERR) != RESET)
2107:lib/ff/sdio_stm32f1.c ****   {
2108:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_RXOVERR);
2109:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_RX_OVERRUN;
2110:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2111:lib/ff/sdio_stm32f1.c ****   }
2112:lib/ff/sdio_stm32f1.c ****   else if (SDIO_GetFlagStatus(SDIO_FLAG_STBITERR) != RESET)
2113:lib/ff/sdio_stm32f1.c ****   {
2114:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_STBITERR);
2115:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_START_BIT_ERR;
2116:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2117:lib/ff/sdio_stm32f1.c ****   }
2118:lib/ff/sdio_stm32f1.c **** 
2119:lib/ff/sdio_stm32f1.c ****   while (SDIO_GetFlagStatus(SDIO_FLAG_RXDAVL) != RESET)
2120:lib/ff/sdio_stm32f1.c ****   {
2121:lib/ff/sdio_stm32f1.c ****     *psdstatus = SDIO_ReadData();
2122:lib/ff/sdio_stm32f1.c ****     psdstatus++;
2123:lib/ff/sdio_stm32f1.c ****   }
2124:lib/ff/sdio_stm32f1.c **** 
2125:lib/ff/sdio_stm32f1.c ****   /*!< Clear all the static status flags*/
2126:lib/ff/sdio_stm32f1.c ****   SDIO_ClearFlag(SDIO_STATIC_FLAGS);
2127:lib/ff/sdio_stm32f1.c ****   psdstatus -= 16;
2128:lib/ff/sdio_stm32f1.c ****   for (count = 0; count < 16; count++)
2129:lib/ff/sdio_stm32f1.c ****   {
2130:lib/ff/sdio_stm32f1.c ****     psdstatus[count] = ((psdstatus[count] & SD_0TO7BITS) << 24) |((psdstatus[count] & SD_8TO15BITS)
2131:lib/ff/sdio_stm32f1.c ****                        ((psdstatus[count] & SD_16TO23BITS) >> 8) |((psdstatus[count] & SD_24TO31BIT
2132:lib/ff/sdio_stm32f1.c ****   }
2133:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
2134:lib/ff/sdio_stm32f1.c **** }
2135:lib/ff/sdio_stm32f1.c **** 
2136:lib/ff/sdio_stm32f1.c **** 
2137:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2138:lib/ff/sdio_stm32f1.c **** /*! 
2139:lib/ff/sdio_stm32f1.c **** 	@brief  Allows to process all the interrupts that are high.
2140:lib/ff/sdio_stm32f1.c **** 	@param  None
2141:lib/ff/sdio_stm32f1.c **** 	@retval SD_Error: SD Card Error code.
2142:lib/ff/sdio_stm32f1.c **** */
2143:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2144:lib/ff/sdio_stm32f1.c **** SD_Error SD_ProcessIRQSrc(void)
2145:lib/ff/sdio_stm32f1.c **** {
2146:lib/ff/sdio_stm32f1.c ****   uint32_t count = 0, restwords = 0;
2147:lib/ff/sdio_stm32f1.c **** 
2148:lib/ff/sdio_stm32f1.c ****   if (DeviceMode == SD_INTERRUPT_MODE)
2149:lib/ff/sdio_stm32f1.c ****   {
2150:lib/ff/sdio_stm32f1.c ****     if (SDIO_GetITStatus(SDIO_IT_RXFIFOHF) != RESET)
2151:lib/ff/sdio_stm32f1.c ****     {
2152:lib/ff/sdio_stm32f1.c ****       for (count = 0; count < SD_HALFFIFO; count++)
2153:lib/ff/sdio_stm32f1.c ****       {
2154:lib/ff/sdio_stm32f1.c ****         *(DestBuffer + count) = SDIO_ReadData();
2155:lib/ff/sdio_stm32f1.c ****       }
2156:lib/ff/sdio_stm32f1.c ****       DestBuffer += SD_HALFFIFO;
2157:lib/ff/sdio_stm32f1.c ****       NumberOfBytes += SD_HALFFIFOBYTES;
2158:lib/ff/sdio_stm32f1.c ****     }
2159:lib/ff/sdio_stm32f1.c ****     else if (SDIO_GetITStatus(SDIO_IT_TXFIFOHE) != RESET)
2160:lib/ff/sdio_stm32f1.c ****     {
2161:lib/ff/sdio_stm32f1.c ****       if ((TotalNumberOfBytes - NumberOfBytes) < SD_HALFFIFOBYTES)
2162:lib/ff/sdio_stm32f1.c ****       {
2163:lib/ff/sdio_stm32f1.c ****         restwords = ((TotalNumberOfBytes - NumberOfBytes) %  4 == 0) ?
2164:lib/ff/sdio_stm32f1.c ****                     ((TotalNumberOfBytes - NumberOfBytes) / 4) :
2165:lib/ff/sdio_stm32f1.c ****                     ((TotalNumberOfBytes - NumberOfBytes) / 4 + 1);
2166:lib/ff/sdio_stm32f1.c **** 
2167:lib/ff/sdio_stm32f1.c ****         for (count = 0; count < restwords;  count++, SrcBuffer++, NumberOfBytes += 4)
2168:lib/ff/sdio_stm32f1.c ****         {
2169:lib/ff/sdio_stm32f1.c ****           SDIO_WriteData(*SrcBuffer);
2170:lib/ff/sdio_stm32f1.c ****         }
2171:lib/ff/sdio_stm32f1.c ****       }
2172:lib/ff/sdio_stm32f1.c ****       else
2173:lib/ff/sdio_stm32f1.c ****       {
2174:lib/ff/sdio_stm32f1.c ****         for (count = 0; count < SD_HALFFIFO; count++)
2175:lib/ff/sdio_stm32f1.c ****         {
2176:lib/ff/sdio_stm32f1.c ****           SDIO_WriteData(*(SrcBuffer + count));
2177:lib/ff/sdio_stm32f1.c ****         }
2178:lib/ff/sdio_stm32f1.c **** 
2179:lib/ff/sdio_stm32f1.c ****         SrcBuffer += SD_HALFFIFO;
2180:lib/ff/sdio_stm32f1.c ****         NumberOfBytes += SD_HALFFIFOBYTES;
2181:lib/ff/sdio_stm32f1.c ****       }
2182:lib/ff/sdio_stm32f1.c ****     }
2183:lib/ff/sdio_stm32f1.c ****   }
2184:lib/ff/sdio_stm32f1.c **** 
2185:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetITStatus(SDIO_IT_DATAEND) != RESET)
2186:lib/ff/sdio_stm32f1.c ****   {
2187:lib/ff/sdio_stm32f1.c ****     if (DeviceMode != SD_DMA_MODE)
2188:lib/ff/sdio_stm32f1.c ****     {
2189:lib/ff/sdio_stm32f1.c ****       while ((SDIO_GetFlagStatus(SDIO_FLAG_RXDAVL) != RESET)  &&  (NumberOfBytes < TotalNumberOfByt
2190:lib/ff/sdio_stm32f1.c ****       {
2191:lib/ff/sdio_stm32f1.c ****         *DestBuffer = SDIO_ReadData();
2192:lib/ff/sdio_stm32f1.c ****         DestBuffer++;
2193:lib/ff/sdio_stm32f1.c ****         NumberOfBytes += 4;
2194:lib/ff/sdio_stm32f1.c ****       }
2195:lib/ff/sdio_stm32f1.c ****     }
2196:lib/ff/sdio_stm32f1.c **** 
2197:lib/ff/sdio_stm32f1.c ****     if (StopCondition == 1)
2198:lib/ff/sdio_stm32f1.c ****     {
2199:lib/ff/sdio_stm32f1.c ****       TransferError = SD_StopTransfer();
2200:lib/ff/sdio_stm32f1.c ****     }
2201:lib/ff/sdio_stm32f1.c ****     else
2202:lib/ff/sdio_stm32f1.c ****     {
2203:lib/ff/sdio_stm32f1.c ****       TransferError = SD_OK;
2204:lib/ff/sdio_stm32f1.c ****     }
2205:lib/ff/sdio_stm32f1.c ****     SDIO_ClearITPendingBit(SDIO_IT_DATAEND);
2206:lib/ff/sdio_stm32f1.c ****     SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND |
2207:lib/ff/sdio_stm32f1.c ****                   SDIO_IT_TXFIFOHE | SDIO_IT_RXFIFOHF | SDIO_IT_TXUNDERR |
2208:lib/ff/sdio_stm32f1.c ****                   SDIO_IT_RXOVERR | SDIO_IT_STBITERR, DISABLE);
2209:lib/ff/sdio_stm32f1.c ****     TransferEnd = 1;
2210:lib/ff/sdio_stm32f1.c ****     NumberOfBytes = 0;
2211:lib/ff/sdio_stm32f1.c ****     return(TransferError);
2212:lib/ff/sdio_stm32f1.c ****   }
2213:lib/ff/sdio_stm32f1.c **** 
2214:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetITStatus(SDIO_IT_DCRCFAIL) != RESET)
2215:lib/ff/sdio_stm32f1.c ****   {
2216:lib/ff/sdio_stm32f1.c ****     SDIO_ClearITPendingBit(SDIO_IT_DCRCFAIL);
2217:lib/ff/sdio_stm32f1.c ****     SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND |
2218:lib/ff/sdio_stm32f1.c ****                   SDIO_IT_TXFIFOHE | SDIO_IT_RXFIFOHF | SDIO_IT_TXUNDERR |
2219:lib/ff/sdio_stm32f1.c ****                   SDIO_IT_RXOVERR | SDIO_IT_STBITERR, DISABLE);
2220:lib/ff/sdio_stm32f1.c ****     NumberOfBytes = 0;
2221:lib/ff/sdio_stm32f1.c ****     TransferError = SD_DATA_CRC_FAIL;
2222:lib/ff/sdio_stm32f1.c ****     return(SD_DATA_CRC_FAIL);
2223:lib/ff/sdio_stm32f1.c ****   }
2224:lib/ff/sdio_stm32f1.c **** 
2225:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetITStatus(SDIO_IT_DTIMEOUT) != RESET)
2226:lib/ff/sdio_stm32f1.c ****   {
2227:lib/ff/sdio_stm32f1.c ****     SDIO_ClearITPendingBit(SDIO_IT_DTIMEOUT);
2228:lib/ff/sdio_stm32f1.c ****     SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND |
2229:lib/ff/sdio_stm32f1.c ****                   SDIO_IT_TXFIFOHE | SDIO_IT_RXFIFOHF | SDIO_IT_TXUNDERR |
2230:lib/ff/sdio_stm32f1.c ****                   SDIO_IT_RXOVERR | SDIO_IT_STBITERR, DISABLE);
2231:lib/ff/sdio_stm32f1.c ****     NumberOfBytes = 0;
2232:lib/ff/sdio_stm32f1.c ****     TransferError = SD_DATA_TIMEOUT;
2233:lib/ff/sdio_stm32f1.c ****     return(SD_DATA_TIMEOUT);
2234:lib/ff/sdio_stm32f1.c ****   }
2235:lib/ff/sdio_stm32f1.c **** 
2236:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetITStatus(SDIO_IT_RXOVERR) != RESET)
2237:lib/ff/sdio_stm32f1.c ****   {
2238:lib/ff/sdio_stm32f1.c ****     SDIO_ClearITPendingBit(SDIO_IT_RXOVERR);
2239:lib/ff/sdio_stm32f1.c ****     SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND |
2240:lib/ff/sdio_stm32f1.c ****                   SDIO_IT_TXFIFOHE | SDIO_IT_RXFIFOHF | SDIO_IT_TXUNDERR |
2241:lib/ff/sdio_stm32f1.c ****                   SDIO_IT_RXOVERR | SDIO_IT_STBITERR, DISABLE);
2242:lib/ff/sdio_stm32f1.c ****     NumberOfBytes = 0;
2243:lib/ff/sdio_stm32f1.c ****     TransferError = SD_RX_OVERRUN;
2244:lib/ff/sdio_stm32f1.c ****     return(SD_RX_OVERRUN);
2245:lib/ff/sdio_stm32f1.c ****   }
2246:lib/ff/sdio_stm32f1.c **** 
2247:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetITStatus(SDIO_IT_TXUNDERR) != RESET)
2248:lib/ff/sdio_stm32f1.c ****   {
2249:lib/ff/sdio_stm32f1.c ****     SDIO_ClearITPendingBit(SDIO_IT_TXUNDERR);
2250:lib/ff/sdio_stm32f1.c ****     SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND |
2251:lib/ff/sdio_stm32f1.c ****                   SDIO_IT_TXFIFOHE | SDIO_IT_RXFIFOHF | SDIO_IT_TXUNDERR |
2252:lib/ff/sdio_stm32f1.c ****                   SDIO_IT_RXOVERR | SDIO_IT_STBITERR, DISABLE);
2253:lib/ff/sdio_stm32f1.c ****     NumberOfBytes = 0;
2254:lib/ff/sdio_stm32f1.c ****     TransferError = SD_TX_UNDERRUN;
2255:lib/ff/sdio_stm32f1.c ****     return(SD_TX_UNDERRUN);
2256:lib/ff/sdio_stm32f1.c ****   }
2257:lib/ff/sdio_stm32f1.c **** 
2258:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetITStatus(SDIO_IT_STBITERR) != RESET)
2259:lib/ff/sdio_stm32f1.c ****   {
2260:lib/ff/sdio_stm32f1.c ****     SDIO_ClearITPendingBit(SDIO_IT_STBITERR);
2261:lib/ff/sdio_stm32f1.c ****     SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND |
2262:lib/ff/sdio_stm32f1.c ****                   SDIO_IT_TXFIFOHE | SDIO_IT_RXFIFOHF | SDIO_IT_TXUNDERR |
2263:lib/ff/sdio_stm32f1.c ****                   SDIO_IT_RXOVERR | SDIO_IT_STBITERR, DISABLE);
2264:lib/ff/sdio_stm32f1.c ****     NumberOfBytes = 0;
2265:lib/ff/sdio_stm32f1.c ****     TransferError = SD_START_BIT_ERR;
2266:lib/ff/sdio_stm32f1.c ****     return(SD_START_BIT_ERR);
2267:lib/ff/sdio_stm32f1.c ****   }
2268:lib/ff/sdio_stm32f1.c **** 
2269:lib/ff/sdio_stm32f1.c ****   return(SD_OK);
2270:lib/ff/sdio_stm32f1.c **** }
2271:lib/ff/sdio_stm32f1.c **** 
2272:lib/ff/sdio_stm32f1.c **** 
2273:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2274:lib/ff/sdio_stm32f1.c **** /*! 
2275:lib/ff/sdio_stm32f1.c **** 	@brief  Checks for error conditions for CMD0.
2276:lib/ff/sdio_stm32f1.c **** 	@param  None
2277:lib/ff/sdio_stm32f1.c **** 	@retval SD_Error: SD Card Error code.
2278:lib/ff/sdio_stm32f1.c **** */
2279:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2280:lib/ff/sdio_stm32f1.c **** static SD_Error CmdError(void)
2281:lib/ff/sdio_stm32f1.c **** {
2282:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
2283:lib/ff/sdio_stm32f1.c ****   uint32_t timeout;
2284:lib/ff/sdio_stm32f1.c **** 
2285:lib/ff/sdio_stm32f1.c ****   timeout = SDIO_CMD0TIMEOUT; /*!< 10000 */
2286:lib/ff/sdio_stm32f1.c **** 
2287:lib/ff/sdio_stm32f1.c ****   while ((timeout > 0) && (SDIO_GetFlagStatus(SDIO_FLAG_CMDSENT) == RESET))
2288:lib/ff/sdio_stm32f1.c ****   {
2289:lib/ff/sdio_stm32f1.c ****     timeout--;
2290:lib/ff/sdio_stm32f1.c ****   }
2291:lib/ff/sdio_stm32f1.c **** 
2292:lib/ff/sdio_stm32f1.c ****   if (timeout == 0)
2293:lib/ff/sdio_stm32f1.c ****   {
2294:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_CMD_RSP_TIMEOUT;
2295:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2296:lib/ff/sdio_stm32f1.c ****   }
2297:lib/ff/sdio_stm32f1.c **** 
2298:lib/ff/sdio_stm32f1.c ****   /*!< Clear all the static flags */
2299:lib/ff/sdio_stm32f1.c ****   SDIO_ClearFlag(SDIO_STATIC_FLAGS);
2300:lib/ff/sdio_stm32f1.c **** 
2301:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
2302:lib/ff/sdio_stm32f1.c **** }
2303:lib/ff/sdio_stm32f1.c **** 
2304:lib/ff/sdio_stm32f1.c **** 
2305:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2306:lib/ff/sdio_stm32f1.c **** /*! 
2307:lib/ff/sdio_stm32f1.c **** 	@brief  Checks for error conditions for R7 response.
2308:lib/ff/sdio_stm32f1.c **** 	@param  None
2309:lib/ff/sdio_stm32f1.c **** 	@retval SD_Error: SD Card Error code.
2310:lib/ff/sdio_stm32f1.c **** */
2311:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2312:lib/ff/sdio_stm32f1.c **** static SD_Error CmdResp7Error(void)
2313:lib/ff/sdio_stm32f1.c **** {
2314:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
2315:lib/ff/sdio_stm32f1.c ****   uint32_t status;
2316:lib/ff/sdio_stm32f1.c ****   uint32_t timeout = SDIO_CMD0TIMEOUT;
2317:lib/ff/sdio_stm32f1.c **** 
2318:lib/ff/sdio_stm32f1.c ****   status = SDIO->STA;
2319:lib/ff/sdio_stm32f1.c **** 
2320:lib/ff/sdio_stm32f1.c ****   while (!(status & (SDIO_FLAG_CCRCFAIL | SDIO_FLAG_CMDREND | SDIO_FLAG_CTIMEOUT)) && (timeout > 0)
2321:lib/ff/sdio_stm32f1.c ****   {
2322:lib/ff/sdio_stm32f1.c ****     timeout--;
2323:lib/ff/sdio_stm32f1.c ****     status = SDIO->STA;
2324:lib/ff/sdio_stm32f1.c ****   }
2325:lib/ff/sdio_stm32f1.c **** 
2326:lib/ff/sdio_stm32f1.c ****   if ((timeout == 0) || (status & SDIO_FLAG_CTIMEOUT))
2327:lib/ff/sdio_stm32f1.c ****   {
2328:lib/ff/sdio_stm32f1.c ****     /*!< Card is not V2.0 complient or card does not support the set voltage range */
2329:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_CMD_RSP_TIMEOUT;
2330:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_CTIMEOUT);
2331:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2332:lib/ff/sdio_stm32f1.c ****   }
2333:lib/ff/sdio_stm32f1.c **** 
2334:lib/ff/sdio_stm32f1.c ****   if (status & SDIO_FLAG_CMDREND)
2335:lib/ff/sdio_stm32f1.c ****   {
2336:lib/ff/sdio_stm32f1.c ****     /*!< Card is SD V2.0 compliant */
2337:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_OK;
2338:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_CMDREND);
2339:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2340:lib/ff/sdio_stm32f1.c ****   }
2341:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
2342:lib/ff/sdio_stm32f1.c **** }
2343:lib/ff/sdio_stm32f1.c **** 
2344:lib/ff/sdio_stm32f1.c **** 
2345:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2346:lib/ff/sdio_stm32f1.c **** /*! 
2347:lib/ff/sdio_stm32f1.c **** 	@brief  Checks for error conditions for R1 response.
2348:lib/ff/sdio_stm32f1.c **** 	@param  cmd: The sent command index.
2349:lib/ff/sdio_stm32f1.c **** 	@retval SD_Error: SD Card Error code.
2350:lib/ff/sdio_stm32f1.c **** */
2351:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2352:lib/ff/sdio_stm32f1.c **** static SD_Error CmdResp1Error(uint8_t cmd)
2353:lib/ff/sdio_stm32f1.c **** {
2354:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
2355:lib/ff/sdio_stm32f1.c ****   uint32_t status;
2356:lib/ff/sdio_stm32f1.c ****   uint32_t response_r1;
2357:lib/ff/sdio_stm32f1.c **** 
2358:lib/ff/sdio_stm32f1.c ****   status = SDIO->STA;
2359:lib/ff/sdio_stm32f1.c **** 
2360:lib/ff/sdio_stm32f1.c ****   while (!(status & (SDIO_FLAG_CCRCFAIL | SDIO_FLAG_CMDREND | SDIO_FLAG_CTIMEOUT)))
2361:lib/ff/sdio_stm32f1.c ****   {
2362:lib/ff/sdio_stm32f1.c ****     status = SDIO->STA;
2363:lib/ff/sdio_stm32f1.c ****   }
2364:lib/ff/sdio_stm32f1.c **** 
2365:lib/ff/sdio_stm32f1.c ****   if (status & SDIO_FLAG_CTIMEOUT)
2366:lib/ff/sdio_stm32f1.c ****   {
2367:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_CMD_RSP_TIMEOUT;
2368:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_CTIMEOUT);
2369:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2370:lib/ff/sdio_stm32f1.c ****   }
2371:lib/ff/sdio_stm32f1.c ****   else if (status & SDIO_FLAG_CCRCFAIL)
2372:lib/ff/sdio_stm32f1.c ****   {
2373:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_CMD_CRC_FAIL;
2374:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_CCRCFAIL);
2375:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2376:lib/ff/sdio_stm32f1.c ****   }
2377:lib/ff/sdio_stm32f1.c **** 
2378:lib/ff/sdio_stm32f1.c ****   /*!< Check response received is of desired command */
2379:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetCommandResponse() != cmd)
2380:lib/ff/sdio_stm32f1.c ****   {
2381:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_ILLEGAL_CMD;
2382:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2383:lib/ff/sdio_stm32f1.c ****   }
2384:lib/ff/sdio_stm32f1.c **** 
2385:lib/ff/sdio_stm32f1.c ****   /*!< Clear all the static flags */
2386:lib/ff/sdio_stm32f1.c ****   SDIO_ClearFlag(SDIO_STATIC_FLAGS);
2387:lib/ff/sdio_stm32f1.c **** 
2388:lib/ff/sdio_stm32f1.c ****   /*!< We have received response, retrieve it for analysis  */
2389:lib/ff/sdio_stm32f1.c ****   response_r1 = SDIO_GetResponse(SDIO_RESP1);
2390:lib/ff/sdio_stm32f1.c **** 
2391:lib/ff/sdio_stm32f1.c ****   if ((response_r1 & SD_OCR_ERRORBITS) == SD_ALLZERO)
2392:lib/ff/sdio_stm32f1.c ****   {
2393:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2394:lib/ff/sdio_stm32f1.c ****   }
2395:lib/ff/sdio_stm32f1.c **** 
2396:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_ADDR_OUT_OF_RANGE)
2397:lib/ff/sdio_stm32f1.c ****   {
2398:lib/ff/sdio_stm32f1.c ****     return(SD_ADDR_OUT_OF_RANGE);
2399:lib/ff/sdio_stm32f1.c ****   }
2400:lib/ff/sdio_stm32f1.c **** 
2401:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_ADDR_MISALIGNED)
2402:lib/ff/sdio_stm32f1.c ****   {
2403:lib/ff/sdio_stm32f1.c ****     return(SD_ADDR_MISALIGNED);
2404:lib/ff/sdio_stm32f1.c ****   }
2405:lib/ff/sdio_stm32f1.c **** 
2406:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_BLOCK_LEN_ERR)
2407:lib/ff/sdio_stm32f1.c ****   {
2408:lib/ff/sdio_stm32f1.c ****     return(SD_BLOCK_LEN_ERR);
2409:lib/ff/sdio_stm32f1.c ****   }
2410:lib/ff/sdio_stm32f1.c **** 
2411:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_ERASE_SEQ_ERR)
2412:lib/ff/sdio_stm32f1.c ****   {
2413:lib/ff/sdio_stm32f1.c ****     return(SD_ERASE_SEQ_ERR);
2414:lib/ff/sdio_stm32f1.c ****   }
2415:lib/ff/sdio_stm32f1.c **** 
2416:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_BAD_ERASE_PARAM)
2417:lib/ff/sdio_stm32f1.c ****   {
2418:lib/ff/sdio_stm32f1.c ****     return(SD_BAD_ERASE_PARAM);
2419:lib/ff/sdio_stm32f1.c ****   }
2420:lib/ff/sdio_stm32f1.c **** 
2421:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_WRITE_PROT_VIOLATION)
2422:lib/ff/sdio_stm32f1.c ****   {
2423:lib/ff/sdio_stm32f1.c ****     return(SD_WRITE_PROT_VIOLATION);
2424:lib/ff/sdio_stm32f1.c ****   }
2425:lib/ff/sdio_stm32f1.c **** 
2426:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_LOCK_UNLOCK_FAILED)
2427:lib/ff/sdio_stm32f1.c ****   {
2428:lib/ff/sdio_stm32f1.c ****     return(SD_LOCK_UNLOCK_FAILED);
2429:lib/ff/sdio_stm32f1.c ****   }
2430:lib/ff/sdio_stm32f1.c **** 
2431:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_COM_CRC_FAILED)
2432:lib/ff/sdio_stm32f1.c ****   {
2433:lib/ff/sdio_stm32f1.c ****     return(SD_COM_CRC_FAILED);
2434:lib/ff/sdio_stm32f1.c ****   }
2435:lib/ff/sdio_stm32f1.c **** 
2436:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_ILLEGAL_CMD)
2437:lib/ff/sdio_stm32f1.c ****   {
2438:lib/ff/sdio_stm32f1.c ****     return(SD_ILLEGAL_CMD);
2439:lib/ff/sdio_stm32f1.c ****   }
2440:lib/ff/sdio_stm32f1.c **** 
2441:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_CARD_ECC_FAILED)
2442:lib/ff/sdio_stm32f1.c ****   {
2443:lib/ff/sdio_stm32f1.c ****     return(SD_CARD_ECC_FAILED);
2444:lib/ff/sdio_stm32f1.c ****   }
2445:lib/ff/sdio_stm32f1.c **** 
2446:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_CC_ERROR)
2447:lib/ff/sdio_stm32f1.c ****   {
2448:lib/ff/sdio_stm32f1.c ****     return(SD_CC_ERROR);
2449:lib/ff/sdio_stm32f1.c ****   }
2450:lib/ff/sdio_stm32f1.c **** 
2451:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_GENERAL_UNKNOWN_ERROR)
2452:lib/ff/sdio_stm32f1.c ****   {
2453:lib/ff/sdio_stm32f1.c ****     return(SD_GENERAL_UNKNOWN_ERROR);
2454:lib/ff/sdio_stm32f1.c ****   }
2455:lib/ff/sdio_stm32f1.c **** 
2456:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_STREAM_READ_UNDERRUN)
2457:lib/ff/sdio_stm32f1.c ****   {
2458:lib/ff/sdio_stm32f1.c ****     return(SD_STREAM_READ_UNDERRUN);
2459:lib/ff/sdio_stm32f1.c ****   }
2460:lib/ff/sdio_stm32f1.c **** 
2461:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_STREAM_WRITE_OVERRUN)
2462:lib/ff/sdio_stm32f1.c ****   {
2463:lib/ff/sdio_stm32f1.c ****     return(SD_STREAM_WRITE_OVERRUN);
2464:lib/ff/sdio_stm32f1.c ****   }
2465:lib/ff/sdio_stm32f1.c **** 
2466:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_CID_CSD_OVERWRIETE)
2467:lib/ff/sdio_stm32f1.c ****   {
2468:lib/ff/sdio_stm32f1.c ****     return(SD_CID_CSD_OVERWRITE);
2469:lib/ff/sdio_stm32f1.c ****   }
2470:lib/ff/sdio_stm32f1.c **** 
2471:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_WP_ERASE_SKIP)
2472:lib/ff/sdio_stm32f1.c ****   {
2473:lib/ff/sdio_stm32f1.c ****     return(SD_WP_ERASE_SKIP);
2474:lib/ff/sdio_stm32f1.c ****   }
2475:lib/ff/sdio_stm32f1.c **** 
2476:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_CARD_ECC_DISABLED)
2477:lib/ff/sdio_stm32f1.c ****   {
2478:lib/ff/sdio_stm32f1.c ****     return(SD_CARD_ECC_DISABLED);
2479:lib/ff/sdio_stm32f1.c ****   }
2480:lib/ff/sdio_stm32f1.c **** 
2481:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_ERASE_RESET)
2482:lib/ff/sdio_stm32f1.c ****   {
2483:lib/ff/sdio_stm32f1.c ****     return(SD_ERASE_RESET);
2484:lib/ff/sdio_stm32f1.c ****   }
2485:lib/ff/sdio_stm32f1.c **** 
2486:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_AKE_SEQ_ERROR)
2487:lib/ff/sdio_stm32f1.c ****   {
2488:lib/ff/sdio_stm32f1.c ****     return(SD_AKE_SEQ_ERROR);
2489:lib/ff/sdio_stm32f1.c ****   }
2490:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
2491:lib/ff/sdio_stm32f1.c **** }
2492:lib/ff/sdio_stm32f1.c **** 
2493:lib/ff/sdio_stm32f1.c **** 
2494:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2495:lib/ff/sdio_stm32f1.c **** /*! 
2496:lib/ff/sdio_stm32f1.c **** 	@brief  Checks for error conditions for R3 (OCR) response.
2497:lib/ff/sdio_stm32f1.c **** 	@param  None
2498:lib/ff/sdio_stm32f1.c **** 	@retval SD_Error: SD Card Error code.
2499:lib/ff/sdio_stm32f1.c **** */
2500:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2501:lib/ff/sdio_stm32f1.c **** static SD_Error CmdResp3Error(void)
2502:lib/ff/sdio_stm32f1.c **** {
2503:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
2504:lib/ff/sdio_stm32f1.c ****   uint32_t status;
2505:lib/ff/sdio_stm32f1.c **** 
2506:lib/ff/sdio_stm32f1.c ****   status = SDIO->STA;
2507:lib/ff/sdio_stm32f1.c **** 
2508:lib/ff/sdio_stm32f1.c ****   while (!(status & (SDIO_FLAG_CCRCFAIL | SDIO_FLAG_CMDREND | SDIO_FLAG_CTIMEOUT)))
2509:lib/ff/sdio_stm32f1.c ****   {
2510:lib/ff/sdio_stm32f1.c ****     status = SDIO->STA;
2511:lib/ff/sdio_stm32f1.c ****   }
2512:lib/ff/sdio_stm32f1.c **** 
2513:lib/ff/sdio_stm32f1.c ****   if (status & SDIO_FLAG_CTIMEOUT)
2514:lib/ff/sdio_stm32f1.c ****   {
2515:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_CMD_RSP_TIMEOUT;
2516:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_CTIMEOUT);
2517:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2518:lib/ff/sdio_stm32f1.c ****   }
2519:lib/ff/sdio_stm32f1.c ****   /*!< Clear all the static flags */
2520:lib/ff/sdio_stm32f1.c ****   SDIO_ClearFlag(SDIO_STATIC_FLAGS);
2521:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
2522:lib/ff/sdio_stm32f1.c **** }
2523:lib/ff/sdio_stm32f1.c **** 
2524:lib/ff/sdio_stm32f1.c **** 
2525:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2526:lib/ff/sdio_stm32f1.c **** /*! 
2527:lib/ff/sdio_stm32f1.c **** 	@brief  Checks for error conditions for R2 (CID or CSD) response.
2528:lib/ff/sdio_stm32f1.c **** 	@param  None
2529:lib/ff/sdio_stm32f1.c **** 	@retval SD_Error: SD Card Error code.
2530:lib/ff/sdio_stm32f1.c **** */
2531:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2532:lib/ff/sdio_stm32f1.c **** static SD_Error CmdResp2Error(void)
2533:lib/ff/sdio_stm32f1.c **** {
  26              		.loc 1 2533 0
  27              		.cfi_startproc
  28              		@ args = 0, pretend = 0, frame = 0
  29              		@ frame_needed = 0, uses_anonymous_args = 0
  30 0000 08B5     		push	{r3, lr}
  31              	.LCFI0:
  32              		.cfi_def_cfa_offset 8
  33              		.cfi_offset 3, -8
  34              		.cfi_offset 14, -4
  35              	.LVL0:
2534:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
2535:lib/ff/sdio_stm32f1.c ****   uint32_t status;
2536:lib/ff/sdio_stm32f1.c **** 
2537:lib/ff/sdio_stm32f1.c ****   status = SDIO->STA;
  36              		.loc 1 2537 0
  37 0002 0C4A     		ldr	r2, .L8
  38              	.L3:
2538:lib/ff/sdio_stm32f1.c **** 
2539:lib/ff/sdio_stm32f1.c ****   while (!(status & (SDIO_FLAG_CCRCFAIL | SDIO_FLAG_CTIMEOUT | SDIO_FLAG_CMDREND)))
2540:lib/ff/sdio_stm32f1.c ****   {
2541:lib/ff/sdio_stm32f1.c ****     status = SDIO->STA;
  39              		.loc 1 2541 0
  40 0004 536B     		ldr	r3, [r2, #52]
  41              	.LVL1:
2539:lib/ff/sdio_stm32f1.c ****   while (!(status & (SDIO_FLAG_CCRCFAIL | SDIO_FLAG_CTIMEOUT | SDIO_FLAG_CMDREND)))
  42              		.loc 1 2539 0
  43 0006 13F0450F 		tst	r3, #69
  44 000a FBD0     		beq	.L3
2542:lib/ff/sdio_stm32f1.c ****   }
2543:lib/ff/sdio_stm32f1.c **** 
2544:lib/ff/sdio_stm32f1.c ****   if (status & SDIO_FLAG_CTIMEOUT)
  45              		.loc 1 2544 0
  46 000c 5A07     		lsls	r2, r3, #29
  47 000e 04D5     		bpl	.L4
  48              	.LVL2:
2545:lib/ff/sdio_stm32f1.c ****   {
2546:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_CMD_RSP_TIMEOUT;
2547:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_CTIMEOUT);
  49              		.loc 1 2547 0
  50 0010 0420     		movs	r0, #4
  51 0012 FFF7FEFF 		bl	SDIO_ClearFlag
  52              	.LVL3:
2548:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
  53              		.loc 1 2548 0
  54 0016 0320     		movs	r0, #3
  55 0018 08BD     		pop	{r3, pc}
  56              	.LVL4:
  57              	.L4:
2549:lib/ff/sdio_stm32f1.c ****   }
2550:lib/ff/sdio_stm32f1.c ****   else if (status & SDIO_FLAG_CCRCFAIL)
  58              		.loc 1 2550 0
  59 001a DB07     		lsls	r3, r3, #31
  60              	.LVL5:
  61 001c 04D5     		bpl	.L6
  62              	.LVL6:
2551:lib/ff/sdio_stm32f1.c ****   {
2552:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_CMD_CRC_FAIL;
2553:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_CCRCFAIL);
  63              		.loc 1 2553 0
  64 001e 0120     		movs	r0, #1
  65 0020 FFF7FEFF 		bl	SDIO_ClearFlag
  66              	.LVL7:
2554:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
  67              		.loc 1 2554 0
  68 0024 0120     		movs	r0, #1
  69 0026 08BD     		pop	{r3, pc}
  70              	.LVL8:
  71              	.L6:
2555:lib/ff/sdio_stm32f1.c ****   }
2556:lib/ff/sdio_stm32f1.c **** 
2557:lib/ff/sdio_stm32f1.c ****   /*!< Clear all the static flags */
2558:lib/ff/sdio_stm32f1.c ****   SDIO_ClearFlag(SDIO_STATIC_FLAGS);
  72              		.loc 1 2558 0
  73 0028 40F2FF50 		movw	r0, #1535
  74 002c FFF7FEFF 		bl	SDIO_ClearFlag
  75              	.LVL9:
2559:lib/ff/sdio_stm32f1.c **** 
2560:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
  76              		.loc 1 2560 0
  77 0030 2A20     		movs	r0, #42
2561:lib/ff/sdio_stm32f1.c **** }
  78              		.loc 1 2561 0
  79 0032 08BD     		pop	{r3, pc}
  80              	.L9:
  81              		.align	2
  82              	.L8:
  83 0034 00800140 		.word	1073840128
  84              		.cfi_endproc
  85              	.LFE82:
  87              		.section	.text.IsCardProgramming,"ax",%progbits
  88              		.align	1
  89              		.thumb
  90              		.thumb_func
  92              	IsCardProgramming:
  93              	.LFB85:
2562:lib/ff/sdio_stm32f1.c **** 
2563:lib/ff/sdio_stm32f1.c **** 
2564:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2565:lib/ff/sdio_stm32f1.c **** /*! 
2566:lib/ff/sdio_stm32f1.c **** 	@brief  Checks for error conditions for R6 (RCA) response.
2567:lib/ff/sdio_stm32f1.c **** 	@param  cmd: The sent command index.
2568:lib/ff/sdio_stm32f1.c **** 	@param  prca: pointer to the variable that will contain the SD card relative 
2569:lib/ff/sdio_stm32f1.c **** 			address RCA. 
2570:lib/ff/sdio_stm32f1.c **** 	@retval SD_Error: SD Card Error code.
2571:lib/ff/sdio_stm32f1.c **** */
2572:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2573:lib/ff/sdio_stm32f1.c **** static SD_Error CmdResp6Error(uint8_t cmd, uint16_t *prca)
2574:lib/ff/sdio_stm32f1.c **** {
2575:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
2576:lib/ff/sdio_stm32f1.c ****   uint32_t status;
2577:lib/ff/sdio_stm32f1.c ****   uint32_t response_r1;
2578:lib/ff/sdio_stm32f1.c **** 
2579:lib/ff/sdio_stm32f1.c ****   status = SDIO->STA;
2580:lib/ff/sdio_stm32f1.c **** 
2581:lib/ff/sdio_stm32f1.c ****   while (!(status & (SDIO_FLAG_CCRCFAIL | SDIO_FLAG_CTIMEOUT | SDIO_FLAG_CMDREND)))
2582:lib/ff/sdio_stm32f1.c ****   {
2583:lib/ff/sdio_stm32f1.c ****     status = SDIO->STA;
2584:lib/ff/sdio_stm32f1.c ****   }
2585:lib/ff/sdio_stm32f1.c **** 
2586:lib/ff/sdio_stm32f1.c ****   if (status & SDIO_FLAG_CTIMEOUT)
2587:lib/ff/sdio_stm32f1.c ****   {
2588:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_CMD_RSP_TIMEOUT;
2589:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_CTIMEOUT);
2590:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2591:lib/ff/sdio_stm32f1.c ****   }
2592:lib/ff/sdio_stm32f1.c ****   else if (status & SDIO_FLAG_CCRCFAIL)
2593:lib/ff/sdio_stm32f1.c ****   {
2594:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_CMD_CRC_FAIL;
2595:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_CCRCFAIL);
2596:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2597:lib/ff/sdio_stm32f1.c ****   }
2598:lib/ff/sdio_stm32f1.c **** 
2599:lib/ff/sdio_stm32f1.c ****   /*!< Check response received is of desired command */
2600:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetCommandResponse() != cmd)
2601:lib/ff/sdio_stm32f1.c ****   {
2602:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_ILLEGAL_CMD;
2603:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2604:lib/ff/sdio_stm32f1.c ****   }
2605:lib/ff/sdio_stm32f1.c **** 
2606:lib/ff/sdio_stm32f1.c ****   /*!< Clear all the static flags */
2607:lib/ff/sdio_stm32f1.c ****   SDIO_ClearFlag(SDIO_STATIC_FLAGS);
2608:lib/ff/sdio_stm32f1.c **** 
2609:lib/ff/sdio_stm32f1.c ****   /*!< We have received response, retrieve it.  */
2610:lib/ff/sdio_stm32f1.c ****   response_r1 = SDIO_GetResponse(SDIO_RESP1);
2611:lib/ff/sdio_stm32f1.c **** 
2612:lib/ff/sdio_stm32f1.c ****   if (SD_ALLZERO == (response_r1 & (SD_R6_GENERAL_UNKNOWN_ERROR | SD_R6_ILLEGAL_CMD | SD_R6_COM_CRC
2613:lib/ff/sdio_stm32f1.c ****   {
2614:lib/ff/sdio_stm32f1.c ****     *prca = (uint16_t) (response_r1 >> 16);
2615:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2616:lib/ff/sdio_stm32f1.c ****   }
2617:lib/ff/sdio_stm32f1.c **** 
2618:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_R6_GENERAL_UNKNOWN_ERROR)
2619:lib/ff/sdio_stm32f1.c ****   {
2620:lib/ff/sdio_stm32f1.c ****     return(SD_GENERAL_UNKNOWN_ERROR);
2621:lib/ff/sdio_stm32f1.c ****   }
2622:lib/ff/sdio_stm32f1.c **** 
2623:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_R6_ILLEGAL_CMD)
2624:lib/ff/sdio_stm32f1.c ****   {
2625:lib/ff/sdio_stm32f1.c ****     return(SD_ILLEGAL_CMD);
2626:lib/ff/sdio_stm32f1.c ****   }
2627:lib/ff/sdio_stm32f1.c **** 
2628:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_R6_COM_CRC_FAILED)
2629:lib/ff/sdio_stm32f1.c ****   {
2630:lib/ff/sdio_stm32f1.c ****     return(SD_COM_CRC_FAILED);
2631:lib/ff/sdio_stm32f1.c ****   }
2632:lib/ff/sdio_stm32f1.c **** 
2633:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
2634:lib/ff/sdio_stm32f1.c **** }
2635:lib/ff/sdio_stm32f1.c **** 
2636:lib/ff/sdio_stm32f1.c **** 
2637:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2638:lib/ff/sdio_stm32f1.c **** /*! 
2639:lib/ff/sdio_stm32f1.c **** 	@brief  Enables or disables the SDIO wide bus mode.
2640:lib/ff/sdio_stm32f1.c **** 	@param  NewState: new state of the SDIO wide bus mode.
2641:lib/ff/sdio_stm32f1.c **** 		This parameter can be: ENABLE or DISABLE.
2642:lib/ff/sdio_stm32f1.c **** 	@retval SD_Error: SD Card Error code.
2643:lib/ff/sdio_stm32f1.c **** */
2644:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2645:lib/ff/sdio_stm32f1.c **** static SD_Error SDEnWideBus(FunctionalState NewState)
2646:lib/ff/sdio_stm32f1.c **** {
2647:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
2648:lib/ff/sdio_stm32f1.c **** 
2649:lib/ff/sdio_stm32f1.c ****   uint32_t scr[2] = {0, 0};
2650:lib/ff/sdio_stm32f1.c **** 
2651:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetResponse(SDIO_RESP1) & SD_CARD_LOCKED)
2652:lib/ff/sdio_stm32f1.c ****   {
2653:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_LOCK_UNLOCK_FAILED;
2654:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2655:lib/ff/sdio_stm32f1.c ****   }
2656:lib/ff/sdio_stm32f1.c **** 
2657:lib/ff/sdio_stm32f1.c ****   /*!< Get SCR Register */
2658:lib/ff/sdio_stm32f1.c ****   errorstatus = FindSCR(RCA, scr);
2659:lib/ff/sdio_stm32f1.c **** 
2660:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
2661:lib/ff/sdio_stm32f1.c ****   {
2662:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2663:lib/ff/sdio_stm32f1.c ****   }
2664:lib/ff/sdio_stm32f1.c **** 
2665:lib/ff/sdio_stm32f1.c ****   /*!< If wide bus operation to be enabled */
2666:lib/ff/sdio_stm32f1.c ****   if (NewState == ENABLE)
2667:lib/ff/sdio_stm32f1.c ****   {
2668:lib/ff/sdio_stm32f1.c ****     /*!< If requested card supports wide bus operation */
2669:lib/ff/sdio_stm32f1.c ****     if ((scr[1] & SD_WIDE_BUS_SUPPORT) != SD_ALLZERO)
2670:lib/ff/sdio_stm32f1.c ****     {
2671:lib/ff/sdio_stm32f1.c ****       /*!< Send CMD55 APP_CMD with argument as card's RCA.*/
2672:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) RCA << 16;
2673:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_CMD;
2674:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
2675:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
2676:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
2677:lib/ff/sdio_stm32f1.c ****       SDIO_SendCommand(&SDIO_CmdInitStructure);
2678:lib/ff/sdio_stm32f1.c **** 
2679:lib/ff/sdio_stm32f1.c ****       errorstatus = CmdResp1Error(SD_CMD_APP_CMD);
2680:lib/ff/sdio_stm32f1.c **** 
2681:lib/ff/sdio_stm32f1.c ****       if (errorstatus != SD_OK)
2682:lib/ff/sdio_stm32f1.c ****       {
2683:lib/ff/sdio_stm32f1.c ****         return(errorstatus);
2684:lib/ff/sdio_stm32f1.c ****       }
2685:lib/ff/sdio_stm32f1.c **** 
2686:lib/ff/sdio_stm32f1.c ****       /*!< Send ACMD6 APP_CMD with argument as 2 for wide bus mode */
2687:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Argument = 0x2;
2688:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_SD_SET_BUSWIDTH;
2689:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
2690:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
2691:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
2692:lib/ff/sdio_stm32f1.c ****       SDIO_SendCommand(&SDIO_CmdInitStructure);
2693:lib/ff/sdio_stm32f1.c **** 
2694:lib/ff/sdio_stm32f1.c ****       errorstatus = CmdResp1Error(SD_CMD_APP_SD_SET_BUSWIDTH);
2695:lib/ff/sdio_stm32f1.c **** 
2696:lib/ff/sdio_stm32f1.c ****       if (errorstatus != SD_OK)
2697:lib/ff/sdio_stm32f1.c ****       {
2698:lib/ff/sdio_stm32f1.c ****         return(errorstatus);
2699:lib/ff/sdio_stm32f1.c ****       }
2700:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
2701:lib/ff/sdio_stm32f1.c ****     }
2702:lib/ff/sdio_stm32f1.c ****     else
2703:lib/ff/sdio_stm32f1.c ****     {
2704:lib/ff/sdio_stm32f1.c ****       errorstatus = SD_REQUEST_NOT_APPLICABLE;
2705:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
2706:lib/ff/sdio_stm32f1.c ****     }
2707:lib/ff/sdio_stm32f1.c ****   }   /*!< If wide bus operation to be disabled */
2708:lib/ff/sdio_stm32f1.c ****   else
2709:lib/ff/sdio_stm32f1.c ****   {
2710:lib/ff/sdio_stm32f1.c ****     /*!< If requested card supports 1 bit mode operation */
2711:lib/ff/sdio_stm32f1.c ****     if ((scr[1] & SD_SINGLE_BUS_SUPPORT) != SD_ALLZERO)
2712:lib/ff/sdio_stm32f1.c ****     {
2713:lib/ff/sdio_stm32f1.c ****       /*!< Send CMD55 APP_CMD with argument as card's RCA.*/
2714:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) RCA << 16;
2715:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_CMD;
2716:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
2717:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
2718:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
2719:lib/ff/sdio_stm32f1.c ****       SDIO_SendCommand(&SDIO_CmdInitStructure);
2720:lib/ff/sdio_stm32f1.c **** 
2721:lib/ff/sdio_stm32f1.c **** 
2722:lib/ff/sdio_stm32f1.c ****       errorstatus = CmdResp1Error(SD_CMD_APP_CMD);
2723:lib/ff/sdio_stm32f1.c **** 
2724:lib/ff/sdio_stm32f1.c ****       if (errorstatus != SD_OK)
2725:lib/ff/sdio_stm32f1.c ****       {
2726:lib/ff/sdio_stm32f1.c ****         return(errorstatus);
2727:lib/ff/sdio_stm32f1.c ****       }
2728:lib/ff/sdio_stm32f1.c **** 
2729:lib/ff/sdio_stm32f1.c ****       /*!< Send ACMD6 APP_CMD with argument as 2 for wide bus mode */
2730:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Argument = 0x00;
2731:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_SD_SET_BUSWIDTH;
2732:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
2733:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
2734:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
2735:lib/ff/sdio_stm32f1.c ****       SDIO_SendCommand(&SDIO_CmdInitStructure);
2736:lib/ff/sdio_stm32f1.c **** 
2737:lib/ff/sdio_stm32f1.c ****       errorstatus = CmdResp1Error(SD_CMD_APP_SD_SET_BUSWIDTH);
2738:lib/ff/sdio_stm32f1.c **** 
2739:lib/ff/sdio_stm32f1.c ****       if (errorstatus != SD_OK)
2740:lib/ff/sdio_stm32f1.c ****       {
2741:lib/ff/sdio_stm32f1.c ****         return(errorstatus);
2742:lib/ff/sdio_stm32f1.c ****       }
2743:lib/ff/sdio_stm32f1.c **** 
2744:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
2745:lib/ff/sdio_stm32f1.c ****     }
2746:lib/ff/sdio_stm32f1.c ****     else
2747:lib/ff/sdio_stm32f1.c ****     {
2748:lib/ff/sdio_stm32f1.c ****       errorstatus = SD_REQUEST_NOT_APPLICABLE;
2749:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
2750:lib/ff/sdio_stm32f1.c ****     }
2751:lib/ff/sdio_stm32f1.c ****   }
2752:lib/ff/sdio_stm32f1.c **** }
2753:lib/ff/sdio_stm32f1.c **** 
2754:lib/ff/sdio_stm32f1.c **** 
2755:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2756:lib/ff/sdio_stm32f1.c **** /*! 
2757:lib/ff/sdio_stm32f1.c **** 	@brief  Checks if the SD card is in programming state.
2758:lib/ff/sdio_stm32f1.c **** 	@param  pstatus: pointer to the variable that will contain the SD card state.
2759:lib/ff/sdio_stm32f1.c **** 	@retval SD_Error: SD Card Error code.
2760:lib/ff/sdio_stm32f1.c **** */
2761:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2762:lib/ff/sdio_stm32f1.c **** static SD_Error IsCardProgramming(uint8_t *pstatus)
2763:lib/ff/sdio_stm32f1.c **** {
  94              		.loc 1 2763 0
  95              		.cfi_startproc
  96              		@ args = 0, pretend = 0, frame = 8
  97              		@ frame_needed = 0, uses_anonymous_args = 0
  98              	.LVL10:
  99 0000 37B5     		push	{r0, r1, r2, r4, r5, lr}
 100              	.LCFI1:
 101              		.cfi_def_cfa_offset 24
 102              		.cfi_offset 0, -24
 103              		.cfi_offset 1, -20
 104              		.cfi_offset 2, -16
 105              		.cfi_offset 4, -12
 106              		.cfi_offset 5, -8
 107              		.cfi_offset 14, -4
 108 0002 0446     		mov	r4, r0
 109              	.LVL11:
2764:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
2765:lib/ff/sdio_stm32f1.c ****   __IO uint32_t respR1 = 0, status = 0;
 110              		.loc 1 2765 0
 111 0004 0022     		movs	r2, #0
 112 0006 0092     		str	r2, [sp, #0]
 113              	.LVL12:
 114 0008 0192     		str	r2, [sp, #4]
 115              	.LVL13:
2766:lib/ff/sdio_stm32f1.c **** 
2767:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) RCA << 16;
 116              		.loc 1 2767 0
 117 000a 5048     		ldr	r0, .L37
 118              	.LVL14:
 119 000c 5049     		ldr	r1, .L37+4
 120 000e 0B68     		ldr	r3, [r1, #0]
 121 0010 1904     		lsls	r1, r3, #16
 122 0012 0160     		str	r1, [r0, #0]
2768:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SEND_STATUS;
 123              		.loc 1 2768 0
 124 0014 0D23     		movs	r3, #13
 125 0016 4360     		str	r3, [r0, #4]
2769:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 126              		.loc 1 2769 0
 127 0018 4021     		movs	r1, #64
 128 001a 8160     		str	r1, [r0, #8]
2770:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 129              		.loc 1 2770 0
 130 001c C260     		str	r2, [r0, #12]
2771:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 131              		.loc 1 2771 0
 132 001e 4FF48062 		mov	r2, #1024
 133 0022 0261     		str	r2, [r0, #16]
2772:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 134              		.loc 1 2772 0
 135 0024 FFF7FEFF 		bl	SDIO_SendCommand
 136              	.LVL15:
2773:lib/ff/sdio_stm32f1.c **** 
2774:lib/ff/sdio_stm32f1.c ****   status = SDIO->STA;
 137              		.loc 1 2774 0
 138 0028 4A48     		ldr	r0, .L37+8
 139              	.L12:
2775:lib/ff/sdio_stm32f1.c ****   while (!(status & (SDIO_FLAG_CCRCFAIL | SDIO_FLAG_CMDREND | SDIO_FLAG_CTIMEOUT)))
2776:lib/ff/sdio_stm32f1.c ****   {
2777:lib/ff/sdio_stm32f1.c ****     status = SDIO->STA;
 140              		.loc 1 2777 0
 141 002a 436B     		ldr	r3, [r0, #52]
 142              	.LVL16:
 143 002c 0193     		str	r3, [sp, #4]
2775:lib/ff/sdio_stm32f1.c ****   while (!(status & (SDIO_FLAG_CCRCFAIL | SDIO_FLAG_CMDREND | SDIO_FLAG_CTIMEOUT)))
 144              		.loc 1 2775 0
 145 002e 0199     		ldr	r1, [sp, #4]
 146 0030 11F0450F 		tst	r1, #69
 147 0034 F9D0     		beq	.L12
2778:lib/ff/sdio_stm32f1.c ****   }
2779:lib/ff/sdio_stm32f1.c **** 
2780:lib/ff/sdio_stm32f1.c ****   if (status & SDIO_FLAG_CTIMEOUT)
 148              		.loc 1 2780 0
 149 0036 019A     		ldr	r2, [sp, #4]
 150 0038 5007     		lsls	r0, r2, #29
 151 003a 04D5     		bpl	.L13
 152              	.LVL17:
2781:lib/ff/sdio_stm32f1.c ****   {
2782:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_CMD_RSP_TIMEOUT;
2783:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_CTIMEOUT);
 153              		.loc 1 2783 0
 154 003c 0420     		movs	r0, #4
 155 003e FFF7FEFF 		bl	SDIO_ClearFlag
 156              	.LVL18:
2784:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 157              		.loc 1 2784 0
 158 0042 0320     		movs	r0, #3
 159 0044 81E0     		b	.L14
 160              	.LVL19:
 161              	.L13:
2785:lib/ff/sdio_stm32f1.c ****   }
2786:lib/ff/sdio_stm32f1.c ****   else if (status & SDIO_FLAG_CCRCFAIL)
 162              		.loc 1 2786 0
 163 0046 019D     		ldr	r5, [sp, #4]
 164 0048 15F00105 		ands	r5, r5, #1
 165 004c 04D0     		beq	.L15
 166              	.LVL20:
2787:lib/ff/sdio_stm32f1.c ****   {
2788:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_CMD_CRC_FAIL;
2789:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_CCRCFAIL);
 167              		.loc 1 2789 0
 168 004e 0120     		movs	r0, #1
 169 0050 FFF7FEFF 		bl	SDIO_ClearFlag
 170              	.LVL21:
2790:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 171              		.loc 1 2790 0
 172 0054 0120     		movs	r0, #1
 173 0056 78E0     		b	.L14
 174              	.LVL22:
 175              	.L15:
2791:lib/ff/sdio_stm32f1.c ****   }
2792:lib/ff/sdio_stm32f1.c **** 
2793:lib/ff/sdio_stm32f1.c ****   status = (uint32_t)SDIO_GetCommandResponse();
 176              		.loc 1 2793 0
 177 0058 FFF7FEFF 		bl	SDIO_GetCommandResponse
 178              	.LVL23:
 179 005c 0190     		str	r0, [sp, #4]
2794:lib/ff/sdio_stm32f1.c **** 
2795:lib/ff/sdio_stm32f1.c ****   /*!< Check response received is of desired command */
2796:lib/ff/sdio_stm32f1.c ****   if (status != SD_CMD_SEND_STATUS)
 180              		.loc 1 2796 0
 181 005e 0198     		ldr	r0, [sp, #4]
 182 0060 0D28     		cmp	r0, #13
 183 0062 01D0     		beq	.L16
 184              	.L17:
2797:lib/ff/sdio_stm32f1.c ****   {
2798:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_ILLEGAL_CMD;
2799:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 185              		.loc 1 2799 0
 186 0064 1020     		movs	r0, #16
 187 0066 70E0     		b	.L14
 188              	.L16:
2800:lib/ff/sdio_stm32f1.c ****   }
2801:lib/ff/sdio_stm32f1.c **** 
2802:lib/ff/sdio_stm32f1.c ****   /*!< Clear all the static flags */
2803:lib/ff/sdio_stm32f1.c ****   SDIO_ClearFlag(SDIO_STATIC_FLAGS);
 189              		.loc 1 2803 0
 190 0068 40F2FF50 		movw	r0, #1535
 191 006c FFF7FEFF 		bl	SDIO_ClearFlag
 192              	.LVL24:
2804:lib/ff/sdio_stm32f1.c **** 
2805:lib/ff/sdio_stm32f1.c **** 
2806:lib/ff/sdio_stm32f1.c ****   /*!< We have received response, retrieve it for analysis  */
2807:lib/ff/sdio_stm32f1.c ****   respR1 = SDIO_GetResponse(SDIO_RESP1);
 193              		.loc 1 2807 0
 194 0070 2846     		mov	r0, r5
 195 0072 FFF7FEFF 		bl	SDIO_GetResponse
 196              	.LVL25:
 197 0076 0090     		str	r0, [sp, #0]
2808:lib/ff/sdio_stm32f1.c **** 
2809:lib/ff/sdio_stm32f1.c ****   /*!< Find out card status */
2810:lib/ff/sdio_stm32f1.c ****   *pstatus = (uint8_t) ((respR1 >> 9) & 0x0000000F);
 198              		.loc 1 2810 0
 199 0078 009B     		ldr	r3, [sp, #0]
 200 007a C3F34321 		ubfx	r1, r3, #9, #4
 201 007e 2170     		strb	r1, [r4, #0]
2811:lib/ff/sdio_stm32f1.c **** 
2812:lib/ff/sdio_stm32f1.c ****   if ((respR1 & SD_OCR_ERRORBITS) == SD_ALLZERO)
 202              		.loc 1 2812 0
 203 0080 009A     		ldr	r2, [sp, #0]
 204 0082 3548     		ldr	r0, .L37+12
 205              	.LVL26:
 206 0084 1040     		ands	r0, r0, r2
 207 0086 0028     		cmp	r0, #0
 208 0088 3CD0     		beq	.L18
2813:lib/ff/sdio_stm32f1.c ****   {
2814:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2815:lib/ff/sdio_stm32f1.c ****   }
2816:lib/ff/sdio_stm32f1.c **** 
2817:lib/ff/sdio_stm32f1.c ****   if (respR1 & SD_OCR_ADDR_OUT_OF_RANGE)
 209              		.loc 1 2817 0
 210 008a 009B     		ldr	r3, [sp, #0]
 211 008c 002B     		cmp	r3, #0
 212 008e 3BDB     		blt	.L19
2818:lib/ff/sdio_stm32f1.c ****   {
2819:lib/ff/sdio_stm32f1.c ****     return(SD_ADDR_OUT_OF_RANGE);
2820:lib/ff/sdio_stm32f1.c ****   }
2821:lib/ff/sdio_stm32f1.c **** 
2822:lib/ff/sdio_stm32f1.c ****   if (respR1 & SD_OCR_ADDR_MISALIGNED)
 213              		.loc 1 2822 0
 214 0090 0099     		ldr	r1, [sp, #0]
 215 0092 4900     		lsls	r1, r1, #1
 216 0094 3AD4     		bmi	.L20
2823:lib/ff/sdio_stm32f1.c ****   {
2824:lib/ff/sdio_stm32f1.c ****     return(SD_ADDR_MISALIGNED);
2825:lib/ff/sdio_stm32f1.c ****   }
2826:lib/ff/sdio_stm32f1.c **** 
2827:lib/ff/sdio_stm32f1.c ****   if (respR1 & SD_OCR_BLOCK_LEN_ERR)
 217              		.loc 1 2827 0
 218 0096 009A     		ldr	r2, [sp, #0]
 219 0098 9200     		lsls	r2, r2, #2
 220 009a 39D4     		bmi	.L21
2828:lib/ff/sdio_stm32f1.c ****   {
2829:lib/ff/sdio_stm32f1.c ****     return(SD_BLOCK_LEN_ERR);
2830:lib/ff/sdio_stm32f1.c ****   }
2831:lib/ff/sdio_stm32f1.c **** 
2832:lib/ff/sdio_stm32f1.c ****   if (respR1 & SD_OCR_ERASE_SEQ_ERR)
 221              		.loc 1 2832 0
 222 009c 0098     		ldr	r0, [sp, #0]
 223 009e C300     		lsls	r3, r0, #3
 224 00a0 38D4     		bmi	.L22
2833:lib/ff/sdio_stm32f1.c ****   {
2834:lib/ff/sdio_stm32f1.c ****     return(SD_ERASE_SEQ_ERR);
2835:lib/ff/sdio_stm32f1.c ****   }
2836:lib/ff/sdio_stm32f1.c **** 
2837:lib/ff/sdio_stm32f1.c ****   if (respR1 & SD_OCR_BAD_ERASE_PARAM)
 225              		.loc 1 2837 0
 226 00a2 009B     		ldr	r3, [sp, #0]
 227 00a4 1801     		lsls	r0, r3, #4
 228 00a6 37D4     		bmi	.L23
2838:lib/ff/sdio_stm32f1.c ****   {
2839:lib/ff/sdio_stm32f1.c ****     return(SD_BAD_ERASE_PARAM);
2840:lib/ff/sdio_stm32f1.c ****   }
2841:lib/ff/sdio_stm32f1.c **** 
2842:lib/ff/sdio_stm32f1.c ****   if (respR1 & SD_OCR_WRITE_PROT_VIOLATION)
 229              		.loc 1 2842 0
 230 00a8 0099     		ldr	r1, [sp, #0]
 231 00aa 4901     		lsls	r1, r1, #5
 232 00ac 36D4     		bmi	.L24
2843:lib/ff/sdio_stm32f1.c ****   {
2844:lib/ff/sdio_stm32f1.c ****     return(SD_WRITE_PROT_VIOLATION);
2845:lib/ff/sdio_stm32f1.c ****   }
2846:lib/ff/sdio_stm32f1.c **** 
2847:lib/ff/sdio_stm32f1.c ****   if (respR1 & SD_OCR_LOCK_UNLOCK_FAILED)
 233              		.loc 1 2847 0
 234 00ae 009A     		ldr	r2, [sp, #0]
 235 00b0 D201     		lsls	r2, r2, #7
 236 00b2 35D4     		bmi	.L25
2848:lib/ff/sdio_stm32f1.c ****   {
2849:lib/ff/sdio_stm32f1.c ****     return(SD_LOCK_UNLOCK_FAILED);
2850:lib/ff/sdio_stm32f1.c ****   }
2851:lib/ff/sdio_stm32f1.c **** 
2852:lib/ff/sdio_stm32f1.c ****   if (respR1 & SD_OCR_COM_CRC_FAILED)
 237              		.loc 1 2852 0
 238 00b4 0098     		ldr	r0, [sp, #0]
 239 00b6 0302     		lsls	r3, r0, #8
 240 00b8 34D4     		bmi	.L26
2853:lib/ff/sdio_stm32f1.c ****   {
2854:lib/ff/sdio_stm32f1.c ****     return(SD_COM_CRC_FAILED);
2855:lib/ff/sdio_stm32f1.c ****   }
2856:lib/ff/sdio_stm32f1.c **** 
2857:lib/ff/sdio_stm32f1.c ****   if (respR1 & SD_OCR_ILLEGAL_CMD)
 241              		.loc 1 2857 0
 242 00ba 009B     		ldr	r3, [sp, #0]
 243 00bc 5802     		lsls	r0, r3, #9
 244 00be D1D4     		bmi	.L17
2858:lib/ff/sdio_stm32f1.c ****   {
2859:lib/ff/sdio_stm32f1.c ****     return(SD_ILLEGAL_CMD);
2860:lib/ff/sdio_stm32f1.c ****   }
2861:lib/ff/sdio_stm32f1.c **** 
2862:lib/ff/sdio_stm32f1.c ****   if (respR1 & SD_OCR_CARD_ECC_FAILED)
 245              		.loc 1 2862 0
 246 00c0 0099     		ldr	r1, [sp, #0]
 247 00c2 8902     		lsls	r1, r1, #10
 248 00c4 30D4     		bmi	.L27
2863:lib/ff/sdio_stm32f1.c ****   {
2864:lib/ff/sdio_stm32f1.c ****     return(SD_CARD_ECC_FAILED);
2865:lib/ff/sdio_stm32f1.c ****   }
2866:lib/ff/sdio_stm32f1.c **** 
2867:lib/ff/sdio_stm32f1.c ****   if (respR1 & SD_OCR_CC_ERROR)
 249              		.loc 1 2867 0
 250 00c6 009A     		ldr	r2, [sp, #0]
 251 00c8 D202     		lsls	r2, r2, #11
 252 00ca 2FD4     		bmi	.L28
2868:lib/ff/sdio_stm32f1.c ****   {
2869:lib/ff/sdio_stm32f1.c ****     return(SD_CC_ERROR);
2870:lib/ff/sdio_stm32f1.c ****   }
2871:lib/ff/sdio_stm32f1.c **** 
2872:lib/ff/sdio_stm32f1.c ****   if (respR1 & SD_OCR_GENERAL_UNKNOWN_ERROR)
 253              		.loc 1 2872 0
 254 00cc 0098     		ldr	r0, [sp, #0]
 255 00ce 0303     		lsls	r3, r0, #12
 256 00d0 2ED4     		bmi	.L29
2873:lib/ff/sdio_stm32f1.c ****   {
2874:lib/ff/sdio_stm32f1.c ****     return(SD_GENERAL_UNKNOWN_ERROR);
2875:lib/ff/sdio_stm32f1.c ****   }
2876:lib/ff/sdio_stm32f1.c **** 
2877:lib/ff/sdio_stm32f1.c ****   if (respR1 & SD_OCR_STREAM_READ_UNDERRUN)
 257              		.loc 1 2877 0
 258 00d2 009B     		ldr	r3, [sp, #0]
 259 00d4 5803     		lsls	r0, r3, #13
 260 00d6 2DD4     		bmi	.L30
2878:lib/ff/sdio_stm32f1.c ****   {
2879:lib/ff/sdio_stm32f1.c ****     return(SD_STREAM_READ_UNDERRUN);
2880:lib/ff/sdio_stm32f1.c ****   }
2881:lib/ff/sdio_stm32f1.c **** 
2882:lib/ff/sdio_stm32f1.c ****   if (respR1 & SD_OCR_STREAM_WRITE_OVERRUN)
 261              		.loc 1 2882 0
 262 00d8 0099     		ldr	r1, [sp, #0]
 263 00da 8903     		lsls	r1, r1, #14
 264 00dc 2CD4     		bmi	.L31
2883:lib/ff/sdio_stm32f1.c ****   {
2884:lib/ff/sdio_stm32f1.c ****     return(SD_STREAM_WRITE_OVERRUN);
2885:lib/ff/sdio_stm32f1.c ****   }
2886:lib/ff/sdio_stm32f1.c **** 
2887:lib/ff/sdio_stm32f1.c ****   if (respR1 & SD_OCR_CID_CSD_OVERWRIETE)
 265              		.loc 1 2887 0
 266 00de 009A     		ldr	r2, [sp, #0]
 267 00e0 D203     		lsls	r2, r2, #15
 268 00e2 2BD4     		bmi	.L32
2888:lib/ff/sdio_stm32f1.c ****   {
2889:lib/ff/sdio_stm32f1.c ****     return(SD_CID_CSD_OVERWRITE);
2890:lib/ff/sdio_stm32f1.c ****   }
2891:lib/ff/sdio_stm32f1.c **** 
2892:lib/ff/sdio_stm32f1.c ****   if (respR1 & SD_OCR_WP_ERASE_SKIP)
 269              		.loc 1 2892 0
 270 00e4 0098     		ldr	r0, [sp, #0]
 271 00e6 0304     		lsls	r3, r0, #16
 272 00e8 2AD4     		bmi	.L33
2893:lib/ff/sdio_stm32f1.c ****   {
2894:lib/ff/sdio_stm32f1.c ****     return(SD_WP_ERASE_SKIP);
2895:lib/ff/sdio_stm32f1.c ****   }
2896:lib/ff/sdio_stm32f1.c **** 
2897:lib/ff/sdio_stm32f1.c ****   if (respR1 & SD_OCR_CARD_ECC_DISABLED)
 273              		.loc 1 2897 0
 274 00ea 009B     		ldr	r3, [sp, #0]
 275 00ec 5804     		lsls	r0, r3, #17
 276 00ee 29D4     		bmi	.L34
2898:lib/ff/sdio_stm32f1.c ****   {
2899:lib/ff/sdio_stm32f1.c ****     return(SD_CARD_ECC_DISABLED);
2900:lib/ff/sdio_stm32f1.c ****   }
2901:lib/ff/sdio_stm32f1.c **** 
2902:lib/ff/sdio_stm32f1.c ****   if (respR1 & SD_OCR_ERASE_RESET)
 277              		.loc 1 2902 0
 278 00f0 0099     		ldr	r1, [sp, #0]
 279 00f2 8904     		lsls	r1, r1, #18
 280 00f4 28D4     		bmi	.L35
2903:lib/ff/sdio_stm32f1.c ****   {
2904:lib/ff/sdio_stm32f1.c ****     return(SD_ERASE_RESET);
2905:lib/ff/sdio_stm32f1.c ****   }
2906:lib/ff/sdio_stm32f1.c **** 
2907:lib/ff/sdio_stm32f1.c ****   if (respR1 & SD_OCR_AKE_SEQ_ERROR)
 281              		.loc 1 2907 0
 282 00f6 009A     		ldr	r2, [sp, #0]
2908:lib/ff/sdio_stm32f1.c ****   {
2909:lib/ff/sdio_stm32f1.c ****     return(SD_AKE_SEQ_ERROR);
 283              		.loc 1 2909 0
 284 00f8 12F0080F 		tst	r2, #8
 285 00fc 0CBF     		ite	eq
 286 00fe 2A20     		moveq	r0, #42
 287 0100 1A20     		movne	r0, #26
 288 0102 22E0     		b	.L14
 289              	.L18:
2814:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 290              		.loc 1 2814 0
 291 0104 2A20     		movs	r0, #42
 292 0106 20E0     		b	.L14
 293              	.L19:
2819:lib/ff/sdio_stm32f1.c ****     return(SD_ADDR_OUT_OF_RANGE);
 294              		.loc 1 2819 0
 295 0108 1C20     		movs	r0, #28
 296 010a 1EE0     		b	.L14
 297              	.L20:
2824:lib/ff/sdio_stm32f1.c ****     return(SD_ADDR_MISALIGNED);
 298              		.loc 1 2824 0
 299 010c 0920     		movs	r0, #9
 300 010e 1CE0     		b	.L14
 301              	.L21:
2829:lib/ff/sdio_stm32f1.c ****     return(SD_BLOCK_LEN_ERR);
 302              		.loc 1 2829 0
 303 0110 0A20     		movs	r0, #10
 304 0112 1AE0     		b	.L14
 305              	.L22:
2834:lib/ff/sdio_stm32f1.c ****     return(SD_ERASE_SEQ_ERR);
 306              		.loc 1 2834 0
 307 0114 0B20     		movs	r0, #11
 308 0116 18E0     		b	.L14
 309              	.L23:
2839:lib/ff/sdio_stm32f1.c ****     return(SD_BAD_ERASE_PARAM);
 310              		.loc 1 2839 0
 311 0118 0C20     		movs	r0, #12
 312 011a 16E0     		b	.L14
 313              	.L24:
2844:lib/ff/sdio_stm32f1.c ****     return(SD_WRITE_PROT_VIOLATION);
 314              		.loc 1 2844 0
 315 011c 0D20     		movs	r0, #13
 316 011e 14E0     		b	.L14
 317              	.L25:
2849:lib/ff/sdio_stm32f1.c ****     return(SD_LOCK_UNLOCK_FAILED);
 318              		.loc 1 2849 0
 319 0120 0E20     		movs	r0, #14
 320 0122 12E0     		b	.L14
 321              	.L26:
2854:lib/ff/sdio_stm32f1.c ****     return(SD_COM_CRC_FAILED);
 322              		.loc 1 2854 0
 323 0124 0F20     		movs	r0, #15
 324 0126 10E0     		b	.L14
 325              	.L27:
2864:lib/ff/sdio_stm32f1.c ****     return(SD_CARD_ECC_FAILED);
 326              		.loc 1 2864 0
 327 0128 1120     		movs	r0, #17
 328 012a 0EE0     		b	.L14
 329              	.L28:
2869:lib/ff/sdio_stm32f1.c ****     return(SD_CC_ERROR);
 330              		.loc 1 2869 0
 331 012c 1220     		movs	r0, #18
 332 012e 0CE0     		b	.L14
 333              	.L29:
2874:lib/ff/sdio_stm32f1.c ****     return(SD_GENERAL_UNKNOWN_ERROR);
 334              		.loc 1 2874 0
 335 0130 1320     		movs	r0, #19
 336 0132 0AE0     		b	.L14
 337              	.L30:
2879:lib/ff/sdio_stm32f1.c ****     return(SD_STREAM_READ_UNDERRUN);
 338              		.loc 1 2879 0
 339 0134 1420     		movs	r0, #20
 340 0136 08E0     		b	.L14
 341              	.L31:
2884:lib/ff/sdio_stm32f1.c ****     return(SD_STREAM_WRITE_OVERRUN);
 342              		.loc 1 2884 0
 343 0138 1520     		movs	r0, #21
 344 013a 06E0     		b	.L14
 345              	.L32:
2889:lib/ff/sdio_stm32f1.c ****     return(SD_CID_CSD_OVERWRITE);
 346              		.loc 1 2889 0
 347 013c 1620     		movs	r0, #22
 348 013e 04E0     		b	.L14
 349              	.L33:
2894:lib/ff/sdio_stm32f1.c ****     return(SD_WP_ERASE_SKIP);
 350              		.loc 1 2894 0
 351 0140 1720     		movs	r0, #23
 352 0142 02E0     		b	.L14
 353              	.L34:
2899:lib/ff/sdio_stm32f1.c ****     return(SD_CARD_ECC_DISABLED);
 354              		.loc 1 2899 0
 355 0144 1820     		movs	r0, #24
 356 0146 00E0     		b	.L14
 357              	.L35:
2904:lib/ff/sdio_stm32f1.c ****     return(SD_ERASE_RESET);
 358              		.loc 1 2904 0
 359 0148 1920     		movs	r0, #25
 360              	.LVL27:
 361              	.L14:
2910:lib/ff/sdio_stm32f1.c ****   }
2911:lib/ff/sdio_stm32f1.c **** 
2912:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
2913:lib/ff/sdio_stm32f1.c **** }
 362              		.loc 1 2913 0
 363 014a 3EBD     		pop	{r1, r2, r3, r4, r5, pc}
 364              	.L38:
 365              		.align	2
 366              	.L37:
 367 014c 00000000 		.word	.LANCHOR0
 368 0150 00000000 		.word	.LANCHOR1
 369 0154 00800140 		.word	1073840128
 370 0158 08E0FFFD 		.word	-33562616
 371              		.cfi_endproc
 372              	.LFE85:
 374              		.section	.text.unlikely.SD_LowLevel_DMA_TxConfig,"ax",%progbits
 375              		.align	1
 376              		.thumb
 377              		.thumb_func
 379              	SD_LowLevel_DMA_TxConfig:
 380              	.LFB88:
2914:lib/ff/sdio_stm32f1.c **** 
2915:lib/ff/sdio_stm32f1.c **** 
2916:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2917:lib/ff/sdio_stm32f1.c **** /*! 
2918:lib/ff/sdio_stm32f1.c **** 	@brief  Find the SD card SCR register value.
2919:lib/ff/sdio_stm32f1.c **** 	@param  rca: selected card address.
2920:lib/ff/sdio_stm32f1.c **** 	@param  pscr: pointer to the buffer that will contain the SCR value.
2921:lib/ff/sdio_stm32f1.c **** 	@retval SD_Error: SD Card Error code.
2922:lib/ff/sdio_stm32f1.c **** */
2923:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
2924:lib/ff/sdio_stm32f1.c **** static SD_Error FindSCR(uint16_t rca, uint32_t *pscr)
2925:lib/ff/sdio_stm32f1.c **** {
2926:lib/ff/sdio_stm32f1.c ****   uint32_t index = 0;
2927:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
2928:lib/ff/sdio_stm32f1.c ****   uint32_t tempscr[2] = {0, 0};
2929:lib/ff/sdio_stm32f1.c **** 
2930:lib/ff/sdio_stm32f1.c ****   /*!< Set Block Size To 8 Bytes */
2931:lib/ff/sdio_stm32f1.c ****   /*!< Send CMD55 APP_CMD with argument as card's RCA */
2932:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = (uint32_t)8;
2933:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SET_BLOCKLEN;
2934:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
2935:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
2936:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
2937:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
2938:lib/ff/sdio_stm32f1.c **** 
2939:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_SET_BLOCKLEN);
2940:lib/ff/sdio_stm32f1.c **** 
2941:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
2942:lib/ff/sdio_stm32f1.c ****   {
2943:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2944:lib/ff/sdio_stm32f1.c ****   }
2945:lib/ff/sdio_stm32f1.c **** 
2946:lib/ff/sdio_stm32f1.c ****   /*!< Send CMD55 APP_CMD with argument as card's RCA */
2947:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) RCA << 16;
2948:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_CMD;
2949:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
2950:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
2951:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
2952:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
2953:lib/ff/sdio_stm32f1.c **** 
2954:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_APP_CMD);
2955:lib/ff/sdio_stm32f1.c **** 
2956:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
2957:lib/ff/sdio_stm32f1.c ****   {
2958:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2959:lib/ff/sdio_stm32f1.c ****   }
2960:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataTimeOut = SD_DATATIMEOUT;
2961:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataLength = 8;
2962:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataBlockSize = SDIO_DataBlockSize_8b;
2963:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToSDIO;
2964:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
2965:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Enable;
2966:lib/ff/sdio_stm32f1.c ****   SDIO_DataConfig(&SDIO_DataInitStructure);
2967:lib/ff/sdio_stm32f1.c **** 
2968:lib/ff/sdio_stm32f1.c **** 
2969:lib/ff/sdio_stm32f1.c ****   /*!< Send ACMD51 SD_APP_SEND_SCR with argument as 0 */
2970:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = 0x0;
2971:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SD_APP_SEND_SCR;
2972:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
2973:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
2974:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
2975:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
2976:lib/ff/sdio_stm32f1.c **** 
2977:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_SD_APP_SEND_SCR);
2978:lib/ff/sdio_stm32f1.c **** 
2979:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
2980:lib/ff/sdio_stm32f1.c ****   {
2981:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2982:lib/ff/sdio_stm32f1.c ****   }
2983:lib/ff/sdio_stm32f1.c **** 
2984:lib/ff/sdio_stm32f1.c ****   while (!(SDIO->STA & (SDIO_FLAG_RXOVERR | SDIO_FLAG_DCRCFAIL | SDIO_FLAG_DTIMEOUT | SDIO_FLAG_DBC
2985:lib/ff/sdio_stm32f1.c ****   {
2986:lib/ff/sdio_stm32f1.c ****     if (SDIO_GetFlagStatus(SDIO_FLAG_RXDAVL) != RESET)
2987:lib/ff/sdio_stm32f1.c ****     {
2988:lib/ff/sdio_stm32f1.c ****       *(tempscr + index) = SDIO_ReadData();
2989:lib/ff/sdio_stm32f1.c ****       index++;
2990:lib/ff/sdio_stm32f1.c ****     }
2991:lib/ff/sdio_stm32f1.c ****   }
2992:lib/ff/sdio_stm32f1.c **** 
2993:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetFlagStatus(SDIO_FLAG_DTIMEOUT) != RESET)
2994:lib/ff/sdio_stm32f1.c ****   {
2995:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_DTIMEOUT);
2996:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_DATA_TIMEOUT;
2997:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
2998:lib/ff/sdio_stm32f1.c ****   }
2999:lib/ff/sdio_stm32f1.c ****   else if (SDIO_GetFlagStatus(SDIO_FLAG_DCRCFAIL) != RESET)
3000:lib/ff/sdio_stm32f1.c ****   {
3001:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_DCRCFAIL);
3002:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_DATA_CRC_FAIL;
3003:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
3004:lib/ff/sdio_stm32f1.c ****   }
3005:lib/ff/sdio_stm32f1.c ****   else if (SDIO_GetFlagStatus(SDIO_FLAG_RXOVERR) != RESET)
3006:lib/ff/sdio_stm32f1.c ****   {
3007:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_RXOVERR);
3008:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_RX_OVERRUN;
3009:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
3010:lib/ff/sdio_stm32f1.c ****   }
3011:lib/ff/sdio_stm32f1.c ****   else if (SDIO_GetFlagStatus(SDIO_FLAG_STBITERR) != RESET)
3012:lib/ff/sdio_stm32f1.c ****   {
3013:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_STBITERR);
3014:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_START_BIT_ERR;
3015:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
3016:lib/ff/sdio_stm32f1.c ****   }
3017:lib/ff/sdio_stm32f1.c **** 
3018:lib/ff/sdio_stm32f1.c ****   /*!< Clear all the static flags */
3019:lib/ff/sdio_stm32f1.c ****   SDIO_ClearFlag(SDIO_STATIC_FLAGS);
3020:lib/ff/sdio_stm32f1.c **** 
3021:lib/ff/sdio_stm32f1.c ****   *(pscr + 1) = ((tempscr[0] & SD_0TO7BITS) << 24) | ((tempscr[0] & SD_8TO15BITS) << 8) | ((tempscr
3022:lib/ff/sdio_stm32f1.c **** 
3023:lib/ff/sdio_stm32f1.c ****   *(pscr) = ((tempscr[1] & SD_0TO7BITS) << 24) | ((tempscr[1] & SD_8TO15BITS) << 8) | ((tempscr[1] 
3024:lib/ff/sdio_stm32f1.c **** 
3025:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
3026:lib/ff/sdio_stm32f1.c **** }
3027:lib/ff/sdio_stm32f1.c **** 
3028:lib/ff/sdio_stm32f1.c **** 
3029:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
3030:lib/ff/sdio_stm32f1.c **** /*! 
3031:lib/ff/sdio_stm32f1.c **** 	@brief  Converts the number of bytes in power of two and returns the power.
3032:lib/ff/sdio_stm32f1.c **** 	@param  NumberOfBytes: number of bytes.
3033:lib/ff/sdio_stm32f1.c **** 	@retval None
3034:lib/ff/sdio_stm32f1.c **** */
3035:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
3036:lib/ff/sdio_stm32f1.c **** static uint8_t convert_from_bytes_to_power_of_two(uint16_t NumberOfBytes)
3037:lib/ff/sdio_stm32f1.c **** {
3038:lib/ff/sdio_stm32f1.c ****   uint8_t count = 0;
3039:lib/ff/sdio_stm32f1.c **** 
3040:lib/ff/sdio_stm32f1.c ****   while (NumberOfBytes != 1)
3041:lib/ff/sdio_stm32f1.c ****   {
3042:lib/ff/sdio_stm32f1.c ****     NumberOfBytes >>= 1;
3043:lib/ff/sdio_stm32f1.c ****     count++;
3044:lib/ff/sdio_stm32f1.c ****   }
3045:lib/ff/sdio_stm32f1.c ****   return(count);
3046:lib/ff/sdio_stm32f1.c **** }
3047:lib/ff/sdio_stm32f1.c **** 
3048:lib/ff/sdio_stm32f1.c **** 
3049:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
3050:lib/ff/sdio_stm32f1.c **** /*! 
3051:lib/ff/sdio_stm32f1.c **** 	@brief  Configures the DMA2 Channel4 for SDIO Tx request.
3052:lib/ff/sdio_stm32f1.c **** 	@param  BufferSRC: pointer to the source buffer
3053:lib/ff/sdio_stm32f1.c **** 	@param  BufferSize: buffer size
3054:lib/ff/sdio_stm32f1.c **** 	@retval None
3055:lib/ff/sdio_stm32f1.c **** */
3056:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
3057:lib/ff/sdio_stm32f1.c **** void SD_LowLevel_DMA_TxConfig(uint32_t *BufferSRC, uint32_t BufferSize)
3058:lib/ff/sdio_stm32f1.c **** {
 381              		.loc 1 3058 0
 382              		.cfi_startproc
 383              		@ args = 0, pretend = 0, frame = 48
 384              		@ frame_needed = 0, uses_anonymous_args = 0
 385              	.LVL28:
 386 0000 70B5     		push	{r4, r5, r6, lr}
 387              	.LCFI2:
 388              		.cfi_def_cfa_offset 16
 389              		.cfi_offset 4, -16
 390              		.cfi_offset 5, -12
 391              		.cfi_offset 6, -8
 392              		.cfi_offset 14, -4
 393 0002 8CB0     		sub	sp, sp, #48
 394              	.LCFI3:
 395              		.cfi_def_cfa_offset 64
 396 0004 0546     		mov	r5, r0
 397 0006 0E46     		mov	r6, r1
3059:lib/ff/sdio_stm32f1.c **** 
3060:lib/ff/sdio_stm32f1.c ****   DMA_InitTypeDef DMA_InitStructure;
3061:lib/ff/sdio_stm32f1.c **** 
3062:lib/ff/sdio_stm32f1.c ****   DMA_ClearFlag(DMA2_FLAG_TC4 | DMA2_FLAG_TE4 | DMA2_FLAG_HT4 | DMA2_FLAG_GL4);
 398              		.loc 1 3062 0
 399 0008 1348     		ldr	r0, .L40
 400              	.LVL29:
 401 000a FFF7FEFF 		bl	DMA_ClearFlag
 402              	.LVL30:
3063:lib/ff/sdio_stm32f1.c **** 
3064:lib/ff/sdio_stm32f1.c ****   /*!< DMA2 Channel4 disable */
3065:lib/ff/sdio_stm32f1.c ****   DMA_Cmd(DMA2_Channel4, DISABLE);
 403              		.loc 1 3065 0
 404 000e 134C     		ldr	r4, .L40+4
 405 0010 2046     		mov	r0, r4
 406 0012 0021     		movs	r1, #0
 407 0014 FFF7FEFF 		bl	DMA_Cmd
 408              	.LVL31:
3066:lib/ff/sdio_stm32f1.c **** 
3067:lib/ff/sdio_stm32f1.c ****   /*!< DMA2 Channel4 Config */
3068:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_PeripheralBaseAddr = (uint32_t)SDIO_FIFO_ADDRESS;
 409              		.loc 1 3068 0
 410 0018 114B     		ldr	r3, .L40+8
 411 001a 0193     		str	r3, [sp, #4]
3069:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_MemoryBaseAddr = (uint32_t)BufferSRC;
 412              		.loc 1 3069 0
 413 001c 0295     		str	r5, [sp, #8]
3070:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_DIR = DMA_DIR_PeripheralDST;
 414              		.loc 1 3070 0
 415 001e 1020     		movs	r0, #16
 416 0020 0390     		str	r0, [sp, #12]
3071:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_BufferSize = BufferSize / 4;
 417              		.loc 1 3071 0
 418 0022 B608     		lsrs	r6, r6, #2
 419              	.LVL32:
 420 0024 0496     		str	r6, [sp, #16]
3072:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_PeripheralInc = DMA_PeripheralInc_Disable;
 421              		.loc 1 3072 0
 422 0026 0021     		movs	r1, #0
 423 0028 0591     		str	r1, [sp, #20]
3073:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_MemoryInc = DMA_MemoryInc_Enable;
 424              		.loc 1 3073 0
 425 002a 8022     		movs	r2, #128
 426 002c 0692     		str	r2, [sp, #24]
3074:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_PeripheralDataSize = DMA_PeripheralDataSize_Word;
 427              		.loc 1 3074 0
 428 002e 4FF40073 		mov	r3, #512
 429 0032 0793     		str	r3, [sp, #28]
3075:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_MemoryDataSize = DMA_MemoryDataSize_Word;
 430              		.loc 1 3075 0
 431 0034 4FF40060 		mov	r0, #2048
 432 0038 0890     		str	r0, [sp, #32]
3076:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_Mode = DMA_Mode_Normal;
 433              		.loc 1 3076 0
 434 003a 0991     		str	r1, [sp, #36]
3077:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_Priority = DMA_Priority_High;
 435              		.loc 1 3077 0
 436 003c 4FF40052 		mov	r2, #8192
 437 0040 0A92     		str	r2, [sp, #40]
3078:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_M2M = DMA_M2M_Disable;
 438              		.loc 1 3078 0
 439 0042 0B91     		str	r1, [sp, #44]
3079:lib/ff/sdio_stm32f1.c ****   DMA_Init(DMA2_Channel4, &DMA_InitStructure);
 440              		.loc 1 3079 0
 441 0044 2046     		mov	r0, r4
 442 0046 01A9     		add	r1, sp, #4
 443 0048 FFF7FEFF 		bl	DMA_Init
 444              	.LVL33:
3080:lib/ff/sdio_stm32f1.c **** 
3081:lib/ff/sdio_stm32f1.c ****   /*!< DMA2 Channel4 enable */
3082:lib/ff/sdio_stm32f1.c ****   DMA_Cmd(DMA2_Channel4, ENABLE);  
 445              		.loc 1 3082 0
 446 004c 2046     		mov	r0, r4
 447 004e 0121     		movs	r1, #1
 448 0050 FFF7FEFF 		bl	DMA_Cmd
 449              	.LVL34:
3083:lib/ff/sdio_stm32f1.c **** }
 450              		.loc 1 3083 0
 451 0054 0CB0     		add	sp, sp, #48
 452 0056 70BD     		pop	{r4, r5, r6, pc}
 453              	.L41:
 454              		.align	2
 455              	.L40:
 456 0058 00F00010 		.word	268496896
 457 005c 44040240 		.word	1073873988
 458 0060 80800140 		.word	1073840256
 459              		.cfi_endproc
 460              	.LFE88:
 462              		.section	.text.unlikely.SD_LowLevel_DMA_RxConfig,"ax",%progbits
 463              		.align	1
 464              		.thumb
 465              		.thumb_func
 467              	SD_LowLevel_DMA_RxConfig:
 468              	.LFB89:
3084:lib/ff/sdio_stm32f1.c **** 
3085:lib/ff/sdio_stm32f1.c **** 
3086:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
3087:lib/ff/sdio_stm32f1.c **** /*! 
3088:lib/ff/sdio_stm32f1.c **** 	@brief  Configures the DMA2 Channel4 for SDIO Rx request.
3089:lib/ff/sdio_stm32f1.c **** 	@param  BufferDST: pointer to the destination buffer
3090:lib/ff/sdio_stm32f1.c **** 	@param  BufferSize: buffer size
3091:lib/ff/sdio_stm32f1.c **** 	@retval None
3092:lib/ff/sdio_stm32f1.c **** */
3093:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
3094:lib/ff/sdio_stm32f1.c **** void SD_LowLevel_DMA_RxConfig(uint32_t *BufferDST, uint32_t BufferSize)
3095:lib/ff/sdio_stm32f1.c **** {
 469              		.loc 1 3095 0
 470              		.cfi_startproc
 471              		@ args = 0, pretend = 0, frame = 48
 472              		@ frame_needed = 0, uses_anonymous_args = 0
 473              	.LVL35:
 474 0000 70B5     		push	{r4, r5, r6, lr}
 475              	.LCFI4:
 476              		.cfi_def_cfa_offset 16
 477              		.cfi_offset 4, -16
 478              		.cfi_offset 5, -12
 479              		.cfi_offset 6, -8
 480              		.cfi_offset 14, -4
 481 0002 8CB0     		sub	sp, sp, #48
 482              	.LCFI5:
 483              		.cfi_def_cfa_offset 64
 484 0004 0546     		mov	r5, r0
 485 0006 0E46     		mov	r6, r1
3096:lib/ff/sdio_stm32f1.c ****   DMA_InitTypeDef DMA_InitStructure;
3097:lib/ff/sdio_stm32f1.c **** 
3098:lib/ff/sdio_stm32f1.c ****   DMA_ClearFlag(DMA2_FLAG_TC4 | DMA2_FLAG_TE4 | DMA2_FLAG_HT4 | DMA2_FLAG_GL4);
 486              		.loc 1 3098 0
 487 0008 1348     		ldr	r0, .L43
 488              	.LVL36:
 489 000a FFF7FEFF 		bl	DMA_ClearFlag
 490              	.LVL37:
3099:lib/ff/sdio_stm32f1.c **** 
3100:lib/ff/sdio_stm32f1.c ****   /*!< DMA2 Channel4 disable */
3101:lib/ff/sdio_stm32f1.c ****   DMA_Cmd(DMA2_Channel4, DISABLE);
 491              		.loc 1 3101 0
 492 000e 134C     		ldr	r4, .L43+4
 493 0010 2046     		mov	r0, r4
 494 0012 0021     		movs	r1, #0
 495 0014 FFF7FEFF 		bl	DMA_Cmd
 496              	.LVL38:
3102:lib/ff/sdio_stm32f1.c **** 
3103:lib/ff/sdio_stm32f1.c ****   /*!< DMA2 Channel4 Config */
3104:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_PeripheralBaseAddr = (uint32_t)SDIO_FIFO_ADDRESS;
 497              		.loc 1 3104 0
 498 0018 114B     		ldr	r3, .L43+8
 499 001a 0193     		str	r3, [sp, #4]
3105:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_MemoryBaseAddr = (uint32_t)BufferDST;
 500              		.loc 1 3105 0
 501 001c 0295     		str	r5, [sp, #8]
3106:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_DIR = DMA_DIR_PeripheralSRC;
 502              		.loc 1 3106 0
 503 001e 0020     		movs	r0, #0
 504 0020 0390     		str	r0, [sp, #12]
3107:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_BufferSize = BufferSize / 4;
 505              		.loc 1 3107 0
 506 0022 B608     		lsrs	r6, r6, #2
 507              	.LVL39:
 508 0024 0496     		str	r6, [sp, #16]
3108:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_PeripheralInc = DMA_PeripheralInc_Disable;
 509              		.loc 1 3108 0
 510 0026 0590     		str	r0, [sp, #20]
3109:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_MemoryInc = DMA_MemoryInc_Enable;
 511              		.loc 1 3109 0
 512 0028 8022     		movs	r2, #128
 513 002a 0692     		str	r2, [sp, #24]
3110:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_PeripheralDataSize = DMA_PeripheralDataSize_Word;
 514              		.loc 1 3110 0
 515 002c 4FF40071 		mov	r1, #512
 516 0030 0791     		str	r1, [sp, #28]
3111:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_MemoryDataSize = DMA_MemoryDataSize_Word;
 517              		.loc 1 3111 0
 518 0032 4FF40063 		mov	r3, #2048
 519 0036 0893     		str	r3, [sp, #32]
3112:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_Mode = DMA_Mode_Normal;
 520              		.loc 1 3112 0
 521 0038 0990     		str	r0, [sp, #36]
3113:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_Priority = DMA_Priority_High;
 522              		.loc 1 3113 0
 523 003a 4FF40052 		mov	r2, #8192
 524 003e 0A92     		str	r2, [sp, #40]
3114:lib/ff/sdio_stm32f1.c ****   DMA_InitStructure.DMA_M2M = DMA_M2M_Disable;
 525              		.loc 1 3114 0
 526 0040 0B90     		str	r0, [sp, #44]
3115:lib/ff/sdio_stm32f1.c ****   DMA_Init(DMA2_Channel4, &DMA_InitStructure);
 527              		.loc 1 3115 0
 528 0042 2046     		mov	r0, r4
 529 0044 01A9     		add	r1, sp, #4
 530 0046 FFF7FEFF 		bl	DMA_Init
 531              	.LVL40:
3116:lib/ff/sdio_stm32f1.c **** 
3117:lib/ff/sdio_stm32f1.c ****   /*!< DMA2 Channel4 enable */
3118:lib/ff/sdio_stm32f1.c ****   DMA_Cmd(DMA2_Channel4, ENABLE); 
 532              		.loc 1 3118 0
 533 004a 2046     		mov	r0, r4
 534 004c 0121     		movs	r1, #1
 535 004e FFF7FEFF 		bl	DMA_Cmd
 536              	.LVL41:
3119:lib/ff/sdio_stm32f1.c **** }
 537              		.loc 1 3119 0
 538 0052 0CB0     		add	sp, sp, #48
 539 0054 70BD     		pop	{r4, r5, r6, pc}
 540              	.L44:
 541 0056 00BF     		.align	2
 542              	.L43:
 543 0058 00F00010 		.word	268496896
 544 005c 44040240 		.word	1073873988
 545 0060 80800140 		.word	1073840256
 546              		.cfi_endproc
 547              	.LFE89:
 549              		.section	.text.CmdResp1Error,"ax",%progbits
 550              		.align	1
 551              		.thumb
 552              		.thumb_func
 554              	CmdResp1Error:
 555              	.LFB80:
2353:lib/ff/sdio_stm32f1.c **** {
 556              		.loc 1 2353 0
 557              		.cfi_startproc
 558              		@ args = 0, pretend = 0, frame = 0
 559              		@ frame_needed = 0, uses_anonymous_args = 0
 560              	.LVL42:
 561 0000 38B5     		push	{r3, r4, r5, lr}
 562              	.LCFI6:
 563              		.cfi_def_cfa_offset 16
 564              		.cfi_offset 3, -16
 565              		.cfi_offset 4, -12
 566              		.cfi_offset 5, -8
 567              		.cfi_offset 14, -4
 568 0002 0546     		mov	r5, r0
 569              	.LVL43:
2358:lib/ff/sdio_stm32f1.c ****   status = SDIO->STA;
 570              		.loc 1 2358 0
 571 0004 394A     		ldr	r2, .L73
 572              	.L47:
2362:lib/ff/sdio_stm32f1.c ****     status = SDIO->STA;
 573              		.loc 1 2362 0
 574 0006 536B     		ldr	r3, [r2, #52]
 575              	.LVL44:
2360:lib/ff/sdio_stm32f1.c ****   while (!(status & (SDIO_FLAG_CCRCFAIL | SDIO_FLAG_CMDREND | SDIO_FLAG_CTIMEOUT)))
 576              		.loc 1 2360 0
 577 0008 13F0450F 		tst	r3, #69
 578 000c FBD0     		beq	.L47
2365:lib/ff/sdio_stm32f1.c ****   if (status & SDIO_FLAG_CTIMEOUT)
 579              		.loc 1 2365 0
 580 000e 5907     		lsls	r1, r3, #29
 581 0010 04D5     		bpl	.L48
 582              	.LVL45:
2368:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_CTIMEOUT);
 583              		.loc 1 2368 0
 584 0012 0420     		movs	r0, #4
 585              	.LVL46:
 586 0014 FFF7FEFF 		bl	SDIO_ClearFlag
 587              	.LVL47:
2369:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 588              		.loc 1 2369 0
 589 0018 0320     		movs	r0, #3
 590 001a 38BD     		pop	{r3, r4, r5, pc}
 591              	.LVL48:
 592              	.L48:
2371:lib/ff/sdio_stm32f1.c ****   else if (status & SDIO_FLAG_CCRCFAIL)
 593              		.loc 1 2371 0
 594 001c 13F00104 		ands	r4, r3, #1
 595 0020 04D0     		beq	.L50
 596              	.LVL49:
2374:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_CCRCFAIL);
 597              		.loc 1 2374 0
 598 0022 0120     		movs	r0, #1
 599              	.LVL50:
 600 0024 FFF7FEFF 		bl	SDIO_ClearFlag
 601              	.LVL51:
2375:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 602              		.loc 1 2375 0
 603 0028 0120     		movs	r0, #1
 604 002a 38BD     		pop	{r3, r4, r5, pc}
 605              	.LVL52:
 606              	.L50:
2379:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetCommandResponse() != cmd)
 607              		.loc 1 2379 0
 608 002c FFF7FEFF 		bl	SDIO_GetCommandResponse
 609              	.LVL53:
 610 0030 A842     		cmp	r0, r5
 611 0032 58D1     		bne	.L52
 612              	.LBB8:
 613              	.LBB9:
2386:lib/ff/sdio_stm32f1.c ****   SDIO_ClearFlag(SDIO_STATIC_FLAGS);
 614              		.loc 1 2386 0
 615 0034 40F2FF50 		movw	r0, #1535
 616 0038 FFF7FEFF 		bl	SDIO_ClearFlag
 617              	.LVL54:
2389:lib/ff/sdio_stm32f1.c ****   response_r1 = SDIO_GetResponse(SDIO_RESP1);
 618              		.loc 1 2389 0
 619 003c 2046     		mov	r0, r4
 620 003e FFF7FEFF 		bl	SDIO_GetResponse
 621              	.LVL55:
2391:lib/ff/sdio_stm32f1.c ****   if ((response_r1 & SD_OCR_ERRORBITS) == SD_ALLZERO)
 622              		.loc 1 2391 0
 623 0042 2B49     		ldr	r1, .L73+4
 624 0044 0140     		ands	r1, r1, r0
 625 0046 0029     		cmp	r1, #0
 626 0048 29D0     		beq	.L53
2396:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_ADDR_OUT_OF_RANGE)
 627              		.loc 1 2396 0
 628 004a 0028     		cmp	r0, #0
 629 004c 29DB     		blt	.L54
2401:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_ADDR_MISALIGNED)
 630              		.loc 1 2401 0
 631 004e 4200     		lsls	r2, r0, #1
 632 0050 29D4     		bmi	.L55
2406:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_BLOCK_LEN_ERR)
 633              		.loc 1 2406 0
 634 0052 8300     		lsls	r3, r0, #2
 635 0054 29D4     		bmi	.L56
2411:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_ERASE_SEQ_ERR)
 636              		.loc 1 2411 0
 637 0056 C100     		lsls	r1, r0, #3
 638 0058 29D4     		bmi	.L57
2416:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_BAD_ERASE_PARAM)
 639              		.loc 1 2416 0
 640 005a 0201     		lsls	r2, r0, #4
 641 005c 29D4     		bmi	.L58
2421:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_WRITE_PROT_VIOLATION)
 642              		.loc 1 2421 0
 643 005e 4301     		lsls	r3, r0, #5
 644 0060 29D4     		bmi	.L59
2426:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_LOCK_UNLOCK_FAILED)
 645              		.loc 1 2426 0
 646 0062 C101     		lsls	r1, r0, #7
 647 0064 29D4     		bmi	.L60
2431:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_COM_CRC_FAILED)
 648              		.loc 1 2431 0
 649 0066 0202     		lsls	r2, r0, #8
 650 0068 29D4     		bmi	.L61
2436:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_ILLEGAL_CMD)
 651              		.loc 1 2436 0
 652 006a 4302     		lsls	r3, r0, #9
 653 006c 3BD4     		bmi	.L52
2441:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_CARD_ECC_FAILED)
 654              		.loc 1 2441 0
 655 006e 8102     		lsls	r1, r0, #10
 656 0070 27D4     		bmi	.L63
2446:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_CC_ERROR)
 657              		.loc 1 2446 0
 658 0072 C202     		lsls	r2, r0, #11
 659 0074 27D4     		bmi	.L64
2451:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_GENERAL_UNKNOWN_ERROR)
 660              		.loc 1 2451 0
 661 0076 0303     		lsls	r3, r0, #12
 662 0078 27D4     		bmi	.L65
2456:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_STREAM_READ_UNDERRUN)
 663              		.loc 1 2456 0
 664 007a 4103     		lsls	r1, r0, #13
 665 007c 27D4     		bmi	.L66
2461:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_STREAM_WRITE_OVERRUN)
 666              		.loc 1 2461 0
 667 007e 8203     		lsls	r2, r0, #14
 668 0080 27D4     		bmi	.L67
2466:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_CID_CSD_OVERWRIETE)
 669              		.loc 1 2466 0
 670 0082 C303     		lsls	r3, r0, #15
 671 0084 27D4     		bmi	.L68
2471:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_WP_ERASE_SKIP)
 672              		.loc 1 2471 0
 673 0086 0104     		lsls	r1, r0, #16
 674 0088 27D4     		bmi	.L69
2476:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_CARD_ECC_DISABLED)
 675              		.loc 1 2476 0
 676 008a 4204     		lsls	r2, r0, #17
 677 008c 27D4     		bmi	.L70
2481:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_OCR_ERASE_RESET)
 678              		.loc 1 2481 0
 679 008e 8304     		lsls	r3, r0, #18
 680 0090 27D4     		bmi	.L71
2488:lib/ff/sdio_stm32f1.c ****     return(SD_AKE_SEQ_ERROR);
 681              		.loc 1 2488 0
 682 0092 10F0080F 		tst	r0, #8
 683 0096 0CBF     		ite	eq
 684 0098 2A20     		moveq	r0, #42
 685 009a 1A20     		movne	r0, #26
 686              	.LVL56:
 687 009c 38BD     		pop	{r3, r4, r5, pc}
 688              	.LVL57:
 689              	.L53:
2393:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 690              		.loc 1 2393 0
 691 009e 2A20     		movs	r0, #42
 692              	.LVL58:
 693 00a0 38BD     		pop	{r3, r4, r5, pc}
 694              	.LVL59:
 695              	.L54:
2398:lib/ff/sdio_stm32f1.c ****     return(SD_ADDR_OUT_OF_RANGE);
 696              		.loc 1 2398 0
 697 00a2 1C20     		movs	r0, #28
 698              	.LVL60:
 699 00a4 38BD     		pop	{r3, r4, r5, pc}
 700              	.LVL61:
 701              	.L55:
2403:lib/ff/sdio_stm32f1.c ****     return(SD_ADDR_MISALIGNED);
 702              		.loc 1 2403 0
 703 00a6 0920     		movs	r0, #9
 704              	.LVL62:
 705 00a8 38BD     		pop	{r3, r4, r5, pc}
 706              	.LVL63:
 707              	.L56:
2408:lib/ff/sdio_stm32f1.c ****     return(SD_BLOCK_LEN_ERR);
 708              		.loc 1 2408 0
 709 00aa 0A20     		movs	r0, #10
 710              	.LVL64:
 711 00ac 38BD     		pop	{r3, r4, r5, pc}
 712              	.LVL65:
 713              	.L57:
2413:lib/ff/sdio_stm32f1.c ****     return(SD_ERASE_SEQ_ERR);
 714              		.loc 1 2413 0
 715 00ae 0B20     		movs	r0, #11
 716              	.LVL66:
 717 00b0 38BD     		pop	{r3, r4, r5, pc}
 718              	.LVL67:
 719              	.L58:
2418:lib/ff/sdio_stm32f1.c ****     return(SD_BAD_ERASE_PARAM);
 720              		.loc 1 2418 0
 721 00b2 0C20     		movs	r0, #12
 722              	.LVL68:
 723 00b4 38BD     		pop	{r3, r4, r5, pc}
 724              	.LVL69:
 725              	.L59:
2423:lib/ff/sdio_stm32f1.c ****     return(SD_WRITE_PROT_VIOLATION);
 726              		.loc 1 2423 0
 727 00b6 0D20     		movs	r0, #13
 728              	.LVL70:
 729 00b8 38BD     		pop	{r3, r4, r5, pc}
 730              	.LVL71:
 731              	.L60:
2428:lib/ff/sdio_stm32f1.c ****     return(SD_LOCK_UNLOCK_FAILED);
 732              		.loc 1 2428 0
 733 00ba 0E20     		movs	r0, #14
 734              	.LVL72:
 735 00bc 38BD     		pop	{r3, r4, r5, pc}
 736              	.LVL73:
 737              	.L61:
2433:lib/ff/sdio_stm32f1.c ****     return(SD_COM_CRC_FAILED);
 738              		.loc 1 2433 0
 739 00be 0F20     		movs	r0, #15
 740              	.LVL74:
 741 00c0 38BD     		pop	{r3, r4, r5, pc}
 742              	.LVL75:
 743              	.L63:
2443:lib/ff/sdio_stm32f1.c ****     return(SD_CARD_ECC_FAILED);
 744              		.loc 1 2443 0
 745 00c2 1120     		movs	r0, #17
 746              	.LVL76:
 747 00c4 38BD     		pop	{r3, r4, r5, pc}
 748              	.LVL77:
 749              	.L64:
2448:lib/ff/sdio_stm32f1.c ****     return(SD_CC_ERROR);
 750              		.loc 1 2448 0
 751 00c6 1220     		movs	r0, #18
 752              	.LVL78:
 753 00c8 38BD     		pop	{r3, r4, r5, pc}
 754              	.LVL79:
 755              	.L65:
2453:lib/ff/sdio_stm32f1.c ****     return(SD_GENERAL_UNKNOWN_ERROR);
 756              		.loc 1 2453 0
 757 00ca 1320     		movs	r0, #19
 758              	.LVL80:
 759 00cc 38BD     		pop	{r3, r4, r5, pc}
 760              	.LVL81:
 761              	.L66:
2458:lib/ff/sdio_stm32f1.c ****     return(SD_STREAM_READ_UNDERRUN);
 762              		.loc 1 2458 0
 763 00ce 1420     		movs	r0, #20
 764              	.LVL82:
 765 00d0 38BD     		pop	{r3, r4, r5, pc}
 766              	.LVL83:
 767              	.L67:
2463:lib/ff/sdio_stm32f1.c ****     return(SD_STREAM_WRITE_OVERRUN);
 768              		.loc 1 2463 0
 769 00d2 1520     		movs	r0, #21
 770              	.LVL84:
 771 00d4 38BD     		pop	{r3, r4, r5, pc}
 772              	.LVL85:
 773              	.L68:
2468:lib/ff/sdio_stm32f1.c ****     return(SD_CID_CSD_OVERWRITE);
 774              		.loc 1 2468 0
 775 00d6 1620     		movs	r0, #22
 776              	.LVL86:
 777 00d8 38BD     		pop	{r3, r4, r5, pc}
 778              	.LVL87:
 779              	.L69:
2473:lib/ff/sdio_stm32f1.c ****     return(SD_WP_ERASE_SKIP);
 780              		.loc 1 2473 0
 781 00da 1720     		movs	r0, #23
 782              	.LVL88:
 783 00dc 38BD     		pop	{r3, r4, r5, pc}
 784              	.LVL89:
 785              	.L70:
2478:lib/ff/sdio_stm32f1.c ****     return(SD_CARD_ECC_DISABLED);
 786              		.loc 1 2478 0
 787 00de 1820     		movs	r0, #24
 788              	.LVL90:
 789 00e0 38BD     		pop	{r3, r4, r5, pc}
 790              	.LVL91:
 791              	.L71:
2483:lib/ff/sdio_stm32f1.c ****     return(SD_ERASE_RESET);
 792              		.loc 1 2483 0
 793 00e2 1920     		movs	r0, #25
 794              	.LVL92:
 795 00e4 38BD     		pop	{r3, r4, r5, pc}
 796              	.L52:
 797              	.LBE9:
 798              	.LBE8:
2382:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 799              		.loc 1 2382 0
 800 00e6 1020     		movs	r0, #16
2491:lib/ff/sdio_stm32f1.c **** }
 801              		.loc 1 2491 0
 802 00e8 38BD     		pop	{r3, r4, r5, pc}
 803              	.L74:
 804 00ea 00BF     		.align	2
 805              	.L73:
 806 00ec 00800140 		.word	1073840128
 807 00f0 08E0FFFD 		.word	-33562616
 808              		.cfi_endproc
 809              	.LFE80:
 811              		.section	.text.SDEnWideBus,"ax",%progbits
 812              		.align	1
 813              		.thumb
 814              		.thumb_func
 816              	SDEnWideBus:
 817              	.LFB84:
2646:lib/ff/sdio_stm32f1.c **** {
 818              		.loc 1 2646 0
 819              		.cfi_startproc
 820              		@ args = 0, pretend = 0, frame = 8
 821              		@ frame_needed = 0, uses_anonymous_args = 0
 822              	.LVL93:
 823 0000 2DE9F347 		push	{r0, r1, r4, r5, r6, r7, r8, r9, sl, lr}
 824              	.LCFI7:
 825              		.cfi_def_cfa_offset 40
 826              		.cfi_offset 0, -40
 827              		.cfi_offset 1, -36
 828              		.cfi_offset 4, -32
 829              		.cfi_offset 5, -28
 830              		.cfi_offset 6, -24
 831              		.cfi_offset 7, -20
 832              		.cfi_offset 8, -16
 833              		.cfi_offset 9, -12
 834              		.cfi_offset 10, -8
 835              		.cfi_offset 14, -4
 836 0004 8046     		mov	r8, r0
 837              	.LVL94:
2651:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetResponse(SDIO_RESP1) & SD_CARD_LOCKED)
 838              		.loc 1 2651 0
 839 0006 0020     		movs	r0, #0
 840              	.LVL95:
 841 0008 FFF7FEFF 		bl	SDIO_GetResponse
 842              	.LVL96:
 843 000c 10F00075 		ands	r5, r0, #33554432
 844 0010 40F0DE80 		bne	.L86
 845              	.LVL97:
 846              	.LBB12:
 847              	.LBB13:
2928:lib/ff/sdio_stm32f1.c ****   uint32_t tempscr[2] = {0, 0};
 848              		.loc 1 2928 0
 849 0014 0095     		str	r5, [sp, #0]
 850 0016 0195     		str	r5, [sp, #4]
2932:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = (uint32_t)8;
 851              		.loc 1 2932 0
 852 0018 704C     		ldr	r4, .L101
2933:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SET_BLOCKLEN;
 853              		.loc 1 2933 0
 854 001a 4FF00809 		mov	r9, #8
 855 001e 4FF0100A 		mov	sl, #16
 856 0022 84E80006 		stmia	r4, {r9, sl}
2934:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 857              		.loc 1 2934 0
 858 0026 4027     		movs	r7, #64
 859 0028 A760     		str	r7, [r4, #8]
2935:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 860              		.loc 1 2935 0
 861 002a E560     		str	r5, [r4, #12]
2936:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 862              		.loc 1 2936 0
 863 002c 4FF48066 		mov	r6, #1024
 864 0030 2661     		str	r6, [r4, #16]
2937:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 865              		.loc 1 2937 0
 866 0032 2046     		mov	r0, r4
 867 0034 FFF7FEFF 		bl	SDIO_SendCommand
 868              	.LVL98:
2939:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_SET_BLOCKLEN);
 869              		.loc 1 2939 0
 870 0038 5046     		mov	r0, sl
 871 003a FFF7FEFF 		bl	CmdResp1Error
 872              	.LVL99:
2941:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
 873              		.loc 1 2941 0
 874 003e 2A28     		cmp	r0, #42
 875 0040 70D1     		bne	.L77
2947:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) RCA << 16;
 876              		.loc 1 2947 0
 877 0042 674B     		ldr	r3, .L101+4
 878 0044 1868     		ldr	r0, [r3, #0]
 879              	.LVL100:
 880 0046 00FA0AF1 		lsl	r1, r0, sl
 881 004a 2160     		str	r1, [r4, #0]
2948:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_CMD;
 882              		.loc 1 2948 0
 883 004c 4FF0370A 		mov	sl, #55
 884 0050 C4F804A0 		str	sl, [r4, #4]
2949:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 885              		.loc 1 2949 0
 886 0054 A760     		str	r7, [r4, #8]
2950:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 887              		.loc 1 2950 0
 888 0056 E560     		str	r5, [r4, #12]
2951:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 889              		.loc 1 2951 0
 890 0058 2661     		str	r6, [r4, #16]
2952:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 891              		.loc 1 2952 0
 892 005a 2046     		mov	r0, r4
 893 005c FFF7FEFF 		bl	SDIO_SendCommand
 894              	.LVL101:
2954:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_APP_CMD);
 895              		.loc 1 2954 0
 896 0060 5046     		mov	r0, sl
 897 0062 FFF7FEFF 		bl	CmdResp1Error
 898              	.LVL102:
2956:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
 899              		.loc 1 2956 0
 900 0066 2A28     		cmp	r0, #42
 901 0068 5CD1     		bne	.L77
2960:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataTimeOut = SD_DATATIMEOUT;
 902              		.loc 1 2960 0
 903 006a 5E48     		ldr	r0, .L101+8
 904              	.LVL103:
 905 006c 5E4A     		ldr	r2, .L101+12
2961:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataLength = 8;
 906              		.loc 1 2961 0
 907 006e 80E80402 		stmia	r0, {r2, r9}
2962:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataBlockSize = SDIO_DataBlockSize_8b;
 908              		.loc 1 2962 0
 909 0072 3022     		movs	r2, #48
 910 0074 8260     		str	r2, [r0, #8]
2963:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToSDIO;
 911              		.loc 1 2963 0
 912 0076 0223     		movs	r3, #2
 913 0078 C360     		str	r3, [r0, #12]
2964:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
 914              		.loc 1 2964 0
 915 007a 0561     		str	r5, [r0, #16]
2965:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Enable;
 916              		.loc 1 2965 0
 917 007c 0121     		movs	r1, #1
 918 007e 4161     		str	r1, [r0, #20]
2966:lib/ff/sdio_stm32f1.c ****   SDIO_DataConfig(&SDIO_DataInitStructure);
 919              		.loc 1 2966 0
 920 0080 FFF7FEFF 		bl	SDIO_DataConfig
 921              	.LVL104:
2970:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = 0x0;
 922              		.loc 1 2970 0
 923 0084 2560     		str	r5, [r4, #0]
2971:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SD_APP_SEND_SCR;
 924              		.loc 1 2971 0
 925 0086 4FF03309 		mov	r9, #51
 926 008a C4F80490 		str	r9, [r4, #4]
2972:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 927              		.loc 1 2972 0
 928 008e A760     		str	r7, [r4, #8]
2973:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 929              		.loc 1 2973 0
 930 0090 E560     		str	r5, [r4, #12]
2974:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 931              		.loc 1 2974 0
 932 0092 2661     		str	r6, [r4, #16]
2975:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 933              		.loc 1 2975 0
 934 0094 2046     		mov	r0, r4
 935 0096 FFF7FEFF 		bl	SDIO_SendCommand
 936              	.LVL105:
2977:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_SD_APP_SEND_SCR);
 937              		.loc 1 2977 0
 938 009a 4846     		mov	r0, r9
 939 009c FFF7FEFF 		bl	CmdResp1Error
 940              	.LVL106:
2979:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
 941              		.loc 1 2979 0
 942 00a0 2A28     		cmp	r0, #42
 943 00a2 3FD1     		bne	.L77
2645:lib/ff/sdio_stm32f1.c **** static SD_Error SDEnWideBus(FunctionalState NewState)
 944              		.loc 1 2645 0
 945 00a4 ADF10404 		sub	r4, sp, #4
 946              	.LVL107:
 947              	.L97:
2984:lib/ff/sdio_stm32f1.c ****   while (!(SDIO->STA & (SDIO_FLAG_RXOVERR | SDIO_FLAG_DCRCFAIL | SDIO_FLAG_DTIMEOUT | SDIO_FLAG_DBC
 948              		.loc 1 2984 0
 949 00a8 5048     		ldr	r0, .L101+16
 950 00aa 426B     		ldr	r2, [r0, #52]
 951 00ac 40F22A63 		movw	r3, #1578
 952 00b0 1340     		ands	r3, r3, r2
 953 00b2 53B9     		cbnz	r3, .L100
 954              	.L80:
2986:lib/ff/sdio_stm32f1.c ****     if (SDIO_GetFlagStatus(SDIO_FLAG_RXDAVL) != RESET)
 955              		.loc 1 2986 0
 956 00b4 4FF40010 		mov	r0, #2097152
 957 00b8 FFF7FEFF 		bl	SDIO_GetFlagStatus
 958              	.LVL108:
 959 00bc 0028     		cmp	r0, #0
 960 00be F3D0     		beq	.L97
2988:lib/ff/sdio_stm32f1.c ****       *(tempscr + index) = SDIO_ReadData();
 961              		.loc 1 2988 0
 962 00c0 FFF7FEFF 		bl	SDIO_ReadData
 963              	.LVL109:
 964 00c4 44F8040F 		str	r0, [r4, #4]!
 965 00c8 EEE7     		b	.L97
 966              	.L100:
2993:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetFlagStatus(SDIO_FLAG_DTIMEOUT) != RESET)
 967              		.loc 1 2993 0
 968 00ca 0820     		movs	r0, #8
 969 00cc FFF7FEFF 		bl	SDIO_GetFlagStatus
 970              	.LVL110:
 971 00d0 20B1     		cbz	r0, .L81
2995:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_DTIMEOUT);
 972              		.loc 1 2995 0
 973 00d2 0820     		movs	r0, #8
 974 00d4 FFF7FEFF 		bl	SDIO_ClearFlag
 975              	.LVL111:
2997:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 976              		.loc 1 2997 0
 977 00d8 0420     		movs	r0, #4
 978 00da 7CE0     		b	.L76
 979              	.LVL112:
 980              	.L81:
2999:lib/ff/sdio_stm32f1.c ****   else if (SDIO_GetFlagStatus(SDIO_FLAG_DCRCFAIL) != RESET)
 981              		.loc 1 2999 0
 982 00dc 0220     		movs	r0, #2
 983 00de FFF7FEFF 		bl	SDIO_GetFlagStatus
 984              	.LVL113:
 985 00e2 20B1     		cbz	r0, .L82
3001:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_DCRCFAIL);
 986              		.loc 1 3001 0
 987 00e4 0220     		movs	r0, #2
 988 00e6 FFF7FEFF 		bl	SDIO_ClearFlag
 989              	.LVL114:
3003:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 990              		.loc 1 3003 0
 991 00ea 0220     		movs	r0, #2
 992 00ec 73E0     		b	.L76
 993              	.LVL115:
 994              	.L82:
3005:lib/ff/sdio_stm32f1.c ****   else if (SDIO_GetFlagStatus(SDIO_FLAG_RXOVERR) != RESET)
 995              		.loc 1 3005 0
 996 00ee 2020     		movs	r0, #32
 997 00f0 FFF7FEFF 		bl	SDIO_GetFlagStatus
 998              	.LVL116:
 999 00f4 20B1     		cbz	r0, .L83
3007:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_RXOVERR);
 1000              		.loc 1 3007 0
 1001 00f6 2020     		movs	r0, #32
 1002 00f8 FFF7FEFF 		bl	SDIO_ClearFlag
 1003              	.LVL117:
3009:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 1004              		.loc 1 3009 0
 1005 00fc 0620     		movs	r0, #6
 1006 00fe 6AE0     		b	.L76
 1007              	.LVL118:
 1008              	.L83:
3011:lib/ff/sdio_stm32f1.c ****   else if (SDIO_GetFlagStatus(SDIO_FLAG_STBITERR) != RESET)
 1009              		.loc 1 3011 0
 1010 0100 4FF40070 		mov	r0, #512
 1011 0104 FFF7FEFF 		bl	SDIO_GetFlagStatus
 1012              	.LVL119:
 1013 0108 28B1     		cbz	r0, .L84
3013:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_STBITERR);
 1014              		.loc 1 3013 0
 1015 010a 4FF40070 		mov	r0, #512
 1016 010e FFF7FEFF 		bl	SDIO_ClearFlag
 1017              	.LVL120:
3015:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 1018              		.loc 1 3015 0
 1019 0112 0720     		movs	r0, #7
 1020 0114 5FE0     		b	.L76
 1021              	.LVL121:
 1022              	.L84:
3019:lib/ff/sdio_stm32f1.c ****   SDIO_ClearFlag(SDIO_STATIC_FLAGS);
 1023              		.loc 1 3019 0
 1024 0116 40F2FF50 		movw	r0, #1535
 1025 011a FFF7FEFF 		bl	SDIO_ClearFlag
 1026              	.LVL122:
 1027 011e 009D     		ldr	r5, [sp, #0]
 1028 0120 2DBA     		rev	r5, r5
 1029 0122 01E0     		b	.L98
 1030              	.LVL123:
 1031              	.L77:
 1032              	.LBE13:
 1033              	.LBE12:
2660:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
 1034              		.loc 1 2660 0
 1035 0124 2A28     		cmp	r0, #42
 1036 0126 56D1     		bne	.L76
 1037              	.LVL124:
 1038              	.L98:
2666:lib/ff/sdio_stm32f1.c ****   if (NewState == ENABLE)
 1039              		.loc 1 2666 0
 1040 0128 B8F1010F 		cmp	r8, #1
 1041 012c 26D1     		bne	.L85
2669:lib/ff/sdio_stm32f1.c ****     if ((scr[1] & SD_WIDE_BUS_SUPPORT) != SD_ALLZERO)
 1042              		.loc 1 2669 0
 1043 012e 6B03     		lsls	r3, r5, #13
 1044 0130 50D5     		bpl	.L91
2672:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) RCA << 16;
 1045              		.loc 1 2672 0
 1046 0132 2A4C     		ldr	r4, .L101
 1047 0134 2A48     		ldr	r0, .L101+4
 1048 0136 0268     		ldr	r2, [r0, #0]
 1049 0138 1304     		lsls	r3, r2, #16
 1050 013a 2360     		str	r3, [r4, #0]
2673:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_CMD;
 1051              		.loc 1 2673 0
 1052 013c 3725     		movs	r5, #55
 1053 013e 6560     		str	r5, [r4, #4]
2674:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 1054              		.loc 1 2674 0
 1055 0140 4FF04008 		mov	r8, #64
 1056 0144 C4F80880 		str	r8, [r4, #8]
2675:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 1057              		.loc 1 2675 0
 1058 0148 0027     		movs	r7, #0
 1059 014a E760     		str	r7, [r4, #12]
2676:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 1060              		.loc 1 2676 0
 1061 014c 4FF48066 		mov	r6, #1024
 1062 0150 2661     		str	r6, [r4, #16]
2677:lib/ff/sdio_stm32f1.c ****       SDIO_SendCommand(&SDIO_CmdInitStructure);
 1063              		.loc 1 2677 0
 1064 0152 2046     		mov	r0, r4
 1065 0154 FFF7FEFF 		bl	SDIO_SendCommand
 1066              	.LVL125:
2679:lib/ff/sdio_stm32f1.c ****       errorstatus = CmdResp1Error(SD_CMD_APP_CMD);
 1067              		.loc 1 2679 0
 1068 0158 2846     		mov	r0, r5
 1069 015a FFF7FEFF 		bl	CmdResp1Error
 1070              	.LVL126:
2681:lib/ff/sdio_stm32f1.c ****       if (errorstatus != SD_OK)
 1071              		.loc 1 2681 0
 1072 015e 2A28     		cmp	r0, #42
 1073 0160 39D1     		bne	.L76
2688:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_SD_SET_BUSWIDTH;
 1074              		.loc 1 2688 0
 1075 0162 0223     		movs	r3, #2
 1076 0164 0625     		movs	r5, #6
 1077 0166 84E82800 		stmia	r4, {r3, r5}
2689:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 1078              		.loc 1 2689 0
 1079 016a C4F80880 		str	r8, [r4, #8]
2690:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 1080              		.loc 1 2690 0
 1081 016e E760     		str	r7, [r4, #12]
2691:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 1082              		.loc 1 2691 0
 1083 0170 2661     		str	r6, [r4, #16]
2692:lib/ff/sdio_stm32f1.c ****       SDIO_SendCommand(&SDIO_CmdInitStructure);
 1084              		.loc 1 2692 0
 1085 0172 2046     		mov	r0, r4
 1086              	.LVL127:
 1087 0174 FFF7FEFF 		bl	SDIO_SendCommand
 1088              	.LVL128:
2694:lib/ff/sdio_stm32f1.c ****       errorstatus = CmdResp1Error(SD_CMD_APP_SD_SET_BUSWIDTH);
 1089              		.loc 1 2694 0
 1090 0178 2846     		mov	r0, r5
 1091 017a 24E0     		b	.L99
 1092              	.L85:
2711:lib/ff/sdio_stm32f1.c ****     if ((scr[1] & SD_SINGLE_BUS_SUPPORT) != SD_ALLZERO)
 1093              		.loc 1 2711 0
 1094 017c E803     		lsls	r0, r5, #15
 1095 017e 29D5     		bpl	.L91
2714:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) RCA << 16;
 1096              		.loc 1 2714 0
 1097 0180 164C     		ldr	r4, .L101
 1098 0182 174E     		ldr	r6, .L101+4
 1099 0184 3768     		ldr	r7, [r6, #0]
 1100 0186 3904     		lsls	r1, r7, #16
 1101 0188 2160     		str	r1, [r4, #0]
2715:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_CMD;
 1102              		.loc 1 2715 0
 1103 018a 3726     		movs	r6, #55
 1104 018c 6660     		str	r6, [r4, #4]
2716:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 1105              		.loc 1 2716 0
 1106 018e 4FF04008 		mov	r8, #64
 1107 0192 C4F80880 		str	r8, [r4, #8]
2717:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 1108              		.loc 1 2717 0
 1109 0196 0025     		movs	r5, #0
 1110 0198 E560     		str	r5, [r4, #12]
2718:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 1111              		.loc 1 2718 0
 1112 019a 4FF48067 		mov	r7, #1024
 1113 019e 2761     		str	r7, [r4, #16]
2719:lib/ff/sdio_stm32f1.c ****       SDIO_SendCommand(&SDIO_CmdInitStructure);
 1114              		.loc 1 2719 0
 1115 01a0 2046     		mov	r0, r4
 1116 01a2 FFF7FEFF 		bl	SDIO_SendCommand
 1117              	.LVL129:
2722:lib/ff/sdio_stm32f1.c ****       errorstatus = CmdResp1Error(SD_CMD_APP_CMD);
 1118              		.loc 1 2722 0
 1119 01a6 3046     		mov	r0, r6
 1120 01a8 FFF7FEFF 		bl	CmdResp1Error
 1121              	.LVL130:
2724:lib/ff/sdio_stm32f1.c ****       if (errorstatus != SD_OK)
 1122              		.loc 1 2724 0
 1123 01ac 2A28     		cmp	r0, #42
 1124 01ae 12D1     		bne	.L76
2730:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Argument = 0x00;
 1125              		.loc 1 2730 0
 1126 01b0 2560     		str	r5, [r4, #0]
2731:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_SD_SET_BUSWIDTH;
 1127              		.loc 1 2731 0
 1128 01b2 0626     		movs	r6, #6
 1129 01b4 6660     		str	r6, [r4, #4]
2732:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 1130              		.loc 1 2732 0
 1131 01b6 C4F80880 		str	r8, [r4, #8]
2733:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 1132              		.loc 1 2733 0
 1133 01ba E560     		str	r5, [r4, #12]
2734:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 1134              		.loc 1 2734 0
 1135 01bc 2761     		str	r7, [r4, #16]
2735:lib/ff/sdio_stm32f1.c ****       SDIO_SendCommand(&SDIO_CmdInitStructure);
 1136              		.loc 1 2735 0
 1137 01be 2046     		mov	r0, r4
 1138              	.LVL131:
 1139 01c0 FFF7FEFF 		bl	SDIO_SendCommand
 1140              	.LVL132:
2737:lib/ff/sdio_stm32f1.c ****       errorstatus = CmdResp1Error(SD_CMD_APP_SD_SET_BUSWIDTH);
 1141              		.loc 1 2737 0
 1142 01c4 3046     		mov	r0, r6
 1143              	.L99:
2752:lib/ff/sdio_stm32f1.c **** }
 1144              		.loc 1 2752 0
 1145 01c6 02B0     		add	sp, sp, #8
 1146 01c8 BDE8F047 		pop	{r4, r5, r6, r7, r8, r9, sl, lr}
2737:lib/ff/sdio_stm32f1.c ****       errorstatus = CmdResp1Error(SD_CMD_APP_SD_SET_BUSWIDTH);
 1147              		.loc 1 2737 0
 1148 01cc FFF7FEBF 		b	CmdResp1Error
 1149              	.LVL133:
 1150              	.L86:
2654:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 1151              		.loc 1 2654 0
 1152 01d0 0E20     		movs	r0, #14
 1153 01d2 00E0     		b	.L76
 1154              	.LVL134:
 1155              	.L91:
2705:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
 1156              		.loc 1 2705 0
 1157 01d4 2520     		movs	r0, #37
 1158              	.LVL135:
 1159              	.L76:
2752:lib/ff/sdio_stm32f1.c **** }
 1160              		.loc 1 2752 0
 1161 01d6 02B0     		add	sp, sp, #8
 1162 01d8 BDE8F087 		pop	{r4, r5, r6, r7, r8, r9, sl, pc}
 1163              	.L102:
 1164              		.align	2
 1165              	.L101:
 1166 01dc 00000000 		.word	.LANCHOR0
 1167 01e0 00000000 		.word	.LANCHOR1
 1168 01e4 00000000 		.word	.LANCHOR2
 1169 01e8 FFFF0F00 		.word	1048575
 1170 01ec 00800140 		.word	1073840128
 1171              		.cfi_endproc
 1172              	.LFE84:
 1174              		.section	.text.SD_DeInit,"ax",%progbits
 1175              		.align	1
 1176              		.global	SD_DeInit
 1177              		.thumb
 1178              		.thumb_func
 1180              	SD_DeInit:
 1181              	.LFB56:
 141:lib/ff/sdio_stm32f1.c **** { 
 1182              		.loc 1 141 0
 1183              		.cfi_startproc
 1184              		@ args = 0, pretend = 0, frame = 8
 1185              		@ frame_needed = 0, uses_anonymous_args = 0
 1186 0000 13B5     		push	{r0, r1, r4, lr}
 1187              	.LCFI8:
 1188              		.cfi_def_cfa_offset 16
 1189              		.cfi_offset 0, -16
 1190              		.cfi_offset 1, -12
 1191              		.cfi_offset 4, -8
 1192              		.cfi_offset 14, -4
 145:lib/ff/sdio_stm32f1.c ****   SDIO_ClockCmd(DISABLE);
 1193              		.loc 1 145 0
 1194 0002 0020     		movs	r0, #0
 1195 0004 FFF7FEFF 		bl	SDIO_ClockCmd
 1196              	.LVL136:
 148:lib/ff/sdio_stm32f1.c ****   SDIO_SetPowerState(SDIO_PowerState_OFF);
 1197              		.loc 1 148 0
 1198 0008 0020     		movs	r0, #0
 1199 000a FFF7FEFF 		bl	SDIO_SetPowerState
 1200              	.LVL137:
 151:lib/ff/sdio_stm32f1.c ****   SDIO_DeInit();
 1201              		.loc 1 151 0
 1202 000e FFF7FEFF 		bl	SDIO_DeInit
 1203              	.LVL138:
 154:lib/ff/sdio_stm32f1.c ****   RCC_AHBPeriphClockCmd(RCC_AHBPeriph_SDIO, DISABLE);
 1204              		.loc 1 154 0
 1205 0012 4FF48060 		mov	r0, #1024
 1206 0016 0021     		movs	r1, #0
 1207 0018 FFF7FEFF 		bl	RCC_AHBPeriphClockCmd
 1208              	.LVL139:
 157:lib/ff/sdio_stm32f1.c ****   GPIO_InitStructure.GPIO_Pin = GPIO_Pin_8 | GPIO_Pin_9 | GPIO_Pin_10 | GPIO_Pin_11 | GPIO_Pin_12;
 1209              		.loc 1 157 0
 1210 001c 4FF4F853 		mov	r3, #7936
 1211 0020 ADF80430 		strh	r3, [sp, #4]	@ movhi
 158:lib/ff/sdio_stm32f1.c ****   GPIO_InitStructure.GPIO_Mode = GPIO_Mode_IN_FLOATING;
 1212              		.loc 1 158 0
 1213 0024 0424     		movs	r4, #4
 1214 0026 8DF80740 		strb	r4, [sp, #7]
 159:lib/ff/sdio_stm32f1.c ****   GPIO_Init(GPIOC, &GPIO_InitStructure);
 1215              		.loc 1 159 0
 1216 002a 0648     		ldr	r0, .L104
 1217 002c 0DEB0401 		add	r1, sp, r4
 1218 0030 FFF7FEFF 		bl	GPIO_Init
 1219              	.LVL140:
 162:lib/ff/sdio_stm32f1.c ****   GPIO_InitStructure.GPIO_Pin = GPIO_Pin_2;
 1220              		.loc 1 162 0
 1221 0034 ADF80440 		strh	r4, [sp, #4]	@ movhi
 163:lib/ff/sdio_stm32f1.c ****   GPIO_Init(GPIOD, &GPIO_InitStructure);
 1222              		.loc 1 163 0
 1223 0038 0348     		ldr	r0, .L104+4
 1224 003a 0DEB0401 		add	r1, sp, r4
 1225 003e FFF7FEFF 		bl	GPIO_Init
 1226              	.LVL141:
 164:lib/ff/sdio_stm32f1.c **** }
 1227              		.loc 1 164 0
 1228 0042 1CBD     		pop	{r2, r3, r4, pc}
 1229              	.L105:
 1230              		.align	2
 1231              	.L104:
 1232 0044 00100140 		.word	1073811456
 1233 0048 00140140 		.word	1073812480
 1234              		.cfi_endproc
 1235              	.LFE56:
 1237              		.section	.text.SD_Detect,"ax",%progbits
 1238              		.align	1
 1239              		.global	SD_Detect
 1240              		.thumb
 1241              		.thumb_func
 1243              	SD_Detect:
 1244              	.LFB60:
 338:lib/ff/sdio_stm32f1.c **** {
 1245              		.loc 1 338 0
 1246              		.cfi_startproc
 1247              		@ args = 0, pretend = 0, frame = 8
 1248              		@ frame_needed = 0, uses_anonymous_args = 0
 1249              		@ link register save eliminated.
 1250 0000 82B0     		sub	sp, sp, #8
 1251              	.LCFI9:
 1252              		.cfi_def_cfa_offset 8
 339:lib/ff/sdio_stm32f1.c ****   __IO uint8_t status = SD_PRESENT;
 1253              		.loc 1 339 0
 1254 0002 0123     		movs	r3, #1
 1255 0004 8DF80730 		strb	r3, [sp, #7]
 1256              	.LVL142:
 349:lib/ff/sdio_stm32f1.c ****   return status;
 1257              		.loc 1 349 0
 1258 0008 9DF80700 		ldrb	r0, [sp, #7]	@ zero_extendqisi2
 1259              	.LVL143:
 1260              	.LVL144:
 350:lib/ff/sdio_stm32f1.c **** }
 1261              		.loc 1 350 0
 1262 000c 02B0     		add	sp, sp, #8
 1263 000e 7047     		bx	lr
 1264              		.cfi_endproc
 1265              	.LFE60:
 1267              		.section	.text.SD_PowerON,"ax",%progbits
 1268              		.align	1
 1269              		.global	SD_PowerON
 1270              		.thumb
 1271              		.thumb_func
 1273              	SD_PowerON:
 1274              	.LFB61:
 362:lib/ff/sdio_stm32f1.c **** {
 1275              		.loc 1 362 0
 1276              		.cfi_startproc
 1277              		@ args = 0, pretend = 0, frame = 0
 1278              		@ frame_needed = 0, uses_anonymous_args = 0
 1279 0000 2DE9F84F 		push	{r3, r4, r5, r6, r7, r8, r9, sl, fp, lr}
 1280              	.LCFI10:
 1281              		.cfi_def_cfa_offset 40
 1282              		.cfi_offset 3, -40
 1283              		.cfi_offset 4, -36
 1284              		.cfi_offset 5, -32
 1285              		.cfi_offset 6, -28
 1286              		.cfi_offset 7, -24
 1287              		.cfi_offset 8, -20
 1288              		.cfi_offset 9, -16
 1289              		.cfi_offset 10, -12
 1290              		.cfi_offset 11, -8
 1291              		.cfi_offset 14, -4
 1292              	.LVL145:
 371:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_ClockDiv = SDIO_INIT_CLK_DIV;
 1293              		.loc 1 371 0
 1294 0004 6548     		ldr	r0, .L141
 1295 0006 B223     		movs	r3, #178
 1296 0008 0375     		strb	r3, [r0, #20]
 372:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_ClockEdge = SDIO_ClockEdge_Rising;
 1297              		.loc 1 372 0
 1298 000a 0024     		movs	r4, #0
 1299 000c 0460     		str	r4, [r0, #0]
 373:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_ClockBypass = SDIO_ClockBypass_Disable;
 1300              		.loc 1 373 0
 1301 000e 4460     		str	r4, [r0, #4]
 374:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_ClockPowerSave = SDIO_ClockPowerSave_Disable;
 1302              		.loc 1 374 0
 1303 0010 8460     		str	r4, [r0, #8]
 375:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_BusWide = SDIO_BusWide_1b;
 1304              		.loc 1 375 0
 1305 0012 C460     		str	r4, [r0, #12]
 376:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_HardwareFlowControl = SDIO_HardwareFlowControl_Disable;
 1306              		.loc 1 376 0
 1307 0014 0461     		str	r4, [r0, #16]
 377:lib/ff/sdio_stm32f1.c ****   SDIO_Init(&SDIO_InitStructure);
 1308              		.loc 1 377 0
 1309 0016 FFF7FEFF 		bl	SDIO_Init
 1310              	.LVL146:
 380:lib/ff/sdio_stm32f1.c ****   SDIO_SetPowerState(SDIO_PowerState_ON);
 1311              		.loc 1 380 0
 1312 001a 0320     		movs	r0, #3
 1313 001c FFF7FEFF 		bl	SDIO_SetPowerState
 1314              	.LVL147:
 383:lib/ff/sdio_stm32f1.c ****   SDIO_ClockCmd(ENABLE);
 1315              		.loc 1 383 0
 1316 0020 0120     		movs	r0, #1
 1317 0022 FFF7FEFF 		bl	SDIO_ClockCmd
 1318              	.LVL148:
 387:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = 0x0;
 1319              		.loc 1 387 0
 1320 0026 5E48     		ldr	r0, .L141+4
 1321 0028 0460     		str	r4, [r0, #0]
 388:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_GO_IDLE_STATE;
 1322              		.loc 1 388 0
 1323 002a 4460     		str	r4, [r0, #4]
 389:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_No;
 1324              		.loc 1 389 0
 1325 002c 8460     		str	r4, [r0, #8]
 390:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 1326              		.loc 1 390 0
 1327 002e C460     		str	r4, [r0, #12]
 391:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 1328              		.loc 1 391 0
 1329 0030 4FF48061 		mov	r1, #1024
 1330 0034 0161     		str	r1, [r0, #16]
 392:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 1331              		.loc 1 392 0
 1332 0036 FFF7FEFF 		bl	SDIO_SendCommand
 1333              	.LVL149:
 1334 003a 4FF48034 		mov	r4, #65536
 1335              	.LVL150:
 1336              	.L108:
 1337              	.LBB20:
 1338              	.LBB21:
2287:lib/ff/sdio_stm32f1.c ****   while ((timeout > 0) && (SDIO_GetFlagStatus(SDIO_FLAG_CMDSENT) == RESET))
 1339              		.loc 1 2287 0
 1340 003e 8020     		movs	r0, #128
 1341 0040 FFF7FEFF 		bl	SDIO_GetFlagStatus
 1342              	.LVL151:
 1343 0044 0028     		cmp	r0, #0
 1344 0046 46D1     		bne	.L140
 1345              	.L110:
 1346 0048 013C     		subs	r4, r4, #1
 1347 004a F8D1     		bne	.L108
 1348 004c 41E0     		b	.L125
 1349              	.LVL152:
 1350              	.L121:
 1351              	.LBE21:
 1352              	.LBE20:
 1353              	.LBB23:
 1354              	.LBB24:
2520:lib/ff/sdio_stm32f1.c ****   SDIO_ClearFlag(SDIO_STATIC_FLAGS);
 1355              		.loc 1 2520 0
 1356 004e 40F2FF50 		movw	r0, #1535
 1357 0052 FFF7FEFF 		bl	SDIO_ClearFlag
 1358              	.LVL153:
 1359              	.LBE24:
 1360              	.LBE23:
 479:lib/ff/sdio_stm32f1.c ****       response = SDIO_GetResponse(SDIO_RESP1);
 1361              		.loc 1 479 0
 1362 0056 2046     		mov	r0, r4
 1363 0058 FFF7FEFF 		bl	SDIO_GetResponse
 1364              	.LVL154:
 480:lib/ff/sdio_stm32f1.c ****       validvoltage = (((response >> 31) == 1) ? 1 : 0);
 1365              		.loc 1 480 0
 1366 005c C60F     		lsrs	r6, r0, #31
 1367              	.LVL155:
 481:lib/ff/sdio_stm32f1.c ****       count++;
 1368              		.loc 1 481 0
 1369 005e 0137     		adds	r7, r7, #1
 1370              	.LVL156:
 1371              	.L118:
 1372 0060 4FF6FF71 		movw	r1, #65535
 449:lib/ff/sdio_stm32f1.c ****     while ((!validvoltage) && (count < SD_MAX_VOLT_TRIAL))
 1373              		.loc 1 449 0 discriminator 1
 1374 0064 002E     		cmp	r6, #0
 1375 0066 40F08B80 		bne	.L122
 449:lib/ff/sdio_stm32f1.c ****     while ((!validvoltage) && (count < SD_MAX_VOLT_TRIAL))
 1376              		.loc 1 449 0 is_stmt 0 discriminator 2
 1377 006a 8F42     		cmp	r7, r1
 1378 006c 00F09280 		beq	.L128
 1379              	.L123:
 453:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Argument = 0x00;
 1380              		.loc 1 453 0 is_stmt 1
 1381 0070 4B4C     		ldr	r4, .L141+4
 1382 0072 2660     		str	r6, [r4, #0]
 454:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_CMD;
 1383              		.loc 1 454 0
 1384 0074 4FF0370B 		mov	fp, #55
 1385 0078 C4F804B0 		str	fp, [r4, #4]
 455:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 1386              		.loc 1 455 0
 1387 007c 4FF0400A 		mov	sl, #64
 1388 0080 C4F808A0 		str	sl, [r4, #8]
 456:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 1389              		.loc 1 456 0
 1390 0084 E660     		str	r6, [r4, #12]
 457:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 1391              		.loc 1 457 0
 1392 0086 4FF48069 		mov	r9, #1024
 1393 008a C4F81090 		str	r9, [r4, #16]
 458:lib/ff/sdio_stm32f1.c ****       SDIO_SendCommand(&SDIO_CmdInitStructure);
 1394              		.loc 1 458 0
 1395 008e 2046     		mov	r0, r4
 1396 0090 FFF7FEFF 		bl	SDIO_SendCommand
 1397              	.LVL157:
 460:lib/ff/sdio_stm32f1.c ****       errorstatus = CmdResp1Error(SD_CMD_APP_CMD);
 1398              		.loc 1 460 0
 1399 0094 5846     		mov	r0, fp
 1400 0096 FFF7FEFF 		bl	CmdResp1Error
 1401              	.LVL158:
 462:lib/ff/sdio_stm32f1.c ****       if (errorstatus != SD_OK)
 1402              		.loc 1 462 0
 1403 009a 2A28     		cmp	r0, #42
 1404 009c 78D1     		bne	.L127
 466:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Argument = SD_VOLTAGE_WINDOW_SD | SDType;
 1405              		.loc 1 466 0
 1406 009e 48F00043 		orr	r3, r8, #-2147483648
 1407 00a2 43F48011 		orr	r1, r3, #1048576
 1408 00a6 2160     		str	r1, [r4, #0]
 467:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SD_APP_OP_COND;
 1409              		.loc 1 467 0
 1410 00a8 2920     		movs	r0, #41
 1411              	.LVL159:
 1412 00aa 6060     		str	r0, [r4, #4]
 468:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 1413              		.loc 1 468 0
 1414 00ac C4F808A0 		str	sl, [r4, #8]
 469:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 1415              		.loc 1 469 0
 1416 00b0 E660     		str	r6, [r4, #12]
 470:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 1417              		.loc 1 470 0
 1418 00b2 C4F81090 		str	r9, [r4, #16]
 471:lib/ff/sdio_stm32f1.c ****       SDIO_SendCommand(&SDIO_CmdInitStructure);
 1419              		.loc 1 471 0
 1420 00b6 2046     		mov	r0, r4
 1421 00b8 FFF7FEFF 		bl	SDIO_SendCommand
 1422              	.LVL160:
 1423              	.LBB26:
 1424              	.LBB25:
2506:lib/ff/sdio_stm32f1.c ****   status = SDIO->STA;
 1425              		.loc 1 2506 0
 1426 00bc 394C     		ldr	r4, .L141+8
 1427              	.L120:
2510:lib/ff/sdio_stm32f1.c ****     status = SDIO->STA;
 1428              		.loc 1 2510 0
 1429 00be 626B     		ldr	r2, [r4, #52]
 1430              	.LVL161:
2508:lib/ff/sdio_stm32f1.c ****   while (!(status & (SDIO_FLAG_CCRCFAIL | SDIO_FLAG_CMDREND | SDIO_FLAG_CTIMEOUT)))
 1431              		.loc 1 2508 0
 1432 00c0 12F0450F 		tst	r2, #69
 1433 00c4 FBD0     		beq	.L120
2513:lib/ff/sdio_stm32f1.c ****   if (status & SDIO_FLAG_CTIMEOUT)
 1434              		.loc 1 2513 0
 1435 00c6 12F00404 		ands	r4, r2, #4
 1436 00ca C0D0     		beq	.L121
 1437              	.LVL162:
2516:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_CTIMEOUT);
 1438              		.loc 1 2516 0
 1439 00cc 0420     		movs	r0, #4
 1440 00ce FFF7FEFF 		bl	SDIO_ClearFlag
 1441              	.LVL163:
 1442              	.L125:
 1443              	.LBE25:
 1444              	.LBE26:
 1445              	.LBB27:
 1446              	.LBB22:
2295:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 1447              		.loc 1 2295 0
 1448 00d2 0325     		movs	r5, #3
 1449 00d4 5FE0     		b	.L132
 1450              	.LVL164:
 1451              	.L140:
2299:lib/ff/sdio_stm32f1.c ****   SDIO_ClearFlag(SDIO_STATIC_FLAGS);
 1452              		.loc 1 2299 0
 1453 00d6 40F2FF50 		movw	r0, #1535
 1454 00da FFF7FEFF 		bl	SDIO_ClearFlag
 1455              	.LVL165:
 1456              	.LBE22:
 1457              	.LBE27:
 408:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = SD_CHECK_PATTERN;
 1458              		.loc 1 408 0
 1459 00de 3048     		ldr	r0, .L141+4
 411:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 1460              		.loc 1 411 0
 1461 00e0 4FF4D571 		mov	r1, #426
 1462 00e4 0822     		movs	r2, #8
 1463 00e6 4023     		movs	r3, #64
 1464 00e8 0024     		movs	r4, #0
 1465 00ea 80E81E00 		stmia	r0, {r1, r2, r3, r4}
 412:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 1466              		.loc 1 412 0
 1467 00ee 4FF48062 		mov	r2, #1024
 1468 00f2 0261     		str	r2, [r0, #16]
 413:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 1469              		.loc 1 413 0
 1470 00f4 FFF7FEFF 		bl	SDIO_SendCommand
 1471              	.LVL166:
 1472              	.LBB28:
 1473              	.LBB29:
2318:lib/ff/sdio_stm32f1.c ****   status = SDIO->STA;
 1474              		.loc 1 2318 0
 1475 00f8 2A48     		ldr	r0, .L141+8
 1476 00fa 456B     		ldr	r5, [r0, #52]
 1477              	.LVL167:
2316:lib/ff/sdio_stm32f1.c ****   uint32_t timeout = SDIO_CMD0TIMEOUT;
 1478              		.loc 1 2316 0
 1479 00fc 4FF48036 		mov	r6, #65536
 1480              	.LVL168:
 1481              	.L124:
2320:lib/ff/sdio_stm32f1.c ****   while (!(status & (SDIO_FLAG_CCRCFAIL | SDIO_FLAG_CMDREND | SDIO_FLAG_CTIMEOUT)) && (timeout > 0)
 1482              		.loc 1 2320 0
 1483 0100 15F0450F 		tst	r5, #69
 1484 0104 04D1     		bne	.L112
 1485 0106 36B1     		cbz	r6, .L114
 1486              	.L113:
2322:lib/ff/sdio_stm32f1.c ****     timeout--;
 1487              		.loc 1 2322 0
 1488 0108 013E     		subs	r6, r6, #1
 1489              	.LVL169:
2323:lib/ff/sdio_stm32f1.c ****     status = SDIO->STA;
 1490              		.loc 1 2323 0
 1491 010a 264D     		ldr	r5, .L141+8
 1492              	.LVL170:
 1493 010c 6D6B     		ldr	r5, [r5, #52]
 1494              	.LVL171:
 1495 010e F7E7     		b	.L124
 1496              	.L112:
2326:lib/ff/sdio_stm32f1.c ****   if ((timeout == 0) || (status & SDIO_FLAG_CTIMEOUT))
 1497              		.loc 1 2326 0
 1498 0110 0EB1     		cbz	r6, .L114
 1499 0112 6907     		lsls	r1, r5, #29
 1500 0114 14D5     		bpl	.L115
 1501              	.L114:
 1502              	.LVL172:
2330:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_CTIMEOUT);
 1503              		.loc 1 2330 0
 1504 0116 0420     		movs	r0, #4
 1505 0118 FFF7FEFF 		bl	SDIO_ClearFlag
 1506              	.LVL173:
 1507              	.LBE29:
 1508              	.LBE28:
 425:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Argument = 0x00;
 1509              		.loc 1 425 0
 1510 011c 2048     		ldr	r0, .L141+4
 426:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_CMD;
 1511              		.loc 1 426 0
 1512 011e 0024     		movs	r4, #0
 1513 0120 3725     		movs	r5, #55
 1514              	.LVL174:
 1515 0122 80E83000 		stmia	r0, {r4, r5}
 427:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 1516              		.loc 1 427 0
 1517 0126 4021     		movs	r1, #64
 1518 0128 8160     		str	r1, [r0, #8]
 428:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 1519              		.loc 1 428 0
 1520 012a C460     		str	r4, [r0, #12]
 429:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 1521              		.loc 1 429 0
 1522 012c 4FF48062 		mov	r2, #1024
 1523 0130 0261     		str	r2, [r0, #16]
 430:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
 1524              		.loc 1 430 0
 1525 0132 FFF7FEFF 		bl	SDIO_SendCommand
 1526              	.LVL175:
 431:lib/ff/sdio_stm32f1.c ****     errorstatus = CmdResp1Error(SD_CMD_APP_CMD);
 1527              		.loc 1 431 0
 1528 0136 2846     		mov	r0, r5
 1529 0138 FFF7FEFF 		bl	CmdResp1Error
 1530              	.LVL176:
 365:lib/ff/sdio_stm32f1.c ****   uint32_t SDType = SD_STD_CAPACITY;
 1531              		.loc 1 365 0
 1532 013c A046     		mov	r8, r4
 1533 013e 09E0     		b	.L116
 1534              	.LVL177:
 1535              	.L115:
 1536              	.LBB31:
 1537              	.LBB30:
2334:lib/ff/sdio_stm32f1.c ****   if (status & SDIO_FLAG_CMDREND)
 1538              		.loc 1 2334 0
 1539 0140 6A06     		lsls	r2, r5, #25
 1540 0142 02D5     		bpl	.L117
2338:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_CMDREND);
 1541              		.loc 1 2338 0
 1542 0144 4020     		movs	r0, #64
 1543 0146 FFF7FEFF 		bl	SDIO_ClearFlag
 1544              	.LVL178:
 1545              	.L117:
 1546              	.LBE30:
 1547              	.LBE31:
 419:lib/ff/sdio_stm32f1.c ****     CardType = SDIO_STD_CAPACITY_SD_CARD_V2_0; /*!< SD Card 2.0 */
 1548              		.loc 1 419 0
 1549 014a 0124     		movs	r4, #1
 1550 014c 164B     		ldr	r3, .L141+12
 1551 014e 1C60     		str	r4, [r3, #0]
 1552              	.LVL179:
 420:lib/ff/sdio_stm32f1.c ****     SDType = SD_HIGH_CAPACITY;
 1553              		.loc 1 420 0
 1554 0150 4FF08048 		mov	r8, #1073741824
 1555              	.LVL180:
 1556              	.L116:
 434:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = 0x00;
 1557              		.loc 1 434 0
 1558 0154 1248     		ldr	r0, .L141+4
 1559 0156 0026     		movs	r6, #0
 1560              	.LVL181:
 1561 0158 0660     		str	r6, [r0, #0]
 435:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_CMD;
 1562              		.loc 1 435 0
 1563 015a 3724     		movs	r4, #55
 1564 015c 4460     		str	r4, [r0, #4]
 436:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 1565              		.loc 1 436 0
 1566 015e 4025     		movs	r5, #64
 1567 0160 8560     		str	r5, [r0, #8]
 437:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 1568              		.loc 1 437 0
 1569 0162 C660     		str	r6, [r0, #12]
 438:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 1570              		.loc 1 438 0
 1571 0164 4FF48063 		mov	r3, #1024
 1572 0168 0361     		str	r3, [r0, #16]
 439:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 1573              		.loc 1 439 0
 1574 016a FFF7FEFF 		bl	SDIO_SendCommand
 1575              	.LVL182:
 440:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_APP_CMD);
 1576              		.loc 1 440 0
 1577 016e 2046     		mov	r0, r4
 1578 0170 FFF7FEFF 		bl	CmdResp1Error
 1579              	.LVL183:
 1580 0174 0546     		mov	r5, r0
 1581              	.LVL184:
 445:lib/ff/sdio_stm32f1.c ****   if (errorstatus == SD_OK)
 1582              		.loc 1 445 0
 1583 0176 2A28     		cmp	r0, #42
 1584 0178 0DD1     		bne	.L132
 1585 017a 3746     		mov	r7, r6
 1586 017c 3046     		mov	r0, r6
 1587              	.LVL185:
 1588 017e 6FE7     		b	.L118
 1589              	.LVL186:
 1590              	.L122:
 483:lib/ff/sdio_stm32f1.c ****     if (count >= SD_MAX_VOLT_TRIAL)
 1591              		.loc 1 483 0
 1592 0180 8F42     		cmp	r7, r1
 1593 0182 07D0     		beq	.L128
 1594              	.LVL187:
 489:lib/ff/sdio_stm32f1.c ****     if (response &= SD_HIGH_CAPACITY)
 1595              		.loc 1 489 0
 1596 0184 4300     		lsls	r3, r0, #1
 1597 0186 06D5     		bpl	.L132
 491:lib/ff/sdio_stm32f1.c ****       CardType = SDIO_HIGH_CAPACITY_SD_CARD;
 1598              		.loc 1 491 0
 1599 0188 0220     		movs	r0, #2
 1600              	.LVL188:
 1601 018a 074A     		ldr	r2, .L141+12
 1602 018c 1060     		str	r0, [r2, #0]
 1603 018e 02E0     		b	.L132
 1604              	.LVL189:
 1605              	.L127:
 460:lib/ff/sdio_stm32f1.c ****       errorstatus = CmdResp1Error(SD_CMD_APP_CMD);
 1606              		.loc 1 460 0
 1607 0190 0546     		mov	r5, r0
 1608 0192 00E0     		b	.L132
 1609              	.LVL190:
 1610              	.L128:
 486:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
 1611              		.loc 1 486 0
 1612 0194 1B25     		movs	r5, #27
 1613              	.LVL191:
 1614              	.L132:
 497:lib/ff/sdio_stm32f1.c **** }
 1615              		.loc 1 497 0
 1616 0196 2846     		mov	r0, r5
 1617 0198 BDE8F88F 		pop	{r3, r4, r5, r6, r7, r8, r9, sl, fp, pc}
 1618              	.L142:
 1619              		.align	2
 1620              	.L141:
 1621 019c 00000000 		.word	.LANCHOR3
 1622 01a0 00000000 		.word	.LANCHOR0
 1623 01a4 00800140 		.word	1073840128
 1624 01a8 00000000 		.word	.LANCHOR4
 1625              		.cfi_endproc
 1626              	.LFE61:
 1628              		.section	.text.SD_PowerOFF,"ax",%progbits
 1629              		.align	1
 1630              		.global	SD_PowerOFF
 1631              		.thumb
 1632              		.thumb_func
 1634              	SD_PowerOFF:
 1635              	.LFB62:
 508:lib/ff/sdio_stm32f1.c **** {
 1636              		.loc 1 508 0
 1637              		.cfi_startproc
 1638              		@ args = 0, pretend = 0, frame = 0
 1639              		@ frame_needed = 0, uses_anonymous_args = 0
 1640 0000 08B5     		push	{r3, lr}
 1641              	.LCFI11:
 1642              		.cfi_def_cfa_offset 8
 1643              		.cfi_offset 3, -8
 1644              		.cfi_offset 14, -4
 1645              	.LVL192:
 512:lib/ff/sdio_stm32f1.c ****   SDIO_SetPowerState(SDIO_PowerState_OFF);
 1646              		.loc 1 512 0
 1647 0002 0020     		movs	r0, #0
 1648 0004 FFF7FEFF 		bl	SDIO_SetPowerState
 1649              	.LVL193:
 515:lib/ff/sdio_stm32f1.c **** }
 1650              		.loc 1 515 0
 1651 0008 2A20     		movs	r0, #42
 1652 000a 08BD     		pop	{r3, pc}
 1653              		.cfi_endproc
 1654              	.LFE62:
 1656              		.section	.text.SD_InitializeCards,"ax",%progbits
 1657              		.align	1
 1658              		.global	SD_InitializeCards
 1659              		.thumb
 1660              		.thumb_func
 1662              	SD_InitializeCards:
 1663              	.LFB63:
 527:lib/ff/sdio_stm32f1.c **** {
 1664              		.loc 1 527 0
 1665              		.cfi_startproc
 1666              		@ args = 0, pretend = 0, frame = 0
 1667              		@ frame_needed = 0, uses_anonymous_args = 0
 1668 0000 38B5     		push	{r3, r4, r5, lr}
 1669              	.LCFI12:
 1670              		.cfi_def_cfa_offset 16
 1671              		.cfi_offset 3, -16
 1672              		.cfi_offset 4, -12
 1673              		.cfi_offset 5, -8
 1674              		.cfi_offset 14, -4
 1675              	.LVL194:
 531:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetPowerState() == SDIO_PowerState_OFF)
 1676              		.loc 1 531 0
 1677 0002 FFF7FEFF 		bl	SDIO_GetPowerState
 1678              	.LVL195:
 1679 0006 0028     		cmp	r0, #0
 1680 0008 00F09480 		beq	.L157
 537:lib/ff/sdio_stm32f1.c ****   if (SDIO_SECURE_DIGITAL_IO_CARD != CardType)
 1681              		.loc 1 537 0
 1682 000c 4F4B     		ldr	r3, .L169
 1683 000e 1868     		ldr	r0, [r3, #0]
 1684 0010 0428     		cmp	r0, #4
 1685 0012 23D0     		beq	.L146
 540:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Argument = 0x0;
 1686              		.loc 1 540 0
 1687 0014 4E48     		ldr	r0, .L169+4
 1688 0016 0025     		movs	r5, #0
 1689 0018 0560     		str	r5, [r0, #0]
 541:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_ALL_SEND_CID;
 1690              		.loc 1 541 0
 1691 001a 0222     		movs	r2, #2
 1692 001c 4260     		str	r2, [r0, #4]
 542:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Long;
 1693              		.loc 1 542 0
 1694 001e C021     		movs	r1, #192
 1695 0020 8160     		str	r1, [r0, #8]
 543:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 1696              		.loc 1 543 0
 1697 0022 C560     		str	r5, [r0, #12]
 544:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 1698              		.loc 1 544 0
 1699 0024 4FF48064 		mov	r4, #1024
 1700 0028 0461     		str	r4, [r0, #16]
 545:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
 1701              		.loc 1 545 0
 1702 002a FFF7FEFF 		bl	SDIO_SendCommand
 1703              	.LVL196:
 547:lib/ff/sdio_stm32f1.c ****     errorstatus = CmdResp2Error();
 1704              		.loc 1 547 0
 1705 002e FFF7FEFF 		bl	CmdResp2Error
 1706              	.LVL197:
 1707 0032 0446     		mov	r4, r0
 1708              	.LVL198:
 549:lib/ff/sdio_stm32f1.c ****     if (SD_OK != errorstatus)
 1709              		.loc 1 549 0
 1710 0034 2A28     		cmp	r0, #42
 1711 0036 40F08680 		bne	.L164
 554:lib/ff/sdio_stm32f1.c ****     CID_Tab[0] = SDIO_GetResponse(SDIO_RESP1);
 1712              		.loc 1 554 0
 1713 003a 2846     		mov	r0, r5
 1714              	.LVL199:
 1715 003c FFF7FEFF 		bl	SDIO_GetResponse
 1716              	.LVL200:
 1717 0040 444C     		ldr	r4, .L169+8
 1718              	.LVL201:
 1719 0042 2060     		str	r0, [r4, #0]
 555:lib/ff/sdio_stm32f1.c ****     CID_Tab[1] = SDIO_GetResponse(SDIO_RESP2);
 1720              		.loc 1 555 0
 1721 0044 0420     		movs	r0, #4
 1722 0046 FFF7FEFF 		bl	SDIO_GetResponse
 1723              	.LVL202:
 1724 004a 6060     		str	r0, [r4, #4]
 556:lib/ff/sdio_stm32f1.c ****     CID_Tab[2] = SDIO_GetResponse(SDIO_RESP3);
 1725              		.loc 1 556 0
 1726 004c 0820     		movs	r0, #8
 1727 004e FFF7FEFF 		bl	SDIO_GetResponse
 1728              	.LVL203:
 1729 0052 A060     		str	r0, [r4, #8]
 557:lib/ff/sdio_stm32f1.c ****     CID_Tab[3] = SDIO_GetResponse(SDIO_RESP4);
 1730              		.loc 1 557 0
 1731 0054 0C20     		movs	r0, #12
 1732 0056 FFF7FEFF 		bl	SDIO_GetResponse
 1733              	.LVL204:
 1734 005a E060     		str	r0, [r4, #12]
 1735              	.L146:
 559:lib/ff/sdio_stm32f1.c ****   if ((SDIO_STD_CAPACITY_SD_CARD_V1_1 == CardType) ||  (SDIO_STD_CAPACITY_SD_CARD_V2_0 == CardType)
 1736              		.loc 1 559 0
 1737 005c 3B4B     		ldr	r3, .L169
 1738 005e 1868     		ldr	r0, [r3, #0]
 1739 0060 0128     		cmp	r0, #1
 1740 0062 03D9     		bls	.L147
 559:lib/ff/sdio_stm32f1.c ****   if ((SDIO_STD_CAPACITY_SD_CARD_V1_1 == CardType) ||  (SDIO_STD_CAPACITY_SD_CARD_V2_0 == CardType)
 1741              		.loc 1 559 0 is_stmt 0 discriminator 1
 1742 0064 0628     		cmp	r0, #6
 1743 0066 01D0     		beq	.L147
 560:lib/ff/sdio_stm32f1.c ****       ||  (SDIO_HIGH_CAPACITY_SD_CARD == CardType))
 1744              		.loc 1 560 0 is_stmt 1
 1745 0068 0228     		cmp	r0, #2
 1746 006a 36D1     		bne	.L158
 1747              	.L147:
 564:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Argument = 0x00;
 1748              		.loc 1 564 0
 1749 006c 3848     		ldr	r0, .L169+4
 1750 006e 0021     		movs	r1, #0
 1751 0070 0160     		str	r1, [r0, #0]
 565:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SET_REL_ADDR;
 1752              		.loc 1 565 0
 1753 0072 0322     		movs	r2, #3
 1754 0074 4260     		str	r2, [r0, #4]
 566:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 1755              		.loc 1 566 0
 1756 0076 4024     		movs	r4, #64
 1757 0078 8460     		str	r4, [r0, #8]
 567:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 1758              		.loc 1 567 0
 1759 007a C160     		str	r1, [r0, #12]
 568:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 1760              		.loc 1 568 0
 1761 007c 4FF48063 		mov	r3, #1024
 1762 0080 0361     		str	r3, [r0, #16]
 569:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
 1763              		.loc 1 569 0
 1764 0082 FFF7FEFF 		bl	SDIO_SendCommand
 1765              	.LVL205:
 1766              	.LBB34:
 1767              	.LBB35:
2579:lib/ff/sdio_stm32f1.c ****   status = SDIO->STA;
 1768              		.loc 1 2579 0
 1769 0086 3449     		ldr	r1, .L169+12
 1770              	.L150:
2583:lib/ff/sdio_stm32f1.c ****     status = SDIO->STA;
 1771              		.loc 1 2583 0
 1772 0088 486B     		ldr	r0, [r1, #52]
 1773              	.LVL206:
2581:lib/ff/sdio_stm32f1.c ****   while (!(status & (SDIO_FLAG_CCRCFAIL | SDIO_FLAG_CTIMEOUT | SDIO_FLAG_CMDREND)))
 1774              		.loc 1 2581 0
 1775 008a 10F0450F 		tst	r0, #69
 1776 008e FBD0     		beq	.L150
2586:lib/ff/sdio_stm32f1.c ****   if (status & SDIO_FLAG_CTIMEOUT)
 1777              		.loc 1 2586 0
 1778 0090 4207     		lsls	r2, r0, #29
 1779 0092 04D5     		bpl	.L151
 1780              	.LVL207:
2589:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_CTIMEOUT);
 1781              		.loc 1 2589 0
 1782 0094 0420     		movs	r0, #4
 1783              	.LVL208:
 1784 0096 FFF7FEFF 		bl	SDIO_ClearFlag
 1785              	.LVL209:
2590:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 1786              		.loc 1 2590 0
 1787 009a 0324     		movs	r4, #3
 1788 009c 53E0     		b	.L164
 1789              	.LVL210:
 1790              	.L151:
2592:lib/ff/sdio_stm32f1.c ****   else if (status & SDIO_FLAG_CCRCFAIL)
 1791              		.loc 1 2592 0
 1792 009e 10F00104 		ands	r4, r0, #1
 1793 00a2 04D0     		beq	.L153
 1794              	.LVL211:
2595:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_CCRCFAIL);
 1795              		.loc 1 2595 0
 1796 00a4 0120     		movs	r0, #1
 1797              	.LVL212:
 1798 00a6 FFF7FEFF 		bl	SDIO_ClearFlag
 1799              	.LVL213:
2596:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 1800              		.loc 1 2596 0
 1801 00aa 0124     		movs	r4, #1
 1802 00ac 4BE0     		b	.L164
 1803              	.LVL214:
 1804              	.L153:
2600:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetCommandResponse() != cmd)
 1805              		.loc 1 2600 0
 1806 00ae FFF7FEFF 		bl	SDIO_GetCommandResponse
 1807              	.LVL215:
 1808 00b2 0328     		cmp	r0, #3
 1809 00b4 42D1     		bne	.L154
2607:lib/ff/sdio_stm32f1.c ****   SDIO_ClearFlag(SDIO_STATIC_FLAGS);
 1810              		.loc 1 2607 0
 1811 00b6 40F2FF50 		movw	r0, #1535
 1812 00ba FFF7FEFF 		bl	SDIO_ClearFlag
 1813              	.LVL216:
2610:lib/ff/sdio_stm32f1.c ****   response_r1 = SDIO_GetResponse(SDIO_RESP1);
 1814              		.loc 1 2610 0
 1815 00be 2046     		mov	r0, r4
 1816 00c0 FFF7FEFF 		bl	SDIO_GetResponse
 1817              	.LVL217:
2612:lib/ff/sdio_stm32f1.c ****   if (SD_ALLZERO == (response_r1 & (SD_R6_GENERAL_UNKNOWN_ERROR | SD_R6_ILLEGAL_CMD | SD_R6_COM_CRC
 1818              		.loc 1 2612 0
 1819 00c4 10F4604F 		tst	r0, #57344
 1820 00c8 01D1     		bne	.L155
2614:lib/ff/sdio_stm32f1.c ****     *prca = (uint16_t) (response_r1 >> 16);
 1821              		.loc 1 2614 0
 1822 00ca 020C     		lsrs	r2, r0, #16
 1823              	.LVL218:
 1824 00cc 06E0     		b	.L148
 1825              	.LVL219:
 1826              	.L155:
2618:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_R6_GENERAL_UNKNOWN_ERROR)
 1827              		.loc 1 2618 0
 1828 00ce 8304     		lsls	r3, r0, #18
 1829 00d0 36D4     		bmi	.L159
2623:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_R6_ILLEGAL_CMD)
 1830              		.loc 1 2623 0
 1831 00d2 4404     		lsls	r4, r0, #17
 1832 00d4 32D4     		bmi	.L154
2628:lib/ff/sdio_stm32f1.c ****   if (response_r1 & SD_R6_COM_CRC_FAILED)
 1833              		.loc 1 2628 0
 1834 00d6 0004     		lsls	r0, r0, #16
 1835              	.LVL220:
 1836 00d8 34D4     		bmi	.L160
 1837              	.LVL221:
 1838              	.L158:
 1839              	.LBE35:
 1840              	.LBE34:
 529:lib/ff/sdio_stm32f1.c ****   uint16_t rca = 0x01;
 1841              		.loc 1 529 0
 1842 00da 0122     		movs	r2, #1
 1843              	.LVL222:
 1844              	.L148:
 579:lib/ff/sdio_stm32f1.c ****   if (SDIO_SECURE_DIGITAL_IO_CARD != CardType)
 1845              		.loc 1 579 0
 1846 00dc 1B4B     		ldr	r3, .L169
 1847 00de 1968     		ldr	r1, [r3, #0]
 1848 00e0 0429     		cmp	r1, #4
 1849 00e2 29D0     		beq	.L161
 581:lib/ff/sdio_stm32f1.c ****     RCA = rca;
 1850              		.loc 1 581 0
 1851 00e4 1D4D     		ldr	r5, .L169+16
 1852 00e6 2A60     		str	r2, [r5, #0]
 584:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Argument = (uint32_t)(rca << 16);
 1853              		.loc 1 584 0
 1854 00e8 194C     		ldr	r4, .L169+4
 1855 00ea 1004     		lsls	r0, r2, #16
 1856 00ec 2060     		str	r0, [r4, #0]
 585:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SEND_CSD;
 1857              		.loc 1 585 0
 1858 00ee 0922     		movs	r2, #9
 1859              	.LVL223:
 1860 00f0 6260     		str	r2, [r4, #4]
 586:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Long;
 1861              		.loc 1 586 0
 1862 00f2 C023     		movs	r3, #192
 1863 00f4 A360     		str	r3, [r4, #8]
 587:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 1864              		.loc 1 587 0
 1865 00f6 0025     		movs	r5, #0
 1866 00f8 E560     		str	r5, [r4, #12]
 588:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 1867              		.loc 1 588 0
 1868 00fa 4FF48061 		mov	r1, #1024
 1869 00fe 2161     		str	r1, [r4, #16]
 589:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
 1870              		.loc 1 589 0
 1871 0100 2046     		mov	r0, r4
 1872 0102 FFF7FEFF 		bl	SDIO_SendCommand
 1873              	.LVL224:
 591:lib/ff/sdio_stm32f1.c ****     errorstatus = CmdResp2Error();
 1874              		.loc 1 591 0
 1875 0106 FFF7FEFF 		bl	CmdResp2Error
 1876              	.LVL225:
 1877 010a 0446     		mov	r4, r0
 1878              	.LVL226:
 593:lib/ff/sdio_stm32f1.c ****     if (SD_OK != errorstatus)
 1879              		.loc 1 593 0
 1880 010c 2A28     		cmp	r0, #42
 1881 010e 1AD1     		bne	.L164
 598:lib/ff/sdio_stm32f1.c ****     CSD_Tab[0] = SDIO_GetResponse(SDIO_RESP1);
 1882              		.loc 1 598 0
 1883 0110 2846     		mov	r0, r5
 1884              	.LVL227:
 1885 0112 FFF7FEFF 		bl	SDIO_GetResponse
 1886              	.LVL228:
 1887 0116 124D     		ldr	r5, .L169+20
 1888 0118 2860     		str	r0, [r5, #0]
 599:lib/ff/sdio_stm32f1.c ****     CSD_Tab[1] = SDIO_GetResponse(SDIO_RESP2);
 1889              		.loc 1 599 0
 1890 011a 0420     		movs	r0, #4
 1891 011c FFF7FEFF 		bl	SDIO_GetResponse
 1892              	.LVL229:
 1893 0120 6860     		str	r0, [r5, #4]
 600:lib/ff/sdio_stm32f1.c ****     CSD_Tab[2] = SDIO_GetResponse(SDIO_RESP3);
 1894              		.loc 1 600 0
 1895 0122 0820     		movs	r0, #8
 1896 0124 FFF7FEFF 		bl	SDIO_GetResponse
 1897              	.LVL230:
 1898 0128 A860     		str	r0, [r5, #8]
 601:lib/ff/sdio_stm32f1.c ****     CSD_Tab[3] = SDIO_GetResponse(SDIO_RESP4);
 1899              		.loc 1 601 0
 1900 012a 0C20     		movs	r0, #12
 1901 012c FFF7FEFF 		bl	SDIO_GetResponse
 1902              	.LVL231:
 1903 0130 E860     		str	r0, [r5, #12]
 1904 0132 08E0     		b	.L164
 1905              	.LVL232:
 1906              	.L157:
 534:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 1907              		.loc 1 534 0
 1908 0134 2524     		movs	r4, #37
 1909 0136 06E0     		b	.L164
 1910              	.LVL233:
 1911              	.L161:
 606:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
 1912              		.loc 1 606 0
 1913 0138 2A24     		movs	r4, #42
 1914 013a 04E0     		b	.L164
 1915              	.LVL234:
 1916              	.L154:
 1917              	.LBB37:
 1918              	.LBB36:
2603:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 1919              		.loc 1 2603 0
 1920 013c 1024     		movs	r4, #16
 1921 013e 02E0     		b	.L164
 1922              	.LVL235:
 1923              	.L159:
2620:lib/ff/sdio_stm32f1.c ****     return(SD_GENERAL_UNKNOWN_ERROR);
 1924              		.loc 1 2620 0
 1925 0140 1324     		movs	r4, #19
 1926 0142 00E0     		b	.L164
 1927              	.LVL236:
 1928              	.L160:
2630:lib/ff/sdio_stm32f1.c ****     return(SD_COM_CRC_FAILED);
 1929              		.loc 1 2630 0
 1930 0144 0F24     		movs	r4, #15
 1931              	.LVL237:
 1932              	.L164:
 1933              	.LBE36:
 1934              	.LBE37:
 607:lib/ff/sdio_stm32f1.c **** }
 1935              		.loc 1 607 0
 1936 0146 2046     		mov	r0, r4
 1937 0148 38BD     		pop	{r3, r4, r5, pc}
 1938              	.L170:
 1939 014a 00BF     		.align	2
 1940              	.L169:
 1941 014c 00000000 		.word	.LANCHOR4
 1942 0150 00000000 		.word	.LANCHOR0
 1943 0154 00000000 		.word	.LANCHOR5
 1944 0158 00800140 		.word	1073840128
 1945 015c 00000000 		.word	.LANCHOR1
 1946 0160 00000000 		.word	.LANCHOR6
 1947              		.cfi_endproc
 1948              	.LFE63:
 1950              		.section	.text.SD_GetCardInfo,"ax",%progbits
 1951              		.align	1
 1952              		.global	SD_GetCardInfo
 1953              		.thumb
 1954              		.thumb_func
 1956              	SD_GetCardInfo:
 1957              	.LFB64:
 619:lib/ff/sdio_stm32f1.c **** {
 1958              		.loc 1 619 0
 1959              		.cfi_startproc
 1960              		@ args = 0, pretend = 0, frame = 0
 1961              		@ frame_needed = 0, uses_anonymous_args = 0
 1962              	.LVL238:
 1963 0000 70B5     		push	{r4, r5, r6, lr}
 1964              	.LCFI13:
 1965              		.cfi_def_cfa_offset 16
 1966              		.cfi_offset 4, -16
 1967              		.cfi_offset 5, -12
 1968              		.cfi_offset 6, -8
 1969              		.cfi_offset 14, -4
 1970              	.LVL239:
 623:lib/ff/sdio_stm32f1.c ****   cardinfo->CardType = (uint8_t)CardType;
 1971              		.loc 1 623 0
 1972 0002 9E4B     		ldr	r3, .L174
 1973 0004 1D68     		ldr	r5, [r3, #0]
 1974 0006 80F85650 		strb	r5, [r0, #86]
 624:lib/ff/sdio_stm32f1.c ****   cardinfo->RCA = (uint16_t)RCA;
 1975              		.loc 1 624 0
 1976 000a 9D49     		ldr	r1, .L174+4
 1977 000c 0A68     		ldr	r2, [r1, #0]
 1978 000e A0F85420 		strh	r2, [r0, #84]	@ movhi
 627:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CSD_Tab[0] & 0xFF000000) >> 24);
 1979              		.loc 1 627 0
 1980 0012 9C4C     		ldr	r4, .L174+8
 1981 0014 2668     		ldr	r6, [r4, #0]
 1982 0016 330E     		lsrs	r3, r6, #24
 1983              	.LVL240:
 628:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.CSDStruct = (tmp & 0xC0) >> 6;
 1984              		.loc 1 628 0
 1985 0018 9909     		lsrs	r1, r3, #6
 1986 001a 0170     		strb	r1, [r0, #0]
 629:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.SysSpecVersion = (tmp & 0x3C) >> 2;
 1987              		.loc 1 629 0
 1988 001c C3F38302 		ubfx	r2, r3, #2, #4
 1989 0020 4270     		strb	r2, [r0, #1]
 630:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.Reserved1 = tmp & 0x03;
 1990              		.loc 1 630 0
 1991 0022 03F00303 		and	r3, r3, #3
 1992              	.LVL241:
 1993 0026 8370     		strb	r3, [r0, #2]
 633:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CSD_Tab[0] & 0x00FF0000) >> 16);
 1994              		.loc 1 633 0
 1995 0028 C6F30741 		ubfx	r1, r6, #16, #8
 1996              	.LVL242:
 634:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.TAAC = tmp;
 1997              		.loc 1 634 0
 1998 002c C170     		strb	r1, [r0, #3]
 637:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CSD_Tab[0] & 0x0000FF00) >> 8);
 1999              		.loc 1 637 0
 2000 002e C6F30722 		ubfx	r2, r6, #8, #8
 2001              	.LVL243:
 638:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.NSAC = tmp;
 2002              		.loc 1 638 0
 2003 0032 0271     		strb	r2, [r0, #4]
 641:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)(CSD_Tab[0] & 0x000000FF);
 2004              		.loc 1 641 0
 2005 0034 F6B2     		uxtb	r6, r6
 2006              	.LVL244:
 642:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.MaxBusClkFrec = tmp;
 2007              		.loc 1 642 0
 2008 0036 4671     		strb	r6, [r0, #5]
 645:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CSD_Tab[1] & 0xFF000000) >> 24);
 2009              		.loc 1 645 0
 2010 0038 6368     		ldr	r3, [r4, #4]
 2011              	.LVL245:
 646:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.CardComdClasses = tmp << 4;
 2012              		.loc 1 646 0
 2013 003a 190E     		lsrs	r1, r3, #24
 2014 003c 0A01     		lsls	r2, r1, #4
 2015 003e C280     		strh	r2, [r0, #6]	@ movhi
 649:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CSD_Tab[1] & 0x00FF0000) >> 16);
 2016              		.loc 1 649 0
 2017 0040 C3F30746 		ubfx	r6, r3, #16, #8
 2018              	.LVL246:
 650:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.CardComdClasses |= (tmp & 0xF0) >> 4;
 2019              		.loc 1 650 0
 2020 0044 C188     		ldrh	r1, [r0, #6]
 2021 0046 8AB2     		uxth	r2, r1
 2022 0048 42EA1611 		orr	r1, r2, r6, lsr #4
 2023 004c C180     		strh	r1, [r0, #6]	@ movhi
 651:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.RdBlockLen = tmp & 0x0F;
 2024              		.loc 1 651 0
 2025 004e 06F00F06 		and	r6, r6, #15
 2026              	.LVL247:
 2027 0052 0672     		strb	r6, [r0, #8]
 654:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CSD_Tab[1] & 0x0000FF00) >> 8);
 2028              		.loc 1 654 0
 2029 0054 C3F30722 		ubfx	r2, r3, #8, #8
 2030 0058 D1B2     		uxtb	r1, r2
 2031              	.LVL248:
 655:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.PartBlockRead = (tmp & 0x80) >> 7;
 2032              		.loc 1 655 0
 2033 005a CE09     		lsrs	r6, r1, #7
 2034 005c 4672     		strb	r6, [r0, #9]
 656:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.WrBlockMisalign = (tmp & 0x40) >> 6;
 2035              		.loc 1 656 0
 2036 005e C2F38016 		ubfx	r6, r2, #6, #1
 2037 0062 8672     		strb	r6, [r0, #10]
 657:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.RdBlockMisalign = (tmp & 0x20) >> 5;
 2038              		.loc 1 657 0
 2039 0064 C2F34016 		ubfx	r6, r2, #5, #1
 2040 0068 C672     		strb	r6, [r0, #11]
 658:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.DSRImpl = (tmp & 0x10) >> 4;
 2041              		.loc 1 658 0
 2042 006a C2F30016 		ubfx	r6, r2, #4, #1
 2043 006e 0673     		strb	r6, [r0, #12]
 659:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.Reserved2 = 0; /*!< Reserved */
 2044              		.loc 1 659 0
 2045 0070 0026     		movs	r6, #0
 2046 0072 4673     		strb	r6, [r0, #13]
 661:lib/ff/sdio_stm32f1.c ****   if ((CardType == SDIO_STD_CAPACITY_SD_CARD_V1_1) || (CardType == SDIO_STD_CAPACITY_SD_CARD_V2_0))
 2047              		.loc 1 661 0
 2048 0074 012D     		cmp	r5, #1
 2049 0076 3CD8     		bhi	.L172
 663:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.DeviceSize = (tmp & 0x03) << 10;
 2050              		.loc 1 663 0
 2051 0078 02F00306 		and	r6, r2, #3
 2052 007c B102     		lsls	r1, r6, #10
 2053 007e 0161     		str	r1, [r0, #16]
 2054              	.LVL249:
 667:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.DeviceSize |= (tmp) << 2;
 2055              		.loc 1 667 0
 2056 0080 0569     		ldr	r5, [r0, #16]
3120:lib/ff/sdio_stm32f1.c **** 
3121:lib/ff/sdio_stm32f1.c **** 
3122:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
3123:lib/ff/sdio_stm32f1.c **** /*! 
3124:lib/ff/sdio_stm32f1.c **** 	@brief  Returns the DMA End Of Transfer Status.
3125:lib/ff/sdio_stm32f1.c **** 	@param  None
3126:lib/ff/sdio_stm32f1.c **** 	@retval DMA SDIO Channel Status.
3127:lib/ff/sdio_stm32f1.c **** */
3128:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
3129:lib/ff/sdio_stm32f1.c **** uint32_t SD_DMAEndOfTransferStatus(void)
3130:lib/ff/sdio_stm32f1.c **** {
3131:lib/ff/sdio_stm32f1.c ****   return (uint32_t)DMA_GetFlagStatus(DMA2_FLAG_TC4);
3132:lib/ff/sdio_stm32f1.c **** }
3133:lib/ff/sdio_stm32f1.c **** 
3134:lib/ff/sdio_stm32f1.c **** 
3135:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
3136:lib/ff/sdio_stm32f1.c **** /*! 
3137:lib/ff/sdio_stm32f1.c ****     @brief	Handles SDIO interrupts requests.
3138:lib/ff/sdio_stm32f1.c **** 	@param	None.
3139:lib/ff/sdio_stm32f1.c ****     @retval	None.
3140:lib/ff/sdio_stm32f1.c **** */
3141:lib/ff/sdio_stm32f1.c **** /**************************************************************************/
3142:lib/ff/sdio_stm32f1.c **** void SDIO_IRQHandler(void)
3143:lib/ff/sdio_stm32f1.c **** {
3144:lib/ff/sdio_stm32f1.c ****   /* Process All SDIO Interrupt Sources */
3145:lib/ff/sdio_stm32f1.c ****   SD_ProcessIRQSrc();
3146:lib/ff/sdio_stm32f1.c **** }
3147:lib/ff/sdio_stm32f1.c **** 
3148:lib/ff/sdio_stm32f1.c **** /**
3149:lib/ff/sdio_stm32f1.c ****   * @brief  Enables wide bus opeartion for the requeseted card if supported by 
3150:lib/ff/sdio_stm32f1.c ****   *         card.
3151:lib/ff/sdio_stm32f1.c ****   * @param  WideMode: Specifies the SD card wide bus mode. 
3152:lib/ff/sdio_stm32f1.c ****   *   This parameter can be one of the following values:
3153:lib/ff/sdio_stm32f1.c ****   *     @arg SDIO_BusWide_8b: 8-bit data transfer (Only for MMC)
3154:lib/ff/sdio_stm32f1.c ****   *     @arg SDIO_BusWide_4b: 4-bit data transfer
3155:lib/ff/sdio_stm32f1.c ****   *     @arg SDIO_BusWide_1b: 1-bit data transfer
3156:lib/ff/sdio_stm32f1.c ****   * @retval SD_Error: SD Card Error code.
3157:lib/ff/sdio_stm32f1.c ****   */
3158:lib/ff/sdio_stm32f1.c **** SD_Error SD_GetCardStatus(SD_CardStatus *cardstatus)
3159:lib/ff/sdio_stm32f1.c **** {
3160:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
3161:lib/ff/sdio_stm32f1.c ****   uint8_t tmp = 0;
3162:lib/ff/sdio_stm32f1.c **** 
3163:lib/ff/sdio_stm32f1.c ****   errorstatus = SD_SendSDStatus((uint32_t *)SDSTATUS_Tab);
3164:lib/ff/sdio_stm32f1.c **** 
3165:lib/ff/sdio_stm32f1.c ****   if (errorstatus  != SD_OK)
3166:lib/ff/sdio_stm32f1.c ****   {
3167:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
3168:lib/ff/sdio_stm32f1.c ****   }
3169:lib/ff/sdio_stm32f1.c **** 
3170:lib/ff/sdio_stm32f1.c ****   /*!< Byte 0 */
3171:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((SDSTATUS_Tab[0] & 0xC0) >> 6);
3172:lib/ff/sdio_stm32f1.c ****   cardstatus->DAT_BUS_WIDTH = tmp;
3173:lib/ff/sdio_stm32f1.c **** 
3174:lib/ff/sdio_stm32f1.c ****   /*!< Byte 0 */
3175:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((SDSTATUS_Tab[0] & 0x20) >> 5);
3176:lib/ff/sdio_stm32f1.c ****   cardstatus->SECURED_MODE = tmp;
3177:lib/ff/sdio_stm32f1.c **** 
3178:lib/ff/sdio_stm32f1.c ****   /*!< Byte 2 */
3179:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((SDSTATUS_Tab[2] & 0xFF));
3180:lib/ff/sdio_stm32f1.c ****   cardstatus->SD_CARD_TYPE = tmp << 8;
3181:lib/ff/sdio_stm32f1.c **** 
3182:lib/ff/sdio_stm32f1.c ****   /*!< Byte 3 */
3183:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((SDSTATUS_Tab[3] & 0xFF));
3184:lib/ff/sdio_stm32f1.c ****   cardstatus->SD_CARD_TYPE |= tmp;
3185:lib/ff/sdio_stm32f1.c **** 
3186:lib/ff/sdio_stm32f1.c ****   /*!< Byte 4 */
3187:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)(SDSTATUS_Tab[4] & 0xFF);
3188:lib/ff/sdio_stm32f1.c ****   cardstatus->SIZE_OF_PROTECTED_AREA = tmp << 24;
3189:lib/ff/sdio_stm32f1.c **** 
3190:lib/ff/sdio_stm32f1.c ****   /*!< Byte 5 */
3191:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)(SDSTATUS_Tab[5] & 0xFF);
3192:lib/ff/sdio_stm32f1.c ****   cardstatus->SIZE_OF_PROTECTED_AREA |= tmp << 16;
3193:lib/ff/sdio_stm32f1.c **** 
3194:lib/ff/sdio_stm32f1.c ****   /*!< Byte 6 */
3195:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)(SDSTATUS_Tab[6] & 0xFF);
3196:lib/ff/sdio_stm32f1.c ****   cardstatus->SIZE_OF_PROTECTED_AREA |= tmp << 8;
3197:lib/ff/sdio_stm32f1.c **** 
3198:lib/ff/sdio_stm32f1.c ****   /*!< Byte 7 */
3199:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)(SDSTATUS_Tab[7] & 0xFF);
3200:lib/ff/sdio_stm32f1.c ****   cardstatus->SIZE_OF_PROTECTED_AREA |= tmp;
3201:lib/ff/sdio_stm32f1.c **** 
3202:lib/ff/sdio_stm32f1.c ****   /*!< Byte 8 */
3203:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((SDSTATUS_Tab[8] & 0xFF));
3204:lib/ff/sdio_stm32f1.c ****   cardstatus->SPEED_CLASS = tmp;
3205:lib/ff/sdio_stm32f1.c **** 
3206:lib/ff/sdio_stm32f1.c ****   /*!< Byte 9 */
3207:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((SDSTATUS_Tab[9] & 0xFF));
3208:lib/ff/sdio_stm32f1.c ****   cardstatus->PERFORMANCE_MOVE = tmp;
3209:lib/ff/sdio_stm32f1.c **** 
3210:lib/ff/sdio_stm32f1.c ****   /*!< Byte 10 */
3211:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((SDSTATUS_Tab[10] & 0xF0) >> 4);
3212:lib/ff/sdio_stm32f1.c ****   cardstatus->AU_SIZE = tmp;
3213:lib/ff/sdio_stm32f1.c **** 
3214:lib/ff/sdio_stm32f1.c ****   /*!< Byte 11 */
3215:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)(SDSTATUS_Tab[11] & 0xFF);
3216:lib/ff/sdio_stm32f1.c ****   cardstatus->ERASE_SIZE = tmp << 8;
3217:lib/ff/sdio_stm32f1.c **** 
3218:lib/ff/sdio_stm32f1.c ****   /*!< Byte 12 */
3219:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)(SDSTATUS_Tab[12] & 0xFF);
3220:lib/ff/sdio_stm32f1.c ****   cardstatus->ERASE_SIZE |= tmp;
3221:lib/ff/sdio_stm32f1.c **** 
3222:lib/ff/sdio_stm32f1.c ****   /*!< Byte 13 */
3223:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((SDSTATUS_Tab[13] & 0xFC) >> 2);
3224:lib/ff/sdio_stm32f1.c ****   cardstatus->ERASE_TIMEOUT = tmp;
3225:lib/ff/sdio_stm32f1.c **** 
3226:lib/ff/sdio_stm32f1.c ****   /*!< Byte 13 */
3227:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((SDSTATUS_Tab[13] & 0x3));
3228:lib/ff/sdio_stm32f1.c ****   cardstatus->ERASE_OFFSET = tmp;
3229:lib/ff/sdio_stm32f1.c ****  
3230:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
3231:lib/ff/sdio_stm32f1.c **** }
 2057              		.loc 1 3231 0
 2058 0082 DBB2     		uxtb	r3, r3
 2059              	.LVL250:
 667:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.DeviceSize |= (tmp) << 2;
 2060              		.loc 1 667 0
 2061 0084 45EA8302 		orr	r2, r5, r3, lsl #2
 2062 0088 0261     		str	r2, [r0, #16]
 670:lib/ff/sdio_stm32f1.c ****     tmp = (uint8_t)((CSD_Tab[2] & 0xFF000000) >> 24);
 2063              		.loc 1 670 0
 2064 008a A468     		ldr	r4, [r4, #8]
 2065 008c 260E     		lsrs	r6, r4, #24
 2066              	.LVL251:
 671:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.DeviceSize |= (tmp & 0xC0) >> 6;
 2067              		.loc 1 671 0
 2068 008e 0169     		ldr	r1, [r0, #16]
 2069 0090 41EA9615 		orr	r5, r1, r6, lsr #6
 2070 0094 0561     		str	r5, [r0, #16]
 673:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.MaxRdCurrentVDDMin = (tmp & 0x38) >> 3;
 2071              		.loc 1 673 0
 2072 0096 C6F3C203 		ubfx	r3, r6, #3, #3
 2073 009a 0375     		strb	r3, [r0, #20]
 674:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.MaxRdCurrentVDDMax = (tmp & 0x07);
 2074              		.loc 1 674 0
 2075 009c 06F00702 		and	r2, r6, #7
 2076 00a0 4275     		strb	r2, [r0, #21]
 677:lib/ff/sdio_stm32f1.c ****     tmp = (uint8_t)((CSD_Tab[2] & 0x00FF0000) >> 16);
 2077              		.loc 1 677 0
 2078 00a2 C4F30746 		ubfx	r6, r4, #16, #8
 2079              	.LVL252:
 678:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.MaxWrCurrentVDDMin = (tmp & 0xE0) >> 5;
 2080              		.loc 1 678 0
 2081 00a6 7109     		lsrs	r1, r6, #5
 2082 00a8 8175     		strb	r1, [r0, #22]
 679:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.MaxWrCurrentVDDMax = (tmp & 0x1C) >> 2;
 2083              		.loc 1 679 0
 2084 00aa C6F38205 		ubfx	r5, r6, #2, #3
 2085 00ae C575     		strb	r5, [r0, #23]
 680:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.DeviceSizeMul = (tmp & 0x03) << 1;
 2086              		.loc 1 680 0
 2087 00b0 06F00303 		and	r3, r6, #3
 2088 00b4 5A00     		lsls	r2, r3, #1
 2089 00b6 0276     		strb	r2, [r0, #24]
 682:lib/ff/sdio_stm32f1.c ****     tmp = (uint8_t)((CSD_Tab[2] & 0x0000FF00) >> 8);
 2090              		.loc 1 682 0
 2091 00b8 C4F30721 		ubfx	r1, r4, #8, #8
 2092              	.LVL253:
 683:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.DeviceSizeMul |= (tmp & 0x80) >> 7;
 2093              		.loc 1 683 0
 2094 00bc 047E     		ldrb	r4, [r0, #24]	@ zero_extendqisi2
 2095 00be 44EAD116 		orr	r6, r4, r1, lsr #7
 2096 00c2 0676     		strb	r6, [r0, #24]
 685:lib/ff/sdio_stm32f1.c ****     cardinfo->CardCapacity = (cardinfo->SD_csd.DeviceSize + 1) ;
 2097              		.loc 1 685 0
 2098 00c4 0669     		ldr	r6, [r0, #16]
 686:lib/ff/sdio_stm32f1.c ****     cardinfo->CardCapacity *= (1 << (cardinfo->SD_csd.DeviceSizeMul + 2));
 2099              		.loc 1 686 0
 2100 00c6 057E     		ldrb	r5, [r0, #24]	@ zero_extendqisi2
 687:lib/ff/sdio_stm32f1.c ****     cardinfo->CardBlockSize = 1 << (cardinfo->SD_csd.RdBlockLen);
 2101              		.loc 1 687 0
 2102 00c8 027A     		ldrb	r2, [r0, #8]	@ zero_extendqisi2
 2103 00ca 0123     		movs	r3, #1
 2104 00cc 03FA02F4 		lsl	r4, r3, r2
 2105 00d0 0465     		str	r4, [r0, #80]
 686:lib/ff/sdio_stm32f1.c ****     cardinfo->CardCapacity *= (1 << (cardinfo->SD_csd.DeviceSizeMul + 2));
 2106              		.loc 1 686 0
 2107 00d2 0235     		adds	r5, r5, #2
 2108 00d4 03FA05F2 		lsl	r2, r3, r5
 2109 00d8 D517     		asrs	r5, r2, #31
 2110 00da A2FB0423 		umull	r2, r3, r2, r4
 2111 00de 04FB0533 		mla	r3, r4, r5, r3
 685:lib/ff/sdio_stm32f1.c ****     cardinfo->CardCapacity = (cardinfo->SD_csd.DeviceSize + 1) ;
 2112              		.loc 1 685 0
 2113 00e2 0136     		adds	r6, r6, #1
 688:lib/ff/sdio_stm32f1.c ****     cardinfo->CardCapacity *= cardinfo->CardBlockSize;
 2114              		.loc 1 688 0
 2115 00e4 A2FB0645 		umull	r4, r5, r2, r6
 2116 00e8 06FB0355 		mla	r5, r6, r3, r5
 2117 00ec C0E91245 		strd	r4, [r0, #72]
 2118 00f0 1CE0     		b	.L173
 2119              	.LVL254:
 2120              	.L172:
 690:lib/ff/sdio_stm32f1.c ****   else if (CardType == SDIO_HIGH_CAPACITY_SD_CARD)
 2121              		.loc 1 690 0
 2122 00f2 022D     		cmp	r5, #2
 2123 00f4 1AD1     		bne	.L173
 2124              	.LVL255:
 694:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.DeviceSize = (tmp & 0x3F) << 16;
 2125              		.loc 1 694 0
 2126 00f6 03F03F05 		and	r5, r3, #63
 2127 00fa 2B04     		lsls	r3, r5, #16
 2128              	.LVL256:
 2129 00fc 0361     		str	r3, [r0, #16]
 697:lib/ff/sdio_stm32f1.c ****     tmp = (uint8_t)((CSD_Tab[2] & 0xFF000000) >> 24);
 2130              		.loc 1 697 0
 2131 00fe A468     		ldr	r4, [r4, #8]
 2132              	.LVL257:
 699:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.DeviceSize |= (tmp << 8);
 2133              		.loc 1 699 0
 2134 0100 0169     		ldr	r1, [r0, #16]
 2135              		.loc 1 3231 0
 2136 0102 220E     		lsrs	r2, r4, #24
 699:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.DeviceSize |= (tmp << 8);
 2137              		.loc 1 699 0
 2138 0104 41EA0225 		orr	r5, r1, r2, lsl #8
 2139 0108 0561     		str	r5, [r0, #16]
 2140              	.LVL258:
 704:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.DeviceSize |= (tmp);
 2141              		.loc 1 704 0
 2142 010a 0369     		ldr	r3, [r0, #16]
 702:lib/ff/sdio_stm32f1.c ****     tmp = (uint8_t)((CSD_Tab[2] & 0x00FF0000) >> 16);
 2143              		.loc 1 702 0
 2144 010c C4F30741 		ubfx	r1, r4, #16, #8
 704:lib/ff/sdio_stm32f1.c ****     cardinfo->SD_csd.DeviceSize |= (tmp);
 2145              		.loc 1 704 0
 2146 0110 41EA0302 		orr	r2, r1, r3
 2147 0114 0261     		str	r2, [r0, #16]
 707:lib/ff/sdio_stm32f1.c ****     tmp = (uint8_t)((CSD_Tab[2] & 0x0000FF00) >> 8);
 2148              		.loc 1 707 0
 2149 0116 C4F30721 		ubfx	r1, r4, #8, #8
 2150              	.LVL259:
 709:lib/ff/sdio_stm32f1.c ****     cardinfo->CardCapacity = (uint64_t)(cardinfo->SD_csd.DeviceSize + 1) * 512 * 1024;
 2151              		.loc 1 709 0
 2152 011a 0469     		ldr	r4, [r0, #16]
 2153 011c 651C     		adds	r5, r4, #1
 2154 011e 6B0B     		lsrs	r3, r5, #13
 2155 0120 C364     		str	r3, [r0, #76]
 2156 0122 EA04     		lsls	r2, r5, #19
 2157 0124 8264     		str	r2, [r0, #72]
 710:lib/ff/sdio_stm32f1.c ****     cardinfo->CardBlockSize = 512;    
 2158              		.loc 1 710 0
 2159 0126 4FF40074 		mov	r4, #512
 2160 012a 0465     		str	r4, [r0, #80]
 2161              	.LVL260:
 2162              	.L173:
 714:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.EraseGrSize = (tmp & 0x40) >> 6;
 2163              		.loc 1 714 0
 2164 012c C1F38014 		ubfx	r4, r1, #6, #1
 2165 0130 4476     		strb	r4, [r0, #25]
 715:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.EraseGrMul = (tmp & 0x3F) << 1;
 2166              		.loc 1 715 0
 2167 0132 01F03F01 		and	r1, r1, #63
 2168              	.LVL261:
 2169 0136 4A00     		lsls	r2, r1, #1
 2170 0138 8276     		strb	r2, [r0, #26]
 718:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)(CSD_Tab[2] & 0x000000FF);
 2171              		.loc 1 718 0
 2172 013a 524D     		ldr	r5, .L174+8
 2173 013c AB68     		ldr	r3, [r5, #8]
 2174              	.LVL262:
 719:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.EraseGrMul |= (tmp & 0x80) >> 7;
 2175              		.loc 1 719 0
 2176 013e 847E     		ldrb	r4, [r0, #26]	@ zero_extendqisi2
 2177 0140 C3F3C011 		ubfx	r1, r3, #7, #1
 2178 0144 44EA0102 		orr	r2, r4, r1
 2179 0148 8276     		strb	r2, [r0, #26]
 720:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.WrProtectGrSize = (tmp & 0x7F);
 2180              		.loc 1 720 0
 2181 014a 03F07F03 		and	r3, r3, #127
 2182              	.LVL263:
 2183 014e C376     		strb	r3, [r0, #27]
 723:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CSD_Tab[3] & 0xFF000000) >> 24);
 2184              		.loc 1 723 0
 2185 0150 ED68     		ldr	r5, [r5, #12]
 2186 0152 2C0E     		lsrs	r4, r5, #24
 2187              	.LVL264:
 724:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.WrProtectGrEnable = (tmp & 0x80) >> 7;
 2188              		.loc 1 724 0
 2189 0154 E109     		lsrs	r1, r4, #7
 2190 0156 0177     		strb	r1, [r0, #28]
 725:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.ManDeflECC = (tmp & 0x60) >> 5;
 2191              		.loc 1 725 0
 2192 0158 C4F34112 		ubfx	r2, r4, #5, #2
 2193 015c 4277     		strb	r2, [r0, #29]
 726:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.WrSpeedFact = (tmp & 0x1C) >> 2;
 2194              		.loc 1 726 0
 2195 015e C4F38203 		ubfx	r3, r4, #2, #3
 2196 0162 8377     		strb	r3, [r0, #30]
 727:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.MaxWrBlockLen = (tmp & 0x03) << 2;
 2197              		.loc 1 727 0
 2198 0164 04F00304 		and	r4, r4, #3
 2199              	.LVL265:
 2200 0168 A100     		lsls	r1, r4, #2
 2201 016a C177     		strb	r1, [r0, #31]
 730:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CSD_Tab[3] & 0x00FF0000) >> 16);
 2202              		.loc 1 730 0
 2203 016c C5F30742 		ubfx	r2, r5, #16, #8
 2204              	.LVL266:
 731:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.MaxWrBlockLen |= (tmp & 0xC0) >> 6;
 2205              		.loc 1 731 0
 2206 0170 C37F     		ldrb	r3, [r0, #31]	@ zero_extendqisi2
 2207 0172 43EA9214 		orr	r4, r3, r2, lsr #6
 2208 0176 C477     		strb	r4, [r0, #31]
 732:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.WriteBlockPaPartial = (tmp & 0x20) >> 5;
 2209              		.loc 1 732 0
 2210 0178 C2F34011 		ubfx	r1, r2, #5, #1
 2211 017c 80F82010 		strb	r1, [r0, #32]
 733:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.Reserved3 = 0;
 2212              		.loc 1 733 0
 2213 0180 0023     		movs	r3, #0
 2214 0182 80F82130 		strb	r3, [r0, #33]
 734:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.ContentProtectAppli = (tmp & 0x01);
 2215              		.loc 1 734 0
 2216 0186 02F00102 		and	r2, r2, #1
 2217              	.LVL267:
 2218 018a 80F82220 		strb	r2, [r0, #34]
 737:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CSD_Tab[3] & 0x0000FF00) >> 8);
 2219              		.loc 1 737 0
 2220 018e C5F30724 		ubfx	r4, r5, #8, #8
 2221              	.LVL268:
 738:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.FileFormatGrouop = (tmp & 0x80) >> 7;
 2222              		.loc 1 738 0
 2223 0192 E109     		lsrs	r1, r4, #7
 2224 0194 80F82310 		strb	r1, [r0, #35]
 739:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.CopyFlag = (tmp & 0x40) >> 6;
 2225              		.loc 1 739 0
 2226 0198 C4F38013 		ubfx	r3, r4, #6, #1
 2227 019c 80F82430 		strb	r3, [r0, #36]
 740:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.PermWrProtect = (tmp & 0x20) >> 5;
 2228              		.loc 1 740 0
 2229 01a0 C4F34012 		ubfx	r2, r4, #5, #1
 2230 01a4 80F82520 		strb	r2, [r0, #37]
 741:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.TempWrProtect = (tmp & 0x10) >> 4;
 2231              		.loc 1 741 0
 2232 01a8 C4F30011 		ubfx	r1, r4, #4, #1
 2233 01ac 80F82610 		strb	r1, [r0, #38]
 742:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.FileFormat = (tmp & 0x0C) >> 2;
 2234              		.loc 1 742 0
 2235 01b0 C4F38103 		ubfx	r3, r4, #2, #2
 2236 01b4 80F82730 		strb	r3, [r0, #39]
 743:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.ECC = (tmp & 0x03);
 2237              		.loc 1 743 0
 2238 01b8 04F00304 		and	r4, r4, #3
 2239              	.LVL269:
 2240 01bc 80F82840 		strb	r4, [r0, #40]
 2241              	.LVL270:
 747:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.CSD_CRC = (tmp & 0xFE) >> 1;
 2242              		.loc 1 747 0
 2243 01c0 C5F34605 		ubfx	r5, r5, #1, #7
 2244              	.LVL271:
 2245 01c4 80F82950 		strb	r5, [r0, #41]
 748:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_csd.Reserved4 = 1;
 2246              		.loc 1 748 0
 2247 01c8 0121     		movs	r1, #1
 2248 01ca 80F82A10 		strb	r1, [r0, #42]
 752:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CID_Tab[0] & 0xFF000000) >> 24);
 2249              		.loc 1 752 0
 2250 01ce 2E4B     		ldr	r3, .L174+12
 2251 01d0 1A68     		ldr	r2, [r3, #0]
 2252 01d2 140E     		lsrs	r4, r2, #24
 2253              	.LVL272:
 753:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ManufacturerID = tmp;
 2254              		.loc 1 753 0
 2255 01d4 80F82C40 		strb	r4, [r0, #44]
 2256              	.LVL273:
 756:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CID_Tab[0] & 0x00FF0000) >> 16);
 2257              		.loc 1 756 0
 2258 01d8 C2F30745 		ubfx	r5, r2, #16, #8
 757:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.OEM_AppliID = tmp << 8;
 2259              		.loc 1 757 0
 2260 01dc 2C02     		lsls	r4, r5, #8
 2261 01de C485     		strh	r4, [r0, #46]	@ movhi
 2262              	.LVL274:
 761:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.OEM_AppliID |= tmp;
 2263              		.loc 1 761 0
 2264 01e0 C58D     		ldrh	r5, [r0, #46]
 2265 01e2 ACB2     		uxth	r4, r5
 760:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CID_Tab[0] & 0x000000FF00) >> 8);
 2266              		.loc 1 760 0
 2267 01e4 C2F30725 		ubfx	r5, r2, #8, #8
 761:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.OEM_AppliID |= tmp;
 2268              		.loc 1 761 0
 2269 01e8 2C43     		orrs	r4, r4, r5
 2270 01ea C485     		strh	r4, [r0, #46]	@ movhi
 2271              	.LVL275:
 765:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdName1 = tmp << 24;
 2272              		.loc 1 765 0
 2273 01ec 1206     		lsls	r2, r2, #24
 2274              	.LVL276:
 2275 01ee 0263     		str	r2, [r0, #48]
 768:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CID_Tab[1] & 0xFF000000) >> 24);
 2276              		.loc 1 768 0
 2277 01f0 5A68     		ldr	r2, [r3, #4]
 2278              	.LVL277:
 769:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdName1 |= tmp << 16;
 2279              		.loc 1 769 0
 2280 01f2 046B     		ldr	r4, [r0, #48]
 2281              		.loc 1 3231 0
 2282 01f4 150E     		lsrs	r5, r2, #24
 769:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdName1 |= tmp << 16;
 2283              		.loc 1 769 0
 2284 01f6 44EA0544 		orr	r4, r4, r5, lsl #16
 2285 01fa 0463     		str	r4, [r0, #48]
 2286              	.LVL278:
 773:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdName1 |= tmp << 8;
 2287              		.loc 1 773 0
 2288 01fc 046B     		ldr	r4, [r0, #48]
 772:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CID_Tab[1] & 0x00FF0000) >> 16);
 2289              		.loc 1 772 0
 2290 01fe C2F30745 		ubfx	r5, r2, #16, #8
 773:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdName1 |= tmp << 8;
 2291              		.loc 1 773 0
 2292 0202 44EA0524 		orr	r4, r4, r5, lsl #8
 2293 0206 0463     		str	r4, [r0, #48]
 2294              	.LVL279:
 777:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdName1 |= tmp;
 2295              		.loc 1 777 0
 2296 0208 046B     		ldr	r4, [r0, #48]
 776:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CID_Tab[1] & 0x0000FF00) >> 8);
 2297              		.loc 1 776 0
 2298 020a C2F30725 		ubfx	r5, r2, #8, #8
 777:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdName1 |= tmp;
 2299              		.loc 1 777 0
 2300 020e 2C43     		orrs	r4, r4, r5
 2301 0210 0463     		str	r4, [r0, #48]
 780:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)(CID_Tab[1] & 0x000000FF);
 2302              		.loc 1 780 0
 2303 0212 D2B2     		uxtb	r2, r2
 2304              	.LVL280:
 781:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdName2 = tmp;
 2305              		.loc 1 781 0
 2306 0214 80F83420 		strb	r2, [r0, #52]
 784:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CID_Tab[2] & 0xFF000000) >> 24);
 2307              		.loc 1 784 0
 2308 0218 9A68     		ldr	r2, [r3, #8]
 2309              	.LVL281:
 2310 021a 150E     		lsrs	r5, r2, #24
 2311              	.LVL282:
 785:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdRev = tmp;
 2312              		.loc 1 785 0
 2313 021c 80F83550 		strb	r5, [r0, #53]
 2314              	.LVL283:
 788:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CID_Tab[2] & 0x00FF0000) >> 16);
 2315              		.loc 1 788 0
 2316 0220 C2F30744 		ubfx	r4, r2, #16, #8
 789:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdSN = tmp << 24;
 2317              		.loc 1 789 0
 2318 0224 2506     		lsls	r5, r4, #24
 2319 0226 8563     		str	r5, [r0, #56]
 2320              	.LVL284:
 793:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdSN |= tmp << 16;
 2321              		.loc 1 793 0
 2322 0228 846B     		ldr	r4, [r0, #56]
 792:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CID_Tab[2] & 0x0000FF00) >> 8);
 2323              		.loc 1 792 0
 2324 022a C2F30725 		ubfx	r5, r2, #8, #8
 793:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdSN |= tmp << 16;
 2325              		.loc 1 793 0
 2326 022e 44EA0544 		orr	r4, r4, r5, lsl #16
 2327 0232 8463     		str	r4, [r0, #56]
 2328              	.LVL285:
 797:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdSN |= tmp << 8;
 2329              		.loc 1 797 0
 2330 0234 846B     		ldr	r4, [r0, #56]
 2331              		.loc 1 3231 0
 2332 0236 D2B2     		uxtb	r2, r2
 2333              	.LVL286:
 797:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdSN |= tmp << 8;
 2334              		.loc 1 797 0
 2335 0238 44EA0224 		orr	r4, r4, r2, lsl #8
 2336 023c 8463     		str	r4, [r0, #56]
 800:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CID_Tab[3] & 0xFF000000) >> 24);
 2337              		.loc 1 800 0
 2338 023e DB68     		ldr	r3, [r3, #12]
 2339              	.LVL287:
 801:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ProdSN |= tmp;
 2340              		.loc 1 801 0
 2341 0240 826B     		ldr	r2, [r0, #56]
 2342 0242 42EA1364 		orr	r4, r2, r3, lsr #24
 2343 0246 8463     		str	r4, [r0, #56]
 804:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CID_Tab[3] & 0x00FF0000) >> 16);
 2344              		.loc 1 804 0
 2345 0248 C3F30742 		ubfx	r2, r3, #16, #8
 2346              	.LVL288:
 805:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.Reserved1 |= (tmp & 0xF0) >> 4;
 2347              		.loc 1 805 0
 2348 024c 90F83C40 		ldrb	r4, [r0, #60]	@ zero_extendqisi2
 2349 0250 44EA1214 		orr	r4, r4, r2, lsr #4
 2350 0254 80F83C40 		strb	r4, [r0, #60]
 806:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ManufactDate = (tmp & 0x0F) << 8;
 2351              		.loc 1 806 0
 2352 0258 02F00F02 		and	r2, r2, #15
 2353              	.LVL289:
 2354 025c 1402     		lsls	r4, r2, #8
 2355 025e C487     		strh	r4, [r0, #62]	@ movhi
 2356              	.LVL290:
 810:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ManufactDate |= tmp;
 2357              		.loc 1 810 0
 2358 0260 C28F     		ldrh	r2, [r0, #62]
 2359 0262 92B2     		uxth	r2, r2
 809:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((CID_Tab[3] & 0x0000FF00) >> 8);
 2360              		.loc 1 809 0
 2361 0264 C3F30724 		ubfx	r4, r3, #8, #8
 810:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.ManufactDate |= tmp;
 2362              		.loc 1 810 0
 2363 0268 2243     		orrs	r2, r2, r4
 2364 026a C287     		strh	r2, [r0, #62]	@ movhi
 2365              	.LVL291:
 814:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.CID_CRC = (tmp & 0xFE) >> 1;
 2366              		.loc 1 814 0
 2367 026c C3F34603 		ubfx	r3, r3, #1, #7
 2368              	.LVL292:
 2369 0270 80F84030 		strb	r3, [r0, #64]
 815:lib/ff/sdio_stm32f1.c ****   cardinfo->SD_cid.Reserved2 = 1;
 2370              		.loc 1 815 0
 2371 0274 80F84110 		strb	r1, [r0, #65]
 818:lib/ff/sdio_stm32f1.c **** }
 2372              		.loc 1 818 0
 2373 0278 2A20     		movs	r0, #42
 2374              	.LVL293:
 2375 027a 70BD     		pop	{r4, r5, r6, pc}
 2376              	.L175:
 2377              		.align	2
 2378              	.L174:
 2379 027c 00000000 		.word	.LANCHOR4
 2380 0280 00000000 		.word	.LANCHOR1
 2381 0284 00000000 		.word	.LANCHOR6
 2382 0288 00000000 		.word	.LANCHOR5
 2383              		.cfi_endproc
 2384              	.LFE64:
 2386              		.section	.text.SD_EnableWideBusOperation,"ax",%progbits
 2387              		.align	1
 2388              		.global	SD_EnableWideBusOperation
 2389              		.thumb
 2390              		.thumb_func
 2392              	SD_EnableWideBusOperation:
 2393              	.LFB65:
 834:lib/ff/sdio_stm32f1.c **** {
 2394              		.loc 1 834 0
 2395              		.cfi_startproc
 2396              		@ args = 0, pretend = 0, frame = 0
 2397              		@ frame_needed = 0, uses_anonymous_args = 0
 2398              	.LVL294:
 2399 0000 38B5     		push	{r3, r4, r5, lr}
 2400              	.LCFI14:
 2401              		.cfi_def_cfa_offset 16
 2402              		.cfi_offset 3, -16
 2403              		.cfi_offset 4, -12
 2404              		.cfi_offset 5, -8
 2405              		.cfi_offset 14, -4
 2406 0002 0546     		mov	r5, r0
 2407              	.LVL295:
 838:lib/ff/sdio_stm32f1.c ****   if (SDIO_MULTIMEDIA_CARD == CardType)
 2408              		.loc 1 838 0
 2409 0004 194B     		ldr	r3, .L183
 2410 0006 1868     		ldr	r0, [r3, #0]
 2411              	.LVL296:
 2412 0008 0328     		cmp	r0, #3
 2413 000a 2BD0     		beq	.L181
 843:lib/ff/sdio_stm32f1.c ****   else if ((SDIO_STD_CAPACITY_SD_CARD_V1_1 == CardType) || (SDIO_STD_CAPACITY_SD_CARD_V2_0 == CardT
 2414              		.loc 1 843 0
 2415 000c 0228     		cmp	r0, #2
 2416 000e 27D8     		bhi	.L180
 845:lib/ff/sdio_stm32f1.c ****     if (SDIO_BusWide_8b == WideMode)
 2417              		.loc 1 845 0
 2418 0010 B5F5805F 		cmp	r5, #4096
 2419 0014 26D0     		beq	.L181
 850:lib/ff/sdio_stm32f1.c ****     else if (SDIO_BusWide_4b == WideMode)
 2420              		.loc 1 850 0
 2421 0016 B5F5006F 		cmp	r5, #2048
 2422 001a 0FD1     		bne	.L178
 852:lib/ff/sdio_stm32f1.c ****       errorstatus = SDEnWideBus(ENABLE);
 2423              		.loc 1 852 0
 2424 001c 0120     		movs	r0, #1
 2425 001e FFF7FEFF 		bl	SDEnWideBus
 2426              	.LVL297:
 2427 0022 0446     		mov	r4, r0
 2428              	.LVL298:
 854:lib/ff/sdio_stm32f1.c ****       if (SD_OK == errorstatus)
 2429              		.loc 1 854 0
 2430 0024 2A28     		cmp	r0, #42
 2431 0026 1ED1     		bne	.L177
 857:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_ClockDiv = SDIO_TRANSFER_CLK_DIV; 
 2432              		.loc 1 857 0
 2433 0028 1148     		ldr	r0, .L183+4
 2434              	.LVL299:
 2435 002a 0123     		movs	r3, #1
 2436 002c 0375     		strb	r3, [r0, #20]
 858:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_ClockEdge = SDIO_ClockEdge_Rising;
 2437              		.loc 1 858 0
 2438 002e 0021     		movs	r1, #0
 2439 0030 0160     		str	r1, [r0, #0]
 859:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_ClockBypass = SDIO_ClockBypass_Disable;
 2440              		.loc 1 859 0
 2441 0032 4160     		str	r1, [r0, #4]
 860:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_ClockPowerSave = SDIO_ClockPowerSave_Disable;
 2442              		.loc 1 860 0
 2443 0034 8160     		str	r1, [r0, #8]
 861:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_BusWide = SDIO_BusWide_4b;
 2444              		.loc 1 861 0
 2445 0036 C560     		str	r5, [r0, #12]
 862:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_HardwareFlowControl = SDIO_HardwareFlowControl_Disable;
 2446              		.loc 1 862 0
 2447 0038 0161     		str	r1, [r0, #16]
 2448 003a 0EE0     		b	.L182
 2449              	.LVL300:
 2450              	.L178:
 868:lib/ff/sdio_stm32f1.c ****       errorstatus = SDEnWideBus(DISABLE);
 2451              		.loc 1 868 0
 2452 003c 0020     		movs	r0, #0
 2453 003e FFF7FEFF 		bl	SDEnWideBus
 2454              	.LVL301:
 2455 0042 0446     		mov	r4, r0
 2456              	.LVL302:
 870:lib/ff/sdio_stm32f1.c ****       if (SD_OK == errorstatus)
 2457              		.loc 1 870 0
 2458 0044 2A28     		cmp	r0, #42
 2459 0046 0ED1     		bne	.L177
 873:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_ClockDiv = SDIO_TRANSFER_CLK_DIV; 
 2460              		.loc 1 873 0
 2461 0048 0948     		ldr	r0, .L183+4
 2462              	.LVL303:
 2463 004a 0121     		movs	r1, #1
 2464 004c 0175     		strb	r1, [r0, #20]
 874:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_ClockEdge = SDIO_ClockEdge_Rising;
 2465              		.loc 1 874 0
 2466 004e 0022     		movs	r2, #0
 2467 0050 0260     		str	r2, [r0, #0]
 875:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_ClockBypass = SDIO_ClockBypass_Disable;
 2468              		.loc 1 875 0
 2469 0052 4260     		str	r2, [r0, #4]
 876:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_ClockPowerSave = SDIO_ClockPowerSave_Disable;
 2470              		.loc 1 876 0
 2471 0054 8260     		str	r2, [r0, #8]
 877:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_BusWide = SDIO_BusWide_1b;
 2472              		.loc 1 877 0
 2473 0056 C260     		str	r2, [r0, #12]
 878:lib/ff/sdio_stm32f1.c ****         SDIO_InitStructure.SDIO_HardwareFlowControl = SDIO_HardwareFlowControl_Disable;
 2474              		.loc 1 878 0
 2475 0058 0261     		str	r2, [r0, #16]
 2476              	.LVL304:
 2477              	.L182:
 879:lib/ff/sdio_stm32f1.c ****         SDIO_Init(&SDIO_InitStructure);
 2478              		.loc 1 879 0
 2479 005a FFF7FEFF 		bl	SDIO_Init
 2480              	.LVL305:
 2481 005e 02E0     		b	.L177
 2482              	.LVL306:
 2483              	.L180:
 835:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
 2484              		.loc 1 835 0
 2485 0060 2A24     		movs	r4, #42
 2486 0062 00E0     		b	.L177
 2487              	.L181:
 841:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 2488              		.loc 1 841 0
 2489 0064 2724     		movs	r4, #39
 2490              	.LVL307:
 2491              	.L177:
 885:lib/ff/sdio_stm32f1.c **** }
 2492              		.loc 1 885 0
 2493 0066 2046     		mov	r0, r4
 2494 0068 38BD     		pop	{r3, r4, r5, pc}
 2495              	.L184:
 2496 006a 00BF     		.align	2
 2497              	.L183:
 2498 006c 00000000 		.word	.LANCHOR4
 2499 0070 00000000 		.word	.LANCHOR3
 2500              		.cfi_endproc
 2501              	.LFE65:
 2503              		.section	.text.SD_SetDeviceMode,"ax",%progbits
 2504              		.align	1
 2505              		.global	SD_SetDeviceMode
 2506              		.thumb
 2507              		.thumb_func
 2509              	SD_SetDeviceMode:
 2510              	.LFB66:
 900:lib/ff/sdio_stm32f1.c **** {
 2511              		.loc 1 900 0
 2512              		.cfi_startproc
 2513              		@ args = 0, pretend = 0, frame = 0
 2514              		@ frame_needed = 0, uses_anonymous_args = 0
 2515              		@ link register save eliminated.
 2516              	.LVL308:
 2517              	.LVL309:
 903:lib/ff/sdio_stm32f1.c ****   if ((Mode == SD_DMA_MODE) || (Mode == SD_INTERRUPT_MODE) || (Mode == SD_POLLING_MODE))
 2518              		.loc 1 903 0
 2519 0000 0228     		cmp	r0, #2
 2520 0002 03D8     		bhi	.L187
 905:lib/ff/sdio_stm32f1.c ****     DeviceMode = Mode;
 2521              		.loc 1 905 0
 2522 0004 024B     		ldr	r3, .L188
 2523 0006 1860     		str	r0, [r3, #0]
 901:lib/ff/sdio_stm32f1.c ****   SD_Error errorstatus = SD_OK;
 2524              		.loc 1 901 0
 2525 0008 2A20     		movs	r0, #42
 2526              	.LVL310:
 2527 000a 7047     		bx	lr
 2528              	.LVL311:
 2529              	.L187:
 909:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_INVALID_PARAMETER;
 2530              		.loc 1 909 0
 2531 000c 2620     		movs	r0, #38
 2532              	.LVL312:
 913:lib/ff/sdio_stm32f1.c **** }
 2533              		.loc 1 913 0
 2534 000e 7047     		bx	lr
 2535              	.L189:
 2536              		.align	2
 2537              	.L188:
 2538 0010 00000000 		.word	.LANCHOR7
 2539              		.cfi_endproc
 2540              	.LFE66:
 2542              		.section	.text.SD_SelectDeselect,"ax",%progbits
 2543              		.align	1
 2544              		.global	SD_SelectDeselect
 2545              		.thumb
 2546              		.thumb_func
 2548              	SD_SelectDeselect:
 2549              	.LFB67:
 924:lib/ff/sdio_stm32f1.c **** {
 2550              		.loc 1 924 0
 2551              		.cfi_startproc
 2552              		@ args = 0, pretend = 0, frame = 0
 2553              		@ frame_needed = 0, uses_anonymous_args = 0
 2554              	.LVL313:
 2555 0000 10B5     		push	{r4, lr}
 2556              	.LCFI15:
 2557              		.cfi_def_cfa_offset 8
 2558              		.cfi_offset 4, -8
 2559              		.cfi_offset 14, -4
 2560              	.LVL314:
 928:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument =  addr;
 2561              		.loc 1 928 0
 2562 0002 094B     		ldr	r3, .L191
 2563 0004 1860     		str	r0, [r3, #0]
 929:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SEL_DESEL_CARD;
 2564              		.loc 1 929 0
 2565 0006 0724     		movs	r4, #7
 2566 0008 5C60     		str	r4, [r3, #4]
 930:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 2567              		.loc 1 930 0
 2568 000a 4022     		movs	r2, #64
 2569 000c 9A60     		str	r2, [r3, #8]
 931:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 2570              		.loc 1 931 0
 2571 000e 0020     		movs	r0, #0
 2572              	.LVL315:
 2573 0010 D860     		str	r0, [r3, #12]
 932:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 2574              		.loc 1 932 0
 2575 0012 4FF48061 		mov	r1, #1024
 2576 0016 1961     		str	r1, [r3, #16]
 933:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 2577              		.loc 1 933 0
 2578 0018 1846     		mov	r0, r3
 2579 001a FFF7FEFF 		bl	SDIO_SendCommand
 2580              	.LVL316:
 935:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_SEL_DESEL_CARD);
 2581              		.loc 1 935 0
 2582 001e 2046     		mov	r0, r4
 938:lib/ff/sdio_stm32f1.c **** }
 2583              		.loc 1 938 0
 2584 0020 BDE81040 		pop	{r4, lr}
 935:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_SEL_DESEL_CARD);
 2585              		.loc 1 935 0
 2586 0024 FFF7FEBF 		b	CmdResp1Error
 2587              	.LVL317:
 2588              	.L192:
 2589              		.align	2
 2590              	.L191:
 2591 0028 00000000 		.word	.LANCHOR0
 2592              		.cfi_endproc
 2593              	.LFE67:
 2595              		.section	.text.SD_Init,"ax",%progbits
 2596              		.align	1
 2597              		.global	SD_Init
 2598              		.thumb
 2599              		.thumb_func
 2601              	SD_Init:
 2602              	.LFB57:
 176:lib/ff/sdio_stm32f1.c **** {
 2603              		.loc 1 176 0
 2604              		.cfi_startproc
 2605              		@ args = 0, pretend = 0, frame = 8
 2606              		@ frame_needed = 0, uses_anonymous_args = 0
 2607 0000 73B5     		push	{r0, r1, r4, r5, r6, lr}
 2608              	.LCFI16:
 2609              		.cfi_def_cfa_offset 24
 2610              		.cfi_offset 0, -24
 2611              		.cfi_offset 1, -20
 2612              		.cfi_offset 4, -16
 2613              		.cfi_offset 5, -12
 2614              		.cfi_offset 6, -8
 2615              		.cfi_offset 14, -4
 2616              	.LVL318:
 183:lib/ff/sdio_stm32f1.c ****   RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOC | RCC_APB2Periph_GPIOD | SD_DETECT_GPIO_CLK, ENABLE);
 2617              		.loc 1 183 0
 2618 0002 B020     		movs	r0, #176
 2619 0004 0121     		movs	r1, #1
 2620 0006 FFF7FEFF 		bl	RCC_APB2PeriphClockCmd
 2621              	.LVL319:
 186:lib/ff/sdio_stm32f1.c ****   GPIO_InitStructure.GPIO_Pin = GPIO_Pin_8 | GPIO_Pin_9 | GPIO_Pin_10 | GPIO_Pin_11 | GPIO_Pin_12;
 2622              		.loc 1 186 0
 2623 000a 4FF4F853 		mov	r3, #7936
 2624 000e ADF80030 		strh	r3, [sp, #0]	@ movhi
 187:lib/ff/sdio_stm32f1.c ****   GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;
 2625              		.loc 1 187 0
 2626 0012 0320     		movs	r0, #3
 2627 0014 8DF80200 		strb	r0, [sp, #2]
 188:lib/ff/sdio_stm32f1.c ****   GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF_PP;
 2628              		.loc 1 188 0
 2629 0018 1821     		movs	r1, #24
 2630 001a 8DF80310 		strb	r1, [sp, #3]
 189:lib/ff/sdio_stm32f1.c ****   GPIO_Init(GPIOC, &GPIO_InitStructure);
 2631              		.loc 1 189 0
 2632 001e 2A48     		ldr	r0, .L196
 2633 0020 6946     		mov	r1, sp
 2634 0022 FFF7FEFF 		bl	GPIO_Init
 2635              	.LVL320:
 192:lib/ff/sdio_stm32f1.c ****   GPIO_InitStructure.GPIO_Pin = GPIO_Pin_2;
 2636              		.loc 1 192 0
 2637 0026 0422     		movs	r2, #4
 2638 0028 ADF80020 		strh	r2, [sp, #0]	@ movhi
 193:lib/ff/sdio_stm32f1.c ****   GPIO_Init(GPIOD, &GPIO_InitStructure);
 2639              		.loc 1 193 0
 2640 002c 2748     		ldr	r0, .L196+4
 2641 002e 6946     		mov	r1, sp
 2642 0030 FFF7FEFF 		bl	GPIO_Init
 2643              	.LVL321:
 196:lib/ff/sdio_stm32f1.c ****   GPIO_InitStructure.GPIO_Pin = SD_DETECT_PIN;
 2644              		.loc 1 196 0
 2645 0034 4FF40065 		mov	r5, #2048
 2646 0038 ADF80050 		strh	r5, [sp, #0]	@ movhi
 197:lib/ff/sdio_stm32f1.c ****   GPIO_InitStructure.GPIO_Mode = GPIO_Mode_IPU;
 2647              		.loc 1 197 0
 2648 003c 4823     		movs	r3, #72
 2649 003e 8DF80330 		strb	r3, [sp, #3]
 198:lib/ff/sdio_stm32f1.c ****   GPIO_Init(SD_DETECT_GPIO_PORT, &GPIO_InitStructure);
 2650              		.loc 1 198 0
 2651 0042 2348     		ldr	r0, .L196+8
 2652 0044 6946     		mov	r1, sp
 2653 0046 FFF7FEFF 		bl	GPIO_Init
 2654              	.LVL322:
 201:lib/ff/sdio_stm32f1.c ****   RCC_AHBPeriphClockCmd(RCC_AHBPeriph_SDIO, ENABLE);
 2655              		.loc 1 201 0
 2656 004a 4FF48060 		mov	r0, #1024
 2657 004e 0121     		movs	r1, #1
 2658 0050 FFF7FEFF 		bl	RCC_AHBPeriphClockCmd
 2659              	.LVL323:
 204:lib/ff/sdio_stm32f1.c ****   RCC_AHBPeriphClockCmd(RCC_AHBPeriph_DMA2, ENABLE);
 2660              		.loc 1 204 0
 2661 0054 0220     		movs	r0, #2
 2662 0056 0121     		movs	r1, #1
 2663 0058 FFF7FEFF 		bl	RCC_AHBPeriphClockCmd
 2664              	.LVL324:
 208:lib/ff/sdio_stm32f1.c ****   SDIO_DeInit();
 2665              		.loc 1 208 0
 2666 005c FFF7FEFF 		bl	SDIO_DeInit
 2667              	.LVL325:
 210:lib/ff/sdio_stm32f1.c ****   errorstatus = SD_PowerON();
 2668              		.loc 1 210 0
 2669 0060 FFF7FEFF 		bl	SD_PowerON
 2670              	.LVL326:
 212:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
 2671              		.loc 1 212 0
 2672 0064 2A28     		cmp	r0, #42
 2673 0066 2ED1     		bne	.L194
 218:lib/ff/sdio_stm32f1.c ****   errorstatus = SD_InitializeCards();
 2674              		.loc 1 218 0
 2675 0068 FFF7FEFF 		bl	SD_InitializeCards
 2676              	.LVL327:
 220:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
 2677              		.loc 1 220 0
 2678 006c 2A28     		cmp	r0, #42
 2679 006e 2AD1     		bne	.L194
 228:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_ClockDiv = SDIO_TRANSFER_CLK_DIV; 
 2680              		.loc 1 228 0
 2681 0070 1848     		ldr	r0, .L196+12
 2682              	.LVL328:
 2683 0072 0126     		movs	r6, #1
 2684 0074 0675     		strb	r6, [r0, #20]
 229:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_ClockEdge = SDIO_ClockEdge_Rising;
 2685              		.loc 1 229 0
 2686 0076 0024     		movs	r4, #0
 2687 0078 0460     		str	r4, [r0, #0]
 230:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_ClockBypass = SDIO_ClockBypass_Disable;
 2688              		.loc 1 230 0
 2689 007a 4460     		str	r4, [r0, #4]
 231:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_ClockPowerSave = SDIO_ClockPowerSave_Disable;
 2690              		.loc 1 231 0
 2691 007c 8460     		str	r4, [r0, #8]
 232:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_BusWide = SDIO_BusWide_1b;
 2692              		.loc 1 232 0
 2693 007e C460     		str	r4, [r0, #12]
 233:lib/ff/sdio_stm32f1.c ****   SDIO_InitStructure.SDIO_HardwareFlowControl = SDIO_HardwareFlowControl_Disable;
 2694              		.loc 1 233 0
 2695 0080 0461     		str	r4, [r0, #16]
 234:lib/ff/sdio_stm32f1.c ****   SDIO_Init(&SDIO_InitStructure);
 2696              		.loc 1 234 0
 2697 0082 FFF7FEFF 		bl	SDIO_Init
 2698              	.LVL329:
 237:lib/ff/sdio_stm32f1.c ****   NVIC_InitStructure.NVIC_IRQChannel = SDIO_IRQn;
 2699              		.loc 1 237 0
 2700 0086 3120     		movs	r0, #49
 2701 0088 8DF80400 		strb	r0, [sp, #4]
 238:lib/ff/sdio_stm32f1.c ****   NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 0;
 2702              		.loc 1 238 0
 2703 008c 8DF80540 		strb	r4, [sp, #5]
 239:lib/ff/sdio_stm32f1.c ****   NVIC_InitStructure.NVIC_IRQChannelSubPriority = 0;
 2704              		.loc 1 239 0
 2705 0090 8DF80640 		strb	r4, [sp, #6]
 240:lib/ff/sdio_stm32f1.c ****   NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;
 2706              		.loc 1 240 0
 2707 0094 8DF80760 		strb	r6, [sp, #7]
 241:lib/ff/sdio_stm32f1.c ****   NVIC_Init(&NVIC_InitStructure);
 2708              		.loc 1 241 0
 2709 0098 01A8     		add	r0, sp, #4
 2710 009a FFF7FEFF 		bl	NVIC_Init
 2711              	.LVL330:
 246:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_GetCardInfo(&SDCardInfo);
 2712              		.loc 1 246 0
 2713 009e 0E4E     		ldr	r6, .L196+16
 2714 00a0 3046     		mov	r0, r6
 2715 00a2 FFF7FEFF 		bl	SD_GetCardInfo
 2716              	.LVL331:
 249:lib/ff/sdio_stm32f1.c ****   if (errorstatus == SD_OK)
 2717              		.loc 1 249 0
 2718 00a6 2A28     		cmp	r0, #42
 2719 00a8 0DD1     		bne	.L194
 252:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_SelectDeselect((uint32_t) (SDCardInfo.RCA << 16));
 2720              		.loc 1 252 0
 2721 00aa B6F85410 		ldrh	r1, [r6, #84]
 2722 00ae 0804     		lsls	r0, r1, #16
 2723              	.LVL332:
 2724 00b0 FFF7FEFF 		bl	SD_SelectDeselect
 2725              	.LVL333:
 255:lib/ff/sdio_stm32f1.c ****   if (errorstatus == SD_OK)
 2726              		.loc 1 255 0
 2727 00b4 2A28     		cmp	r0, #42
 2728 00b6 06D1     		bne	.L194
 257:lib/ff/sdio_stm32f1.c ****     errorstatus = SD_EnableWideBusOperation(SDIO_BusWide_4b);
 2729              		.loc 1 257 0
 2730 00b8 2846     		mov	r0, r5
 2731              	.LVL334:
 2732 00ba FFF7FEFF 		bl	SD_EnableWideBusOperation
 2733              	.LVL335:
 261:lib/ff/sdio_stm32f1.c ****   if (errorstatus == SD_OK)
 2734              		.loc 1 261 0
 2735 00be 2A28     		cmp	r0, #42
 2736              	.LVL336:
 2737              	.LBB38:
 2738              	.LBB39:
 905:lib/ff/sdio_stm32f1.c ****     DeviceMode = Mode;
 2739              		.loc 1 905 0
 2740 00c0 04BF     		itt	eq
 2741 00c2 064A     		ldreq	r2, .L196+20
 2742 00c4 1460     		streq	r4, [r2, #0]
 2743              	.LVL337:
 2744              	.L194:
 2745              	.LBE39:
 2746              	.LBE38:
 267:lib/ff/sdio_stm32f1.c **** }
 2747              		.loc 1 267 0
 2748 00c6 7CBD     		pop	{r2, r3, r4, r5, r6, pc}
 2749              	.L197:
 2750              		.align	2
 2751              	.L196:
 2752 00c8 00100140 		.word	1073811456
 2753 00cc 00140140 		.word	1073812480
 2754 00d0 001C0140 		.word	1073814528
 2755 00d4 00000000 		.word	.LANCHOR3
 2756 00d8 00000000 		.word	.LANCHOR8
 2757 00dc 00000000 		.word	.LANCHOR7
 2758              		.cfi_endproc
 2759              	.LFE57:
 2761              		.section	.text.SD_ReadBlock,"ax",%progbits
 2762              		.align	1
 2763              		.global	SD_ReadBlock
 2764              		.thumb
 2765              		.thumb_func
 2767              	SD_ReadBlock:
 2768              	.LFB68:
 951:lib/ff/sdio_stm32f1.c **** {
 2769              		.loc 1 951 0
 2770              		.cfi_startproc
 2771              		@ args = 0, pretend = 0, frame = 8
 2772              		@ frame_needed = 0, uses_anonymous_args = 0
 2773              	.LVL338:
 2774 0000 2DE9F74F 		push	{r0, r1, r2, r4, r5, r6, r7, r8, r9, sl, fp, lr}
 2775              	.LCFI17:
 2776              		.cfi_def_cfa_offset 48
 2777              		.cfi_offset 0, -48
 2778              		.cfi_offset 1, -44
 2779              		.cfi_offset 2, -40
 2780              		.cfi_offset 4, -36
 2781              		.cfi_offset 5, -32
 2782              		.cfi_offset 6, -28
 2783              		.cfi_offset 7, -24
 2784              		.cfi_offset 8, -20
 2785              		.cfi_offset 9, -16
 2786              		.cfi_offset 10, -12
 2787              		.cfi_offset 11, -8
 2788              		.cfi_offset 14, -4
 2789 0004 8946     		mov	r9, r1
 2790 0006 1646     		mov	r6, r2
 2791              	.LVL339:
 956:lib/ff/sdio_stm32f1.c ****   if (NULL == readbuff)
 2792              		.loc 1 956 0
 2793 0008 8046     		mov	r8, r0
 2794 000a 08B9     		cbnz	r0, .L199
 2795              	.LVL340:
 2796              	.L202:
 959:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 2797              		.loc 1 959 0
 2798 000c 2624     		movs	r4, #38
 2799 000e F2E0     		b	.L200
 2800              	.LVL341:
 2801              	.L199:
 962:lib/ff/sdio_stm32f1.c ****   TransferError = SD_OK;
 2802              		.loc 1 962 0
 2803 0010 2A22     		movs	r2, #42
 2804              	.LVL342:
 2805 0012 7A4B     		ldr	r3, .L249
 2806 0014 1A70     		strb	r2, [r3, #0]
 963:lib/ff/sdio_stm32f1.c ****   TransferEnd = 0;
 2807              		.loc 1 963 0
 2808 0016 0024     		movs	r4, #0
 2809 0018 7948     		ldr	r0, .L249+4
 2810              	.LVL343:
 2811 001a 0460     		str	r4, [r0, #0]
 964:lib/ff/sdio_stm32f1.c ****   TotalNumberOfBytes = 0;
 2812              		.loc 1 964 0
 2813 001c 7949     		ldr	r1, .L249+8
 2814              	.LVL344:
 2815 001e 0C60     		str	r4, [r1, #0]
 967:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataTimeOut = SD_DATATIMEOUT;
 2816              		.loc 1 967 0
 2817 0020 7948     		ldr	r0, .L249+12
 2818 0022 7A4B     		ldr	r3, .L249+16
 968:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataLength = 0;
 2819              		.loc 1 968 0
 2820 0024 80E81800 		stmia	r0, {r3, r4}
 969:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataBlockSize = SDIO_DataBlockSize_1b;
 2821              		.loc 1 969 0
 2822 0028 8460     		str	r4, [r0, #8]
 970:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToCard;
 2823              		.loc 1 970 0
 2824 002a C460     		str	r4, [r0, #12]
 971:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
 2825              		.loc 1 971 0
 2826 002c 0461     		str	r4, [r0, #16]
 972:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Disable;
 2827              		.loc 1 972 0
 2828 002e 4461     		str	r4, [r0, #20]
 973:lib/ff/sdio_stm32f1.c ****   SDIO_DataConfig(&SDIO_DataInitStructure);
 2829              		.loc 1 973 0
 2830 0030 FFF7FEFF 		bl	SDIO_DataConfig
 2831              	.LVL345:
 974:lib/ff/sdio_stm32f1.c ****   SDIO_DMACmd(DISABLE);
 2832              		.loc 1 974 0
 2833 0034 2046     		mov	r0, r4
 2834 0036 FFF7FEFF 		bl	SDIO_DMACmd
 2835              	.LVL346:
 976:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetResponse(SDIO_RESP1) & SD_CARD_LOCKED)
 2836              		.loc 1 976 0
 2837 003a 2046     		mov	r0, r4
 2838 003c FFF7FEFF 		bl	SDIO_GetResponse
 2839              	.LVL347:
 2840 0040 8301     		lsls	r3, r0, #6
 2841 0042 00F1D780 		bmi	.L223
 982:lib/ff/sdio_stm32f1.c ****   if (CardType == SDIO_HIGH_CAPACITY_SD_CARD)
 2842              		.loc 1 982 0
 2843 0046 724C     		ldr	r4, .L249+20
 2844 0048 2268     		ldr	r2, [r4, #0]
 2845 004a 022A     		cmp	r2, #2
 2846              	.LVL348:
 985:lib/ff/sdio_stm32f1.c ****     ReadAddr /= 512;
 2847              		.loc 1 985 0
 2848 004c 04BF     		itt	eq
 2849 004e 4FEA5929 		lsreq	r9, r9, #9
 2850              	.LVL349:
 984:lib/ff/sdio_stm32f1.c ****     BlockSize = 512;
 2851              		.loc 1 984 0
 2852 0052 4FF40076 		moveq	r6, #512
 2853              	.LVL350:
 987:lib/ff/sdio_stm32f1.c ****   if ((BlockSize > 0) && (BlockSize <= 2048) && ((BlockSize & (BlockSize - 1)) == 0))
 2854              		.loc 1 987 0
 2855 0056 701E     		subs	r0, r6, #1
 2856 0058 83B2     		uxth	r3, r0
 2857 005a B3F5006F 		cmp	r3, #2048
 2858 005e D5D2     		bcs	.L202
 987:lib/ff/sdio_stm32f1.c ****   if ((BlockSize > 0) && (BlockSize <= 2048) && ((BlockSize & (BlockSize - 1)) == 0))
 2859              		.loc 1 987 0 is_stmt 0 discriminator 1
 2860 0060 10EA0601 		ands	r1, r0, r6
 2861 0064 D2D1     		bne	.L202
 987:lib/ff/sdio_stm32f1.c ****   if ((BlockSize > 0) && (BlockSize <= 2048) && ((BlockSize & (BlockSize - 1)) == 0))
 2862              		.loc 1 987 0
 2863 0066 3746     		mov	r7, r6
 2864              	.L203:
 2865              	.LVL351:
 2866              	.LBB44:
 2867              	.LBB45:
3040:lib/ff/sdio_stm32f1.c ****   while (NumberOfBytes != 1)
 2868              		.loc 1 3040 0 is_stmt 1
 2869 0068 012F     		cmp	r7, #1
 2870 006a 04D0     		beq	.L246
 2871              	.L204:
3042:lib/ff/sdio_stm32f1.c ****     NumberOfBytes >>= 1;
 2872              		.loc 1 3042 0
 2873 006c C7F34F07 		ubfx	r7, r7, #1, #16
 2874              	.LVL352:
3043:lib/ff/sdio_stm32f1.c ****     count++;
 2875              		.loc 1 3043 0
 2876 0070 4D1C     		adds	r5, r1, #1
 2877 0072 E9B2     		uxtb	r1, r5
 2878              	.LVL353:
 2879 0074 F8E7     		b	.L203
 2880              	.LVL354:
 2881              	.L246:
 2882              	.LBE45:
 2883              	.LBE44:
 992:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) BlockSize;
 2884              		.loc 1 992 0
 2885 0076 674D     		ldr	r5, .L249+24
 2886 0078 2E60     		str	r6, [r5, #0]
 993:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SET_BLOCKLEN;
 2887              		.loc 1 993 0
 2888 007a 1024     		movs	r4, #16
 2889 007c 6C60     		str	r4, [r5, #4]
 994:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 2890              		.loc 1 994 0
 2891 007e 4FF0400B 		mov	fp, #64
 2892 0082 C5F808B0 		str	fp, [r5, #8]
 995:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 2893              		.loc 1 995 0
 2894 0086 4FF0000A 		mov	sl, #0
 2895 008a C5F80CA0 		str	sl, [r5, #12]
 996:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 2896              		.loc 1 996 0
 2897 008e 4FF48062 		mov	r2, #1024
 2898 0092 2A61     		str	r2, [r5, #16]
 997:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
 2899              		.loc 1 997 0
 2900 0094 2846     		mov	r0, r5
 2901 0096 0191     		str	r1, [sp, #4]
 2902 0098 FFF7FEFF 		bl	SDIO_SendCommand
 2903              	.LVL355:
 999:lib/ff/sdio_stm32f1.c ****     errorstatus = CmdResp1Error(SD_CMD_SET_BLOCKLEN);
 2904              		.loc 1 999 0
 2905 009c 2046     		mov	r0, r4
 2906 009e FFF7FEFF 		bl	CmdResp1Error
 2907              	.LVL356:
 2908 00a2 0446     		mov	r4, r0
 2909              	.LVL357:
1001:lib/ff/sdio_stm32f1.c ****     if (SD_OK != errorstatus)
 2910              		.loc 1 1001 0
 2911 00a4 2A28     		cmp	r0, #42
 2912 00a6 019B     		ldr	r3, [sp, #4]
 2913 00a8 40F0A580 		bne	.L200
1012:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataTimeOut = SD_DATATIMEOUT;
 2914              		.loc 1 1012 0
 2915 00ac 5648     		ldr	r0, .L249+12
 2916              	.LVL358:
 2917 00ae 5749     		ldr	r1, .L249+16
1013:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataLength = BlockSize;
 2918              		.loc 1 1013 0
 2919 00b0 80E84200 		stmia	r0, {r1, r6}
1014:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataBlockSize = (uint32_t) power << 4;
 2920              		.loc 1 1014 0
 2921 00b4 1901     		lsls	r1, r3, #4
 2922 00b6 8160     		str	r1, [r0, #8]
1015:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToSDIO;
 2923              		.loc 1 1015 0
 2924 00b8 0224     		movs	r4, #2
 2925              	.LVL359:
 2926 00ba C460     		str	r4, [r0, #12]
1016:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
 2927              		.loc 1 1016 0
 2928 00bc C0F810A0 		str	sl, [r0, #16]
1017:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Enable;
 2929              		.loc 1 1017 0
 2930 00c0 4761     		str	r7, [r0, #20]
1018:lib/ff/sdio_stm32f1.c ****   SDIO_DataConfig(&SDIO_DataInitStructure);
 2931              		.loc 1 1018 0
 2932 00c2 FFF7FEFF 		bl	SDIO_DataConfig
 2933              	.LVL360:
1020:lib/ff/sdio_stm32f1.c ****   TotalNumberOfBytes = BlockSize;
 2934              		.loc 1 1020 0
 2935 00c6 4F48     		ldr	r0, .L249+8
 2936 00c8 0660     		str	r6, [r0, #0]
1021:lib/ff/sdio_stm32f1.c ****   StopCondition = 0;
 2937              		.loc 1 1021 0
 2938 00ca 534A     		ldr	r2, .L249+28
 2939 00cc C2F800A0 		str	sl, [r2, #0]
1022:lib/ff/sdio_stm32f1.c ****   DestBuffer = (uint32_t *)readbuff;
 2940              		.loc 1 1022 0
 2941 00d0 524B     		ldr	r3, .L249+32
 2942 00d2 C3F80080 		str	r8, [r3, #0]
1025:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = (uint32_t)ReadAddr;
 2943              		.loc 1 1025 0
 2944 00d6 C5F80090 		str	r9, [r5, #0]
1026:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_READ_SINGLE_BLOCK;
 2945              		.loc 1 1026 0
 2946 00da 1124     		movs	r4, #17
 2947 00dc 6C60     		str	r4, [r5, #4]
1027:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 2948              		.loc 1 1027 0
 2949 00de C5F808B0 		str	fp, [r5, #8]
1028:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 2950              		.loc 1 1028 0
 2951 00e2 C5F80CA0 		str	sl, [r5, #12]
1029:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 2952              		.loc 1 1029 0
 2953 00e6 4FF48061 		mov	r1, #1024
 2954 00ea 2961     		str	r1, [r5, #16]
1030:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 2955              		.loc 1 1030 0
 2956 00ec 2846     		mov	r0, r5
 2957 00ee FFF7FEFF 		bl	SDIO_SendCommand
 2958              	.LVL361:
1032:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_READ_SINGLE_BLOCK);
 2959              		.loc 1 1032 0
 2960 00f2 2046     		mov	r0, r4
 2961 00f4 FFF7FEFF 		bl	CmdResp1Error
 2962              	.LVL362:
 2963 00f8 0446     		mov	r4, r0
 2964              	.LVL363:
1034:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
 2965              		.loc 1 1034 0
 2966 00fa 2A28     		cmp	r0, #42
 2967 00fc 7BD1     		bne	.L200
1039:lib/ff/sdio_stm32f1.c ****   if (DeviceMode == SD_POLLING_MODE)
 2968              		.loc 1 1039 0
 2969 00fe 4848     		ldr	r0, .L249+36
 2970              	.LVL364:
 2971 0100 0268     		ldr	r2, [r0, #0]
 2972 0102 022A     		cmp	r2, #2
 2973 0104 49D1     		bne	.L205
1039:lib/ff/sdio_stm32f1.c ****   if (DeviceMode == SD_POLLING_MODE)
 2974              		.loc 1 1039 0 is_stmt 0 discriminator 1
 2975 0106 4546     		mov	r5, r8
 2976              	.LVL365:
 2977              	.L242:
1042:lib/ff/sdio_stm32f1.c ****     while (!(SDIO->STA &(SDIO_FLAG_RXOVERR | SDIO_FLAG_DCRCFAIL | SDIO_FLAG_DTIMEOUT | SDIO_FLAG_DB
 2978              		.loc 1 1042 0 is_stmt 1 discriminator 1
 2979 0108 464E     		ldr	r6, .L249+40
 2980 010a 736B     		ldr	r3, [r6, #52]
 2981 010c 40F22A66 		movw	r6, #1578
 2982 0110 1E40     		ands	r6, r6, r3
 2983 0112 6EB9     		cbnz	r6, .L247
 2984              	.L209:
1044:lib/ff/sdio_stm32f1.c ****       if (SDIO_GetFlagStatus(SDIO_FLAG_RXFIFOHF) != RESET)
 2985              		.loc 1 1044 0
 2986 0114 4FF40040 		mov	r0, #32768
 2987 0118 FFF7FEFF 		bl	SDIO_GetFlagStatus
 2988              	.LVL366:
 2989 011c 0028     		cmp	r0, #0
 2990 011e F3D0     		beq	.L242
 2991              	.L208:
1048:lib/ff/sdio_stm32f1.c ****           *(tempbuff + count) = SDIO_ReadData();
 2992              		.loc 1 1048 0 discriminator 2
 2993 0120 FFF7FEFF 		bl	SDIO_ReadData
 2994              	.LVL367:
 2995 0124 A851     		str	r0, [r5, r6]
 2996 0126 0436     		adds	r6, r6, #4
1046:lib/ff/sdio_stm32f1.c ****         for (count = 0; count < 8; count++)
 2997              		.loc 1 1046 0 discriminator 2
 2998 0128 202E     		cmp	r6, #32
 2999 012a F9D1     		bne	.L208
1050:lib/ff/sdio_stm32f1.c ****         tempbuff += 8;
 3000              		.loc 1 1050 0
 3001 012c 2035     		adds	r5, r5, #32
 3002              	.LVL368:
 3003 012e EBE7     		b	.L242
 3004              	.L247:
1054:lib/ff/sdio_stm32f1.c ****     if (SDIO_GetFlagStatus(SDIO_FLAG_DTIMEOUT) != RESET)
 3005              		.loc 1 1054 0
 3006 0130 0820     		movs	r0, #8
 3007 0132 FFF7FEFF 		bl	SDIO_GetFlagStatus
 3008              	.LVL369:
 3009 0136 20B1     		cbz	r0, .L210
1056:lib/ff/sdio_stm32f1.c ****       SDIO_ClearFlag(SDIO_FLAG_DTIMEOUT);
 3010              		.loc 1 1056 0
 3011 0138 0820     		movs	r0, #8
 3012 013a FFF7FEFF 		bl	SDIO_ClearFlag
 3013              	.LVL370:
1058:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
 3014              		.loc 1 1058 0
 3015 013e 0424     		movs	r4, #4
 3016 0140 59E0     		b	.L200
 3017              	.LVL371:
 3018              	.L210:
1060:lib/ff/sdio_stm32f1.c ****     else if (SDIO_GetFlagStatus(SDIO_FLAG_DCRCFAIL) != RESET)
 3019              		.loc 1 1060 0
 3020 0142 0220     		movs	r0, #2
 3021 0144 FFF7FEFF 		bl	SDIO_GetFlagStatus
 3022              	.LVL372:
 3023 0148 20B1     		cbz	r0, .L211
1062:lib/ff/sdio_stm32f1.c ****       SDIO_ClearFlag(SDIO_FLAG_DCRCFAIL);
 3024              		.loc 1 1062 0
 3025 014a 0220     		movs	r0, #2
 3026 014c FFF7FEFF 		bl	SDIO_ClearFlag
 3027              	.LVL373:
1064:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
 3028              		.loc 1 1064 0
 3029 0150 0224     		movs	r4, #2
 3030 0152 50E0     		b	.L200
 3031              	.LVL374:
 3032              	.L211:
1066:lib/ff/sdio_stm32f1.c ****     else if (SDIO_GetFlagStatus(SDIO_FLAG_RXOVERR) != RESET)
 3033              		.loc 1 1066 0
 3034 0154 2020     		movs	r0, #32
 3035 0156 FFF7FEFF 		bl	SDIO_GetFlagStatus
 3036              	.LVL375:
 3037 015a 20B1     		cbz	r0, .L212
1068:lib/ff/sdio_stm32f1.c ****       SDIO_ClearFlag(SDIO_FLAG_RXOVERR);
 3038              		.loc 1 1068 0
 3039 015c 2020     		movs	r0, #32
 3040 015e FFF7FEFF 		bl	SDIO_ClearFlag
 3041              	.LVL376:
1070:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
 3042              		.loc 1 1070 0
 3043 0162 0624     		movs	r4, #6
 3044 0164 47E0     		b	.L200
 3045              	.LVL377:
 3046              	.L212:
1072:lib/ff/sdio_stm32f1.c ****     else if (SDIO_GetFlagStatus(SDIO_FLAG_STBITERR) != RESET)
 3047              		.loc 1 1072 0
 3048 0166 4FF40070 		mov	r0, #512
 3049 016a FFF7FEFF 		bl	SDIO_GetFlagStatus
 3050              	.LVL378:
 3051 016e 28B1     		cbz	r0, .L243
1074:lib/ff/sdio_stm32f1.c ****       SDIO_ClearFlag(SDIO_FLAG_STBITERR);
 3052              		.loc 1 1074 0
 3053 0170 4FF40070 		mov	r0, #512
 3054 0174 FFF7FEFF 		bl	SDIO_ClearFlag
 3055              	.LVL379:
1076:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
 3056              		.loc 1 1076 0
 3057 0178 0724     		movs	r4, #7
 3058 017a 3CE0     		b	.L200
 3059              	.LVL380:
 3060              	.L243:
1078:lib/ff/sdio_stm32f1.c ****     while (SDIO_GetFlagStatus(SDIO_FLAG_RXDAVL) != RESET)
 3061              		.loc 1 1078 0 discriminator 1
 3062 017c 4FF40010 		mov	r0, #2097152
 3063 0180 FFF7FEFF 		bl	SDIO_GetFlagStatus
 3064              	.LVL381:
 3065 0184 20B1     		cbz	r0, .L248
 3066              	.L215:
1080:lib/ff/sdio_stm32f1.c ****       *tempbuff = SDIO_ReadData();
 3067              		.loc 1 1080 0
 3068 0186 FFF7FEFF 		bl	SDIO_ReadData
 3069              	.LVL382:
 3070 018a 45F8040B 		str	r0, [r5], #4
 3071              	.LVL383:
 3072 018e F5E7     		b	.L243
 3073              	.LVL384:
 3074              	.L248:
1085:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_STATIC_FLAGS);
 3075              		.loc 1 1085 0
 3076 0190 40F2FF50 		movw	r0, #1535
 3077 0194 FFF7FEFF 		bl	SDIO_ClearFlag
 3078              	.LVL385:
 3079 0198 2DE0     		b	.L200
 3080              	.LVL386:
 3081              	.L205:
1087:lib/ff/sdio_stm32f1.c ****   else if (DeviceMode == SD_INTERRUPT_MODE)
 3082              		.loc 1 1087 0
 3083 019a 012A     		cmp	r2, #1
 3084 019c 0CD1     		bne	.L216
1089:lib/ff/sdio_stm32f1.c ****     SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND | SDIO_IT_RXOVERR | SDIO_IT
 3085              		.loc 1 1089 0
 3086 019e 48F22A30 		movw	r0, #33578
 3087 01a2 3946     		mov	r1, r7
 3088 01a4 FFF7FEFF 		bl	SDIO_ITConfig
 3089              	.LVL387:
 3090              	.L218:
1090:lib/ff/sdio_stm32f1.c ****     while ((TransferEnd == 0) && (TransferError == SD_OK))
 3091              		.loc 1 1090 0 discriminator 1
 3092 01a8 154B     		ldr	r3, .L249+4
 3093 01aa 1968     		ldr	r1, [r3, #0]
 3094 01ac 134B     		ldr	r3, .L249
 3095 01ae D9B9     		cbnz	r1, .L221
1090:lib/ff/sdio_stm32f1.c ****     while ((TransferEnd == 0) && (TransferError == SD_OK))
 3096              		.loc 1 1090 0 is_stmt 0 discriminator 2
 3097 01b0 1878     		ldrb	r0, [r3, #0]	@ zero_extendqisi2
 3098 01b2 2A28     		cmp	r0, #42
 3099 01b4 F8D0     		beq	.L218
 3100 01b6 17E0     		b	.L221
 3101              	.L216:
1097:lib/ff/sdio_stm32f1.c ****   else if (DeviceMode == SD_DMA_MODE)
 3102              		.loc 1 1097 0 is_stmt 1
 3103 01b8 EAB9     		cbnz	r2, .L200
1099:lib/ff/sdio_stm32f1.c ****     SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND | SDIO_IT_RXOVERR | SDIO_IT
 3104              		.loc 1 1099 0
 3105 01ba 40F22A30 		movw	r0, #810
 3106 01be 3946     		mov	r1, r7
 3107 01c0 FFF7FEFF 		bl	SDIO_ITConfig
 3108              	.LVL388:
1100:lib/ff/sdio_stm32f1.c ****     SDIO_DMACmd(ENABLE);
 3109              		.loc 1 1100 0
 3110 01c4 3846     		mov	r0, r7
 3111 01c6 FFF7FEFF 		bl	SDIO_DMACmd
 3112              	.LVL389:
1101:lib/ff/sdio_stm32f1.c ****     SD_LowLevel_DMA_RxConfig((uint32_t *)readbuff, BlockSize);
 3113              		.loc 1 1101 0
 3114 01ca 4046     		mov	r0, r8
 3115 01cc 3146     		mov	r1, r6
 3116 01ce FFF7FEFF 		bl	SD_LowLevel_DMA_RxConfig
 3117              	.LVL390:
 3118              	.L222:
 3119              	.LBB46:
 3120              	.LBB47:
3131:lib/ff/sdio_stm32f1.c ****   return (uint32_t)DMA_GetFlagStatus(DMA2_FLAG_TC4);
 3121              		.loc 1 3131 0 discriminator 1
 3122 01d2 1548     		ldr	r0, .L249+44
 3123 01d4 FFF7FEFF 		bl	DMA_GetFlagStatus
 3124              	.LVL391:
 3125 01d8 084B     		ldr	r3, .L249
 3126              	.LBE47:
 3127              	.LBE46:
1102:lib/ff/sdio_stm32f1.c ****     while ((SD_DMAEndOfTransferStatus() == RESET) && (TransferEnd == 0) && (TransferError == SD_OK)
 3128              		.loc 1 1102 0 discriminator 1
 3129 01da 28B9     		cbnz	r0, .L221
1102:lib/ff/sdio_stm32f1.c ****     while ((SD_DMAEndOfTransferStatus() == RESET) && (TransferEnd == 0) && (TransferError == SD_OK)
 3130              		.loc 1 1102 0 is_stmt 0 discriminator 2
 3131 01dc 0849     		ldr	r1, .L249+4
 3132 01de 0868     		ldr	r0, [r1, #0]
 3133 01e0 10B9     		cbnz	r0, .L221
1102:lib/ff/sdio_stm32f1.c ****     while ((SD_DMAEndOfTransferStatus() == RESET) && (TransferEnd == 0) && (TransferError == SD_OK)
 3134              		.loc 1 1102 0 discriminator 1
 3135 01e2 1A78     		ldrb	r2, [r3, #0]	@ zero_extendqisi2
 3136 01e4 2A2A     		cmp	r2, #42
 3137 01e6 F4D0     		beq	.L222
 3138              	.L221:
1104:lib/ff/sdio_stm32f1.c ****     if (TransferError != SD_OK)
 3139              		.loc 1 1104 0 is_stmt 1
 3140 01e8 1A78     		ldrb	r2, [r3, #0]	@ zero_extendqisi2
 3141 01ea 2A2A     		cmp	r2, #42
 3142 01ec 03D0     		beq	.L200
1106:lib/ff/sdio_stm32f1.c ****       return(TransferError);
 3143              		.loc 1 1106 0
 3144 01ee 034C     		ldr	r4, .L249
 3145              	.LVL392:
 3146 01f0 2478     		ldrb	r4, [r4, #0]	@ zero_extendqisi2
 3147 01f2 00E0     		b	.L200
 3148              	.LVL393:
 3149              	.L223:
 979:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 3150              		.loc 1 979 0
 3151 01f4 0E24     		movs	r4, #14
 3152              	.LVL394:
 3153              	.L200:
1110:lib/ff/sdio_stm32f1.c **** }
 3154              		.loc 1 1110 0
 3155 01f6 2046     		mov	r0, r4
 3156 01f8 BDE8FE8F 		pop	{r1, r2, r3, r4, r5, r6, r7, r8, r9, sl, fp, pc}
 3157              	.L250:
 3158              		.align	2
 3159              	.L249:
 3160 01fc 00000000 		.word	.LANCHOR9
 3161 0200 00000000 		.word	.LANCHOR10
 3162 0204 00000000 		.word	.LANCHOR11
 3163 0208 00000000 		.word	.LANCHOR2
 3164 020c FFFF0F00 		.word	1048575
 3165 0210 00000000 		.word	.LANCHOR4
 3166 0214 00000000 		.word	.LANCHOR0
 3167 0218 00000000 		.word	.LANCHOR12
 3168 021c 00000000 		.word	.LANCHOR13
 3169 0220 00000000 		.word	.LANCHOR7
 3170 0224 00800140 		.word	1073840128
 3171 0228 00200010 		.word	268443648
 3172              		.cfi_endproc
 3173              	.LFE68:
 3175              		.section	.text.SD_ReadMultiBlocks,"ax",%progbits
 3176              		.align	1
 3177              		.global	SD_ReadMultiBlocks
 3178              		.thumb
 3179              		.thumb_func
 3181              	SD_ReadMultiBlocks:
 3182              	.LFB69:
1124:lib/ff/sdio_stm32f1.c **** {
 3183              		.loc 1 1124 0
 3184              		.cfi_startproc
 3185              		@ args = 0, pretend = 0, frame = 8
 3186              		@ frame_needed = 0, uses_anonymous_args = 0
 3187              	.LVL395:
 3188 0000 2DE9F74F 		push	{r0, r1, r2, r4, r5, r6, r7, r8, r9, sl, fp, lr}
 3189              	.LCFI18:
 3190              		.cfi_def_cfa_offset 48
 3191              		.cfi_offset 0, -48
 3192              		.cfi_offset 1, -44
 3193              		.cfi_offset 2, -40
 3194              		.cfi_offset 4, -36
 3195              		.cfi_offset 5, -32
 3196              		.cfi_offset 6, -28
 3197              		.cfi_offset 7, -24
 3198              		.cfi_offset 8, -20
 3199              		.cfi_offset 9, -16
 3200              		.cfi_offset 10, -12
 3201              		.cfi_offset 11, -8
 3202              		.cfi_offset 14, -4
 3203 0004 8846     		mov	r8, r1
 3204 0006 9346     		mov	fp, r2
 3205 0008 9A46     		mov	sl, r3
 3206              	.LVL396:
1129:lib/ff/sdio_stm32f1.c ****   if (NULL == readbuff)
 3207              		.loc 1 1129 0
 3208 000a 0746     		mov	r7, r0
 3209 000c 08B9     		cbnz	r0, .L252
 3210              	.LVL397:
 3211              	.L255:
1132:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 3212              		.loc 1 1132 0
 3213 000e 2624     		movs	r4, #38
 3214 0010 24E1     		b	.L253
 3215              	.LVL398:
 3216              	.L252:
1135:lib/ff/sdio_stm32f1.c ****   TransferError = SD_OK;
 3217              		.loc 1 1135 0
 3218 0012 2A21     		movs	r1, #42
 3219              	.LVL399:
 3220 0014 934B     		ldr	r3, .L315
 3221              	.LVL400:
 3222 0016 1970     		strb	r1, [r3, #0]
1136:lib/ff/sdio_stm32f1.c ****   TransferEnd = 0;
 3223              		.loc 1 1136 0
 3224 0018 0024     		movs	r4, #0
 3225 001a 9348     		ldr	r0, .L315+4
 3226              	.LVL401:
 3227 001c 0460     		str	r4, [r0, #0]
1137:lib/ff/sdio_stm32f1.c ****   TotalNumberOfBytes = 0;
 3228              		.loc 1 1137 0
 3229 001e 934A     		ldr	r2, .L315+8
 3230              	.LVL402:
 3231 0020 1460     		str	r4, [r2, #0]
1140:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataTimeOut = SD_DATATIMEOUT;
 3232              		.loc 1 1140 0
 3233 0022 9348     		ldr	r0, .L315+12
 3234 0024 934B     		ldr	r3, .L315+16
1141:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataLength = 0;
 3235              		.loc 1 1141 0
 3236 0026 80E81800 		stmia	r0, {r3, r4}
1142:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataBlockSize = SDIO_DataBlockSize_1b;
 3237              		.loc 1 1142 0
 3238 002a 8460     		str	r4, [r0, #8]
1143:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToCard;
 3239              		.loc 1 1143 0
 3240 002c C460     		str	r4, [r0, #12]
1144:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
 3241              		.loc 1 1144 0
 3242 002e 0461     		str	r4, [r0, #16]
1145:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Disable;
 3243              		.loc 1 1145 0
 3244 0030 4461     		str	r4, [r0, #20]
1146:lib/ff/sdio_stm32f1.c ****   SDIO_DataConfig(&SDIO_DataInitStructure);
 3245              		.loc 1 1146 0
 3246 0032 FFF7FEFF 		bl	SDIO_DataConfig
 3247              	.LVL403:
1147:lib/ff/sdio_stm32f1.c ****   SDIO_DMACmd(DISABLE);
 3248              		.loc 1 1147 0
 3249 0036 2046     		mov	r0, r4
 3250 0038 FFF7FEFF 		bl	SDIO_DMACmd
 3251              	.LVL404:
1149:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetResponse(SDIO_RESP1) & SD_CARD_LOCKED)
 3252              		.loc 1 1149 0
 3253 003c 2046     		mov	r0, r4
 3254 003e FFF7FEFF 		bl	SDIO_GetResponse
 3255              	.LVL405:
 3256 0042 8201     		lsls	r2, r0, #6
 3257 0044 00F10781 		bmi	.L279
1155:lib/ff/sdio_stm32f1.c ****   if (CardType == SDIO_HIGH_CAPACITY_SD_CARD)
 3258              		.loc 1 1155 0
 3259 0048 8B4C     		ldr	r4, .L315+20
 3260 004a 2168     		ldr	r1, [r4, #0]
 3261 004c 0229     		cmp	r1, #2
 3262              	.LVL406:
1158:lib/ff/sdio_stm32f1.c ****     ReadAddr /= 512;
 3263              		.loc 1 1158 0
 3264 004e 04BF     		itt	eq
 3265 0050 4FEA5828 		lsreq	r8, r8, #9
 3266              	.LVL407:
1157:lib/ff/sdio_stm32f1.c ****     BlockSize = 512;
 3267              		.loc 1 1157 0
 3268 0054 4FF4007B 		moveq	fp, #512
 3269              	.LVL408:
1161:lib/ff/sdio_stm32f1.c ****   if ((BlockSize > 0) && (BlockSize <= 2048) && (0 == (BlockSize & (BlockSize - 1))))
 3270              		.loc 1 1161 0
 3271 0058 0BF1FF3C 		add	ip, fp, #-1
 3272 005c 1FFA8CF3 		uxth	r3, ip
 3273 0060 B3F5006F 		cmp	r3, #2048
 3274 0064 D3D2     		bcs	.L255
1161:lib/ff/sdio_stm32f1.c ****   if ((BlockSize > 0) && (BlockSize <= 2048) && (0 == (BlockSize & (BlockSize - 1))))
 3275              		.loc 1 1161 0 is_stmt 0 discriminator 1
 3276 0066 1CEA0B0E 		ands	lr, ip, fp
 3277 006a D0D1     		bne	.L255
1161:lib/ff/sdio_stm32f1.c ****   if ((BlockSize > 0) && (BlockSize <= 2048) && (0 == (BlockSize & (BlockSize - 1))))
 3278              		.loc 1 1161 0
 3279 006c 5E46     		mov	r6, fp
 3280              	.L256:
 3281              	.LVL409:
 3282              	.LBB52:
 3283              	.LBB53:
3040:lib/ff/sdio_stm32f1.c ****   while (NumberOfBytes != 1)
 3284              		.loc 1 3040 0 is_stmt 1
 3285 006e 012E     		cmp	r6, #1
 3286 0070 06D0     		beq	.L312
 3287              	.L257:
3042:lib/ff/sdio_stm32f1.c ****     NumberOfBytes >>= 1;
 3288              		.loc 1 3042 0
 3289 0072 C6F34F06 		ubfx	r6, r6, #1, #16
 3290              	.LVL410:
3043:lib/ff/sdio_stm32f1.c ****     count++;
 3291              		.loc 1 3043 0
 3292 0076 0EF10105 		add	r5, lr, #1
 3293 007a 5FFA85FE 		uxtb	lr, r5
 3294              	.LVL411:
 3295 007e F6E7     		b	.L256
 3296              	.LVL412:
 3297              	.L312:
 3298              	.LBE53:
 3299              	.LBE52:
1166:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) BlockSize;
 3300              		.loc 1 1166 0
 3301 0080 7E4D     		ldr	r5, .L315+24
 3302 0082 C5F800B0 		str	fp, [r5, #0]
1167:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SET_BLOCKLEN;
 3303              		.loc 1 1167 0
 3304 0086 1024     		movs	r4, #16
 3305 0088 6C60     		str	r4, [r5, #4]
1168:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 3306              		.loc 1 1168 0
 3307 008a 4020     		movs	r0, #64
 3308 008c A860     		str	r0, [r5, #8]
1169:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 3309              		.loc 1 1169 0
 3310 008e 4FF00009 		mov	r9, #0
 3311 0092 C5F80C90 		str	r9, [r5, #12]
1170:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 3312              		.loc 1 1170 0
 3313 0096 4FF48062 		mov	r2, #1024
 3314 009a 2A61     		str	r2, [r5, #16]
1171:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
 3315              		.loc 1 1171 0
 3316 009c 2846     		mov	r0, r5
 3317 009e CDF804E0 		str	lr, [sp, #4]
 3318 00a2 FFF7FEFF 		bl	SDIO_SendCommand
 3319              	.LVL413:
1173:lib/ff/sdio_stm32f1.c ****     errorstatus = CmdResp1Error(SD_CMD_SET_BLOCKLEN);
 3320              		.loc 1 1173 0
 3321 00a6 2046     		mov	r0, r4
 3322 00a8 FFF7FEFF 		bl	CmdResp1Error
 3323              	.LVL414:
 3324 00ac 0446     		mov	r4, r0
 3325              	.LVL415:
1175:lib/ff/sdio_stm32f1.c ****     if (SD_OK != errorstatus)
 3326              		.loc 1 1175 0
 3327 00ae 2A28     		cmp	r0, #42
 3328 00b0 DDF804C0 		ldr	ip, [sp, #4]
 3329 00b4 40F0D280 		bne	.L253
1186:lib/ff/sdio_stm32f1.c ****   if (NumberOfBlocks > 1)
 3330              		.loc 1 1186 0
 3331 00b8 BAF1010F 		cmp	sl, #1
 3332 00bc 40F2CE80 		bls	.L253
1189:lib/ff/sdio_stm32f1.c ****     if (NumberOfBlocks * BlockSize > SD_MAX_DATA_LENGTH)
 3333              		.loc 1 1189 0
 3334 00c0 0AFB0BFA 		mul	sl, sl, fp
 3335              	.LVL416:
 3336 00c4 BAF1007F 		cmp	sl, #33554432
 3337 00c8 A1D2     		bcs	.L255
1195:lib/ff/sdio_stm32f1.c ****     TotalNumberOfBytes = NumberOfBlocks * BlockSize;
 3338              		.loc 1 1195 0
 3339 00ca 6849     		ldr	r1, .L315+8
 3340 00cc C1F800A0 		str	sl, [r1, #0]
1196:lib/ff/sdio_stm32f1.c ****     StopCondition = 1;
 3341              		.loc 1 1196 0
 3342 00d0 6B4B     		ldr	r3, .L315+28
 3343 00d2 1E60     		str	r6, [r3, #0]
1197:lib/ff/sdio_stm32f1.c ****     DestBuffer = (uint32_t *)readbuff;
 3344              		.loc 1 1197 0
 3345 00d4 6B48     		ldr	r0, .L315+32
 3346              	.LVL417:
 3347 00d6 0760     		str	r7, [r0, #0]
1199:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_DataTimeOut = SD_DATATIMEOUT;
 3348              		.loc 1 1199 0
 3349 00d8 6548     		ldr	r0, .L315+12
 3350 00da 664A     		ldr	r2, .L315+16
1200:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_DataLength = NumberOfBlocks * BlockSize;
 3351              		.loc 1 1200 0
 3352 00dc 80E80404 		stmia	r0, {r2, sl}
1201:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_DataBlockSize = (uint32_t) power << 4;
 3353              		.loc 1 1201 0
 3354 00e0 4FEA0C12 		lsl	r2, ip, #4
 3355 00e4 8260     		str	r2, [r0, #8]
1202:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToSDIO;
 3356              		.loc 1 1202 0
 3357 00e6 0221     		movs	r1, #2
 3358 00e8 C160     		str	r1, [r0, #12]
1203:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
 3359              		.loc 1 1203 0
 3360 00ea C0F81090 		str	r9, [r0, #16]
1204:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Enable;
 3361              		.loc 1 1204 0
 3362 00ee 4661     		str	r6, [r0, #20]
1205:lib/ff/sdio_stm32f1.c ****     SDIO_DataConfig(&SDIO_DataInitStructure);
 3363              		.loc 1 1205 0
 3364 00f0 FFF7FEFF 		bl	SDIO_DataConfig
 3365              	.LVL418:
1208:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Argument = (uint32_t)ReadAddr;
 3366              		.loc 1 1208 0
 3367 00f4 C5F80080 		str	r8, [r5, #0]
1209:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_READ_MULT_BLOCK;
 3368              		.loc 1 1209 0
 3369 00f8 4FF01208 		mov	r8, #18
 3370              	.LVL419:
 3371 00fc C5F80480 		str	r8, [r5, #4]
1210:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 3372              		.loc 1 1210 0
 3373 0100 4023     		movs	r3, #64
 3374 0102 AB60     		str	r3, [r5, #8]
1211:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 3375              		.loc 1 1211 0
 3376 0104 C5F80C90 		str	r9, [r5, #12]
1212:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 3377              		.loc 1 1212 0
 3378 0108 4FF48060 		mov	r0, #1024
 3379 010c 2861     		str	r0, [r5, #16]
1213:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
 3380              		.loc 1 1213 0
 3381 010e 2846     		mov	r0, r5
 3382 0110 FFF7FEFF 		bl	SDIO_SendCommand
 3383              	.LVL420:
1215:lib/ff/sdio_stm32f1.c ****     errorstatus = CmdResp1Error(SD_CMD_READ_MULT_BLOCK);
 3384              		.loc 1 1215 0
 3385 0114 4046     		mov	r0, r8
 3386 0116 FFF7FEFF 		bl	CmdResp1Error
 3387              	.LVL421:
1217:lib/ff/sdio_stm32f1.c ****     if (errorstatus != SD_OK)
 3388              		.loc 1 1217 0
 3389 011a 2A28     		cmp	r0, #42
 3390 011c 40F09D80 		bne	.L281
1222:lib/ff/sdio_stm32f1.c ****     if (DeviceMode == SD_POLLING_MODE)
 3391              		.loc 1 1222 0
 3392 0120 594A     		ldr	r2, .L315+36
 3393 0122 1168     		ldr	r1, [r2, #0]
 3394 0124 0229     		cmp	r1, #2
 3395 0126 69D1     		bne	.L259
 3396              	.LVL422:
 3397              	.L308:
1225:lib/ff/sdio_stm32f1.c ****       while (!(SDIO->STA &(SDIO_FLAG_RXOVERR | SDIO_FLAG_DCRCFAIL | SDIO_FLAG_DATAEND | SDIO_FLAG_D
 3398              		.loc 1 1225 0 discriminator 1
 3399 0128 584B     		ldr	r3, .L315+40
 3400 012a 586B     		ldr	r0, [r3, #52]
 3401 012c 40F22A34 		movw	r4, #810
 3402 0130 0440     		ands	r4, r4, r0
 3403 0132 6CB9     		cbnz	r4, .L313
 3404              	.L263:
1227:lib/ff/sdio_stm32f1.c ****         if (SDIO_GetFlagStatus(SDIO_FLAG_RXFIFOHF) != RESET)
 3405              		.loc 1 1227 0
 3406 0134 4FF40040 		mov	r0, #32768
 3407 0138 FFF7FEFF 		bl	SDIO_GetFlagStatus
 3408              	.LVL423:
 3409 013c 0028     		cmp	r0, #0
 3410 013e F3D0     		beq	.L308
 3411              	.L262:
1231:lib/ff/sdio_stm32f1.c ****             *(tempbuff + count) = SDIO_ReadData();
 3412              		.loc 1 1231 0 discriminator 2
 3413 0140 FFF7FEFF 		bl	SDIO_ReadData
 3414              	.LVL424:
 3415 0144 3851     		str	r0, [r7, r4]
 3416 0146 0434     		adds	r4, r4, #4
1229:lib/ff/sdio_stm32f1.c ****           for (count = 0; count < SD_HALFFIFO; count++)
 3417              		.loc 1 1229 0 discriminator 2
 3418 0148 202C     		cmp	r4, #32
 3419 014a F9D1     		bne	.L262
1233:lib/ff/sdio_stm32f1.c ****           tempbuff += SD_HALFFIFO;
 3420              		.loc 1 1233 0
 3421 014c 2037     		adds	r7, r7, #32
 3422              	.LVL425:
 3423 014e EBE7     		b	.L308
 3424              	.L313:
1237:lib/ff/sdio_stm32f1.c ****       if (SDIO_GetFlagStatus(SDIO_FLAG_DTIMEOUT) != RESET)
 3425              		.loc 1 1237 0
 3426 0150 0820     		movs	r0, #8
 3427 0152 FFF7FEFF 		bl	SDIO_GetFlagStatus
 3428              	.LVL426:
 3429 0156 20B1     		cbz	r0, .L264
1239:lib/ff/sdio_stm32f1.c ****         SDIO_ClearFlag(SDIO_FLAG_DTIMEOUT);
 3430              		.loc 1 1239 0
 3431 0158 0820     		movs	r0, #8
 3432 015a FFF7FEFF 		bl	SDIO_ClearFlag
 3433              	.LVL427:
1241:lib/ff/sdio_stm32f1.c ****         return(errorstatus);
 3434              		.loc 1 1241 0
 3435 015e 0424     		movs	r4, #4
 3436 0160 7CE0     		b	.L253
 3437              	.LVL428:
 3438              	.L264:
1243:lib/ff/sdio_stm32f1.c ****       else if (SDIO_GetFlagStatus(SDIO_FLAG_DCRCFAIL) != RESET)
 3439              		.loc 1 1243 0
 3440 0162 0220     		movs	r0, #2
 3441 0164 FFF7FEFF 		bl	SDIO_GetFlagStatus
 3442              	.LVL429:
 3443 0168 20B1     		cbz	r0, .L265
1245:lib/ff/sdio_stm32f1.c ****         SDIO_ClearFlag(SDIO_FLAG_DCRCFAIL);
 3444              		.loc 1 1245 0
 3445 016a 0220     		movs	r0, #2
 3446 016c FFF7FEFF 		bl	SDIO_ClearFlag
 3447              	.LVL430:
1247:lib/ff/sdio_stm32f1.c ****         return(errorstatus);
 3448              		.loc 1 1247 0
 3449 0170 0224     		movs	r4, #2
 3450 0172 73E0     		b	.L253
 3451              	.LVL431:
 3452              	.L265:
1249:lib/ff/sdio_stm32f1.c ****       else if (SDIO_GetFlagStatus(SDIO_FLAG_RXOVERR) != RESET)
 3453              		.loc 1 1249 0
 3454 0174 2020     		movs	r0, #32
 3455 0176 FFF7FEFF 		bl	SDIO_GetFlagStatus
 3456              	.LVL432:
 3457 017a 20B1     		cbz	r0, .L266
1251:lib/ff/sdio_stm32f1.c ****         SDIO_ClearFlag(SDIO_FLAG_RXOVERR);
 3458              		.loc 1 1251 0
 3459 017c 2020     		movs	r0, #32
 3460 017e FFF7FEFF 		bl	SDIO_ClearFlag
 3461              	.LVL433:
1253:lib/ff/sdio_stm32f1.c ****         return(errorstatus);
 3462              		.loc 1 1253 0
 3463 0182 0624     		movs	r4, #6
 3464 0184 6AE0     		b	.L253
 3465              	.LVL434:
 3466              	.L266:
1255:lib/ff/sdio_stm32f1.c ****       else if (SDIO_GetFlagStatus(SDIO_FLAG_STBITERR) != RESET)
 3467              		.loc 1 1255 0
 3468 0186 4FF40070 		mov	r0, #512
 3469 018a FFF7FEFF 		bl	SDIO_GetFlagStatus
 3470              	.LVL435:
 3471 018e 28B1     		cbz	r0, .L309
1257:lib/ff/sdio_stm32f1.c ****         SDIO_ClearFlag(SDIO_FLAG_STBITERR);
 3472              		.loc 1 1257 0
 3473 0190 4FF40070 		mov	r0, #512
 3474 0194 FFF7FEFF 		bl	SDIO_ClearFlag
 3475              	.LVL436:
1259:lib/ff/sdio_stm32f1.c ****         return(errorstatus);
 3476              		.loc 1 1259 0
 3477 0198 0724     		movs	r4, #7
 3478 019a 5FE0     		b	.L253
 3479              	.LVL437:
 3480              	.L309:
1261:lib/ff/sdio_stm32f1.c ****       while (SDIO_GetFlagStatus(SDIO_FLAG_RXDAVL) != RESET)
 3481              		.loc 1 1261 0 discriminator 1
 3482 019c 4FF40010 		mov	r0, #2097152
 3483 01a0 FFF7FEFF 		bl	SDIO_GetFlagStatus
 3484              	.LVL438:
 3485 01a4 20B1     		cbz	r0, .L314
 3486              	.L269:
1263:lib/ff/sdio_stm32f1.c ****         *tempbuff = SDIO_ReadData();
 3487              		.loc 1 1263 0
 3488 01a6 FFF7FEFF 		bl	SDIO_ReadData
 3489              	.LVL439:
 3490 01aa 47F8040B 		str	r0, [r7], #4
 3491              	.LVL440:
 3492 01ae F5E7     		b	.L309
 3493              	.LVL441:
 3494              	.L314:
1267:lib/ff/sdio_stm32f1.c ****       if (SDIO_GetFlagStatus(SDIO_FLAG_DATAEND) != RESET)
 3495              		.loc 1 1267 0
 3496 01b0 4FF48070 		mov	r0, #256
 3497 01b4 FFF7FEFF 		bl	SDIO_GetFlagStatus
 3498              	.LVL442:
 3499 01b8 28B9     		cbnz	r0, .L270
 3500              	.L272:
 3501              	.LVL443:
1289:lib/ff/sdio_stm32f1.c ****       SDIO_ClearFlag(SDIO_STATIC_FLAGS);
 3502              		.loc 1 1289 0
 3503 01ba 40F2FF50 		movw	r0, #1535
 3504 01be FFF7FEFF 		bl	SDIO_ClearFlag
 3505              	.LVL444:
 3506 01c2 2A24     		movs	r4, #42
 3507 01c4 4AE0     		b	.L253
 3508              	.LVL445:
 3509              	.L270:
1270:lib/ff/sdio_stm32f1.c ****         if ((SDIO_STD_CAPACITY_SD_CARD_V1_1 == CardType) || (SDIO_HIGH_CAPACITY_SD_CARD == CardType
 3510              		.loc 1 1270 0
 3511 01c6 2C4A     		ldr	r2, .L315+20
 3512 01c8 1168     		ldr	r1, [r2, #0]
 3513 01ca 19B1     		cbz	r1, .L271
1270:lib/ff/sdio_stm32f1.c ****         if ((SDIO_STD_CAPACITY_SD_CARD_V1_1 == CardType) || (SDIO_HIGH_CAPACITY_SD_CARD == CardType
 3514              		.loc 1 1270 0 is_stmt 0 discriminator 1
 3515 01cc 0229     		cmp	r1, #2
 3516 01ce 01D0     		beq	.L271
 3517 01d0 0129     		cmp	r1, #1
 3518 01d2 F2D1     		bne	.L272
 3519              	.L271:
1273:lib/ff/sdio_stm32f1.c ****           SDIO_CmdInitStructure.SDIO_Argument = 0x0;
 3520              		.loc 1 1273 0 is_stmt 1
 3521 01d4 2948     		ldr	r0, .L315+24
1274:lib/ff/sdio_stm32f1.c ****           SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_STOP_TRANSMISSION;
 3522              		.loc 1 1274 0
 3523 01d6 0022     		movs	r2, #0
 3524 01d8 0C24     		movs	r4, #12
 3525 01da 80E81400 		stmia	r0, {r2, r4}
1275:lib/ff/sdio_stm32f1.c ****           SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 3526              		.loc 1 1275 0
 3527 01de 4023     		movs	r3, #64
 3528 01e0 8360     		str	r3, [r0, #8]
1276:lib/ff/sdio_stm32f1.c ****           SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 3529              		.loc 1 1276 0
 3530 01e2 C260     		str	r2, [r0, #12]
1277:lib/ff/sdio_stm32f1.c ****           SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 3531              		.loc 1 1277 0
 3532 01e4 4FF48062 		mov	r2, #1024
 3533 01e8 0261     		str	r2, [r0, #16]
1278:lib/ff/sdio_stm32f1.c ****           SDIO_SendCommand(&SDIO_CmdInitStructure);
 3534              		.loc 1 1278 0
 3535 01ea FFF7FEFF 		bl	SDIO_SendCommand
 3536              	.LVL446:
1280:lib/ff/sdio_stm32f1.c ****           errorstatus = CmdResp1Error(SD_CMD_STOP_TRANSMISSION);
 3537              		.loc 1 1280 0
 3538 01ee 2046     		mov	r0, r4
 3539 01f0 FFF7FEFF 		bl	CmdResp1Error
 3540              	.LVL447:
 3541 01f4 0446     		mov	r4, r0
 3542              	.LVL448:
1282:lib/ff/sdio_stm32f1.c ****           if (errorstatus != SD_OK)
 3543              		.loc 1 1282 0
 3544 01f6 2A28     		cmp	r0, #42
 3545 01f8 30D1     		bne	.L253
 3546 01fa DEE7     		b	.L272
 3547              	.LVL449:
 3548              	.L259:
1291:lib/ff/sdio_stm32f1.c ****     else if (DeviceMode == SD_INTERRUPT_MODE)
 3549              		.loc 1 1291 0
 3550 01fc 0129     		cmp	r1, #1
 3551 01fe 0CD1     		bne	.L273
1293:lib/ff/sdio_stm32f1.c ****       SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND | SDIO_IT_RXOVERR | SDIO_
 3552              		.loc 1 1293 0
 3553 0200 48F22A30 		movw	r0, #33578
 3554              	.LVL450:
 3555 0204 3146     		mov	r1, r6
 3556 0206 FFF7FEFF 		bl	SDIO_ITConfig
 3557              	.LVL451:
 3558              	.L275:
1294:lib/ff/sdio_stm32f1.c ****       while ((TransferEnd == 0) && (TransferError == SD_OK))
 3559              		.loc 1 1294 0 discriminator 1
 3560 020a 174B     		ldr	r3, .L315+4
 3561 020c 1868     		ldr	r0, [r3, #0]
 3562 020e 154B     		ldr	r3, .L315
 3563 0210 D8B9     		cbnz	r0, .L277
1294:lib/ff/sdio_stm32f1.c ****       while ((TransferEnd == 0) && (TransferError == SD_OK))
 3564              		.loc 1 1294 0 is_stmt 0 discriminator 2
 3565 0212 1A78     		ldrb	r2, [r3, #0]	@ zero_extendqisi2
 3566 0214 2A2A     		cmp	r2, #42
 3567 0216 F8D0     		beq	.L275
 3568 0218 17E0     		b	.L277
 3569              	.LVL452:
 3570              	.L273:
1301:lib/ff/sdio_stm32f1.c ****     else if (DeviceMode == SD_DMA_MODE)
 3571              		.loc 1 1301 0 is_stmt 1
 3572 021a F9B9     		cbnz	r1, .L253
1303:lib/ff/sdio_stm32f1.c ****       SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND | SDIO_IT_RXOVERR | SDIO_
 3573              		.loc 1 1303 0
 3574 021c 40F22A30 		movw	r0, #810
 3575              	.LVL453:
 3576 0220 3146     		mov	r1, r6
 3577 0222 FFF7FEFF 		bl	SDIO_ITConfig
 3578              	.LVL454:
1304:lib/ff/sdio_stm32f1.c ****       SDIO_DMACmd(ENABLE);
 3579              		.loc 1 1304 0
 3580 0226 3046     		mov	r0, r6
 3581 0228 FFF7FEFF 		bl	SDIO_DMACmd
 3582              	.LVL455:
1305:lib/ff/sdio_stm32f1.c ****       SD_LowLevel_DMA_RxConfig((uint32_t *)readbuff, (NumberOfBlocks * BlockSize));
 3583              		.loc 1 1305 0
 3584 022c 3846     		mov	r0, r7
 3585 022e 5146     		mov	r1, sl
 3586 0230 FFF7FEFF 		bl	SD_LowLevel_DMA_RxConfig
 3587              	.LVL456:
 3588              	.L278:
 3589              	.LBB54:
 3590              	.LBB55:
3131:lib/ff/sdio_stm32f1.c ****   return (uint32_t)DMA_GetFlagStatus(DMA2_FLAG_TC4);
 3591              		.loc 1 3131 0 discriminator 1
 3592 0234 1648     		ldr	r0, .L315+44
 3593 0236 FFF7FEFF 		bl	DMA_GetFlagStatus
 3594              	.LVL457:
 3595 023a 0A4B     		ldr	r3, .L315
 3596              	.LBE55:
 3597              	.LBE54:
1306:lib/ff/sdio_stm32f1.c ****       while ((SD_DMAEndOfTransferStatus() == RESET) && (TransferEnd == 0) && (TransferError == SD_O
 3598              		.loc 1 1306 0 discriminator 1
 3599 023c 28B9     		cbnz	r0, .L277
1306:lib/ff/sdio_stm32f1.c ****       while ((SD_DMAEndOfTransferStatus() == RESET) && (TransferEnd == 0) && (TransferError == SD_O
 3600              		.loc 1 1306 0 is_stmt 0 discriminator 2
 3601 023e 0A48     		ldr	r0, .L315+4
 3602 0240 0268     		ldr	r2, [r0, #0]
 3603 0242 12B9     		cbnz	r2, .L277
1306:lib/ff/sdio_stm32f1.c ****       while ((SD_DMAEndOfTransferStatus() == RESET) && (TransferEnd == 0) && (TransferError == SD_O
 3604              		.loc 1 1306 0 discriminator 1
 3605 0244 1978     		ldrb	r1, [r3, #0]	@ zero_extendqisi2
 3606 0246 2A29     		cmp	r1, #42
 3607 0248 F4D0     		beq	.L278
 3608              	.L277:
1308:lib/ff/sdio_stm32f1.c ****       if (TransferError != SD_OK)
 3609              		.loc 1 1308 0 is_stmt 1
 3610 024a 1978     		ldrb	r1, [r3, #0]	@ zero_extendqisi2
 3611 024c 2A29     		cmp	r1, #42
 3612 024e 05D0     		beq	.L253
1310:lib/ff/sdio_stm32f1.c ****         return(TransferError);
 3613              		.loc 1 1310 0
 3614 0250 044C     		ldr	r4, .L315
 3615 0252 2478     		ldrb	r4, [r4, #0]	@ zero_extendqisi2
 3616 0254 02E0     		b	.L253
 3617              	.LVL458:
 3618              	.L279:
1152:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 3619              		.loc 1 1152 0
 3620 0256 0E24     		movs	r4, #14
 3621 0258 00E0     		b	.L253
 3622              	.LVL459:
 3623              	.L281:
1217:lib/ff/sdio_stm32f1.c ****     if (errorstatus != SD_OK)
 3624              		.loc 1 1217 0
 3625 025a 0446     		mov	r4, r0
 3626              	.LVL460:
 3627              	.L253:
1315:lib/ff/sdio_stm32f1.c **** }
 3628              		.loc 1 1315 0
 3629 025c 2046     		mov	r0, r4
 3630 025e BDE8FE8F 		pop	{r1, r2, r3, r4, r5, r6, r7, r8, r9, sl, fp, pc}
 3631              	.L316:
 3632 0262 00BF     		.align	2
 3633              	.L315:
 3634 0264 00000000 		.word	.LANCHOR9
 3635 0268 00000000 		.word	.LANCHOR10
 3636 026c 00000000 		.word	.LANCHOR11
 3637 0270 00000000 		.word	.LANCHOR2
 3638 0274 FFFF0F00 		.word	1048575
 3639 0278 00000000 		.word	.LANCHOR4
 3640 027c 00000000 		.word	.LANCHOR0
 3641 0280 00000000 		.word	.LANCHOR12
 3642 0284 00000000 		.word	.LANCHOR13
 3643 0288 00000000 		.word	.LANCHOR7
 3644 028c 00800140 		.word	1073840128
 3645 0290 00200010 		.word	268443648
 3646              		.cfi_endproc
 3647              	.LFE69:
 3649              		.section	.text.SD_WriteBlock,"ax",%progbits
 3650              		.align	1
 3651              		.global	SD_WriteBlock
 3652              		.thumb
 3653              		.thumb_func
 3655              	SD_WriteBlock:
 3656              	.LFB70:
1328:lib/ff/sdio_stm32f1.c **** {
 3657              		.loc 1 1328 0
 3658              		.cfi_startproc
 3659              		@ args = 0, pretend = 0, frame = 16
 3660              		@ frame_needed = 0, uses_anonymous_args = 0
 3661              	.LVL461:
 3662 0000 2DE9F04F 		push	{r4, r5, r6, r7, r8, r9, sl, fp, lr}
 3663              	.LCFI19:
 3664              		.cfi_def_cfa_offset 36
 3665              		.cfi_offset 4, -36
 3666              		.cfi_offset 5, -32
 3667              		.cfi_offset 6, -28
 3668              		.cfi_offset 7, -24
 3669              		.cfi_offset 8, -20
 3670              		.cfi_offset 9, -16
 3671              		.cfi_offset 10, -12
 3672              		.cfi_offset 11, -8
 3673              		.cfi_offset 14, -4
 3674 0004 85B0     		sub	sp, sp, #20
 3675              	.LCFI20:
 3676              		.cfi_def_cfa_offset 56
 3677 0006 0F46     		mov	r7, r1
 3678 0008 1546     		mov	r5, r2
 3679              	.LVL462:
1330:lib/ff/sdio_stm32f1.c ****   uint8_t  power = 0, cardstate = 0;
 3680              		.loc 1 1330 0
 3681 000a 0024     		movs	r4, #0
 3682 000c 8DF80F40 		strb	r4, [sp, #15]
 3683              	.LVL463:
1335:lib/ff/sdio_stm32f1.c ****   if (writebuff == NULL)
 3684              		.loc 1 1335 0
 3685 0010 0646     		mov	r6, r0
 3686 0012 08B9     		cbnz	r0, .L318
 3687              	.LVL464:
 3688              	.L321:
1338:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 3689              		.loc 1 1338 0
 3690 0014 2620     		movs	r0, #38
 3691 0016 50E1     		b	.L319
 3692              	.LVL465:
 3693              	.L318:
1341:lib/ff/sdio_stm32f1.c ****   TransferError = SD_OK;
 3694              		.loc 1 1341 0
 3695 0018 2A22     		movs	r2, #42
 3696              	.LVL466:
 3697 001a A94B     		ldr	r3, .L383
 3698 001c 1A70     		strb	r2, [r3, #0]
1342:lib/ff/sdio_stm32f1.c ****   TransferEnd = 0;
 3699              		.loc 1 1342 0
 3700 001e A948     		ldr	r0, .L383+4
 3701              	.LVL467:
 3702 0020 0460     		str	r4, [r0, #0]
1343:lib/ff/sdio_stm32f1.c ****   TotalNumberOfBytes = 0;
 3703              		.loc 1 1343 0
 3704 0022 A949     		ldr	r1, .L383+8
 3705              	.LVL468:
 3706 0024 0C60     		str	r4, [r1, #0]
1345:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataTimeOut = SD_DATATIMEOUT;
 3707              		.loc 1 1345 0
 3708 0026 A948     		ldr	r0, .L383+12
 3709 0028 A94A     		ldr	r2, .L383+16
1346:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataLength = 0;
 3710              		.loc 1 1346 0
 3711 002a 80E81400 		stmia	r0, {r2, r4}
1347:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataBlockSize = SDIO_DataBlockSize_1b;
 3712              		.loc 1 1347 0
 3713 002e 8460     		str	r4, [r0, #8]
1348:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToCard;
 3714              		.loc 1 1348 0
 3715 0030 C460     		str	r4, [r0, #12]
1349:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
 3716              		.loc 1 1349 0
 3717 0032 0461     		str	r4, [r0, #16]
1350:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Disable;
 3718              		.loc 1 1350 0
 3719 0034 4461     		str	r4, [r0, #20]
1351:lib/ff/sdio_stm32f1.c ****   SDIO_DataConfig(&SDIO_DataInitStructure);
 3720              		.loc 1 1351 0
 3721 0036 FFF7FEFF 		bl	SDIO_DataConfig
 3722              	.LVL469:
1352:lib/ff/sdio_stm32f1.c ****   SDIO_DMACmd(DISABLE);
 3723              		.loc 1 1352 0
 3724 003a 2046     		mov	r0, r4
 3725 003c FFF7FEFF 		bl	SDIO_DMACmd
 3726              	.LVL470:
1354:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetResponse(SDIO_RESP1) & SD_CARD_LOCKED)
 3727              		.loc 1 1354 0
 3728 0040 2046     		mov	r0, r4
 3729 0042 FFF7FEFF 		bl	SDIO_GetResponse
 3730              	.LVL471:
 3731 0046 8101     		lsls	r1, r0, #6
 3732 0048 00F13481 		bmi	.L348
1360:lib/ff/sdio_stm32f1.c ****   if (CardType == SDIO_HIGH_CAPACITY_SD_CARD)
 3733              		.loc 1 1360 0
 3734 004c A14A     		ldr	r2, .L383+20
 3735 004e 1368     		ldr	r3, [r2, #0]
 3736 0050 022B     		cmp	r3, #2
 3737 0052 02D1     		bne	.L320
 3738              	.LVL472:
1363:lib/ff/sdio_stm32f1.c ****     WriteAddr /= 512;
 3739              		.loc 1 1363 0
 3740 0054 7F0A     		lsrs	r7, r7, #9
 3741              	.LVL473:
1362:lib/ff/sdio_stm32f1.c ****     BlockSize = 512;
 3742              		.loc 1 1362 0
 3743 0056 4FF40075 		mov	r5, #512
 3744              	.LVL474:
 3745              	.L320:
1367:lib/ff/sdio_stm32f1.c ****   if ((BlockSize > 0) && (BlockSize <= 2048) && ((BlockSize & (BlockSize - 1)) == 0))
 3746              		.loc 1 1367 0
 3747 005a 05F1FF38 		add	r8, r5, #-1
 3748 005e 1FFA88F0 		uxth	r0, r8
 3749 0062 B0F5006F 		cmp	r0, #2048
 3750 0066 D5D2     		bcs	.L321
1367:lib/ff/sdio_stm32f1.c ****   if ((BlockSize > 0) && (BlockSize <= 2048) && ((BlockSize & (BlockSize - 1)) == 0))
 3751              		.loc 1 1367 0 is_stmt 0 discriminator 1
 3752 0068 18EA0508 		ands	r8, r8, r5
 3753 006c D2D1     		bne	.L321
1367:lib/ff/sdio_stm32f1.c ****   if ((BlockSize > 0) && (BlockSize <= 2048) && ((BlockSize & (BlockSize - 1)) == 0))
 3754              		.loc 1 1367 0
 3755 006e 2C46     		mov	r4, r5
 3756              	.L322:
 3757              	.LVL475:
 3758              	.LBB60:
 3759              	.LBB61:
3040:lib/ff/sdio_stm32f1.c ****   while (NumberOfBytes != 1)
 3760              		.loc 1 3040 0 is_stmt 1
 3761 0070 012C     		cmp	r4, #1
 3762 0072 06D0     		beq	.L380
 3763              	.L323:
3042:lib/ff/sdio_stm32f1.c ****     NumberOfBytes >>= 1;
 3764              		.loc 1 3042 0
 3765 0074 C4F34F04 		ubfx	r4, r4, #1, #16
 3766              	.LVL476:
3043:lib/ff/sdio_stm32f1.c ****     count++;
 3767              		.loc 1 3043 0
 3768 0078 08F10108 		add	r8, r8, #1
 3769              	.LVL477:
 3770 007c 5FFA88F8 		uxtb	r8, r8
 3771              	.LVL478:
 3772 0080 F6E7     		b	.L322
 3773              	.L380:
 3774              	.LVL479:
 3775              	.LBE61:
 3776              	.LBE60:
1371:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) BlockSize;
 3777              		.loc 1 1371 0
 3778 0082 954C     		ldr	r4, .L383+24
 3779              	.LVL480:
 3780 0084 2560     		str	r5, [r4, #0]
1372:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SET_BLOCKLEN;
 3781              		.loc 1 1372 0
 3782 0086 4FF0100A 		mov	sl, #16
 3783 008a C4F804A0 		str	sl, [r4, #4]
1373:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 3784              		.loc 1 1373 0
 3785 008e 4021     		movs	r1, #64
 3786 0090 A160     		str	r1, [r4, #8]
1374:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 3787              		.loc 1 1374 0
 3788 0092 4FF00009 		mov	r9, #0
 3789 0096 C4F80C90 		str	r9, [r4, #12]
1375:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 3790              		.loc 1 1375 0
 3791 009a 4FF4806B 		mov	fp, #1024
 3792 009e C4F810B0 		str	fp, [r4, #16]
1376:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
 3793              		.loc 1 1376 0
 3794 00a2 2046     		mov	r0, r4
 3795 00a4 0191     		str	r1, [sp, #4]
 3796 00a6 FFF7FEFF 		bl	SDIO_SendCommand
 3797              	.LVL481:
1378:lib/ff/sdio_stm32f1.c ****     errorstatus = CmdResp1Error(SD_CMD_SET_BLOCKLEN);
 3798              		.loc 1 1378 0
 3799 00aa 5046     		mov	r0, sl
 3800 00ac FFF7FEFF 		bl	CmdResp1Error
 3801              	.LVL482:
1380:lib/ff/sdio_stm32f1.c ****     if (errorstatus != SD_OK)
 3802              		.loc 1 1380 0
 3803 00b0 2A28     		cmp	r0, #42
 3804 00b2 019B     		ldr	r3, [sp, #4]
 3805 00b4 40F00181 		bne	.L319
1392:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) (RCA << 16);
 3806              		.loc 1 1392 0
 3807 00b8 884A     		ldr	r2, .L383+28
 3808 00ba 1068     		ldr	r0, [r2, #0]
 3809              	.LVL483:
 3810 00bc 00FA0AF1 		lsl	r1, r0, sl
 3811 00c0 2160     		str	r1, [r4, #0]
1393:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SEND_STATUS;
 3812              		.loc 1 1393 0
 3813 00c2 4FF00D0A 		mov	sl, #13
 3814 00c6 C4F804A0 		str	sl, [r4, #4]
1394:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 3815              		.loc 1 1394 0
 3816 00ca A360     		str	r3, [r4, #8]
1395:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 3817              		.loc 1 1395 0
 3818 00cc C4F80C90 		str	r9, [r4, #12]
1396:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 3819              		.loc 1 1396 0
 3820 00d0 C4F810B0 		str	fp, [r4, #16]
1397:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 3821              		.loc 1 1397 0
 3822 00d4 2046     		mov	r0, r4
 3823 00d6 FFF7FEFF 		bl	SDIO_SendCommand
 3824              	.LVL484:
1399:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_SEND_STATUS);
 3825              		.loc 1 1399 0
 3826 00da 5046     		mov	r0, sl
 3827 00dc FFF7FEFF 		bl	CmdResp1Error
 3828              	.LVL485:
1401:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
 3829              		.loc 1 1401 0
 3830 00e0 2A28     		cmp	r0, #42
 3831 00e2 40F0EA80 		bne	.L319
1406:lib/ff/sdio_stm32f1.c ****   cardstatus = SDIO_GetResponse(SDIO_RESP1);
 3832              		.loc 1 1406 0
 3833 00e6 4846     		mov	r0, r9
 3834              	.LVL486:
 3835 00e8 FFF7FEFF 		bl	SDIO_GetResponse
 3836              	.LVL487:
1408:lib/ff/sdio_stm32f1.c ****   timeout = SD_DATATIMEOUT;
 3837              		.loc 1 1408 0
 3838 00ec 784C     		ldr	r4, .L383+16
 3839              	.LVL488:
 3840              	.L324:
1410:lib/ff/sdio_stm32f1.c ****   while (((cardstatus & 0x00000100) == 0) && (timeout > 0))
 3841              		.loc 1 1410 0 discriminator 1
 3842 00ee 10F48079 		ands	r9, r0, #256
 3843 00f2 1FD1     		bne	.L325
1410:lib/ff/sdio_stm32f1.c ****   while (((cardstatus & 0x00000100) == 0) && (timeout > 0))
 3844              		.loc 1 1410 0 is_stmt 0 discriminator 2
 3845 00f4 002C     		cmp	r4, #0
 3846 00f6 00F0DF80 		beq	.L350
 3847              	.L326:
1412:lib/ff/sdio_stm32f1.c ****     timeout--;
 3848              		.loc 1 1412 0 is_stmt 1
 3849 00fa 013C     		subs	r4, r4, #1
 3850              	.LVL489:
1413:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) (RCA << 16);
 3851              		.loc 1 1413 0
 3852 00fc 7648     		ldr	r0, .L383+24
 3853              	.LVL490:
 3854 00fe 774A     		ldr	r2, .L383+28
 3855 0100 1368     		ldr	r3, [r2, #0]
 3856 0102 1904     		lsls	r1, r3, #16
 3857 0104 0160     		str	r1, [r0, #0]
1414:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SEND_STATUS;
 3858              		.loc 1 1414 0
 3859 0106 4FF00D0A 		mov	sl, #13
 3860 010a C0F804A0 		str	sl, [r0, #4]
1415:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 3861              		.loc 1 1415 0
 3862 010e 4022     		movs	r2, #64
 3863 0110 8260     		str	r2, [r0, #8]
1416:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 3864              		.loc 1 1416 0
 3865 0112 C0F80C90 		str	r9, [r0, #12]
1417:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 3866              		.loc 1 1417 0
 3867 0116 4FF48063 		mov	r3, #1024
 3868 011a 0361     		str	r3, [r0, #16]
1418:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
 3869              		.loc 1 1418 0
 3870 011c FFF7FEFF 		bl	SDIO_SendCommand
 3871              	.LVL491:
1420:lib/ff/sdio_stm32f1.c ****     errorstatus = CmdResp1Error(SD_CMD_SEND_STATUS);
 3872              		.loc 1 1420 0
 3873 0120 5046     		mov	r0, sl
 3874 0122 FFF7FEFF 		bl	CmdResp1Error
 3875              	.LVL492:
1422:lib/ff/sdio_stm32f1.c ****     if (errorstatus != SD_OK)
 3876              		.loc 1 1422 0
 3877 0126 2A28     		cmp	r0, #42
 3878 0128 40F0C780 		bne	.L319
1426:lib/ff/sdio_stm32f1.c ****     cardstatus = SDIO_GetResponse(SDIO_RESP1);
 3879              		.loc 1 1426 0
 3880 012c 4846     		mov	r0, r9
 3881              	.LVL493:
 3882 012e FFF7FEFF 		bl	SDIO_GetResponse
 3883              	.LVL494:
 3884 0132 DCE7     		b	.L324
 3885              	.L325:
1429:lib/ff/sdio_stm32f1.c ****   if (timeout == 0)
 3886              		.loc 1 1429 0
 3887 0134 002C     		cmp	r4, #0
 3888 0136 00F0BF80 		beq	.L350
1435:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = WriteAddr;
 3889              		.loc 1 1435 0
 3890 013a 6748     		ldr	r0, .L383+24
 3891              	.LVL495:
 3892 013c 0760     		str	r7, [r0, #0]
1436:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_WRITE_SINGLE_BLOCK;
 3893              		.loc 1 1436 0
 3894 013e 1824     		movs	r4, #24
 3895              	.LVL496:
 3896 0140 4460     		str	r4, [r0, #4]
1437:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 3897              		.loc 1 1437 0
 3898 0142 4027     		movs	r7, #64
 3899              	.LVL497:
 3900 0144 8760     		str	r7, [r0, #8]
1438:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 3901              		.loc 1 1438 0
 3902 0146 0027     		movs	r7, #0
 3903 0148 C760     		str	r7, [r0, #12]
1439:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 3904              		.loc 1 1439 0
 3905 014a 4FF48063 		mov	r3, #1024
 3906 014e 0361     		str	r3, [r0, #16]
1440:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 3907              		.loc 1 1440 0
 3908 0150 FFF7FEFF 		bl	SDIO_SendCommand
 3909              	.LVL498:
1442:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_WRITE_SINGLE_BLOCK);
 3910              		.loc 1 1442 0
 3911 0154 2046     		mov	r0, r4
 3912 0156 FFF7FEFF 		bl	CmdResp1Error
 3913              	.LVL499:
1444:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
 3914              		.loc 1 1444 0
 3915 015a 2A28     		cmp	r0, #42
 3916 015c 40F0AD80 		bne	.L319
1449:lib/ff/sdio_stm32f1.c ****   TotalNumberOfBytes = BlockSize;
 3917              		.loc 1 1449 0
 3918 0160 594C     		ldr	r4, .L383+8
 3919 0162 2560     		str	r5, [r4, #0]
1450:lib/ff/sdio_stm32f1.c ****   StopCondition = 0;
 3920              		.loc 1 1450 0
 3921 0164 5E4A     		ldr	r2, .L383+32
 3922 0166 1760     		str	r7, [r2, #0]
1451:lib/ff/sdio_stm32f1.c ****   SrcBuffer = (uint32_t *)writebuff;
 3923              		.loc 1 1451 0
 3924 0168 5E48     		ldr	r0, .L383+36
 3925              	.LVL500:
 3926 016a 0660     		str	r6, [r0, #0]
1453:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataTimeOut = SD_DATATIMEOUT;
 3927              		.loc 1 1453 0
 3928 016c 5748     		ldr	r0, .L383+12
 3929 016e 584A     		ldr	r2, .L383+16
1454:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataLength = BlockSize;
 3930              		.loc 1 1454 0
 3931 0170 80E82400 		stmia	r0, {r2, r5}
1455:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataBlockSize = (uint32_t) power << 4;
 3932              		.loc 1 1455 0
 3933 0174 4FEA0811 		lsl	r1, r8, #4
 3934 0178 8160     		str	r1, [r0, #8]
1456:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToCard;
 3935              		.loc 1 1456 0
 3936 017a C760     		str	r7, [r0, #12]
1457:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
 3937              		.loc 1 1457 0
 3938 017c 0761     		str	r7, [r0, #16]
1458:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Enable;
 3939              		.loc 1 1458 0
 3940 017e 0124     		movs	r4, #1
 3941 0180 4461     		str	r4, [r0, #20]
1459:lib/ff/sdio_stm32f1.c ****   SDIO_DataConfig(&SDIO_DataInitStructure);
 3942              		.loc 1 1459 0
 3943 0182 FFF7FEFF 		bl	SDIO_DataConfig
 3944              	.LVL501:
1462:lib/ff/sdio_stm32f1.c ****   if (DeviceMode == SD_POLLING_MODE)
 3945              		.loc 1 1462 0
 3946 0186 584B     		ldr	r3, .L383+40
 3947 0188 1968     		ldr	r1, [r3, #0]
 3948 018a 0229     		cmp	r1, #2
 3949 018c 56D1     		bne	.L377
 3950 018e 3446     		mov	r4, r6
 3951 0190 3D46     		mov	r5, r7
 3952              	.LVL502:
 3953              	.L376:
1464:lib/ff/sdio_stm32f1.c ****     while (!(SDIO->STA & (SDIO_FLAG_DBCKEND | SDIO_FLAG_TXUNDERR | SDIO_FLAG_DCRCFAIL | SDIO_FLAG_D
 3954              		.loc 1 1464 0 discriminator 1
 3955 0192 564E     		ldr	r6, .L383+44
 3956 0194 726B     		ldr	r2, [r6, #52]
 3957 0196 40F21A66 		movw	r6, #1562
 3958 019a 1640     		ands	r6, r6, r2
 3959 019c 3EBB     		cbnz	r6, .L381
 3960              	.L336:
1466:lib/ff/sdio_stm32f1.c ****       if (SDIO_GetFlagStatus(SDIO_FLAG_TXFIFOHE) != RESET)
 3961              		.loc 1 1466 0
 3962 019e 4FF48040 		mov	r0, #16384
 3963 01a2 FFF7FEFF 		bl	SDIO_GetFlagStatus
 3964              	.LVL503:
 3965 01a6 0028     		cmp	r0, #0
 3966 01a8 F3D0     		beq	.L376
1468:lib/ff/sdio_stm32f1.c ****         if ((TotalNumberOfBytes - bytestransferred) < 32)
 3967              		.loc 1 1468 0
 3968 01aa 4748     		ldr	r0, .L383+8
 3969 01ac 0268     		ldr	r2, [r0, #0]
 3970 01ae 531B     		subs	r3, r2, r5
 3971 01b0 1F2B     		cmp	r3, #31
 3972 01b2 13D8     		bhi	.L330
1470:lib/ff/sdio_stm32f1.c ****           restwords = ((TotalNumberOfBytes - bytestransferred) % 4 == 0) ? ((TotalNumberOfBytes - b
 3973              		.loc 1 1470 0
 3974 01b4 13F0030F 		tst	r3, #3
 3975 01b8 4FEA9307 		lsr	r7, r3, #2
 3976 01bc 18BF     		it	ne
 3977 01be 0137     		addne	r7, r7, #1
 3978              	.LVL504:
1472:lib/ff/sdio_stm32f1.c ****           for (count = 0; count < restwords; count++, tempbuff++, bytestransferred += 4)
 3979              		.loc 1 1472 0
 3980 01c0 0026     		movs	r6, #0
 3981              	.LVL505:
 3982              	.L333:
1472:lib/ff/sdio_stm32f1.c ****           for (count = 0; count < restwords; count++, tempbuff++, bytestransferred += 4)
 3983              		.loc 1 1472 0 is_stmt 0 discriminator 1
 3984 01c2 BE42     		cmp	r6, r7
 3985 01c4 4FEA8601 		lsl	r1, r6, #2
 3986 01c8 05D0     		beq	.L382
 3987              	.L334:
1474:lib/ff/sdio_stm32f1.c ****             SDIO_WriteData(*tempbuff);
 3988              		.loc 1 1474 0 is_stmt 1 discriminator 2
 3989 01ca 54F82600 		ldr	r0, [r4, r6, lsl #2]
 3990 01ce FFF7FEFF 		bl	SDIO_WriteData
 3991              	.LVL506:
1472:lib/ff/sdio_stm32f1.c ****           for (count = 0; count < restwords; count++, tempbuff++, bytestransferred += 4)
 3992              		.loc 1 1472 0 discriminator 2
 3993 01d2 0136     		adds	r6, r6, #1
 3994              	.LVL507:
 3995 01d4 F5E7     		b	.L333
 3996              	.L382:
 3997 01d6 6D18     		adds	r5, r5, r1
 3998 01d8 6418     		adds	r4, r4, r1
 3999 01da DAE7     		b	.L376
 4000              	.LVL508:
 4001              	.L330:
1481:lib/ff/sdio_stm32f1.c ****             SDIO_WriteData(*(tempbuff + count));
 4002              		.loc 1 1481 0 discriminator 2
 4003 01dc A059     		ldr	r0, [r4, r6]
 4004 01de FFF7FEFF 		bl	SDIO_WriteData
 4005              	.LVL509:
 4006 01e2 0436     		adds	r6, r6, #4
1479:lib/ff/sdio_stm32f1.c ****           for (count = 0; count < 8; count++)
 4007              		.loc 1 1479 0 discriminator 2
 4008 01e4 202E     		cmp	r6, #32
 4009 01e6 F9D1     		bne	.L330
1483:lib/ff/sdio_stm32f1.c ****           tempbuff += 8;
 4010              		.loc 1 1483 0
 4011 01e8 2034     		adds	r4, r4, #32
 4012              	.LVL510:
1484:lib/ff/sdio_stm32f1.c ****           bytestransferred += 32;
 4013              		.loc 1 1484 0
 4014 01ea 2035     		adds	r5, r5, #32
 4015              	.LVL511:
 4016 01ec D1E7     		b	.L376
 4017              	.L381:
1488:lib/ff/sdio_stm32f1.c ****     if (SDIO_GetFlagStatus(SDIO_FLAG_DTIMEOUT) != RESET)
 4018              		.loc 1 1488 0
 4019 01ee 0820     		movs	r0, #8
 4020 01f0 FFF7FEFF 		bl	SDIO_GetFlagStatus
 4021              	.LVL512:
 4022 01f4 20B1     		cbz	r0, .L337
1490:lib/ff/sdio_stm32f1.c ****       SDIO_ClearFlag(SDIO_FLAG_DTIMEOUT);
 4023              		.loc 1 1490 0
 4024 01f6 0820     		movs	r0, #8
 4025 01f8 FFF7FEFF 		bl	SDIO_ClearFlag
 4026              	.LVL513:
1492:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
 4027              		.loc 1 1492 0
 4028 01fc 0420     		movs	r0, #4
 4029 01fe 5CE0     		b	.L319
 4030              	.LVL514:
 4031              	.L337:
1494:lib/ff/sdio_stm32f1.c ****     else if (SDIO_GetFlagStatus(SDIO_FLAG_DCRCFAIL) != RESET)
 4032              		.loc 1 1494 0
 4033 0200 0220     		movs	r0, #2
 4034 0202 FFF7FEFF 		bl	SDIO_GetFlagStatus
 4035              	.LVL515:
 4036 0206 20B1     		cbz	r0, .L338
1496:lib/ff/sdio_stm32f1.c ****       SDIO_ClearFlag(SDIO_FLAG_DCRCFAIL);
 4037              		.loc 1 1496 0
 4038 0208 0220     		movs	r0, #2
 4039 020a FFF7FEFF 		bl	SDIO_ClearFlag
 4040              	.LVL516:
1498:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
 4041              		.loc 1 1498 0
 4042 020e 0220     		movs	r0, #2
 4043 0210 53E0     		b	.L319
 4044              	.LVL517:
 4045              	.L338:
1500:lib/ff/sdio_stm32f1.c ****     else if (SDIO_GetFlagStatus(SDIO_FLAG_TXUNDERR) != RESET)
 4046              		.loc 1 1500 0
 4047 0212 1020     		movs	r0, #16
 4048 0214 FFF7FEFF 		bl	SDIO_GetFlagStatus
 4049              	.LVL518:
 4050 0218 20B1     		cbz	r0, .L339
1502:lib/ff/sdio_stm32f1.c ****       SDIO_ClearFlag(SDIO_FLAG_TXUNDERR);
 4051              		.loc 1 1502 0
 4052 021a 1020     		movs	r0, #16
 4053 021c FFF7FEFF 		bl	SDIO_ClearFlag
 4054              	.LVL519:
1504:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
 4055              		.loc 1 1504 0
 4056 0220 0520     		movs	r0, #5
 4057 0222 4AE0     		b	.L319
 4058              	.LVL520:
 4059              	.L339:
1506:lib/ff/sdio_stm32f1.c ****     else if (SDIO_GetFlagStatus(SDIO_FLAG_STBITERR) != RESET)
 4060              		.loc 1 1506 0
 4061 0224 4FF40070 		mov	r0, #512
 4062 0228 FFF7FEFF 		bl	SDIO_GetFlagStatus
 4063              	.LVL521:
 4064 022c 0028     		cmp	r0, #0
 4065 022e 31D0     		beq	.L340
1508:lib/ff/sdio_stm32f1.c ****       SDIO_ClearFlag(SDIO_FLAG_STBITERR);
 4066              		.loc 1 1508 0
 4067 0230 4FF40070 		mov	r0, #512
 4068 0234 FFF7FEFF 		bl	SDIO_ClearFlag
 4069              	.LVL522:
1510:lib/ff/sdio_stm32f1.c ****       return(errorstatus);
 4070              		.loc 1 1510 0
 4071 0238 0720     		movs	r0, #7
 4072 023a 3EE0     		b	.L319
 4073              	.LVL523:
 4074              	.L377:
1513:lib/ff/sdio_stm32f1.c ****   else if (DeviceMode == SD_INTERRUPT_MODE)
 4075              		.loc 1 1513 0
 4076 023c 0129     		cmp	r1, #1
 4077 023e 0BD1     		bne	.L341
1515:lib/ff/sdio_stm32f1.c ****     SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND | SDIO_FLAG_TXFIFOHE | SDIO
 4078              		.loc 1 1515 0
 4079 0240 44F21A30 		movw	r0, #17178
 4080 0244 FFF7FEFF 		bl	SDIO_ITConfig
 4081              	.LVL524:
 4082              	.L343:
1516:lib/ff/sdio_stm32f1.c ****     while ((TransferEnd == 0) && (TransferError == SD_OK))
 4083              		.loc 1 1516 0 discriminator 1
 4084 0248 1E49     		ldr	r1, .L383+4
 4085 024a 0A68     		ldr	r2, [r1, #0]
 4086 024c 1C49     		ldr	r1, .L383
 4087 024e DAB9     		cbnz	r2, .L344
1516:lib/ff/sdio_stm32f1.c ****     while ((TransferEnd == 0) && (TransferError == SD_OK))
 4088              		.loc 1 1516 0 is_stmt 0 discriminator 2
 4089 0250 0878     		ldrb	r0, [r1, #0]	@ zero_extendqisi2
 4090 0252 2A28     		cmp	r0, #42
 4091 0254 F8D0     		beq	.L343
 4092 0256 17E0     		b	.L344
 4093              	.L341:
1523:lib/ff/sdio_stm32f1.c ****   else if (DeviceMode == SD_DMA_MODE)
 4094              		.loc 1 1523 0 is_stmt 1
 4095 0258 E1B9     		cbnz	r1, .L340
1525:lib/ff/sdio_stm32f1.c ****     SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND | SDIO_IT_TXUNDERR | SDIO_I
 4096              		.loc 1 1525 0
 4097 025a 40F21A30 		movw	r0, #794
 4098 025e 2146     		mov	r1, r4
 4099 0260 FFF7FEFF 		bl	SDIO_ITConfig
 4100              	.LVL525:
1526:lib/ff/sdio_stm32f1.c ****     SD_LowLevel_DMA_TxConfig((uint32_t *)writebuff, BlockSize);
 4101              		.loc 1 1526 0
 4102 0264 3046     		mov	r0, r6
 4103 0266 2946     		mov	r1, r5
 4104 0268 FFF7FEFF 		bl	SD_LowLevel_DMA_TxConfig
 4105              	.LVL526:
1527:lib/ff/sdio_stm32f1.c ****     SDIO_DMACmd(ENABLE);
 4106              		.loc 1 1527 0
 4107 026c 2046     		mov	r0, r4
 4108 026e FFF7FEFF 		bl	SDIO_DMACmd
 4109              	.LVL527:
 4110              	.L345:
 4111              	.LBB62:
 4112              	.LBB63:
3131:lib/ff/sdio_stm32f1.c ****   return (uint32_t)DMA_GetFlagStatus(DMA2_FLAG_TC4);
 4113              		.loc 1 3131 0 discriminator 1
 4114 0272 1F48     		ldr	r0, .L383+48
 4115 0274 FFF7FEFF 		bl	DMA_GetFlagStatus
 4116              	.LVL528:
 4117 0278 1149     		ldr	r1, .L383
 4118              	.LBE63:
 4119              	.LBE62:
1528:lib/ff/sdio_stm32f1.c ****     while ((SD_DMAEndOfTransferStatus() == RESET) && (TransferEnd == 0) && (TransferError == SD_OK)
 4120              		.loc 1 1528 0 discriminator 1
 4121 027a 28B9     		cbnz	r0, .L344
1528:lib/ff/sdio_stm32f1.c ****     while ((SD_DMAEndOfTransferStatus() == RESET) && (TransferEnd == 0) && (TransferError == SD_OK)
 4122              		.loc 1 1528 0 is_stmt 0 discriminator 2
 4123 027c 114A     		ldr	r2, .L383+4
 4124 027e 1068     		ldr	r0, [r2, #0]
 4125 0280 10B9     		cbnz	r0, .L344
1528:lib/ff/sdio_stm32f1.c ****     while ((SD_DMAEndOfTransferStatus() == RESET) && (TransferEnd == 0) && (TransferError == SD_OK)
 4126              		.loc 1 1528 0 discriminator 1
 4127 0282 0B78     		ldrb	r3, [r1, #0]	@ zero_extendqisi2
 4128 0284 2A2B     		cmp	r3, #42
 4129 0286 F4D0     		beq	.L345
 4130              	.L344:
1530:lib/ff/sdio_stm32f1.c ****     if (TransferError != SD_OK)
 4131              		.loc 1 1530 0 is_stmt 1
 4132 0288 0B78     		ldrb	r3, [r1, #0]	@ zero_extendqisi2
 4133 028a 2A2B     		cmp	r3, #42
 4134 028c 02D0     		beq	.L340
1532:lib/ff/sdio_stm32f1.c ****       return(TransferError);
 4135              		.loc 1 1532 0
 4136 028e 0C49     		ldr	r1, .L383
 4137 0290 0878     		ldrb	r0, [r1, #0]	@ zero_extendqisi2
 4138 0292 12E0     		b	.L319
 4139              	.LVL529:
 4140              	.L340:
1537:lib/ff/sdio_stm32f1.c ****   SDIO_ClearFlag(SDIO_STATIC_FLAGS);
 4141              		.loc 1 1537 0
 4142 0294 40F2FF50 		movw	r0, #1535
 4143 0298 FFF7FEFF 		bl	SDIO_ClearFlag
 4144              	.LVL530:
 4145              	.L347:
1544:lib/ff/sdio_stm32f1.c ****     errorstatus = IsCardProgramming(&cardstate);
 4146              		.loc 1 1544 0
 4147 029c 0DF10F00 		add	r0, sp, #15
 4148 02a0 FFF7FEFF 		bl	IsCardProgramming
 4149              	.LVL531:
1542:lib/ff/sdio_stm32f1.c ****   while ((errorstatus == SD_OK) && ((cardstate == SD_CARD_PROGRAMMING) || (cardstate == SD_CARD_REC
 4150              		.loc 1 1542 0
 4151 02a4 2A28     		cmp	r0, #42
 4152 02a6 08D1     		bne	.L319
1542:lib/ff/sdio_stm32f1.c ****   while ((errorstatus == SD_OK) && ((cardstate == SD_CARD_PROGRAMMING) || (cardstate == SD_CARD_REC
 4153              		.loc 1 1542 0 is_stmt 0 discriminator 2
 4154 02a8 9DF80F30 		ldrb	r3, [sp, #15]	@ zero_extendqisi2
 4155              	.LVL532:
 4156 02ac 991F     		subs	r1, r3, #6
 4157              	.LVL533:
 4158 02ae 0129     		cmp	r1, #1
 4159 02b0 F4D9     		bls	.L347
 4160 02b2 02E0     		b	.L319
 4161              	.LVL534:
 4162              	.L348:
1357:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 4163              		.loc 1 1357 0 is_stmt 1
 4164 02b4 0E20     		movs	r0, #14
 4165 02b6 00E0     		b	.L319
 4166              	.LVL535:
 4167              	.L350:
1431:lib/ff/sdio_stm32f1.c ****     return(SD_ERROR);
 4168              		.loc 1 1431 0
 4169 02b8 2920     		movs	r0, #41
 4170              	.LVL536:
 4171              	.L319:
1548:lib/ff/sdio_stm32f1.c **** }
 4172              		.loc 1 1548 0
 4173 02ba 05B0     		add	sp, sp, #20
 4174 02bc BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, sl, fp, pc}
 4175              	.L384:
 4176              		.align	2
 4177              	.L383:
 4178 02c0 00000000 		.word	.LANCHOR9
 4179 02c4 00000000 		.word	.LANCHOR10
 4180 02c8 00000000 		.word	.LANCHOR11
 4181 02cc 00000000 		.word	.LANCHOR2
 4182 02d0 FFFF0F00 		.word	1048575
 4183 02d4 00000000 		.word	.LANCHOR4
 4184 02d8 00000000 		.word	.LANCHOR0
 4185 02dc 00000000 		.word	.LANCHOR1
 4186 02e0 00000000 		.word	.LANCHOR12
 4187 02e4 00000000 		.word	.LANCHOR14
 4188 02e8 00000000 		.word	.LANCHOR7
 4189 02ec 00800140 		.word	1073840128
 4190 02f0 00200010 		.word	268443648
 4191              		.cfi_endproc
 4192              	.LFE70:
 4194              		.section	.text.SD_WriteMultiBlocks,"ax",%progbits
 4195              		.align	1
 4196              		.global	SD_WriteMultiBlocks
 4197              		.thumb
 4198              		.thumb_func
 4200              	SD_WriteMultiBlocks:
 4201              	.LFB71:
1562:lib/ff/sdio_stm32f1.c **** {
 4202              		.loc 1 1562 0
 4203              		.cfi_startproc
 4204              		@ args = 0, pretend = 0, frame = 24
 4205              		@ frame_needed = 0, uses_anonymous_args = 0
 4206              	.LVL537:
 4207 0000 2DE9F04F 		push	{r4, r5, r6, r7, r8, r9, sl, fp, lr}
 4208              	.LCFI21:
 4209              		.cfi_def_cfa_offset 36
 4210              		.cfi_offset 4, -36
 4211              		.cfi_offset 5, -32
 4212              		.cfi_offset 6, -28
 4213              		.cfi_offset 7, -24
 4214              		.cfi_offset 8, -20
 4215              		.cfi_offset 9, -16
 4216              		.cfi_offset 10, -12
 4217              		.cfi_offset 11, -8
 4218              		.cfi_offset 14, -4
 4219 0004 87B0     		sub	sp, sp, #28
 4220              	.LCFI22:
 4221              		.cfi_def_cfa_offset 64
 4222 0006 8A46     		mov	sl, r1
 4223 0008 1446     		mov	r4, r2
 4224 000a 9B46     		mov	fp, r3
 4225              	.LVL538:
1564:lib/ff/sdio_stm32f1.c ****   uint8_t  power = 0, cardstate = 0;
 4226              		.loc 1 1564 0
 4227 000c 0026     		movs	r6, #0
 4228 000e 8DF81360 		strb	r6, [sp, #19]
 4229              	.LVL539:
1568:lib/ff/sdio_stm32f1.c ****   __IO uint32_t count = 0;
 4230              		.loc 1 1568 0
 4231 0012 0596     		str	r6, [sp, #20]
 4232              	.LVL540:
1570:lib/ff/sdio_stm32f1.c ****   if (writebuff == NULL)
 4233              		.loc 1 1570 0
 4234 0014 0390     		str	r0, [sp, #12]
 4235 0016 08B9     		cbnz	r0, .L386
 4236              	.LVL541:
 4237              	.L389:
1573:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 4238              		.loc 1 1573 0
 4239 0018 2620     		movs	r0, #38
 4240 001a A8E1     		b	.L387
 4241              	.LVL542:
 4242              	.L386:
1576:lib/ff/sdio_stm32f1.c ****   TransferError = SD_OK;
 4243              		.loc 1 1576 0
 4244 001c 2A22     		movs	r2, #42
 4245              	.LVL543:
 4246 001e AB4B     		ldr	r3, .L457
 4247              	.LVL544:
 4248 0020 1A70     		strb	r2, [r3, #0]
1577:lib/ff/sdio_stm32f1.c ****   TransferEnd = 0;
 4249              		.loc 1 1577 0
 4250 0022 AB48     		ldr	r0, .L457+4
 4251              	.LVL545:
 4252 0024 0660     		str	r6, [r0, #0]
1578:lib/ff/sdio_stm32f1.c ****   TotalNumberOfBytes = 0;
 4253              		.loc 1 1578 0
 4254 0026 AB49     		ldr	r1, .L457+8
 4255              	.LVL546:
 4256 0028 0E60     		str	r6, [r1, #0]
1580:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataTimeOut = SD_DATATIMEOUT;
 4257              		.loc 1 1580 0
 4258 002a AB48     		ldr	r0, .L457+12
 4259 002c AB4B     		ldr	r3, .L457+16
1581:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataLength = 0;
 4260              		.loc 1 1581 0
 4261 002e 80E84800 		stmia	r0, {r3, r6}
1582:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataBlockSize = SDIO_DataBlockSize_1b;
 4262              		.loc 1 1582 0
 4263 0032 8660     		str	r6, [r0, #8]
1583:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToCard;
 4264              		.loc 1 1583 0
 4265 0034 C660     		str	r6, [r0, #12]
1584:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
 4266              		.loc 1 1584 0
 4267 0036 0661     		str	r6, [r0, #16]
1585:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Disable;
 4268              		.loc 1 1585 0
 4269 0038 4661     		str	r6, [r0, #20]
1586:lib/ff/sdio_stm32f1.c ****   SDIO_DataConfig(&SDIO_DataInitStructure);
 4270              		.loc 1 1586 0
 4271 003a FFF7FEFF 		bl	SDIO_DataConfig
 4272              	.LVL547:
1587:lib/ff/sdio_stm32f1.c ****   SDIO_DMACmd(DISABLE);
 4273              		.loc 1 1587 0
 4274 003e 3046     		mov	r0, r6
 4275 0040 FFF7FEFF 		bl	SDIO_DMACmd
 4276              	.LVL548:
1589:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetResponse(SDIO_RESP1) & SD_CARD_LOCKED)
 4277              		.loc 1 1589 0
 4278 0044 3046     		mov	r0, r6
 4279 0046 FFF7FEFF 		bl	SDIO_GetResponse
 4280              	.LVL549:
 4281 004a 8001     		lsls	r0, r0, #6
 4282 004c 00F18E81 		bmi	.L421
1595:lib/ff/sdio_stm32f1.c ****   if (CardType == SDIO_HIGH_CAPACITY_SD_CARD)
 4283              		.loc 1 1595 0
 4284 0050 A34A     		ldr	r2, .L457+20
 4285 0052 1368     		ldr	r3, [r2, #0]
 4286 0054 022B     		cmp	r3, #2
 4287              	.LVL550:
1598:lib/ff/sdio_stm32f1.c ****     WriteAddr /= 512;
 4288              		.loc 1 1598 0
 4289 0056 04BF     		itt	eq
 4290 0058 4FEA5A2A 		lsreq	sl, sl, #9
 4291              	.LVL551:
1597:lib/ff/sdio_stm32f1.c ****     BlockSize = 512;
 4292              		.loc 1 1597 0
 4293 005c 4FF40074 		moveq	r4, #512
 4294              	.LVL552:
1602:lib/ff/sdio_stm32f1.c ****   if ((BlockSize > 0) && (BlockSize <= 2048) && ((BlockSize & (BlockSize - 1)) == 0))
 4295              		.loc 1 1602 0
 4296 0060 04F1FF39 		add	r9, r4, #-1
 4297 0064 1FFA89F0 		uxth	r0, r9
 4298 0068 B0F5006F 		cmp	r0, #2048
 4299 006c D4D2     		bcs	.L389
1602:lib/ff/sdio_stm32f1.c ****   if ((BlockSize > 0) && (BlockSize <= 2048) && ((BlockSize & (BlockSize - 1)) == 0))
 4300              		.loc 1 1602 0 is_stmt 0 discriminator 1
 4301 006e 19EA0409 		ands	r9, r9, r4
 4302 0072 D1D1     		bne	.L389
1602:lib/ff/sdio_stm32f1.c ****   if ((BlockSize > 0) && (BlockSize <= 2048) && ((BlockSize & (BlockSize - 1)) == 0))
 4303              		.loc 1 1602 0
 4304 0074 2546     		mov	r5, r4
 4305              	.L390:
 4306              	.LVL553:
 4307              	.LBB68:
 4308              	.LBB69:
3040:lib/ff/sdio_stm32f1.c ****   while (NumberOfBytes != 1)
 4309              		.loc 1 3040 0 is_stmt 1
 4310 0076 012D     		cmp	r5, #1
 4311 0078 06D0     		beq	.L452
 4312              	.L391:
3042:lib/ff/sdio_stm32f1.c ****     NumberOfBytes >>= 1;
 4313              		.loc 1 3042 0
 4314 007a C5F34F05 		ubfx	r5, r5, #1, #16
 4315              	.LVL554:
3043:lib/ff/sdio_stm32f1.c ****     count++;
 4316              		.loc 1 3043 0
 4317 007e 09F10109 		add	r9, r9, #1
 4318              	.LVL555:
 4319 0082 5FFA89F9 		uxtb	r9, r9
 4320              	.LVL556:
 4321 0086 F6E7     		b	.L390
 4322              	.L452:
 4323              	.LVL557:
 4324              	.LBE69:
 4325              	.LBE68:
1606:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) BlockSize;
 4326              		.loc 1 1606 0
 4327 0088 964D     		ldr	r5, .L457+24
 4328              	.LVL558:
 4329 008a 2C60     		str	r4, [r5, #0]
1607:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SET_BLOCKLEN;
 4330              		.loc 1 1607 0
 4331 008c 1021     		movs	r1, #16
 4332 008e 6960     		str	r1, [r5, #4]
1608:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 4333              		.loc 1 1608 0
 4334 0090 4FF04008 		mov	r8, #64
 4335 0094 C5F80880 		str	r8, [r5, #8]
1609:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 4336              		.loc 1 1609 0
 4337 0098 0027     		movs	r7, #0
 4338 009a EF60     		str	r7, [r5, #12]
1610:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 4339              		.loc 1 1610 0
 4340 009c 4FF48066 		mov	r6, #1024
 4341 00a0 2E61     		str	r6, [r5, #16]
1611:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
 4342              		.loc 1 1611 0
 4343 00a2 2846     		mov	r0, r5
 4344 00a4 0191     		str	r1, [sp, #4]
 4345 00a6 FFF7FEFF 		bl	SDIO_SendCommand
 4346              	.LVL559:
1613:lib/ff/sdio_stm32f1.c ****     errorstatus = CmdResp1Error(SD_CMD_SET_BLOCKLEN);
 4347              		.loc 1 1613 0
 4348 00aa 019A     		ldr	r2, [sp, #4]
 4349 00ac 1046     		mov	r0, r2
 4350 00ae FFF7FEFF 		bl	CmdResp1Error
 4351              	.LVL560:
1615:lib/ff/sdio_stm32f1.c ****     if (errorstatus != SD_OK)
 4352              		.loc 1 1615 0
 4353 00b2 2A28     		cmp	r0, #42
 4354 00b4 40F05B81 		bne	.L387
1627:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) (RCA << 16);
 4355              		.loc 1 1627 0
 4356 00b8 8B4B     		ldr	r3, .L457+28
 4357 00ba 1868     		ldr	r0, [r3, #0]
 4358              	.LVL561:
 4359 00bc 0104     		lsls	r1, r0, #16
 4360 00be 2960     		str	r1, [r5, #0]
1628:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SEND_STATUS;
 4361              		.loc 1 1628 0
 4362 00c0 0D22     		movs	r2, #13
 4363 00c2 6A60     		str	r2, [r5, #4]
1629:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 4364              		.loc 1 1629 0
 4365 00c4 C5F80880 		str	r8, [r5, #8]
1630:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 4366              		.loc 1 1630 0
 4367 00c8 EF60     		str	r7, [r5, #12]
1631:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 4368              		.loc 1 1631 0
 4369 00ca 2E61     		str	r6, [r5, #16]
1632:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 4370              		.loc 1 1632 0
 4371 00cc 2846     		mov	r0, r5
 4372 00ce 0292     		str	r2, [sp, #8]
 4373 00d0 0193     		str	r3, [sp, #4]
 4374 00d2 FFF7FEFF 		bl	SDIO_SendCommand
 4375              	.LVL562:
1634:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_SEND_STATUS);
 4376              		.loc 1 1634 0
 4377 00d6 029B     		ldr	r3, [sp, #8]
 4378 00d8 1846     		mov	r0, r3
 4379 00da FFF7FEFF 		bl	CmdResp1Error
 4380              	.LVL563:
1636:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
 4381              		.loc 1 1636 0
 4382 00de 2A28     		cmp	r0, #42
 4383 00e0 019A     		ldr	r2, [sp, #4]
 4384 00e2 40F04481 		bne	.L387
1641:lib/ff/sdio_stm32f1.c ****   if (NumberOfBlocks > 1)
 4385              		.loc 1 1641 0
 4386 00e6 BBF1010F 		cmp	fp, #1
 4387 00ea 40F22581 		bls	.L392
1644:lib/ff/sdio_stm32f1.c ****     if (NumberOfBlocks * BlockSize > SD_MAX_DATA_LENGTH)
 4388              		.loc 1 1644 0
 4389 00ee 0BFB04F4 		mul	r4, fp, r4
 4390              	.LVL564:
 4391 00f2 B4F1007F 		cmp	r4, #33554432
 4392 00f6 8FD2     		bcs	.L389
1650:lib/ff/sdio_stm32f1.c ****     if ((SDIO_STD_CAPACITY_SD_CARD_V1_1 == CardType) || (SDIO_STD_CAPACITY_SD_CARD_V2_0 == CardType
 4393              		.loc 1 1650 0
 4394 00f8 7948     		ldr	r0, .L457+20
 4395              	.LVL565:
 4396 00fa 0168     		ldr	r1, [r0, #0]
 4397 00fc 0229     		cmp	r1, #2
 4398 00fe 14D9     		bls	.L393
 4399              	.LVL566:
 4400              	.L395:
1684:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Argument = (uint32_t)WriteAddr;
 4401              		.loc 1 1684 0
 4402 0100 7848     		ldr	r0, .L457+24
 4403 0102 C0F800A0 		str	sl, [r0, #0]
1685:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_WRITE_MULT_BLOCK;
 4404              		.loc 1 1685 0
 4405 0106 1927     		movs	r7, #25
 4406 0108 4760     		str	r7, [r0, #4]
1686:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 4407              		.loc 1 1686 0
 4408 010a 4026     		movs	r6, #64
 4409 010c 8660     		str	r6, [r0, #8]
1687:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 4410              		.loc 1 1687 0
 4411 010e 0026     		movs	r6, #0
 4412 0110 C660     		str	r6, [r0, #12]
1688:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 4413              		.loc 1 1688 0
 4414 0112 4FF48063 		mov	r3, #1024
 4415 0116 0361     		str	r3, [r0, #16]
1689:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
 4416              		.loc 1 1689 0
 4417 0118 FFF7FEFF 		bl	SDIO_SendCommand
 4418              	.LVL567:
1691:lib/ff/sdio_stm32f1.c ****     errorstatus = CmdResp1Error(SD_CMD_WRITE_MULT_BLOCK);
 4419              		.loc 1 1691 0
 4420 011c 3846     		mov	r0, r7
 4421 011e FFF7FEFF 		bl	CmdResp1Error
 4422              	.LVL568:
1693:lib/ff/sdio_stm32f1.c ****     if (SD_OK != errorstatus)
 4423              		.loc 1 1693 0
 4424 0122 2A28     		cmp	r0, #42
 4425 0124 40F02381 		bne	.L387
 4426 0128 26E0     		b	.L453
 4427              	.LVL569:
 4428              	.L393:
1653:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) (RCA << 16);
 4429              		.loc 1 1653 0
 4430 012a 1368     		ldr	r3, [r2, #0]
 4431 012c 1A04     		lsls	r2, r3, #16
 4432 012e 2A60     		str	r2, [r5, #0]
1654:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_CMD;
 4433              		.loc 1 1654 0
 4434 0130 3721     		movs	r1, #55
 4435 0132 6960     		str	r1, [r5, #4]
1655:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 4436              		.loc 1 1655 0
 4437 0134 C5F80880 		str	r8, [r5, #8]
1656:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 4438              		.loc 1 1656 0
 4439 0138 EF60     		str	r7, [r5, #12]
1657:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 4440              		.loc 1 1657 0
 4441 013a 2E61     		str	r6, [r5, #16]
1658:lib/ff/sdio_stm32f1.c ****       SDIO_SendCommand(&SDIO_CmdInitStructure);
 4442              		.loc 1 1658 0
 4443 013c 2846     		mov	r0, r5
 4444 013e 0191     		str	r1, [sp, #4]
 4445 0140 FFF7FEFF 		bl	SDIO_SendCommand
 4446              	.LVL570:
1661:lib/ff/sdio_stm32f1.c ****       errorstatus = CmdResp1Error(SD_CMD_APP_CMD);
 4447              		.loc 1 1661 0
 4448 0144 0198     		ldr	r0, [sp, #4]
 4449 0146 FFF7FEFF 		bl	CmdResp1Error
 4450              	.LVL571:
1663:lib/ff/sdio_stm32f1.c ****       if (errorstatus != SD_OK)
 4451              		.loc 1 1663 0
 4452 014a 2A28     		cmp	r0, #42
 4453 014c 40F00F81 		bne	.L387
1668:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Argument = (uint32_t)NumberOfBlocks;
 4454              		.loc 1 1668 0
 4455 0150 C5F800B0 		str	fp, [r5, #0]
1669:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SET_BLOCK_COUNT;
 4456              		.loc 1 1669 0
 4457 0154 4FF0170B 		mov	fp, #23
 4458              	.LVL572:
 4459 0158 C5F804B0 		str	fp, [r5, #4]
1670:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 4460              		.loc 1 1670 0
 4461 015c C5F80880 		str	r8, [r5, #8]
1671:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 4462              		.loc 1 1671 0
 4463 0160 EF60     		str	r7, [r5, #12]
1672:lib/ff/sdio_stm32f1.c ****       SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 4464              		.loc 1 1672 0
 4465 0162 2E61     		str	r6, [r5, #16]
1673:lib/ff/sdio_stm32f1.c ****       SDIO_SendCommand(&SDIO_CmdInitStructure);
 4466              		.loc 1 1673 0
 4467 0164 2846     		mov	r0, r5
 4468              	.LVL573:
 4469 0166 FFF7FEFF 		bl	SDIO_SendCommand
 4470              	.LVL574:
1675:lib/ff/sdio_stm32f1.c ****       errorstatus = CmdResp1Error(SD_CMD_SET_BLOCK_COUNT);
 4471              		.loc 1 1675 0
 4472 016a 5846     		mov	r0, fp
 4473 016c FFF7FEFF 		bl	CmdResp1Error
 4474              	.LVL575:
1677:lib/ff/sdio_stm32f1.c ****       if (errorstatus != SD_OK)
 4475              		.loc 1 1677 0
 4476 0170 2A28     		cmp	r0, #42
 4477 0172 40F0FC80 		bne	.L387
 4478 0176 C3E7     		b	.L395
 4479              	.L453:
1698:lib/ff/sdio_stm32f1.c ****     TotalNumberOfBytes = NumberOfBlocks * BlockSize;
 4480              		.loc 1 1698 0
 4481 0178 564F     		ldr	r7, .L457+8
 4482 017a 3C60     		str	r4, [r7, #0]
1699:lib/ff/sdio_stm32f1.c ****     StopCondition = 1;
 4483              		.loc 1 1699 0
 4484 017c 0127     		movs	r7, #1
 4485 017e 5B4A     		ldr	r2, .L457+32
 4486 0180 1760     		str	r7, [r2, #0]
1700:lib/ff/sdio_stm32f1.c ****     SrcBuffer = (uint32_t *)writebuff;
 4487              		.loc 1 1700 0
 4488 0182 5B49     		ldr	r1, .L457+36
 4489 0184 0398     		ldr	r0, [sp, #12]
 4490              	.LVL576:
 4491 0186 0860     		str	r0, [r1, #0]
1702:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_DataTimeOut = SD_DATATIMEOUT;
 4492              		.loc 1 1702 0
 4493 0188 5348     		ldr	r0, .L457+12
 4494 018a 544A     		ldr	r2, .L457+16
1703:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_DataLength = NumberOfBlocks * BlockSize;
 4495              		.loc 1 1703 0
 4496 018c 80E81400 		stmia	r0, {r2, r4}
1704:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_DataBlockSize = (uint32_t) power << 4;
 4497              		.loc 1 1704 0
 4498 0190 4FEA0913 		lsl	r3, r9, #4
 4499 0194 8360     		str	r3, [r0, #8]
1705:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToCard;
 4500              		.loc 1 1705 0
 4501 0196 C660     		str	r6, [r0, #12]
1706:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
 4502              		.loc 1 1706 0
 4503 0198 0661     		str	r6, [r0, #16]
1707:lib/ff/sdio_stm32f1.c ****     SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Enable;
 4504              		.loc 1 1707 0
 4505 019a 4761     		str	r7, [r0, #20]
1708:lib/ff/sdio_stm32f1.c ****     SDIO_DataConfig(&SDIO_DataInitStructure);
 4506              		.loc 1 1708 0
 4507 019c FFF7FEFF 		bl	SDIO_DataConfig
 4508              	.LVL577:
1710:lib/ff/sdio_stm32f1.c ****     if (DeviceMode == SD_POLLING_MODE)
 4509              		.loc 1 1710 0
 4510 01a0 544A     		ldr	r2, .L457+40
 4511 01a2 1168     		ldr	r1, [r2, #0]
 4512 01a4 0229     		cmp	r1, #2
 4513 01a6 40F08180 		bne	.L448
 4514 01aa 039D     		ldr	r5, [sp, #12]
 4515              	.LVL578:
 4516              	.L446:
1712:lib/ff/sdio_stm32f1.c ****       while (!(SDIO->STA & (SDIO_FLAG_TXUNDERR | SDIO_FLAG_DCRCFAIL | SDIO_FLAG_DATAEND | SDIO_FLAG
 4517              		.loc 1 1712 0 discriminator 1
 4518 01ac 524C     		ldr	r4, .L457+44
 4519 01ae 606B     		ldr	r0, [r4, #52]
 4520 01b0 40F21A34 		movw	r4, #794
 4521 01b4 0440     		ands	r4, r4, r0
 4522 01b6 002C     		cmp	r4, #0
 4523 01b8 35D1     		bne	.L454
 4524              	.L407:
1714:lib/ff/sdio_stm32f1.c ****         if (SDIO_GetFlagStatus(SDIO_FLAG_TXFIFOHE) != RESET)
 4525              		.loc 1 1714 0
 4526 01ba 4FF48040 		mov	r0, #16384
 4527 01be FFF7FEFF 		bl	SDIO_GetFlagStatus
 4528              	.LVL579:
 4529 01c2 0028     		cmp	r0, #0
 4530 01c4 F2D0     		beq	.L446
1716:lib/ff/sdio_stm32f1.c ****           if (!((TotalNumberOfBytes - bytestransferred) < SD_HALFFIFOBYTES))
 4531              		.loc 1 1716 0
 4532 01c6 4349     		ldr	r1, .L457+8
 4533 01c8 0B68     		ldr	r3, [r1, #0]
 4534 01ca 981B     		subs	r0, r3, r6
 4535 01cc 1F28     		cmp	r0, #31
 4536 01ce 11D9     		bls	.L399
1718:lib/ff/sdio_stm32f1.c ****             for (count = 0; count < SD_HALFFIFO; count++)
 4537              		.loc 1 1718 0
 4538 01d0 0594     		str	r4, [sp, #20]
 4539              	.L400:
1718:lib/ff/sdio_stm32f1.c ****             for (count = 0; count < SD_HALFFIFO; count++)
 4540              		.loc 1 1718 0 is_stmt 0 discriminator 1
 4541 01d2 0599     		ldr	r1, [sp, #20]
 4542 01d4 0729     		cmp	r1, #7
 4543 01d6 08D8     		bhi	.L455
 4544              	.L401:
1720:lib/ff/sdio_stm32f1.c ****               SDIO_WriteData(*(tempbuff + count));
 4545              		.loc 1 1720 0 is_stmt 1 discriminator 2
 4546 01d8 059B     		ldr	r3, [sp, #20]
 4547 01da 55F82300 		ldr	r0, [r5, r3, lsl #2]
 4548 01de FFF7FEFF 		bl	SDIO_WriteData
 4549              	.LVL580:
1718:lib/ff/sdio_stm32f1.c ****             for (count = 0; count < SD_HALFFIFO; count++)
 4550              		.loc 1 1718 0 discriminator 2
 4551 01e2 059C     		ldr	r4, [sp, #20]
 4552 01e4 601C     		adds	r0, r4, #1
 4553              	.LVL581:
 4554 01e6 0590     		str	r0, [sp, #20]
 4555              	.LVL582:
 4556 01e8 F3E7     		b	.L400
 4557              	.L455:
1722:lib/ff/sdio_stm32f1.c ****             tempbuff += SD_HALFFIFO;
 4558              		.loc 1 1722 0
 4559 01ea 05F12004 		add	r4, r5, #32
 4560              	.LVL583:
1723:lib/ff/sdio_stm32f1.c ****             bytestransferred += SD_HALFFIFOBYTES;
 4561              		.loc 1 1723 0
 4562 01ee 06F12001 		add	r1, r6, #32
 4563              	.LVL584:
 4564 01f2 15E0     		b	.L402
 4565              	.LVL585:
 4566              	.L399:
1727:lib/ff/sdio_stm32f1.c ****             restwords = ((TotalNumberOfBytes - bytestransferred) % 4 == 0) ? ((TotalNumberOfBytes -
 4567              		.loc 1 1727 0
 4568 01f4 10F0030F 		tst	r0, #3
 4569 01f8 4FEA9007 		lsr	r7, r0, #2
 4570 01fc 18BF     		it	ne
 4571 01fe 0137     		addne	r7, r7, #1
 4572              	.LVL586:
1730:lib/ff/sdio_stm32f1.c ****             for (count = 0; count < restwords; count++, tempbuff++, bytestransferred += 4)
 4573              		.loc 1 1730 0
 4574 0200 0024     		movs	r4, #0
 4575 0202 0594     		str	r4, [sp, #20]
 4576 0204 2C46     		mov	r4, r5
 4577              	.LVL587:
 4578              	.L405:
1561:lib/ff/sdio_stm32f1.c **** SD_Error SD_WriteMultiBlocks(uint8_t *writebuff, uint32_t WriteAddr, uint16_t BlockSize, uint32_t N
 4579              		.loc 1 1561 0 discriminator 1
 4580 0206 721B     		subs	r2, r6, r5
 4581 0208 A118     		adds	r1, r4, r2
1730:lib/ff/sdio_stm32f1.c ****             for (count = 0; count < restwords; count++, tempbuff++, bytestransferred += 4)
 4582              		.loc 1 1730 0 discriminator 1
 4583 020a 059B     		ldr	r3, [sp, #20]
 4584 020c BB42     		cmp	r3, r7
 4585 020e 07D2     		bcs	.L402
 4586              	.L406:
1732:lib/ff/sdio_stm32f1.c ****               SDIO_WriteData(*tempbuff);
 4587              		.loc 1 1732 0 discriminator 2
 4588 0210 54F8040B 		ldr	r0, [r4], #4
 4589              	.LVL588:
 4590 0214 FFF7FEFF 		bl	SDIO_WriteData
 4591              	.LVL589:
1730:lib/ff/sdio_stm32f1.c ****             for (count = 0; count < restwords; count++, tempbuff++, bytestransferred += 4)
 4592              		.loc 1 1730 0 discriminator 2
 4593 0218 0598     		ldr	r0, [sp, #20]
 4594 021a 421C     		adds	r2, r0, #1
 4595              	.LVL590:
 4596 021c 0592     		str	r2, [sp, #20]
 4597              	.LVL591:
 4598 021e F2E7     		b	.L405
 4599              	.LVL592:
 4600              	.L402:
1710:lib/ff/sdio_stm32f1.c ****     if (DeviceMode == SD_POLLING_MODE)
 4601              		.loc 1 1710 0 discriminator 1
 4602 0220 2546     		mov	r5, r4
 4603 0222 0E46     		mov	r6, r1
 4604 0224 C2E7     		b	.L446
 4605              	.LVL593:
 4606              	.L454:
1738:lib/ff/sdio_stm32f1.c ****       if (SDIO_GetFlagStatus(SDIO_FLAG_DTIMEOUT) != RESET)
 4607              		.loc 1 1738 0
 4608 0226 0820     		movs	r0, #8
 4609 0228 FFF7FEFF 		bl	SDIO_GetFlagStatus
 4610              	.LVL594:
 4611 022c 20B1     		cbz	r0, .L408
1740:lib/ff/sdio_stm32f1.c ****         SDIO_ClearFlag(SDIO_FLAG_DTIMEOUT);
 4612              		.loc 1 1740 0
 4613 022e 0820     		movs	r0, #8
 4614 0230 FFF7FEFF 		bl	SDIO_ClearFlag
 4615              	.LVL595:
1742:lib/ff/sdio_stm32f1.c ****         return(errorstatus);
 4616              		.loc 1 1742 0
 4617 0234 0420     		movs	r0, #4
 4618 0236 9AE0     		b	.L387
 4619              	.LVL596:
 4620              	.L408:
1744:lib/ff/sdio_stm32f1.c ****       else if (SDIO_GetFlagStatus(SDIO_FLAG_DCRCFAIL) != RESET)
 4621              		.loc 1 1744 0
 4622 0238 0220     		movs	r0, #2
 4623 023a FFF7FEFF 		bl	SDIO_GetFlagStatus
 4624              	.LVL597:
 4625 023e 20B1     		cbz	r0, .L409
1746:lib/ff/sdio_stm32f1.c ****         SDIO_ClearFlag(SDIO_FLAG_DCRCFAIL);
 4626              		.loc 1 1746 0
 4627 0240 0220     		movs	r0, #2
 4628 0242 FFF7FEFF 		bl	SDIO_ClearFlag
 4629              	.LVL598:
1748:lib/ff/sdio_stm32f1.c ****         return(errorstatus);
 4630              		.loc 1 1748 0
 4631 0246 0220     		movs	r0, #2
 4632 0248 91E0     		b	.L387
 4633              	.LVL599:
 4634              	.L409:
1750:lib/ff/sdio_stm32f1.c ****       else if (SDIO_GetFlagStatus(SDIO_FLAG_TXUNDERR) != RESET)
 4635              		.loc 1 1750 0
 4636 024a 1020     		movs	r0, #16
 4637 024c FFF7FEFF 		bl	SDIO_GetFlagStatus
 4638              	.LVL600:
 4639 0250 20B1     		cbz	r0, .L410
1752:lib/ff/sdio_stm32f1.c ****         SDIO_ClearFlag(SDIO_FLAG_TXUNDERR);
 4640              		.loc 1 1752 0
 4641 0252 1020     		movs	r0, #16
 4642 0254 FFF7FEFF 		bl	SDIO_ClearFlag
 4643              	.LVL601:
1754:lib/ff/sdio_stm32f1.c ****         return(errorstatus);
 4644              		.loc 1 1754 0
 4645 0258 0520     		movs	r0, #5
 4646 025a 88E0     		b	.L387
 4647              	.LVL602:
 4648              	.L410:
1756:lib/ff/sdio_stm32f1.c ****       else if (SDIO_GetFlagStatus(SDIO_FLAG_STBITERR) != RESET)
 4649              		.loc 1 1756 0
 4650 025c 4FF40070 		mov	r0, #512
 4651 0260 FFF7FEFF 		bl	SDIO_GetFlagStatus
 4652              	.LVL603:
 4653 0264 0446     		mov	r4, r0
 4654 0266 28B1     		cbz	r0, .L411
1758:lib/ff/sdio_stm32f1.c ****         SDIO_ClearFlag(SDIO_FLAG_STBITERR);
 4655              		.loc 1 1758 0
 4656 0268 4FF40070 		mov	r0, #512
 4657 026c FFF7FEFF 		bl	SDIO_ClearFlag
 4658              	.LVL604:
1760:lib/ff/sdio_stm32f1.c ****         return(errorstatus);
 4659              		.loc 1 1760 0
 4660 0270 0720     		movs	r0, #7
 4661 0272 7CE0     		b	.L387
 4662              	.LVL605:
 4663              	.L411:
1763:lib/ff/sdio_stm32f1.c ****       if (SDIO_GetFlagStatus(SDIO_FLAG_DATAEND) != RESET)
 4664              		.loc 1 1763 0
 4665 0274 4FF48070 		mov	r0, #256
 4666 0278 FFF7FEFF 		bl	SDIO_GetFlagStatus
 4667              	.LVL606:
 4668 027c 0028     		cmp	r0, #0
 4669 027e 5BD0     		beq	.L392
1765:lib/ff/sdio_stm32f1.c ****        if ((SDIO_STD_CAPACITY_SD_CARD_V1_1 == CardType) || (SDIO_STD_CAPACITY_SD_CARD_V2_0 == CardT
 4670              		.loc 1 1765 0
 4671 0280 174B     		ldr	r3, .L457+20
 4672 0282 1A68     		ldr	r2, [r3, #0]
 4673 0284 022A     		cmp	r2, #2
 4674 0286 57D8     		bhi	.L392
1768:lib/ff/sdio_stm32f1.c ****           SDIO_CmdInitStructure.SDIO_Argument = 0x0;
 4675              		.loc 1 1768 0
 4676 0288 1648     		ldr	r0, .L457+24
 4677 028a 0460     		str	r4, [r0, #0]
1769:lib/ff/sdio_stm32f1.c ****           SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_STOP_TRANSMISSION;
 4678              		.loc 1 1769 0
 4679 028c 0C25     		movs	r5, #12
 4680              	.LVL607:
 4681 028e 4560     		str	r5, [r0, #4]
1770:lib/ff/sdio_stm32f1.c ****           SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 4682              		.loc 1 1770 0
 4683 0290 4021     		movs	r1, #64
 4684 0292 8160     		str	r1, [r0, #8]
1771:lib/ff/sdio_stm32f1.c ****           SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 4685              		.loc 1 1771 0
 4686 0294 C460     		str	r4, [r0, #12]
1772:lib/ff/sdio_stm32f1.c ****           SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 4687              		.loc 1 1772 0
 4688 0296 4FF48063 		mov	r3, #1024
 4689 029a 0361     		str	r3, [r0, #16]
1773:lib/ff/sdio_stm32f1.c ****           SDIO_SendCommand(&SDIO_CmdInitStructure);
 4690              		.loc 1 1773 0
 4691 029c FFF7FEFF 		bl	SDIO_SendCommand
 4692              	.LVL608:
1776:lib/ff/sdio_stm32f1.c ****           errorstatus = CmdResp1Error(SD_CMD_STOP_TRANSMISSION);
 4693              		.loc 1 1776 0
 4694 02a0 2846     		mov	r0, r5
 4695 02a2 FFF7FEFF 		bl	CmdResp1Error
 4696              	.LVL609:
1778:lib/ff/sdio_stm32f1.c ****           if (errorstatus != SD_OK)
 4697              		.loc 1 1778 0
 4698 02a6 2A28     		cmp	r0, #42
 4699 02a8 61D1     		bne	.L387
 4700 02aa 45E0     		b	.L392
 4701              	.LVL610:
 4702              	.L448:
1785:lib/ff/sdio_stm32f1.c ****     else if (DeviceMode == SD_INTERRUPT_MODE)
 4703              		.loc 1 1785 0
 4704 02ac 0129     		cmp	r1, #1
 4705 02ae 25D1     		bne	.L412
1787:lib/ff/sdio_stm32f1.c ****       SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND | SDIO_IT_TXFIFOHE | SDIO
 4706              		.loc 1 1787 0
 4707 02b0 44F21A30 		movw	r0, #17178
 4708 02b4 FFF7FEFF 		bl	SDIO_ITConfig
 4709              	.LVL611:
 4710              	.L414:
1788:lib/ff/sdio_stm32f1.c ****       while ((TransferEnd == 0) && (TransferError == SD_OK))
 4711              		.loc 1 1788 0 discriminator 1
 4712 02b8 0549     		ldr	r1, .L457+4
 4713 02ba 0868     		ldr	r0, [r1, #0]
 4714 02bc 0349     		ldr	r1, .L457
 4715 02be 0028     		cmp	r0, #0
 4716 02c0 34D1     		bne	.L415
1788:lib/ff/sdio_stm32f1.c ****       while ((TransferEnd == 0) && (TransferError == SD_OK))
 4717              		.loc 1 1788 0 is_stmt 0 discriminator 2
 4718 02c2 0B78     		ldrb	r3, [r1, #0]	@ zero_extendqisi2
 4719 02c4 2A2B     		cmp	r3, #42
 4720 02c6 F7D0     		beq	.L414
 4721 02c8 30E0     		b	.L415
 4722              	.L458:
 4723 02ca 00BF     		.align	2
 4724              	.L457:
 4725 02cc 00000000 		.word	.LANCHOR9
 4726 02d0 00000000 		.word	.LANCHOR10
 4727 02d4 00000000 		.word	.LANCHOR11
 4728 02d8 00000000 		.word	.LANCHOR2
 4729 02dc FFFF0F00 		.word	1048575
 4730 02e0 00000000 		.word	.LANCHOR4
 4731 02e4 00000000 		.word	.LANCHOR0
 4732 02e8 00000000 		.word	.LANCHOR1
 4733 02ec 00000000 		.word	.LANCHOR12
 4734 02f0 00000000 		.word	.LANCHOR14
 4735 02f4 00000000 		.word	.LANCHOR7
 4736 02f8 00800140 		.word	1073840128
 4737              	.L412:
1795:lib/ff/sdio_stm32f1.c ****     else if (DeviceMode == SD_DMA_MODE)
 4738              		.loc 1 1795 0 is_stmt 1
 4739 02fc E1B9     		cbnz	r1, .L392
1797:lib/ff/sdio_stm32f1.c ****       SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND | SDIO_IT_TXUNDERR | SDIO
 4740              		.loc 1 1797 0
 4741 02fe 40F21A30 		movw	r0, #794
 4742 0302 3946     		mov	r1, r7
 4743 0304 FFF7FEFF 		bl	SDIO_ITConfig
 4744              	.LVL612:
1798:lib/ff/sdio_stm32f1.c ****       SDIO_DMACmd(ENABLE);
 4745              		.loc 1 1798 0
 4746 0308 3846     		mov	r0, r7
 4747 030a FFF7FEFF 		bl	SDIO_DMACmd
 4748              	.LVL613:
1799:lib/ff/sdio_stm32f1.c ****       SD_LowLevel_DMA_TxConfig((uint32_t *)writebuff, (NumberOfBlocks * BlockSize));
 4749              		.loc 1 1799 0
 4750 030e 0398     		ldr	r0, [sp, #12]
 4751 0310 2146     		mov	r1, r4
 4752 0312 FFF7FEFF 		bl	SD_LowLevel_DMA_TxConfig
 4753              	.LVL614:
 4754              	.L416:
 4755              	.LBB70:
 4756              	.LBB71:
3131:lib/ff/sdio_stm32f1.c ****   return (uint32_t)DMA_GetFlagStatus(DMA2_FLAG_TC4);
 4757              		.loc 1 3131 0 discriminator 1
 4758 0316 1748     		ldr	r0, .L459
 4759 0318 FFF7FEFF 		bl	DMA_GetFlagStatus
 4760              	.LVL615:
 4761 031c 1649     		ldr	r1, .L459+4
 4762              	.LBE71:
 4763              	.LBE70:
1800:lib/ff/sdio_stm32f1.c ****       while ((SD_DMAEndOfTransferStatus() == RESET) && (TransferEnd == 0) && (TransferError == SD_O
 4764              		.loc 1 1800 0 discriminator 1
 4765 031e 28B9     		cbnz	r0, .L415
1800:lib/ff/sdio_stm32f1.c ****       while ((SD_DMAEndOfTransferStatus() == RESET) && (TransferEnd == 0) && (TransferError == SD_O
 4766              		.loc 1 1800 0 is_stmt 0 discriminator 2
 4767 0320 1648     		ldr	r0, .L459+8
 4768 0322 0368     		ldr	r3, [r0, #0]
 4769 0324 13B9     		cbnz	r3, .L415
1800:lib/ff/sdio_stm32f1.c ****       while ((SD_DMAEndOfTransferStatus() == RESET) && (TransferEnd == 0) && (TransferError == SD_O
 4770              		.loc 1 1800 0 discriminator 1
 4771 0326 0A78     		ldrb	r2, [r1, #0]	@ zero_extendqisi2
 4772 0328 2A2A     		cmp	r2, #42
 4773 032a F4D0     		beq	.L416
 4774              	.L415:
1802:lib/ff/sdio_stm32f1.c ****       if (TransferError != SD_OK)
 4775              		.loc 1 1802 0 is_stmt 1
 4776 032c 0A78     		ldrb	r2, [r1, #0]	@ zero_extendqisi2
 4777 032e 2A2A     		cmp	r2, #42
 4778 0330 02D0     		beq	.L392
1804:lib/ff/sdio_stm32f1.c ****         return(TransferError);
 4779              		.loc 1 1804 0
 4780 0332 1149     		ldr	r1, .L459+4
 4781 0334 0878     		ldrb	r0, [r1, #0]	@ zero_extendqisi2
 4782 0336 1AE0     		b	.L387
 4783              	.LVL616:
 4784              	.L392:
1809:lib/ff/sdio_stm32f1.c ****   SDIO_ClearFlag(SDIO_STATIC_FLAGS);
 4785              		.loc 1 1809 0
 4786 0338 40F2FF50 		movw	r0, #1535
 4787 033c FFF7FEFF 		bl	SDIO_ClearFlag
 4788              	.LVL617:
1812:lib/ff/sdio_stm32f1.c ****   for(count = 0; count < 0xFFFF; count++)
 4789              		.loc 1 1812 0
 4790 0340 0022     		movs	r2, #0
 4791              	.L449:
1812:lib/ff/sdio_stm32f1.c ****   for(count = 0; count < 0xFFFF; count++)
 4792              		.loc 1 1812 0 is_stmt 0 discriminator 2
 4793 0342 0592     		str	r2, [sp, #20]
 4794 0344 0598     		ldr	r0, [sp, #20]
 4795 0346 4FF6FE72 		movw	r2, #65534
 4796 034a 9042     		cmp	r0, r2
 4797 034c 07D8     		bhi	.L420
 4798              	.L418:
 4799 034e 0598     		ldr	r0, [sp, #20]
 4800 0350 421C     		adds	r2, r0, #1
 4801              	.LVL618:
 4802 0352 F6E7     		b	.L449
 4803              	.LVL619:
 4804              	.L456:
1818:lib/ff/sdio_stm32f1.c ****   while ((errorstatus == SD_OK) && ((cardstate == SD_CARD_PROGRAMMING) || (cardstate == SD_CARD_REC
 4805              		.loc 1 1818 0 is_stmt 1 discriminator 2
 4806 0354 9DF81310 		ldrb	r1, [sp, #19]	@ zero_extendqisi2
 4807              	.LVL620:
 4808 0358 8B1F     		subs	r3, r1, #6
 4809              	.LVL621:
 4810 035a 012B     		cmp	r3, #1
 4811 035c 07D8     		bhi	.L387
 4812              	.LVL622:
 4813              	.L420:
1820:lib/ff/sdio_stm32f1.c ****     errorstatus = IsCardProgramming(&cardstate);
 4814              		.loc 1 1820 0
 4815 035e 0DF11300 		add	r0, sp, #19
 4816 0362 FFF7FEFF 		bl	IsCardProgramming
 4817              	.LVL623:
1818:lib/ff/sdio_stm32f1.c ****   while ((errorstatus == SD_OK) && ((cardstate == SD_CARD_PROGRAMMING) || (cardstate == SD_CARD_REC
 4818              		.loc 1 1818 0
 4819 0366 2A28     		cmp	r0, #42
 4820 0368 F4D0     		beq	.L456
 4821 036a 00E0     		b	.L387
 4822              	.LVL624:
 4823              	.L421:
1592:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 4824              		.loc 1 1592 0
 4825 036c 0E20     		movs	r0, #14
 4826              	.LVL625:
 4827              	.L387:
1824:lib/ff/sdio_stm32f1.c **** }
 4828              		.loc 1 1824 0
 4829 036e 07B0     		add	sp, sp, #28
 4830 0370 BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, sl, fp, pc}
 4831              	.L460:
 4832              		.align	2
 4833              	.L459:
 4834 0374 00200010 		.word	268443648
 4835 0378 00000000 		.word	.LANCHOR9
 4836 037c 00000000 		.word	.LANCHOR10
 4837              		.cfi_endproc
 4838              	.LFE71:
 4840              		.section	.text.SD_GetTransferState,"ax",%progbits
 4841              		.align	1
 4842              		.global	SD_GetTransferState
 4843              		.thumb
 4844              		.thumb_func
 4846              	SD_GetTransferState:
 4847              	.LFB72:
1838:lib/ff/sdio_stm32f1.c **** {
 4848              		.loc 1 1838 0
 4849              		.cfi_startproc
 4850              		@ args = 0, pretend = 0, frame = 0
 4851              		@ frame_needed = 0, uses_anonymous_args = 0
 4852              		@ link register save eliminated.
1839:lib/ff/sdio_stm32f1.c ****   if (SDIO->STA & (SDIO_FLAG_TXACT | SDIO_FLAG_RXACT))
 4853              		.loc 1 1839 0
 4854 0000 034B     		ldr	r3, .L462
 4855 0002 586B     		ldr	r0, [r3, #52]
 4856 0004 10F4405F 		tst	r0, #12288
1847:lib/ff/sdio_stm32f1.c **** }
 4857              		.loc 1 1847 0
 4858 0008 0CBF     		ite	eq
 4859 000a 0020     		moveq	r0, #0
 4860 000c 0120     		movne	r0, #1
 4861 000e 7047     		bx	lr
 4862              	.L463:
 4863              		.align	2
 4864              	.L462:
 4865 0010 00800140 		.word	1073840128
 4866              		.cfi_endproc
 4867              	.LFE72:
 4869              		.section	.text.SD_StopTransfer,"ax",%progbits
 4870              		.align	1
 4871              		.global	SD_StopTransfer
 4872              		.thumb
 4873              		.thumb_func
 4875              	SD_StopTransfer:
 4876              	.LFB73:
1858:lib/ff/sdio_stm32f1.c **** {
 4877              		.loc 1 1858 0
 4878              		.cfi_startproc
 4879              		@ args = 0, pretend = 0, frame = 0
 4880              		@ frame_needed = 0, uses_anonymous_args = 0
 4881 0000 10B5     		push	{r4, lr}
 4882              	.LCFI23:
 4883              		.cfi_def_cfa_offset 8
 4884              		.cfi_offset 4, -8
 4885              		.cfi_offset 14, -4
 4886              	.LVL626:
1862:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = 0x0;
 4887              		.loc 1 1862 0
 4888 0002 0948     		ldr	r0, .L465
1863:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_STOP_TRANSMISSION;
 4889              		.loc 1 1863 0
 4890 0004 0022     		movs	r2, #0
 4891 0006 0C24     		movs	r4, #12
 4892 0008 80E81400 		stmia	r0, {r2, r4}
1864:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 4893              		.loc 1 1864 0
 4894 000c 4021     		movs	r1, #64
 4895 000e 8160     		str	r1, [r0, #8]
1865:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 4896              		.loc 1 1865 0
 4897 0010 C260     		str	r2, [r0, #12]
1866:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 4898              		.loc 1 1866 0
 4899 0012 4FF48062 		mov	r2, #1024
 4900 0016 0261     		str	r2, [r0, #16]
1867:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 4901              		.loc 1 1867 0
 4902 0018 FFF7FEFF 		bl	SDIO_SendCommand
 4903              	.LVL627:
1869:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_STOP_TRANSMISSION);
 4904              		.loc 1 1869 0
 4905 001c 2046     		mov	r0, r4
1872:lib/ff/sdio_stm32f1.c **** }
 4906              		.loc 1 1872 0
 4907 001e BDE81040 		pop	{r4, lr}
1869:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_STOP_TRANSMISSION);
 4908              		.loc 1 1869 0
 4909 0022 FFF7FEBF 		b	CmdResp1Error
 4910              	.LVL628:
 4911              	.L466:
 4912 0026 00BF     		.align	2
 4913              	.L465:
 4914 0028 00000000 		.word	.LANCHOR0
 4915              		.cfi_endproc
 4916              	.LFE73:
 4918              		.section	.text.SD_Erase,"ax",%progbits
 4919              		.align	1
 4920              		.global	SD_Erase
 4921              		.thumb
 4922              		.thumb_func
 4924              	SD_Erase:
 4925              	.LFB74:
1884:lib/ff/sdio_stm32f1.c **** {
 4926              		.loc 1 1884 0
 4927              		.cfi_startproc
 4928              		@ args = 0, pretend = 0, frame = 8
 4929              		@ frame_needed = 0, uses_anonymous_args = 0
 4930              	.LVL629:
 4931 0000 2DE9F743 		push	{r0, r1, r2, r4, r5, r6, r7, r8, r9, lr}
 4932              	.LCFI24:
 4933              		.cfi_def_cfa_offset 40
 4934              		.cfi_offset 0, -40
 4935              		.cfi_offset 1, -36
 4936              		.cfi_offset 2, -32
 4937              		.cfi_offset 4, -28
 4938              		.cfi_offset 5, -24
 4939              		.cfi_offset 6, -20
 4940              		.cfi_offset 7, -16
 4941              		.cfi_offset 8, -12
 4942              		.cfi_offset 9, -8
 4943              		.cfi_offset 14, -4
 4944 0004 0646     		mov	r6, r0
 4945 0006 0D46     		mov	r5, r1
 4946              	.LVL630:
1887:lib/ff/sdio_stm32f1.c ****   __IO uint32_t maxdelay = 0;
 4947              		.loc 1 1887 0
 4948 0008 0020     		movs	r0, #0
 4949              	.LVL631:
 4950 000a 0190     		str	r0, [sp, #4]
 4951              	.LVL632:
1888:lib/ff/sdio_stm32f1.c ****   uint8_t cardstate = 0;
 4952              		.loc 1 1888 0
 4953 000c 8DF80300 		strb	r0, [sp, #3]
 4954              	.LVL633:
1891:lib/ff/sdio_stm32f1.c ****   if (((CSD_Tab[1] >> 20) & SD_CCCC_ERASE) == 0)
 4955              		.loc 1 1891 0
 4956 0010 334B     		ldr	r3, .L479
 4957 0012 5968     		ldr	r1, [r3, #4]
 4958              	.LVL634:
 4959 0014 8A01     		lsls	r2, r1, #6
 4960 0016 5ED5     		bpl	.L476
1897:lib/ff/sdio_stm32f1.c ****   maxdelay = 120000 / ((SDIO->CLKCR & 0xFF) + 2);
 4961              		.loc 1 1897 0
 4962 0018 324A     		ldr	r2, .L479+4
 4963 001a 5368     		ldr	r3, [r2, #4]
 4964 001c D9B2     		uxtb	r1, r3
 4965 001e 8B1C     		adds	r3, r1, #2
 4966 0020 314A     		ldr	r2, .L479+8
 4967 0022 B2FBF3F1 		udiv	r1, r2, r3
 4968              	.LVL635:
 4969 0026 0191     		str	r1, [sp, #4]
 4970              	.LVL636:
1899:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetResponse(SDIO_RESP1) & SD_CARD_LOCKED)
 4971              		.loc 1 1899 0
 4972 0028 FFF7FEFF 		bl	SDIO_GetResponse
 4973              	.LVL637:
 4974 002c 8301     		lsls	r3, r0, #6
 4975 002e 54D4     		bmi	.L477
1905:lib/ff/sdio_stm32f1.c ****   if (CardType == SDIO_HIGH_CAPACITY_SD_CARD)
 4976              		.loc 1 1905 0
 4977 0030 2E48     		ldr	r0, .L479+12
 4978 0032 0468     		ldr	r4, [r0, #0]
 4979 0034 022C     		cmp	r4, #2
 4980 0036 02D1     		bne	.L469
1907:lib/ff/sdio_stm32f1.c ****     startaddr /= 512;
 4981              		.loc 1 1907 0
 4982 0038 760A     		lsrs	r6, r6, #9
 4983              	.LVL638:
1908:lib/ff/sdio_stm32f1.c ****     endaddr /= 512;
 4984              		.loc 1 1908 0
 4985 003a 6D0A     		lsrs	r5, r5, #9
 4986              	.LVL639:
 4987 003c 13E0     		b	.L470
 4988              	.L469:
1912:lib/ff/sdio_stm32f1.c ****   if ((SDIO_STD_CAPACITY_SD_CARD_V1_1 == CardType) || (SDIO_STD_CAPACITY_SD_CARD_V2_0 == CardType) 
 4989              		.loc 1 1912 0
 4990 003e 12D9     		bls	.L470
 4991              	.LVL640:
 4992              	.L472:
1944:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = 0;
 4993              		.loc 1 1944 0
 4994 0040 2B48     		ldr	r0, .L479+16
1945:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_ERASE;
 4995              		.loc 1 1945 0
 4996 0042 0024     		movs	r4, #0
 4997 0044 2625     		movs	r5, #38
 4998 0046 80E83000 		stmia	r0, {r4, r5}
1946:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 4999              		.loc 1 1946 0
 5000 004a 4023     		movs	r3, #64
 5001 004c 8360     		str	r3, [r0, #8]
1947:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 5002              		.loc 1 1947 0
 5003 004e C460     		str	r4, [r0, #12]
1948:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 5004              		.loc 1 1948 0
 5005 0050 4FF48062 		mov	r2, #1024
 5006 0054 0261     		str	r2, [r0, #16]
1949:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 5007              		.loc 1 1949 0
 5008 0056 FFF7FEFF 		bl	SDIO_SendCommand
 5009              	.LVL641:
1951:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_ERASE);
 5010              		.loc 1 1951 0
 5011 005a 2846     		mov	r0, r5
 5012 005c FFF7FEFF 		bl	CmdResp1Error
 5013              	.LVL642:
1953:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
 5014              		.loc 1 1953 0
 5015 0060 2A28     		cmp	r0, #42
 5016 0062 3BD1     		bne	.L468
 5017 0064 26E0     		b	.L471
 5018              	.LVL643:
 5019              	.L470:
1915:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Argument = startaddr;
 5020              		.loc 1 1915 0
 5021 0066 224C     		ldr	r4, .L479+16
 5022 0068 2660     		str	r6, [r4, #0]
1916:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SD_ERASE_GRP_START;
 5023              		.loc 1 1916 0
 5024 006a 4FF02009 		mov	r9, #32
 5025 006e C4F80490 		str	r9, [r4, #4]
1917:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 5026              		.loc 1 1917 0
 5027 0072 4FF04008 		mov	r8, #64
 5028 0076 C4F80880 		str	r8, [r4, #8]
1918:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 5029              		.loc 1 1918 0
 5030 007a 0027     		movs	r7, #0
 5031 007c E760     		str	r7, [r4, #12]
1919:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 5032              		.loc 1 1919 0
 5033 007e 4FF48066 		mov	r6, #1024
 5034              	.LVL644:
 5035 0082 2661     		str	r6, [r4, #16]
1920:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
 5036              		.loc 1 1920 0
 5037 0084 2046     		mov	r0, r4
 5038 0086 FFF7FEFF 		bl	SDIO_SendCommand
 5039              	.LVL645:
1922:lib/ff/sdio_stm32f1.c ****     errorstatus = CmdResp1Error(SD_CMD_SD_ERASE_GRP_START);
 5040              		.loc 1 1922 0
 5041 008a 4846     		mov	r0, r9
 5042 008c FFF7FEFF 		bl	CmdResp1Error
 5043              	.LVL646:
1923:lib/ff/sdio_stm32f1.c ****     if (errorstatus != SD_OK)
 5044              		.loc 1 1923 0
 5045 0090 2A28     		cmp	r0, #42
 5046 0092 23D1     		bne	.L468
1929:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Argument = endaddr;
 5047              		.loc 1 1929 0
 5048 0094 2560     		str	r5, [r4, #0]
1930:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SD_ERASE_GRP_END;
 5049              		.loc 1 1930 0
 5050 0096 2125     		movs	r5, #33
 5051              	.LVL647:
 5052 0098 6560     		str	r5, [r4, #4]
1931:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 5053              		.loc 1 1931 0
 5054 009a C4F80880 		str	r8, [r4, #8]
1932:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 5055              		.loc 1 1932 0
 5056 009e E760     		str	r7, [r4, #12]
1933:lib/ff/sdio_stm32f1.c ****     SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 5057              		.loc 1 1933 0
 5058 00a0 2661     		str	r6, [r4, #16]
1934:lib/ff/sdio_stm32f1.c ****     SDIO_SendCommand(&SDIO_CmdInitStructure);
 5059              		.loc 1 1934 0
 5060 00a2 2046     		mov	r0, r4
 5061              	.LVL648:
 5062 00a4 FFF7FEFF 		bl	SDIO_SendCommand
 5063              	.LVL649:
1936:lib/ff/sdio_stm32f1.c ****     errorstatus = CmdResp1Error(SD_CMD_SD_ERASE_GRP_END);
 5064              		.loc 1 1936 0
 5065 00a8 2846     		mov	r0, r5
 5066 00aa FFF7FEFF 		bl	CmdResp1Error
 5067              	.LVL650:
1937:lib/ff/sdio_stm32f1.c ****     if (errorstatus != SD_OK)
 5068              		.loc 1 1937 0
 5069 00ae 2A28     		cmp	r0, #42
 5070 00b0 14D1     		bne	.L468
 5071 00b2 C5E7     		b	.L472
 5072              	.LVL651:
 5073              	.L471:
1958:lib/ff/sdio_stm32f1.c ****   for (delay = 0; delay < maxdelay; delay++)
 5074              		.loc 1 1958 0 discriminator 1
 5075 00b4 0199     		ldr	r1, [sp, #4]
 5076 00b6 8C42     		cmp	r4, r1
 5077 00b8 06D2     		bcs	.L475
 5078              	.L473:
1958:lib/ff/sdio_stm32f1.c ****   for (delay = 0; delay < maxdelay; delay++)
 5079              		.loc 1 1958 0 is_stmt 0 discriminator 2
 5080 00ba 0134     		adds	r4, r4, #1
 5081              	.LVL652:
 5082 00bc FAE7     		b	.L471
 5083              	.L478:
1964:lib/ff/sdio_stm32f1.c ****   while ((errorstatus == SD_OK) && ((SD_CARD_PROGRAMMING == cardstate) || (SD_CARD_RECEIVING == car
 5084              		.loc 1 1964 0 is_stmt 1 discriminator 2
 5085 00be 9DF80330 		ldrb	r3, [sp, #3]	@ zero_extendqisi2
 5086              	.LVL653:
 5087 00c2 9A1F     		subs	r2, r3, #6
 5088              	.LVL654:
 5089 00c4 012A     		cmp	r2, #1
 5090 00c6 09D8     		bhi	.L468
 5091              	.LVL655:
 5092              	.L475:
1966:lib/ff/sdio_stm32f1.c ****     errorstatus = IsCardProgramming(&cardstate);
 5093              		.loc 1 1966 0
 5094 00c8 0DF10300 		add	r0, sp, #3
 5095 00cc FFF7FEFF 		bl	IsCardProgramming
 5096              	.LVL656:
1964:lib/ff/sdio_stm32f1.c ****   while ((errorstatus == SD_OK) && ((SD_CARD_PROGRAMMING == cardstate) || (SD_CARD_RECEIVING == car
 5097              		.loc 1 1964 0
 5098 00d0 2A28     		cmp	r0, #42
 5099 00d2 F4D0     		beq	.L478
 5100 00d4 02E0     		b	.L468
 5101              	.LVL657:
 5102              	.L476:
1894:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 5103              		.loc 1 1894 0
 5104 00d6 2520     		movs	r0, #37
 5105 00d8 00E0     		b	.L468
 5106              	.L477:
1902:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 5107              		.loc 1 1902 0
 5108 00da 0E20     		movs	r0, #14
 5109              	.LVL658:
 5110              	.L468:
1970:lib/ff/sdio_stm32f1.c **** }
 5111              		.loc 1 1970 0
 5112 00dc BDE8FE83 		pop	{r1, r2, r3, r4, r5, r6, r7, r8, r9, pc}
 5113              	.L480:
 5114              		.align	2
 5115              	.L479:
 5116 00e0 00000000 		.word	.LANCHOR6
 5117 00e4 00800140 		.word	1073840128
 5118 00e8 C0D40100 		.word	120000
 5119 00ec 00000000 		.word	.LANCHOR4
 5120 00f0 00000000 		.word	.LANCHOR0
 5121              		.cfi_endproc
 5122              	.LFE74:
 5124              		.section	.text.SD_SendStatus,"ax",%progbits
 5125              		.align	1
 5126              		.global	SD_SendStatus
 5127              		.thumb
 5128              		.thumb_func
 5130              	SD_SendStatus:
 5131              	.LFB75:
1982:lib/ff/sdio_stm32f1.c **** {
 5132              		.loc 1 1982 0
 5133              		.cfi_startproc
 5134              		@ args = 0, pretend = 0, frame = 0
 5135              		@ frame_needed = 0, uses_anonymous_args = 0
 5136              	.LVL659:
 5137 0000 70B5     		push	{r4, r5, r6, lr}
 5138              	.LCFI25:
 5139              		.cfi_def_cfa_offset 16
 5140              		.cfi_offset 4, -16
 5141              		.cfi_offset 5, -12
 5142              		.cfi_offset 6, -8
 5143              		.cfi_offset 14, -4
 5144              	.LVL660:
1985:lib/ff/sdio_stm32f1.c ****   if (pcardstatus == NULL)
 5145              		.loc 1 1985 0
 5146 0002 0546     		mov	r5, r0
 5147 0004 D0B1     		cbz	r0, .L483
1991:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) RCA << 16;
 5148              		.loc 1 1991 0
 5149 0006 0F48     		ldr	r0, .L484
 5150              	.LVL661:
 5151 0008 0F4A     		ldr	r2, .L484+4
 5152 000a 1168     		ldr	r1, [r2, #0]
 5153 000c 0B04     		lsls	r3, r1, #16
 5154 000e 0360     		str	r3, [r0, #0]
1992:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SEND_STATUS;
 5155              		.loc 1 1992 0
 5156 0010 0D24     		movs	r4, #13
 5157 0012 4460     		str	r4, [r0, #4]
1993:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 5158              		.loc 1 1993 0
 5159 0014 4026     		movs	r6, #64
 5160 0016 8660     		str	r6, [r0, #8]
1994:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 5161              		.loc 1 1994 0
 5162 0018 0026     		movs	r6, #0
 5163 001a C660     		str	r6, [r0, #12]
1995:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 5164              		.loc 1 1995 0
 5165 001c 4FF48062 		mov	r2, #1024
 5166 0020 0261     		str	r2, [r0, #16]
1996:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 5167              		.loc 1 1996 0
 5168 0022 FFF7FEFF 		bl	SDIO_SendCommand
 5169              	.LVL662:
1999:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_SEND_STATUS);
 5170              		.loc 1 1999 0
 5171 0026 2046     		mov	r0, r4
 5172 0028 FFF7FEFF 		bl	CmdResp1Error
 5173              	.LVL663:
 5174 002c 0446     		mov	r4, r0
 5175              	.LVL664:
2001:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
 5176              		.loc 1 2001 0
 5177 002e 2A28     		cmp	r0, #42
 5178 0030 05D1     		bne	.L482
2006:lib/ff/sdio_stm32f1.c ****   *pcardstatus = SDIO_GetResponse(SDIO_RESP1);
 5179              		.loc 1 2006 0
 5180 0032 3046     		mov	r0, r6
 5181              	.LVL665:
 5182 0034 FFF7FEFF 		bl	SDIO_GetResponse
 5183              	.LVL666:
 5184 0038 2860     		str	r0, [r5, #0]
2008:lib/ff/sdio_stm32f1.c ****   return(errorstatus);
 5185              		.loc 1 2008 0
 5186 003a 00E0     		b	.L482
 5187              	.LVL667:
 5188              	.L483:
1988:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 5189              		.loc 1 1988 0
 5190 003c 2624     		movs	r4, #38
 5191              	.LVL668:
 5192              	.L482:
2009:lib/ff/sdio_stm32f1.c **** }
 5193              		.loc 1 2009 0
 5194 003e 2046     		mov	r0, r4
 5195 0040 70BD     		pop	{r4, r5, r6, pc}
 5196              	.L485:
 5197 0042 00BF     		.align	2
 5198              	.L484:
 5199 0044 00000000 		.word	.LANCHOR0
 5200 0048 00000000 		.word	.LANCHOR1
 5201              		.cfi_endproc
 5202              	.LFE75:
 5204              		.section	.text.SD_GetState,"ax",%progbits
 5205              		.align	1
 5206              		.global	SD_GetState
 5207              		.thumb
 5208              		.thumb_func
 5210              	SD_GetState:
 5211              	.LFB59:
 309:lib/ff/sdio_stm32f1.c **** {
 5212              		.loc 1 309 0
 5213              		.cfi_startproc
 5214              		@ args = 0, pretend = 0, frame = 8
 5215              		@ frame_needed = 0, uses_anonymous_args = 0
 5216 0000 07B5     		push	{r0, r1, r2, lr}
 5217              	.LCFI26:
 5218              		.cfi_def_cfa_offset 16
 5219              		.cfi_offset 0, -16
 5220              		.cfi_offset 1, -12
 5221              		.cfi_offset 2, -8
 5222              		.cfi_offset 14, -4
 310:lib/ff/sdio_stm32f1.c ****   uint32_t resp1 = 0;
 5223              		.loc 1 310 0
 5224 0002 0023     		movs	r3, #0
 5225 0004 0193     		str	r3, [sp, #4]
 5226              	.LVL669:
 5227              	.LBB72:
 5228              	.LBB73:
 339:lib/ff/sdio_stm32f1.c ****   __IO uint8_t status = SD_PRESENT;
 5229              		.loc 1 339 0
 5230 0006 0120     		movs	r0, #1
 5231 0008 8DF80300 		strb	r0, [sp, #3]
 5232              	.LVL670:
 349:lib/ff/sdio_stm32f1.c ****   return status;
 5233              		.loc 1 349 0
 5234 000c 9DF80310 		ldrb	r1, [sp, #3]	@ zero_extendqisi2
 5235              	.LVL671:
 5236              	.LBE73:
 5237              	.LBE72:
 312:lib/ff/sdio_stm32f1.c ****   if(SD_Detect()== SD_PRESENT)
 5238              		.loc 1 312 0
 5239 0010 0129     		cmp	r1, #1
 5240 0012 01D0     		beq	.L487
 5241              	.L489:
 325:lib/ff/sdio_stm32f1.c ****     return SD_CARD_ERROR;
 5242              		.loc 1 325 0
 5243 0014 FF20     		movs	r0, #255
 5244 0016 07E0     		b	.L488
 5245              	.L487:
 314:lib/ff/sdio_stm32f1.c ****     if (SD_SendStatus(&resp1) != SD_OK)
 5246              		.loc 1 314 0
 5247 0018 01A8     		add	r0, sp, #4
 5248 001a FFF7FEFF 		bl	SD_SendStatus
 5249              	.LVL672:
 5250 001e 2A28     		cmp	r0, #42
 5251 0020 F8D1     		bne	.L489
 320:lib/ff/sdio_stm32f1.c ****       return (SDCardState)((resp1 >> 9) & 0x0F);
 5252              		.loc 1 320 0
 5253 0022 019A     		ldr	r2, [sp, #4]
 5254 0024 C2F34320 		ubfx	r0, r2, #9, #4
 5255              	.LVL673:
 5256              	.L488:
 327:lib/ff/sdio_stm32f1.c **** }
 5257              		.loc 1 327 0
 5258 0028 0EBD     		pop	{r1, r2, r3, pc}
 5259              		.cfi_endproc
 5260              	.LFE59:
 5262              		.section	.text.SD_GetStatus,"ax",%progbits
 5263              		.align	1
 5264              		.global	SD_GetStatus
 5265              		.thumb
 5266              		.thumb_func
 5268              	SD_GetStatus:
 5269              	.LFB58:
 281:lib/ff/sdio_stm32f1.c **** {
 5270              		.loc 1 281 0
 5271              		.cfi_startproc
 5272              		@ args = 0, pretend = 0, frame = 0
 5273              		@ frame_needed = 0, uses_anonymous_args = 0
 5274 0000 08B5     		push	{r3, lr}
 5275              	.LCFI27:
 5276              		.cfi_def_cfa_offset 8
 5277              		.cfi_offset 3, -8
 5278              		.cfi_offset 14, -4
 5279              	.LVL674:
 284:lib/ff/sdio_stm32f1.c ****   cardstate = SD_GetState();
 5280              		.loc 1 284 0
 5281 0002 FFF7FEFF 		bl	SD_GetState
 5282              	.LVL675:
 286:lib/ff/sdio_stm32f1.c ****   if (cardstate == SD_CARD_TRANSFER)
 5283              		.loc 1 286 0
 5284 0006 0428     		cmp	r0, #4
 5285 0008 04D0     		beq	.L492
 292:lib/ff/sdio_stm32f1.c ****     return (SD_TRANSFER_ERROR);
 5286              		.loc 1 292 0
 5287 000a FF28     		cmp	r0, #255
 5288 000c 14BF     		ite	ne
 5289 000e 0120     		movne	r0, #1
 5290 0010 0220     		moveq	r0, #2
 5291              	.LVL676:
 5292 0012 08BD     		pop	{r3, pc}
 5293              	.LVL677:
 5294              	.L492:
 288:lib/ff/sdio_stm32f1.c ****     return(SD_TRANSFER_OK);
 5295              		.loc 1 288 0
 5296 0014 0020     		movs	r0, #0
 5297              	.LVL678:
 298:lib/ff/sdio_stm32f1.c **** }
 5298              		.loc 1 298 0
 5299 0016 08BD     		pop	{r3, pc}
 5300              		.cfi_endproc
 5301              	.LFE58:
 5303              		.section	.text.SD_SendSDStatus,"ax",%progbits
 5304              		.align	1
 5305              		.global	SD_SendSDStatus
 5306              		.thumb
 5307              		.thumb_func
 5309              	SD_SendSDStatus:
 5310              	.LFB76:
2021:lib/ff/sdio_stm32f1.c **** {
 5311              		.loc 1 2021 0
 5312              		.cfi_startproc
 5313              		@ args = 0, pretend = 0, frame = 0
 5314              		@ frame_needed = 0, uses_anonymous_args = 0
 5315              	.LVL679:
 5316 0000 2DE9F843 		push	{r3, r4, r5, r6, r7, r8, r9, lr}
 5317              	.LCFI28:
 5318              		.cfi_def_cfa_offset 32
 5319              		.cfi_offset 3, -32
 5320              		.cfi_offset 4, -28
 5321              		.cfi_offset 5, -24
 5322              		.cfi_offset 6, -20
 5323              		.cfi_offset 7, -16
 5324              		.cfi_offset 8, -12
 5325              		.cfi_offset 9, -8
 5326              		.cfi_offset 14, -4
 5327 0004 0646     		mov	r6, r0
 5328              	.LVL680:
2025:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetResponse(SDIO_RESP1) & SD_CARD_LOCKED)
 5329              		.loc 1 2025 0
 5330 0006 0020     		movs	r0, #0
 5331              	.LVL681:
 5332 0008 FFF7FEFF 		bl	SDIO_GetResponse
 5333              	.LVL682:
 5334 000c 10F00077 		ands	r7, r0, #33554432
 5335 0010 40F09B80 		bne	.L507
2032:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = 64;
 5336              		.loc 1 2032 0
 5337 0014 4F4C     		ldr	r4, .L519
 5338 0016 4FF04008 		mov	r8, #64
 5339 001a C4F80080 		str	r8, [r4, #0]
2033:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SET_BLOCKLEN;
 5340              		.loc 1 2033 0
 5341 001e 1025     		movs	r5, #16
 5342 0020 6560     		str	r5, [r4, #4]
2034:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 5343              		.loc 1 2034 0
 5344 0022 C4F80880 		str	r8, [r4, #8]
2035:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 5345              		.loc 1 2035 0
 5346 0026 E760     		str	r7, [r4, #12]
2036:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 5347              		.loc 1 2036 0
 5348 0028 4FF48069 		mov	r9, #1024
 5349 002c C4F81090 		str	r9, [r4, #16]
2037:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 5350              		.loc 1 2037 0
 5351 0030 2046     		mov	r0, r4
 5352 0032 FFF7FEFF 		bl	SDIO_SendCommand
 5353              	.LVL683:
2039:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_SET_BLOCKLEN);
 5354              		.loc 1 2039 0
 5355 0036 2846     		mov	r0, r5
 5356 0038 FFF7FEFF 		bl	CmdResp1Error
 5357              	.LVL684:
 5358 003c 0546     		mov	r5, r0
 5359              	.LVL685:
2041:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
 5360              		.loc 1 2041 0
 5361 003e 2A28     		cmp	r0, #42
 5362 0040 40F08480 		bne	.L495
2047:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = (uint32_t) RCA << 16;
 5363              		.loc 1 2047 0
 5364 0044 444B     		ldr	r3, .L519+4
 5365 0046 1868     		ldr	r0, [r3, #0]
 5366              	.LVL686:
 5367 0048 0104     		lsls	r1, r0, #16
 5368 004a 2160     		str	r1, [r4, #0]
2048:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_APP_CMD;
 5369              		.loc 1 2048 0
 5370 004c 3725     		movs	r5, #55
 5371              	.LVL687:
 5372 004e 6560     		str	r5, [r4, #4]
2049:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 5373              		.loc 1 2049 0
 5374 0050 C4F80880 		str	r8, [r4, #8]
2050:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 5375              		.loc 1 2050 0
 5376 0054 E760     		str	r7, [r4, #12]
2051:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 5377              		.loc 1 2051 0
 5378 0056 C4F81090 		str	r9, [r4, #16]
2052:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 5379              		.loc 1 2052 0
 5380 005a 2046     		mov	r0, r4
 5381 005c FFF7FEFF 		bl	SDIO_SendCommand
 5382              	.LVL688:
2053:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_APP_CMD);
 5383              		.loc 1 2053 0
 5384 0060 2846     		mov	r0, r5
 5385 0062 FFF7FEFF 		bl	CmdResp1Error
 5386              	.LVL689:
 5387 0066 0546     		mov	r5, r0
 5388              	.LVL690:
2055:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
 5389              		.loc 1 2055 0
 5390 0068 2A28     		cmp	r0, #42
 5391 006a 6FD1     		bne	.L495
2060:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataTimeOut = SD_DATATIMEOUT;
 5392              		.loc 1 2060 0
 5393 006c 3B48     		ldr	r0, .L519+8
 5394              	.LVL691:
 5395 006e 3C4B     		ldr	r3, .L519+12
2061:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataLength = 64;
 5396              		.loc 1 2061 0
 5397 0070 80E80801 		stmia	r0, {r3, r8}
2062:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DataBlockSize = SDIO_DataBlockSize_64b;
 5398              		.loc 1 2062 0
 5399 0074 6022     		movs	r2, #96
 5400 0076 8260     		str	r2, [r0, #8]
2063:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferDir = SDIO_TransferDir_ToSDIO;
 5401              		.loc 1 2063 0
 5402 0078 0223     		movs	r3, #2
 5403 007a C360     		str	r3, [r0, #12]
2064:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_TransferMode = SDIO_TransferMode_Block;
 5404              		.loc 1 2064 0
 5405 007c 0761     		str	r7, [r0, #16]
2065:lib/ff/sdio_stm32f1.c ****   SDIO_DataInitStructure.SDIO_DPSM = SDIO_DPSM_Enable;
 5406              		.loc 1 2065 0
 5407 007e 0121     		movs	r1, #1
 5408 0080 4161     		str	r1, [r0, #20]
2066:lib/ff/sdio_stm32f1.c ****   SDIO_DataConfig(&SDIO_DataInitStructure);
 5409              		.loc 1 2066 0
 5410 0082 FFF7FEFF 		bl	SDIO_DataConfig
 5411              	.LVL692:
2069:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Argument = 0;
 5412              		.loc 1 2069 0
 5413 0086 2760     		str	r7, [r4, #0]
2070:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CmdIndex = SD_CMD_SD_APP_STAUS;
 5414              		.loc 1 2070 0
 5415 0088 0D25     		movs	r5, #13
 5416              	.LVL693:
 5417 008a 6560     		str	r5, [r4, #4]
2071:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Response = SDIO_Response_Short;
 5418              		.loc 1 2071 0
 5419 008c C4F80880 		str	r8, [r4, #8]
2072:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_Wait = SDIO_Wait_No;
 5420              		.loc 1 2072 0
 5421 0090 E760     		str	r7, [r4, #12]
2073:lib/ff/sdio_stm32f1.c ****   SDIO_CmdInitStructure.SDIO_CPSM = SDIO_CPSM_Enable;
 5422              		.loc 1 2073 0
 5423 0092 C4F81090 		str	r9, [r4, #16]
2074:lib/ff/sdio_stm32f1.c ****   SDIO_SendCommand(&SDIO_CmdInitStructure);
 5424              		.loc 1 2074 0
 5425 0096 2046     		mov	r0, r4
 5426 0098 FFF7FEFF 		bl	SDIO_SendCommand
 5427              	.LVL694:
2075:lib/ff/sdio_stm32f1.c ****   errorstatus = CmdResp1Error(SD_CMD_SD_APP_STAUS);
 5428              		.loc 1 2075 0
 5429 009c 2846     		mov	r0, r5
 5430 009e FFF7FEFF 		bl	CmdResp1Error
 5431              	.LVL695:
 5432 00a2 0546     		mov	r5, r0
 5433              	.LVL696:
2077:lib/ff/sdio_stm32f1.c ****   if (errorstatus != SD_OK)
 5434              		.loc 1 2077 0
 5435 00a4 2A28     		cmp	r0, #42
 5436 00a6 51D1     		bne	.L495
 5437              	.LVL697:
 5438              	.L515:
2082:lib/ff/sdio_stm32f1.c ****   while (!(SDIO->STA &(SDIO_FLAG_RXOVERR | SDIO_FLAG_DCRCFAIL | SDIO_FLAG_DTIMEOUT | SDIO_FLAG_DBCK
 5439              		.loc 1 2082 0 discriminator 1
 5440 00a8 2E4C     		ldr	r4, .L519+16
 5441 00aa 606B     		ldr	r0, [r4, #52]
 5442 00ac 40F22A64 		movw	r4, #1578
 5443 00b0 0440     		ands	r4, r4, r0
 5444 00b2 6CB9     		cbnz	r4, .L517
 5445              	.L499:
2084:lib/ff/sdio_stm32f1.c ****     if (SDIO_GetFlagStatus(SDIO_FLAG_RXFIFOHF) != RESET)
 5446              		.loc 1 2084 0
 5447 00b4 4FF40040 		mov	r0, #32768
 5448 00b8 FFF7FEFF 		bl	SDIO_GetFlagStatus
 5449              	.LVL698:
 5450 00bc 0028     		cmp	r0, #0
 5451 00be F3D0     		beq	.L515
 5452              	.L498:
2088:lib/ff/sdio_stm32f1.c ****         *(psdstatus + count) = SDIO_ReadData();
 5453              		.loc 1 2088 0 discriminator 2
 5454 00c0 FFF7FEFF 		bl	SDIO_ReadData
 5455              	.LVL699:
 5456 00c4 3051     		str	r0, [r6, r4]
 5457 00c6 0434     		adds	r4, r4, #4
2086:lib/ff/sdio_stm32f1.c ****       for (count = 0; count < 8; count++)
 5458              		.loc 1 2086 0 discriminator 2
 5459 00c8 202C     		cmp	r4, #32
 5460 00ca F9D1     		bne	.L498
2090:lib/ff/sdio_stm32f1.c ****       psdstatus += 8;
 5461              		.loc 1 2090 0
 5462 00cc 2036     		adds	r6, r6, #32
 5463              	.LVL700:
 5464 00ce EBE7     		b	.L515
 5465              	.L517:
2094:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetFlagStatus(SDIO_FLAG_DTIMEOUT) != RESET)
 5466              		.loc 1 2094 0
 5467 00d0 0820     		movs	r0, #8
 5468 00d2 FFF7FEFF 		bl	SDIO_GetFlagStatus
 5469              	.LVL701:
 5470 00d6 20B1     		cbz	r0, .L500
2096:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_DTIMEOUT);
 5471              		.loc 1 2096 0
 5472 00d8 0820     		movs	r0, #8
 5473 00da FFF7FEFF 		bl	SDIO_ClearFlag
 5474              	.LVL702:
2098:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 5475              		.loc 1 2098 0
 5476 00de 0425     		movs	r5, #4
 5477 00e0 34E0     		b	.L495
 5478              	.LVL703:
 5479              	.L500:
2100:lib/ff/sdio_stm32f1.c ****   else if (SDIO_GetFlagStatus(SDIO_FLAG_DCRCFAIL) != RESET)
 5480              		.loc 1 2100 0
 5481 00e2 0220     		movs	r0, #2
 5482 00e4 FFF7FEFF 		bl	SDIO_GetFlagStatus
 5483              	.LVL704:
 5484 00e8 20B1     		cbz	r0, .L501
2102:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_DCRCFAIL);
 5485              		.loc 1 2102 0
 5486 00ea 0220     		movs	r0, #2
 5487 00ec FFF7FEFF 		bl	SDIO_ClearFlag
 5488              	.LVL705:
2104:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 5489              		.loc 1 2104 0
 5490 00f0 0225     		movs	r5, #2
 5491 00f2 2BE0     		b	.L495
 5492              	.LVL706:
 5493              	.L501:
2106:lib/ff/sdio_stm32f1.c ****   else if (SDIO_GetFlagStatus(SDIO_FLAG_RXOVERR) != RESET)
 5494              		.loc 1 2106 0
 5495 00f4 2020     		movs	r0, #32
 5496 00f6 FFF7FEFF 		bl	SDIO_GetFlagStatus
 5497              	.LVL707:
 5498 00fa 20B1     		cbz	r0, .L502
2108:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_RXOVERR);
 5499              		.loc 1 2108 0
 5500 00fc 2020     		movs	r0, #32
 5501 00fe FFF7FEFF 		bl	SDIO_ClearFlag
 5502              	.LVL708:
2110:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 5503              		.loc 1 2110 0
 5504 0102 0625     		movs	r5, #6
 5505 0104 22E0     		b	.L495
 5506              	.LVL709:
 5507              	.L502:
2112:lib/ff/sdio_stm32f1.c ****   else if (SDIO_GetFlagStatus(SDIO_FLAG_STBITERR) != RESET)
 5508              		.loc 1 2112 0
 5509 0106 4FF40070 		mov	r0, #512
 5510 010a FFF7FEFF 		bl	SDIO_GetFlagStatus
 5511              	.LVL710:
 5512 010e 28B1     		cbz	r0, .L516
2114:lib/ff/sdio_stm32f1.c ****     SDIO_ClearFlag(SDIO_FLAG_STBITERR);
 5513              		.loc 1 2114 0
 5514 0110 4FF40070 		mov	r0, #512
 5515 0114 FFF7FEFF 		bl	SDIO_ClearFlag
 5516              	.LVL711:
2116:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 5517              		.loc 1 2116 0
 5518 0118 0725     		movs	r5, #7
 5519 011a 17E0     		b	.L495
 5520              	.LVL712:
 5521              	.L516:
2119:lib/ff/sdio_stm32f1.c ****   while (SDIO_GetFlagStatus(SDIO_FLAG_RXDAVL) != RESET)
 5522              		.loc 1 2119 0 discriminator 1
 5523 011c 4FF40010 		mov	r0, #2097152
 5524 0120 FFF7FEFF 		bl	SDIO_GetFlagStatus
 5525              	.LVL713:
 5526 0124 20B1     		cbz	r0, .L518
 5527              	.L505:
2121:lib/ff/sdio_stm32f1.c ****     *psdstatus = SDIO_ReadData();
 5528              		.loc 1 2121 0
 5529 0126 FFF7FEFF 		bl	SDIO_ReadData
 5530              	.LVL714:
 5531 012a 46F8040B 		str	r0, [r6], #4
 5532              	.LVL715:
 5533 012e F5E7     		b	.L516
 5534              	.LVL716:
 5535              	.L518:
2126:lib/ff/sdio_stm32f1.c ****   SDIO_ClearFlag(SDIO_STATIC_FLAGS);
 5536              		.loc 1 2126 0
 5537 0130 40F2FF50 		movw	r0, #1535
 5538 0134 FFF7FEFF 		bl	SDIO_ClearFlag
 5539              	.LVL717:
2127:lib/ff/sdio_stm32f1.c ****   psdstatus -= 16;
 5540              		.loc 1 2127 0
 5541 0138 A6F14003 		sub	r3, r6, #64
 5542              	.LVL718:
 5543              	.L506:
2130:lib/ff/sdio_stm32f1.c ****     psdstatus[count] = ((psdstatus[count] & SD_0TO7BITS) << 24) |((psdstatus[count] & SD_8TO15BITS)
 5544              		.loc 1 2130 0 discriminator 2
 5545 013c 1A68     		ldr	r2, [r3, #0]
 5546 013e 11BA     		rev	r1, r2
 5547 0140 43F8041B 		str	r1, [r3], #4
2128:lib/ff/sdio_stm32f1.c ****   for (count = 0; count < 16; count++)
 5548              		.loc 1 2128 0 discriminator 2
 5549 0144 B342     		cmp	r3, r6
 5550 0146 F9D1     		bne	.L506
 5551 0148 00E0     		b	.L495
 5552              	.LVL719:
 5553              	.L507:
2028:lib/ff/sdio_stm32f1.c ****     return(errorstatus);
 5554              		.loc 1 2028 0
 5555 014a 0E25     		movs	r5, #14
 5556              	.LVL720:
 5557              	.L495:
2134:lib/ff/sdio_stm32f1.c **** }
 5558              		.loc 1 2134 0
 5559 014c 2846     		mov	r0, r5
 5560 014e BDE8F883 		pop	{r3, r4, r5, r6, r7, r8, r9, pc}
 5561              	.L520:
 5562 0152 00BF     		.align	2
 5563              	.L519:
 5564 0154 00000000 		.word	.LANCHOR0
 5565 0158 00000000 		.word	.LANCHOR1
 5566 015c 00000000 		.word	.LANCHOR2
 5567 0160 FFFF0F00 		.word	1048575
 5568 0164 00800140 		.word	1073840128
 5569              		.cfi_endproc
 5570              	.LFE76:
 5572              		.section	.text.SD_ProcessIRQSrc,"ax",%progbits
 5573              		.align	1
 5574              		.global	SD_ProcessIRQSrc
 5575              		.thumb
 5576              		.thumb_func
 5578              	SD_ProcessIRQSrc:
 5579              	.LFB77:
2145:lib/ff/sdio_stm32f1.c **** {
 5580              		.loc 1 2145 0
 5581              		.cfi_startproc
 5582              		@ args = 0, pretend = 0, frame = 0
 5583              		@ frame_needed = 0, uses_anonymous_args = 0
 5584 0000 70B5     		push	{r4, r5, r6, lr}
 5585              	.LCFI29:
 5586              		.cfi_def_cfa_offset 16
 5587              		.cfi_offset 4, -16
 5588              		.cfi_offset 5, -12
 5589              		.cfi_offset 6, -8
 5590              		.cfi_offset 14, -4
 5591              	.LVL721:
2148:lib/ff/sdio_stm32f1.c ****   if (DeviceMode == SD_INTERRUPT_MODE)
 5592              		.loc 1 2148 0
 5593 0002 724B     		ldr	r3, .L559
 5594 0004 1868     		ldr	r0, [r3, #0]
 5595 0006 0128     		cmp	r0, #1
 5596 0008 47D1     		bne	.L523
2150:lib/ff/sdio_stm32f1.c ****     if (SDIO_GetITStatus(SDIO_IT_RXFIFOHF) != RESET)
 5597              		.loc 1 2150 0
 5598 000a 4FF40040 		mov	r0, #32768
 5599 000e FFF7FEFF 		bl	SDIO_GetITStatus
 5600              	.LVL722:
 5601 0012 0446     		mov	r4, r0
 5602 0014 48B1     		cbz	r0, .L524
 5603 0016 0024     		movs	r4, #0
 5604              	.LVL723:
 5605              	.L525:
2154:lib/ff/sdio_stm32f1.c ****         *(DestBuffer + count) = SDIO_ReadData();
 5606              		.loc 1 2154 0 discriminator 2
 5607 0018 6D4D     		ldr	r5, .L559+4
 5608 001a 2E68     		ldr	r6, [r5, #0]
 5609 001c FFF7FEFF 		bl	SDIO_ReadData
 5610              	.LVL724:
 5611 0020 3051     		str	r0, [r6, r4]
 5612 0022 0434     		adds	r4, r4, #4
2152:lib/ff/sdio_stm32f1.c ****       for (count = 0; count < SD_HALFFIFO; count++)
 5613              		.loc 1 2152 0 discriminator 2
 5614 0024 202C     		cmp	r4, #32
 5615 0026 F7D1     		bne	.L525
 5616 0028 30E0     		b	.L556
 5617              	.LVL725:
 5618              	.L524:
2159:lib/ff/sdio_stm32f1.c ****     else if (SDIO_GetITStatus(SDIO_IT_TXFIFOHE) != RESET)
 5619              		.loc 1 2159 0
 5620 002a 4FF48040 		mov	r0, #16384
 5621 002e FFF7FEFF 		bl	SDIO_GetITStatus
 5622              	.LVL726:
 5623 0032 0028     		cmp	r0, #0
 5624 0034 31D0     		beq	.L523
2161:lib/ff/sdio_stm32f1.c ****       if ((TotalNumberOfBytes - NumberOfBytes) < SD_HALFFIFOBYTES)
 5625              		.loc 1 2161 0
 5626 0036 6749     		ldr	r1, .L559+8
 5627 0038 0B68     		ldr	r3, [r1, #0]
 5628 003a 674A     		ldr	r2, .L559+12
 5629 003c 1068     		ldr	r0, [r2, #0]
 5630 003e 191A     		subs	r1, r3, r0
 5631 0040 1F29     		cmp	r1, #31
 5632 0042 1BD8     		bhi	.L527
2163:lib/ff/sdio_stm32f1.c ****         restwords = ((TotalNumberOfBytes - NumberOfBytes) %  4 == 0) ?
 5633              		.loc 1 2163 0
 5634 0044 1668     		ldr	r6, [r2, #0]
 5635 0046 981B     		subs	r0, r3, r6
2164:lib/ff/sdio_stm32f1.c ****                     ((TotalNumberOfBytes - NumberOfBytes) / 4) :
 5636              		.loc 1 2164 0
 5637 0048 1268     		ldr	r2, [r2, #0]
 5638 004a 8107     		lsls	r1, r0, #30
 5639 004c 02D1     		bne	.L528
2164:lib/ff/sdio_stm32f1.c ****                     ((TotalNumberOfBytes - NumberOfBytes) / 4) :
 5640              		.loc 1 2164 0 is_stmt 0 discriminator 1
 5641 004e 9C1A     		subs	r4, r3, r2
 5642 0050 A608     		lsrs	r6, r4, #2
 5643 0052 02E0     		b	.L529
 5644              	.L528:
2165:lib/ff/sdio_stm32f1.c ****                     ((TotalNumberOfBytes - NumberOfBytes) / 4 + 1);
 5645              		.loc 1 2165 0 is_stmt 1 discriminator 2
 5646 0054 991A     		subs	r1, r3, r2
 5647 0056 8B08     		lsrs	r3, r1, #2
2164:lib/ff/sdio_stm32f1.c ****                     ((TotalNumberOfBytes - NumberOfBytes) / 4) :
 5648              		.loc 1 2164 0 discriminator 2
 5649 0058 5E1C     		adds	r6, r3, #1
 5650              	.L529:
 5651              	.LVL727:
2167:lib/ff/sdio_stm32f1.c ****         for (count = 0; count < restwords;  count++, SrcBuffer++, NumberOfBytes += 4)
 5652              		.loc 1 2167 0
 5653 005a 0024     		movs	r4, #0
 5654              	.LVL728:
 5655              	.L530:
2167:lib/ff/sdio_stm32f1.c ****         for (count = 0; count < restwords;  count++, SrcBuffer++, NumberOfBytes += 4)
 5656              		.loc 1 2167 0 is_stmt 0 discriminator 1
 5657 005c B442     		cmp	r4, r6
 5658 005e 1CD0     		beq	.L523
 5659              	.L531:
2169:lib/ff/sdio_stm32f1.c ****           SDIO_WriteData(*SrcBuffer);
 5660              		.loc 1 2169 0 is_stmt 1 discriminator 2
 5661 0060 5E4D     		ldr	r5, .L559+16
 5662 0062 2868     		ldr	r0, [r5, #0]
 5663 0064 0068     		ldr	r0, [r0, #0]
 5664 0066 FFF7FEFF 		bl	SDIO_WriteData
 5665              	.LVL729:
2167:lib/ff/sdio_stm32f1.c ****         for (count = 0; count < restwords;  count++, SrcBuffer++, NumberOfBytes += 4)
 5666              		.loc 1 2167 0 discriminator 2
 5667 006a 0134     		adds	r4, r4, #1
 5668              	.LVL730:
 5669 006c 2A68     		ldr	r2, [r5, #0]
 5670 006e 111D     		adds	r1, r2, #4
 5671 0070 2960     		str	r1, [r5, #0]
 5672 0072 594B     		ldr	r3, .L559+12
 5673 0074 1868     		ldr	r0, [r3, #0]
 5674 0076 021D     		adds	r2, r0, #4
 5675 0078 1A60     		str	r2, [r3, #0]
 5676 007a EFE7     		b	.L530
 5677              	.LVL731:
 5678              	.L527:
2176:lib/ff/sdio_stm32f1.c ****           SDIO_WriteData(*(SrcBuffer + count));
 5679              		.loc 1 2176 0 discriminator 2
 5680 007c 574D     		ldr	r5, .L559+16
 5681 007e 2B68     		ldr	r3, [r5, #0]
 5682 0080 1859     		ldr	r0, [r3, r4]
 5683 0082 FFF7FEFF 		bl	SDIO_WriteData
 5684              	.LVL732:
 5685 0086 0434     		adds	r4, r4, #4
2174:lib/ff/sdio_stm32f1.c ****         for (count = 0; count < SD_HALFFIFO; count++)
 5686              		.loc 1 2174 0 discriminator 2
 5687 0088 202C     		cmp	r4, #32
 5688 008a F7D1     		bne	.L527
 5689              	.L556:
2179:lib/ff/sdio_stm32f1.c ****         SrcBuffer += SD_HALFFIFO;
 5690              		.loc 1 2179 0
 5691 008c 2968     		ldr	r1, [r5, #0]
 5692 008e 2031     		adds	r1, r1, #32
 5693 0090 2960     		str	r1, [r5, #0]
2180:lib/ff/sdio_stm32f1.c ****         NumberOfBytes += SD_HALFFIFOBYTES;
 5694              		.loc 1 2180 0
 5695 0092 514B     		ldr	r3, .L559+12
 5696 0094 1868     		ldr	r0, [r3, #0]
 5697 0096 2030     		adds	r0, r0, #32
 5698 0098 1860     		str	r0, [r3, #0]
 5699              	.LVL733:
 5700              	.L523:
2185:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetITStatus(SDIO_IT_DATAEND) != RESET)
 5701              		.loc 1 2185 0
 5702 009a 4FF48070 		mov	r0, #256
 5703 009e FFF7FEFF 		bl	SDIO_GetITStatus
 5704              	.LVL734:
 5705 00a2 0446     		mov	r4, r0
 5706 00a4 0028     		cmp	r0, #0
 5707 00a6 37D0     		beq	.L532
2187:lib/ff/sdio_stm32f1.c ****     if (DeviceMode != SD_DMA_MODE)
 5708              		.loc 1 2187 0
 5709 00a8 484C     		ldr	r4, .L559
 5710 00aa 2368     		ldr	r3, [r4, #0]
 5711 00ac CBB9     		cbnz	r3, .L552
 5712              	.L536:
2197:lib/ff/sdio_stm32f1.c ****     if (StopCondition == 1)
 5713              		.loc 1 2197 0
 5714 00ae 4C4B     		ldr	r3, .L559+20
 5715 00b0 1C68     		ldr	r4, [r3, #0]
 5716 00b2 012C     		cmp	r4, #1
 5717 00b4 4B4C     		ldr	r4, .L559+24
 5718 00b6 1BD1     		bne	.L555
2199:lib/ff/sdio_stm32f1.c ****       TransferError = SD_StopTransfer();
 5719              		.loc 1 2199 0
 5720 00b8 FFF7FEFF 		bl	SD_StopTransfer
 5721              	.LVL735:
 5722 00bc 2070     		strb	r0, [r4, #0]
 5723 00be 19E0     		b	.L538
 5724              	.L558:
2189:lib/ff/sdio_stm32f1.c ****       while ((SDIO_GetFlagStatus(SDIO_FLAG_RXDAVL) != RESET)  &&  (NumberOfBytes < TotalNumberOfByt
 5725              		.loc 1 2189 0 discriminator 2
 5726 00c0 454C     		ldr	r4, .L559+12
 5727 00c2 2068     		ldr	r0, [r4, #0]
 5728 00c4 434A     		ldr	r2, .L559+8
 5729 00c6 1168     		ldr	r1, [r2, #0]
 5730 00c8 8842     		cmp	r0, r1
 5731 00ca F0D2     		bcs	.L536
 5732              	.L537:
2191:lib/ff/sdio_stm32f1.c ****         *DestBuffer = SDIO_ReadData();
 5733              		.loc 1 2191 0
 5734 00cc 404D     		ldr	r5, .L559+4
 5735 00ce 2E68     		ldr	r6, [r5, #0]
 5736 00d0 FFF7FEFF 		bl	SDIO_ReadData
 5737              	.LVL736:
 5738 00d4 3060     		str	r0, [r6, #0]
2192:lib/ff/sdio_stm32f1.c ****         DestBuffer++;
 5739              		.loc 1 2192 0
 5740 00d6 2968     		ldr	r1, [r5, #0]
 5741 00d8 081D     		adds	r0, r1, #4
 5742 00da 2860     		str	r0, [r5, #0]
2193:lib/ff/sdio_stm32f1.c ****         NumberOfBytes += 4;
 5743              		.loc 1 2193 0
 5744 00dc 2368     		ldr	r3, [r4, #0]
 5745 00de 1A1D     		adds	r2, r3, #4
 5746 00e0 2260     		str	r2, [r4, #0]
 5747              	.L552:
2189:lib/ff/sdio_stm32f1.c ****       while ((SDIO_GetFlagStatus(SDIO_FLAG_RXDAVL) != RESET)  &&  (NumberOfBytes < TotalNumberOfByt
 5748              		.loc 1 2189 0 discriminator 1
 5749 00e2 4FF40010 		mov	r0, #2097152
 5750 00e6 FFF7FEFF 		bl	SDIO_GetFlagStatus
 5751              	.LVL737:
 5752 00ea 0028     		cmp	r0, #0
 5753 00ec E8D1     		bne	.L558
 5754 00ee DEE7     		b	.L536
 5755              	.L555:
2203:lib/ff/sdio_stm32f1.c ****       TransferError = SD_OK;
 5756              		.loc 1 2203 0
 5757 00f0 2A20     		movs	r0, #42
 5758 00f2 2070     		strb	r0, [r4, #0]
 5759              	.L538:
2205:lib/ff/sdio_stm32f1.c ****     SDIO_ClearITPendingBit(SDIO_IT_DATAEND);
 5760              		.loc 1 2205 0
 5761 00f4 4FF48070 		mov	r0, #256
 5762 00f8 FFF7FEFF 		bl	SDIO_ClearITPendingBit
 5763              	.LVL738:
2206:lib/ff/sdio_stm32f1.c ****     SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND |
 5764              		.loc 1 2206 0
 5765 00fc 4CF23A30 		movw	r0, #49978
 5766 0100 0021     		movs	r1, #0
 5767 0102 FFF7FEFF 		bl	SDIO_ITConfig
 5768              	.LVL739:
2209:lib/ff/sdio_stm32f1.c ****     TransferEnd = 1;
 5769              		.loc 1 2209 0
 5770 0106 0122     		movs	r2, #1
 5771 0108 3749     		ldr	r1, .L559+28
 5772 010a 0A60     		str	r2, [r1, #0]
2210:lib/ff/sdio_stm32f1.c ****     NumberOfBytes = 0;
 5773              		.loc 1 2210 0
 5774 010c 0020     		movs	r0, #0
 5775 010e 324B     		ldr	r3, .L559+12
 5776 0110 1860     		str	r0, [r3, #0]
2211:lib/ff/sdio_stm32f1.c ****     return(TransferError);
 5777              		.loc 1 2211 0
 5778 0112 344A     		ldr	r2, .L559+24
 5779 0114 1078     		ldrb	r0, [r2, #0]	@ zero_extendqisi2
 5780 0116 70BD     		pop	{r4, r5, r6, pc}
 5781              	.L532:
2214:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetITStatus(SDIO_IT_DCRCFAIL) != RESET)
 5782              		.loc 1 2214 0
 5783 0118 0220     		movs	r0, #2
 5784 011a FFF7FEFF 		bl	SDIO_GetITStatus
 5785              	.LVL740:
 5786 011e 0546     		mov	r5, r0
 5787 0120 58B1     		cbz	r0, .L540
2216:lib/ff/sdio_stm32f1.c ****     SDIO_ClearITPendingBit(SDIO_IT_DCRCFAIL);
 5788              		.loc 1 2216 0
 5789 0122 0220     		movs	r0, #2
 5790 0124 FFF7FEFF 		bl	SDIO_ClearITPendingBit
 5791              	.LVL741:
2217:lib/ff/sdio_stm32f1.c ****     SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND |
 5792              		.loc 1 2217 0
 5793 0128 4CF23A30 		movw	r0, #49978
 5794 012c 2146     		mov	r1, r4
 5795 012e FFF7FEFF 		bl	SDIO_ITConfig
 5796              	.LVL742:
2220:lib/ff/sdio_stm32f1.c ****     NumberOfBytes = 0;
 5797              		.loc 1 2220 0
 5798 0132 294A     		ldr	r2, .L559+12
 5799 0134 1460     		str	r4, [r2, #0]
2221:lib/ff/sdio_stm32f1.c ****     TransferError = SD_DATA_CRC_FAIL;
 5800              		.loc 1 2221 0
 5801 0136 0220     		movs	r0, #2
 5802 0138 43E0     		b	.L557
 5803              	.L540:
2225:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetITStatus(SDIO_IT_DTIMEOUT) != RESET)
 5804              		.loc 1 2225 0
 5805 013a 0820     		movs	r0, #8
 5806 013c FFF7FEFF 		bl	SDIO_GetITStatus
 5807              	.LVL743:
 5808 0140 0446     		mov	r4, r0
 5809 0142 58B1     		cbz	r0, .L541
2227:lib/ff/sdio_stm32f1.c ****     SDIO_ClearITPendingBit(SDIO_IT_DTIMEOUT);
 5810              		.loc 1 2227 0
 5811 0144 0820     		movs	r0, #8
 5812 0146 FFF7FEFF 		bl	SDIO_ClearITPendingBit
 5813              	.LVL744:
2228:lib/ff/sdio_stm32f1.c ****     SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND |
 5814              		.loc 1 2228 0
 5815 014a 4CF23A30 		movw	r0, #49978
 5816 014e 2946     		mov	r1, r5
 5817 0150 FFF7FEFF 		bl	SDIO_ITConfig
 5818              	.LVL745:
2231:lib/ff/sdio_stm32f1.c ****     NumberOfBytes = 0;
 5819              		.loc 1 2231 0
 5820 0154 2048     		ldr	r0, .L559+12
 5821 0156 0560     		str	r5, [r0, #0]
2232:lib/ff/sdio_stm32f1.c ****     TransferError = SD_DATA_TIMEOUT;
 5822              		.loc 1 2232 0
 5823 0158 0420     		movs	r0, #4
 5824 015a 32E0     		b	.L557
 5825              	.L541:
2236:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetITStatus(SDIO_IT_RXOVERR) != RESET)
 5826              		.loc 1 2236 0
 5827 015c 2020     		movs	r0, #32
 5828 015e FFF7FEFF 		bl	SDIO_GetITStatus
 5829              	.LVL746:
 5830 0162 0546     		mov	r5, r0
 5831 0164 58B1     		cbz	r0, .L542
2238:lib/ff/sdio_stm32f1.c ****     SDIO_ClearITPendingBit(SDIO_IT_RXOVERR);
 5832              		.loc 1 2238 0
 5833 0166 2020     		movs	r0, #32
 5834 0168 FFF7FEFF 		bl	SDIO_ClearITPendingBit
 5835              	.LVL747:
2239:lib/ff/sdio_stm32f1.c ****     SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND |
 5836              		.loc 1 2239 0
 5837 016c 4CF23A30 		movw	r0, #49978
 5838 0170 2146     		mov	r1, r4
 5839 0172 FFF7FEFF 		bl	SDIO_ITConfig
 5840              	.LVL748:
2242:lib/ff/sdio_stm32f1.c ****     NumberOfBytes = 0;
 5841              		.loc 1 2242 0
 5842 0176 184B     		ldr	r3, .L559+12
 5843 0178 1C60     		str	r4, [r3, #0]
2243:lib/ff/sdio_stm32f1.c ****     TransferError = SD_RX_OVERRUN;
 5844              		.loc 1 2243 0
 5845 017a 0620     		movs	r0, #6
 5846 017c 21E0     		b	.L557
 5847              	.L542:
2247:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetITStatus(SDIO_IT_TXUNDERR) != RESET)
 5848              		.loc 1 2247 0
 5849 017e 1020     		movs	r0, #16
 5850 0180 FFF7FEFF 		bl	SDIO_GetITStatus
 5851              	.LVL749:
 5852 0184 0446     		mov	r4, r0
 5853 0186 58B1     		cbz	r0, .L543
2249:lib/ff/sdio_stm32f1.c ****     SDIO_ClearITPendingBit(SDIO_IT_TXUNDERR);
 5854              		.loc 1 2249 0
 5855 0188 1020     		movs	r0, #16
 5856 018a FFF7FEFF 		bl	SDIO_ClearITPendingBit
 5857              	.LVL750:
2250:lib/ff/sdio_stm32f1.c ****     SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND |
 5858              		.loc 1 2250 0
 5859 018e 4CF23A30 		movw	r0, #49978
 5860 0192 2946     		mov	r1, r5
 5861 0194 FFF7FEFF 		bl	SDIO_ITConfig
 5862              	.LVL751:
2253:lib/ff/sdio_stm32f1.c ****     NumberOfBytes = 0;
 5863              		.loc 1 2253 0
 5864 0198 0F49     		ldr	r1, .L559+12
 5865 019a 0D60     		str	r5, [r1, #0]
2254:lib/ff/sdio_stm32f1.c ****     TransferError = SD_TX_UNDERRUN;
 5866              		.loc 1 2254 0
 5867 019c 0520     		movs	r0, #5
 5868 019e 10E0     		b	.L557
 5869              	.L543:
2258:lib/ff/sdio_stm32f1.c ****   if (SDIO_GetITStatus(SDIO_IT_STBITERR) != RESET)
 5870              		.loc 1 2258 0
 5871 01a0 4FF40070 		mov	r0, #512
 5872 01a4 FFF7FEFF 		bl	SDIO_GetITStatus
 5873              	.LVL752:
 5874 01a8 70B1     		cbz	r0, .L545
2260:lib/ff/sdio_stm32f1.c ****     SDIO_ClearITPendingBit(SDIO_IT_STBITERR);
 5875              		.loc 1 2260 0
 5876 01aa 4FF40070 		mov	r0, #512
 5877 01ae FFF7FEFF 		bl	SDIO_ClearITPendingBit
 5878              	.LVL753:
2261:lib/ff/sdio_stm32f1.c ****     SDIO_ITConfig(SDIO_IT_DCRCFAIL | SDIO_IT_DTIMEOUT | SDIO_IT_DATAEND |
 5879              		.loc 1 2261 0
 5880 01b2 4CF23A30 		movw	r0, #49978
 5881 01b6 2146     		mov	r1, r4
 5882 01b8 FFF7FEFF 		bl	SDIO_ITConfig
 5883              	.LVL754:
2264:lib/ff/sdio_stm32f1.c ****     NumberOfBytes = 0;
 5884              		.loc 1 2264 0
 5885 01bc 064A     		ldr	r2, .L559+12
 5886 01be 1460     		str	r4, [r2, #0]
2265:lib/ff/sdio_stm32f1.c ****     TransferError = SD_START_BIT_ERR;
 5887              		.loc 1 2265 0
 5888 01c0 0720     		movs	r0, #7
 5889              	.L557:
 5890 01c2 0849     		ldr	r1, .L559+24
 5891 01c4 0870     		strb	r0, [r1, #0]
2266:lib/ff/sdio_stm32f1.c ****     return(SD_START_BIT_ERR);
 5892              		.loc 1 2266 0
 5893 01c6 70BD     		pop	{r4, r5, r6, pc}
 5894              	.L545:
2269:lib/ff/sdio_stm32f1.c ****   return(SD_OK);
 5895              		.loc 1 2269 0
 5896 01c8 2A20     		movs	r0, #42
2270:lib/ff/sdio_stm32f1.c **** }
 5897              		.loc 1 2270 0
 5898 01ca 70BD     		pop	{r4, r5, r6, pc}
 5899              	.L560:
 5900              		.align	2
 5901              	.L559:
 5902 01cc 00000000 		.word	.LANCHOR7
 5903 01d0 00000000 		.word	.LANCHOR13
 5904 01d4 00000000 		.word	.LANCHOR11
 5905 01d8 00000000 		.word	.LANCHOR15
 5906 01dc 00000000 		.word	.LANCHOR14
 5907 01e0 00000000 		.word	.LANCHOR12
 5908 01e4 00000000 		.word	.LANCHOR9
 5909 01e8 00000000 		.word	.LANCHOR10
 5910              		.cfi_endproc
 5911              	.LFE77:
 5913              		.section	.text.SDIO_IRQHandler,"ax",%progbits
 5914              		.align	1
 5915              		.global	SDIO_IRQHandler
 5916              		.thumb
 5917              		.thumb_func
 5919              	SDIO_IRQHandler:
 5920              	.LFB91:
3143:lib/ff/sdio_stm32f1.c **** {
 5921              		.loc 1 3143 0
 5922              		.cfi_startproc
 5923              		@ args = 0, pretend = 0, frame = 0
 5924              		@ frame_needed = 0, uses_anonymous_args = 0
 5925              		@ link register save eliminated.
3146:lib/ff/sdio_stm32f1.c **** }
 5926              		.loc 1 3146 0
3145:lib/ff/sdio_stm32f1.c ****   SD_ProcessIRQSrc();
 5927              		.loc 1 3145 0
 5928 0000 FFF7FEBF 		b	SD_ProcessIRQSrc
 5929              	.LVL755:
 5930              		.cfi_endproc
 5931              	.LFE91:
 5933              		.section	.text.SD_GetCardStatus,"ax",%progbits
 5934              		.align	1
 5935              		.global	SD_GetCardStatus
 5936              		.thumb
 5937              		.thumb_func
 5939              	SD_GetCardStatus:
 5940              	.LFB92:
3159:lib/ff/sdio_stm32f1.c **** {
 5941              		.loc 1 3159 0
 5942              		.cfi_startproc
 5943              		@ args = 0, pretend = 0, frame = 0
 5944              		@ frame_needed = 0, uses_anonymous_args = 0
 5945              	.LVL756:
 5946 0000 38B5     		push	{r3, r4, r5, lr}
 5947              	.LCFI30:
 5948              		.cfi_def_cfa_offset 16
 5949              		.cfi_offset 3, -16
 5950              		.cfi_offset 4, -12
 5951              		.cfi_offset 5, -8
 5952              		.cfi_offset 14, -4
 5953 0002 0446     		mov	r4, r0
 5954              	.LVL757:
3163:lib/ff/sdio_stm32f1.c ****   errorstatus = SD_SendSDStatus((uint32_t *)SDSTATUS_Tab);
 5955              		.loc 1 3163 0
 5956 0004 1E4D     		ldr	r5, .L564
 5957 0006 2846     		mov	r0, r5
 5958              	.LVL758:
 5959 0008 FFF7FEFF 		bl	SD_SendSDStatus
 5960              	.LVL759:
3165:lib/ff/sdio_stm32f1.c ****   if (errorstatus  != SD_OK)
 5961              		.loc 1 3165 0
 5962 000c 2A28     		cmp	r0, #42
 5963 000e 35D1     		bne	.L563
3171:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((SDSTATUS_Tab[0] & 0xC0) >> 6);
 5964              		.loc 1 3171 0
 5965 0010 2B78     		ldrb	r3, [r5, #0]	@ zero_extendqisi2
 5966 0012 9909     		lsrs	r1, r3, #6
 5967              	.LVL760:
3172:lib/ff/sdio_stm32f1.c ****   cardstatus->DAT_BUS_WIDTH = tmp;
 5968              		.loc 1 3172 0
 5969 0014 2170     		strb	r1, [r4, #0]
3175:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((SDSTATUS_Tab[0] & 0x20) >> 5);
 5970              		.loc 1 3175 0
 5971 0016 2A78     		ldrb	r2, [r5, #0]	@ zero_extendqisi2
 5972 0018 C2F34013 		ubfx	r3, r2, #5, #1
 5973              	.LVL761:
3176:lib/ff/sdio_stm32f1.c ****   cardstatus->SECURED_MODE = tmp;
 5974              		.loc 1 3176 0
 5975 001c 6370     		strb	r3, [r4, #1]
 5976              	.LVL762:
3180:lib/ff/sdio_stm32f1.c ****   cardstatus->SD_CARD_TYPE = tmp << 8;
 5977              		.loc 1 3180 0
 5978 001e A978     		ldrb	r1, [r5, #2]	@ zero_extendqisi2
 5979 0020 0A02     		lsls	r2, r1, #8
 5980 0022 6280     		strh	r2, [r4, #2]	@ movhi
 5981              	.LVL763:
3184:lib/ff/sdio_stm32f1.c ****   cardstatus->SD_CARD_TYPE |= tmp;
 5982              		.loc 1 3184 0
 5983 0024 6388     		ldrh	r3, [r4, #2]
 5984 0026 99B2     		uxth	r1, r3
 5985 0028 EA78     		ldrb	r2, [r5, #3]	@ zero_extendqisi2
 5986 002a 1143     		orrs	r1, r1, r2
 5987 002c 6180     		strh	r1, [r4, #2]	@ movhi
 5988              	.LVL764:
3188:lib/ff/sdio_stm32f1.c ****   cardstatus->SIZE_OF_PROTECTED_AREA = tmp << 24;
 5989              		.loc 1 3188 0
 5990 002e 2B79     		ldrb	r3, [r5, #4]	@ zero_extendqisi2
 5991 0030 1906     		lsls	r1, r3, #24
 5992 0032 6160     		str	r1, [r4, #4]
 5993              	.LVL765:
3192:lib/ff/sdio_stm32f1.c ****   cardstatus->SIZE_OF_PROTECTED_AREA |= tmp << 16;
 5994              		.loc 1 3192 0
 5995 0034 6368     		ldr	r3, [r4, #4]
 5996 0036 6A79     		ldrb	r2, [r5, #5]	@ zero_extendqisi2
 5997 0038 43EA0241 		orr	r1, r3, r2, lsl #16
 5998 003c 6160     		str	r1, [r4, #4]
 5999              	.LVL766:
3196:lib/ff/sdio_stm32f1.c ****   cardstatus->SIZE_OF_PROTECTED_AREA |= tmp << 8;
 6000              		.loc 1 3196 0
 6001 003e 6368     		ldr	r3, [r4, #4]
 6002 0040 AA79     		ldrb	r2, [r5, #6]	@ zero_extendqisi2
 6003 0042 43EA0221 		orr	r1, r3, r2, lsl #8
 6004 0046 6160     		str	r1, [r4, #4]
 6005              	.LVL767:
3200:lib/ff/sdio_stm32f1.c ****   cardstatus->SIZE_OF_PROTECTED_AREA |= tmp;
 6006              		.loc 1 3200 0
 6007 0048 6368     		ldr	r3, [r4, #4]
 6008 004a EA79     		ldrb	r2, [r5, #7]	@ zero_extendqisi2
 6009 004c 42EA0301 		orr	r1, r2, r3
 6010 0050 6160     		str	r1, [r4, #4]
3203:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((SDSTATUS_Tab[8] & 0xFF));
 6011              		.loc 1 3203 0
 6012 0052 2B7A     		ldrb	r3, [r5, #8]	@ zero_extendqisi2
 6013              	.LVL768:
3204:lib/ff/sdio_stm32f1.c ****   cardstatus->SPEED_CLASS = tmp;
 6014              		.loc 1 3204 0
 6015 0054 2372     		strb	r3, [r4, #8]
3207:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((SDSTATUS_Tab[9] & 0xFF));
 6016              		.loc 1 3207 0
 6017 0056 6A7A     		ldrb	r2, [r5, #9]	@ zero_extendqisi2
 6018              	.LVL769:
3208:lib/ff/sdio_stm32f1.c ****   cardstatus->PERFORMANCE_MOVE = tmp;
 6019              		.loc 1 3208 0
 6020 0058 6272     		strb	r2, [r4, #9]
3211:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((SDSTATUS_Tab[10] & 0xF0) >> 4);
 6021              		.loc 1 3211 0
 6022 005a A97A     		ldrb	r1, [r5, #10]	@ zero_extendqisi2
 6023 005c 0B09     		lsrs	r3, r1, #4
 6024              	.LVL770:
3212:lib/ff/sdio_stm32f1.c ****   cardstatus->AU_SIZE = tmp;
 6025              		.loc 1 3212 0
 6026 005e A372     		strb	r3, [r4, #10]
 6027              	.LVL771:
3216:lib/ff/sdio_stm32f1.c ****   cardstatus->ERASE_SIZE = tmp << 8;
 6028              		.loc 1 3216 0
 6029 0060 EA7A     		ldrb	r2, [r5, #11]	@ zero_extendqisi2
 6030 0062 1102     		lsls	r1, r2, #8
 6031 0064 A181     		strh	r1, [r4, #12]	@ movhi
 6032              	.LVL772:
3220:lib/ff/sdio_stm32f1.c ****   cardstatus->ERASE_SIZE |= tmp;
 6033              		.loc 1 3220 0
 6034 0066 A389     		ldrh	r3, [r4, #12]
 6035 0068 99B2     		uxth	r1, r3
 6036 006a 2A7B     		ldrb	r2, [r5, #12]	@ zero_extendqisi2
 6037 006c 1143     		orrs	r1, r1, r2
 6038 006e A181     		strh	r1, [r4, #12]	@ movhi
3223:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((SDSTATUS_Tab[13] & 0xFC) >> 2);
 6039              		.loc 1 3223 0
 6040 0070 6B7B     		ldrb	r3, [r5, #13]	@ zero_extendqisi2
 6041 0072 9908     		lsrs	r1, r3, #2
 6042              	.LVL773:
3224:lib/ff/sdio_stm32f1.c ****   cardstatus->ERASE_TIMEOUT = tmp;
 6043              		.loc 1 3224 0
 6044 0074 A173     		strb	r1, [r4, #14]
3227:lib/ff/sdio_stm32f1.c ****   tmp = (uint8_t)((SDSTATUS_Tab[13] & 0x3));
 6045              		.loc 1 3227 0
 6046 0076 03F00302 		and	r2, r3, #3
 6047              	.LVL774:
3228:lib/ff/sdio_stm32f1.c ****   cardstatus->ERASE_OFFSET = tmp;
 6048              		.loc 1 3228 0
 6049 007a E273     		strb	r2, [r4, #15]
 6050              	.LVL775:
 6051              	.L563:
 6052              		.loc 1 3231 0
 6053 007c 38BD     		pop	{r3, r4, r5, pc}
 6054              	.L565:
 6055 007e 00BF     		.align	2
 6056              	.L564:
 6057 0080 00000000 		.word	.LANCHOR16
 6058              		.cfi_endproc
 6059              	.LFE92:
 6061              		.global	SDIO_DataInitStructure
 6062              		.global	SDIO_CmdInitStructure
 6063              		.global	SDIO_InitStructure
 6064              		.global	SDCardInfo
 6065              		.global	NumberOfBytes
 6066              		.global	TransferEnd
 6067              		.global	TransferError
 6068              		.global	DestBuffer
 6069              		.global	SrcBuffer
 6070              		.section	.bss.SDIO_DataInitStructure,"aw",%nobits
 6071              		.align	2
 6072              		.set	.LANCHOR2,. + 0
 6075              	SDIO_DataInitStructure:
 6076 0000 00000000 		.space	24
 6076      00000000 
 6076      00000000 
 6076      00000000 
 6076      00000000 
 6077              		.section	.bss.CSD_Tab,"aw",%nobits
 6078              		.align	2
 6079              		.set	.LANCHOR6,. + 0
 6082              	CSD_Tab:
 6083 0000 00000000 		.space	16
 6083      00000000 
 6083      00000000 
 6083      00000000 
 6084              		.section	.bss.SDCardInfo,"aw",%nobits
 6085              		.align	3
 6086              		.set	.LANCHOR8,. + 0
 6089              	SDCardInfo:
 6090 0000 00000000 		.space	88
 6090      00000000 
 6090      00000000 
 6090      00000000 
 6090      00000000 
 6091              		.section	.bss.NumberOfBytes,"aw",%nobits
 6092              		.align	2
 6093              		.set	.LANCHOR15,. + 0
 6096              	NumberOfBytes:
 6097 0000 00000000 		.space	4
 6098              		.section	.bss.SDSTATUS_Tab,"aw",%nobits
 6099              		.set	.LANCHOR16,. + 0
 6102              	SDSTATUS_Tab:
 6103 0000 00000000 		.space	16
 6103      00000000 
 6103      00000000 
 6103      00000000 
 6104              		.section	.bss.CardType,"aw",%nobits
 6105              		.align	2
 6106              		.set	.LANCHOR4,. + 0
 6109              	CardType:
 6110 0000 00000000 		.space	4
 6111              		.section	.bss.CID_Tab,"aw",%nobits
 6112              		.align	2
 6113              		.set	.LANCHOR5,. + 0
 6116              	CID_Tab:
 6117 0000 00000000 		.space	16
 6117      00000000 
 6117      00000000 
 6117      00000000 
 6118              		.section	.bss.TransferEnd,"aw",%nobits
 6119              		.align	2
 6120              		.set	.LANCHOR10,. + 0
 6123              	TransferEnd:
 6124 0000 00000000 		.space	4
 6125              		.section	.bss.DestBuffer,"aw",%nobits
 6126              		.align	2
 6127              		.set	.LANCHOR13,. + 0
 6130              	DestBuffer:
 6131 0000 00000000 		.space	4
 6132              		.section	.bss.SDIO_InitStructure,"aw",%nobits
 6133              		.align	2
 6134              		.set	.LANCHOR3,. + 0
 6137              	SDIO_InitStructure:
 6138 0000 00000000 		.space	24
 6138      00000000 
 6138      00000000 
 6138      00000000 
 6138      00000000 
 6139              		.section	.bss.SrcBuffer,"aw",%nobits
 6140              		.align	2
 6141              		.set	.LANCHOR14,. + 0
 6144              	SrcBuffer:
 6145 0000 00000000 		.space	4
 6146              		.section	.bss.RCA,"aw",%nobits
 6147              		.align	2
 6148              		.set	.LANCHOR1,. + 0
 6151              	RCA:
 6152 0000 00000000 		.space	4
 6153              		.section	.data.TransferError,"aw",%progbits
 6154              		.set	.LANCHOR9,. + 0
 6157              	TransferError:
 6158 0000 2A       		.byte	42
 6159              		.section	.bss.TotalNumberOfBytes,"aw",%nobits
 6160              		.align	2
 6161              		.set	.LANCHOR11,. + 0
 6164              	TotalNumberOfBytes:
 6165 0000 00000000 		.space	4
 6166              		.section	.bss.SDIO_CmdInitStructure,"aw",%nobits
 6167              		.align	2
 6168              		.set	.LANCHOR0,. + 0
 6171              	SDIO_CmdInitStructure:
 6172 0000 00000000 		.space	20
 6172      00000000 
 6172      00000000 
 6172      00000000 
 6172      00000000 
 6173              		.section	.data.DeviceMode,"aw",%progbits
 6174              		.align	2
 6175              		.set	.LANCHOR7,. + 0
 6178              	DeviceMode:
 6179 0000 02000000 		.word	2
 6180              		.section	.bss.StopCondition,"aw",%nobits
 6181              		.align	2
 6182              		.set	.LANCHOR12,. + 0
 6185              	StopCondition:
 6186 0000 00000000 		.space	4
 6187              		.text
 6188              	.Letext0:
 6189              		.file 2 "c:\\devz\\arm\\launchpad\\bin\\../lib/gcc/arm-none-eabi/4.7.3/include/stdint-gcc.h"
 6190              		.file 3 "./lib/CMSIS/Device/ST/STM32F10x/Include/stm32f10x.h"
 6191              		.file 4 "./lib/STM32F10x_StdPeriph_Driver/inc/stm32f10x_dma.h"
 6192              		.file 5 "./lib/STM32F10x_StdPeriph_Driver/inc/stm32f10x_gpio.h"
 6193              		.file 6 "./lib/STM32F10x_StdPeriph_Driver/inc/stm32f10x_sdio.h"
 6194              		.file 7 "./lib/STM32F10x_StdPeriph_Driver/inc/misc.h"
 6195              		.file 8 "lib/ff/sdio_stm32f1.h"
 6196              		.file 9 "./lib/CMSIS/Include/core_cm3.h"
 6197              		.file 10 "./lib/STM32F10x_StdPeriph_Driver/inc/stm32f10x_rcc.h"
DEFINED SYMBOLS
                            *ABS*:00000000 sdio_stm32f1.c
  R:\TEMP\ccvQncQh.s:19     .text.CmdResp2Error:00000000 $t
  R:\TEMP\ccvQncQh.s:23     .text.CmdResp2Error:00000000 CmdResp2Error
  R:\TEMP\ccvQncQh.s:83     .text.CmdResp2Error:00000034 $d
  R:\TEMP\ccvQncQh.s:88     .text.IsCardProgramming:00000000 $t
  R:\TEMP\ccvQncQh.s:92     .text.IsCardProgramming:00000000 IsCardProgramming
  R:\TEMP\ccvQncQh.s:367    .text.IsCardProgramming:0000014c $d
  R:\TEMP\ccvQncQh.s:375    .text.unlikely.SD_LowLevel_DMA_TxConfig:00000000 $t
  R:\TEMP\ccvQncQh.s:379    .text.unlikely.SD_LowLevel_DMA_TxConfig:00000000 SD_LowLevel_DMA_TxConfig
  R:\TEMP\ccvQncQh.s:456    .text.unlikely.SD_LowLevel_DMA_TxConfig:00000058 $d
  R:\TEMP\ccvQncQh.s:463    .text.unlikely.SD_LowLevel_DMA_RxConfig:00000000 $t
  R:\TEMP\ccvQncQh.s:467    .text.unlikely.SD_LowLevel_DMA_RxConfig:00000000 SD_LowLevel_DMA_RxConfig
  R:\TEMP\ccvQncQh.s:543    .text.unlikely.SD_LowLevel_DMA_RxConfig:00000058 $d
  R:\TEMP\ccvQncQh.s:550    .text.CmdResp1Error:00000000 $t
  R:\TEMP\ccvQncQh.s:554    .text.CmdResp1Error:00000000 CmdResp1Error
  R:\TEMP\ccvQncQh.s:806    .text.CmdResp1Error:000000ec $d
  R:\TEMP\ccvQncQh.s:812    .text.SDEnWideBus:00000000 $t
  R:\TEMP\ccvQncQh.s:816    .text.SDEnWideBus:00000000 SDEnWideBus
  R:\TEMP\ccvQncQh.s:1166   .text.SDEnWideBus:000001dc $d
  R:\TEMP\ccvQncQh.s:1175   .text.SD_DeInit:00000000 $t
  R:\TEMP\ccvQncQh.s:1180   .text.SD_DeInit:00000000 SD_DeInit
  R:\TEMP\ccvQncQh.s:1232   .text.SD_DeInit:00000044 $d
  R:\TEMP\ccvQncQh.s:1238   .text.SD_Detect:00000000 $t
  R:\TEMP\ccvQncQh.s:1243   .text.SD_Detect:00000000 SD_Detect
  R:\TEMP\ccvQncQh.s:1268   .text.SD_PowerON:00000000 $t
  R:\TEMP\ccvQncQh.s:1273   .text.SD_PowerON:00000000 SD_PowerON
  R:\TEMP\ccvQncQh.s:1621   .text.SD_PowerON:0000019c $d
  R:\TEMP\ccvQncQh.s:1629   .text.SD_PowerOFF:00000000 $t
  R:\TEMP\ccvQncQh.s:1634   .text.SD_PowerOFF:00000000 SD_PowerOFF
  R:\TEMP\ccvQncQh.s:1657   .text.SD_InitializeCards:00000000 $t
  R:\TEMP\ccvQncQh.s:1662   .text.SD_InitializeCards:00000000 SD_InitializeCards
  R:\TEMP\ccvQncQh.s:1941   .text.SD_InitializeCards:0000014c $d
  R:\TEMP\ccvQncQh.s:1951   .text.SD_GetCardInfo:00000000 $t
  R:\TEMP\ccvQncQh.s:1956   .text.SD_GetCardInfo:00000000 SD_GetCardInfo
  R:\TEMP\ccvQncQh.s:2379   .text.SD_GetCardInfo:0000027c $d
  R:\TEMP\ccvQncQh.s:2387   .text.SD_EnableWideBusOperation:00000000 $t
  R:\TEMP\ccvQncQh.s:2392   .text.SD_EnableWideBusOperation:00000000 SD_EnableWideBusOperation
  R:\TEMP\ccvQncQh.s:2498   .text.SD_EnableWideBusOperation:0000006c $d
  R:\TEMP\ccvQncQh.s:2504   .text.SD_SetDeviceMode:00000000 $t
  R:\TEMP\ccvQncQh.s:2509   .text.SD_SetDeviceMode:00000000 SD_SetDeviceMode
  R:\TEMP\ccvQncQh.s:2538   .text.SD_SetDeviceMode:00000010 $d
  R:\TEMP\ccvQncQh.s:2543   .text.SD_SelectDeselect:00000000 $t
  R:\TEMP\ccvQncQh.s:2548   .text.SD_SelectDeselect:00000000 SD_SelectDeselect
  R:\TEMP\ccvQncQh.s:2591   .text.SD_SelectDeselect:00000028 $d
  R:\TEMP\ccvQncQh.s:2596   .text.SD_Init:00000000 $t
  R:\TEMP\ccvQncQh.s:2601   .text.SD_Init:00000000 SD_Init
  R:\TEMP\ccvQncQh.s:2752   .text.SD_Init:000000c8 $d
  R:\TEMP\ccvQncQh.s:2762   .text.SD_ReadBlock:00000000 $t
  R:\TEMP\ccvQncQh.s:2767   .text.SD_ReadBlock:00000000 SD_ReadBlock
  R:\TEMP\ccvQncQh.s:3160   .text.SD_ReadBlock:000001fc $d
  R:\TEMP\ccvQncQh.s:3176   .text.SD_ReadMultiBlocks:00000000 $t
  R:\TEMP\ccvQncQh.s:3181   .text.SD_ReadMultiBlocks:00000000 SD_ReadMultiBlocks
  R:\TEMP\ccvQncQh.s:3634   .text.SD_ReadMultiBlocks:00000264 $d
  R:\TEMP\ccvQncQh.s:3650   .text.SD_WriteBlock:00000000 $t
  R:\TEMP\ccvQncQh.s:3655   .text.SD_WriteBlock:00000000 SD_WriteBlock
  R:\TEMP\ccvQncQh.s:4178   .text.SD_WriteBlock:000002c0 $d
  R:\TEMP\ccvQncQh.s:4195   .text.SD_WriteMultiBlocks:00000000 $t
  R:\TEMP\ccvQncQh.s:4200   .text.SD_WriteMultiBlocks:00000000 SD_WriteMultiBlocks
  R:\TEMP\ccvQncQh.s:4725   .text.SD_WriteMultiBlocks:000002cc $d
  R:\TEMP\ccvQncQh.s:4739   .text.SD_WriteMultiBlocks:000002fc $t
  R:\TEMP\ccvQncQh.s:4834   .text.SD_WriteMultiBlocks:00000374 $d
  R:\TEMP\ccvQncQh.s:4841   .text.SD_GetTransferState:00000000 $t
  R:\TEMP\ccvQncQh.s:4846   .text.SD_GetTransferState:00000000 SD_GetTransferState
  R:\TEMP\ccvQncQh.s:4865   .text.SD_GetTransferState:00000010 $d
  R:\TEMP\ccvQncQh.s:4870   .text.SD_StopTransfer:00000000 $t
  R:\TEMP\ccvQncQh.s:4875   .text.SD_StopTransfer:00000000 SD_StopTransfer
  R:\TEMP\ccvQncQh.s:4914   .text.SD_StopTransfer:00000028 $d
  R:\TEMP\ccvQncQh.s:4919   .text.SD_Erase:00000000 $t
  R:\TEMP\ccvQncQh.s:4924   .text.SD_Erase:00000000 SD_Erase
  R:\TEMP\ccvQncQh.s:5116   .text.SD_Erase:000000e0 $d
  R:\TEMP\ccvQncQh.s:5125   .text.SD_SendStatus:00000000 $t
  R:\TEMP\ccvQncQh.s:5130   .text.SD_SendStatus:00000000 SD_SendStatus
  R:\TEMP\ccvQncQh.s:5199   .text.SD_SendStatus:00000044 $d
  R:\TEMP\ccvQncQh.s:5205   .text.SD_GetState:00000000 $t
  R:\TEMP\ccvQncQh.s:5210   .text.SD_GetState:00000000 SD_GetState
  R:\TEMP\ccvQncQh.s:5263   .text.SD_GetStatus:00000000 $t
  R:\TEMP\ccvQncQh.s:5268   .text.SD_GetStatus:00000000 SD_GetStatus
  R:\TEMP\ccvQncQh.s:5304   .text.SD_SendSDStatus:00000000 $t
  R:\TEMP\ccvQncQh.s:5309   .text.SD_SendSDStatus:00000000 SD_SendSDStatus
  R:\TEMP\ccvQncQh.s:5564   .text.SD_SendSDStatus:00000154 $d
  R:\TEMP\ccvQncQh.s:5573   .text.SD_ProcessIRQSrc:00000000 $t
  R:\TEMP\ccvQncQh.s:5578   .text.SD_ProcessIRQSrc:00000000 SD_ProcessIRQSrc
  R:\TEMP\ccvQncQh.s:5902   .text.SD_ProcessIRQSrc:000001cc $d
  R:\TEMP\ccvQncQh.s:5914   .text.SDIO_IRQHandler:00000000 $t
  R:\TEMP\ccvQncQh.s:5919   .text.SDIO_IRQHandler:00000000 SDIO_IRQHandler
  R:\TEMP\ccvQncQh.s:5934   .text.SD_GetCardStatus:00000000 $t
  R:\TEMP\ccvQncQh.s:5939   .text.SD_GetCardStatus:00000000 SD_GetCardStatus
  R:\TEMP\ccvQncQh.s:6057   .text.SD_GetCardStatus:00000080 $d
  R:\TEMP\ccvQncQh.s:6075   .bss.SDIO_DataInitStructure:00000000 SDIO_DataInitStructure
  R:\TEMP\ccvQncQh.s:6171   .bss.SDIO_CmdInitStructure:00000000 SDIO_CmdInitStructure
  R:\TEMP\ccvQncQh.s:6137   .bss.SDIO_InitStructure:00000000 SDIO_InitStructure
  R:\TEMP\ccvQncQh.s:6089   .bss.SDCardInfo:00000000 SDCardInfo
  R:\TEMP\ccvQncQh.s:6096   .bss.NumberOfBytes:00000000 NumberOfBytes
  R:\TEMP\ccvQncQh.s:6123   .bss.TransferEnd:00000000 TransferEnd
  R:\TEMP\ccvQncQh.s:6157   .data.TransferError:00000000 TransferError
  R:\TEMP\ccvQncQh.s:6130   .bss.DestBuffer:00000000 DestBuffer
  R:\TEMP\ccvQncQh.s:6144   .bss.SrcBuffer:00000000 SrcBuffer
  R:\TEMP\ccvQncQh.s:6071   .bss.SDIO_DataInitStructure:00000000 $d
  R:\TEMP\ccvQncQh.s:6078   .bss.CSD_Tab:00000000 $d
  R:\TEMP\ccvQncQh.s:6082   .bss.CSD_Tab:00000000 CSD_Tab
  R:\TEMP\ccvQncQh.s:6085   .bss.SDCardInfo:00000000 $d
  R:\TEMP\ccvQncQh.s:6092   .bss.NumberOfBytes:00000000 $d
  R:\TEMP\ccvQncQh.s:6102   .bss.SDSTATUS_Tab:00000000 SDSTATUS_Tab
  R:\TEMP\ccvQncQh.s:6103   .bss.SDSTATUS_Tab:00000000 $d
  R:\TEMP\ccvQncQh.s:6105   .bss.CardType:00000000 $d
  R:\TEMP\ccvQncQh.s:6109   .bss.CardType:00000000 CardType
  R:\TEMP\ccvQncQh.s:6112   .bss.CID_Tab:00000000 $d
  R:\TEMP\ccvQncQh.s:6116   .bss.CID_Tab:00000000 CID_Tab
  R:\TEMP\ccvQncQh.s:6119   .bss.TransferEnd:00000000 $d
  R:\TEMP\ccvQncQh.s:6126   .bss.DestBuffer:00000000 $d
  R:\TEMP\ccvQncQh.s:6133   .bss.SDIO_InitStructure:00000000 $d
  R:\TEMP\ccvQncQh.s:6140   .bss.SrcBuffer:00000000 $d
  R:\TEMP\ccvQncQh.s:6147   .bss.RCA:00000000 $d
  R:\TEMP\ccvQncQh.s:6151   .bss.RCA:00000000 RCA
  R:\TEMP\ccvQncQh.s:6160   .bss.TotalNumberOfBytes:00000000 $d
  R:\TEMP\ccvQncQh.s:6164   .bss.TotalNumberOfBytes:00000000 TotalNumberOfBytes
  R:\TEMP\ccvQncQh.s:6167   .bss.SDIO_CmdInitStructure:00000000 $d
  R:\TEMP\ccvQncQh.s:6174   .data.DeviceMode:00000000 $d
  R:\TEMP\ccvQncQh.s:6178   .data.DeviceMode:00000000 DeviceMode
  R:\TEMP\ccvQncQh.s:6181   .bss.StopCondition:00000000 $d
  R:\TEMP\ccvQncQh.s:6185   .bss.StopCondition:00000000 StopCondition
                     .debug_frame:00000010 $d

UNDEFINED SYMBOLS
SDIO_ClearFlag
SDIO_SendCommand
SDIO_GetCommandResponse
SDIO_GetResponse
DMA_ClearFlag
DMA_Cmd
DMA_Init
SDIO_DataConfig
SDIO_GetFlagStatus
SDIO_ReadData
SDIO_ClockCmd
SDIO_SetPowerState
SDIO_DeInit
RCC_AHBPeriphClockCmd
GPIO_Init
SDIO_Init
SDIO_GetPowerState
RCC_APB2PeriphClockCmd
NVIC_Init
SDIO_DMACmd
SDIO_ITConfig
DMA_GetFlagStatus
SDIO_WriteData
SDIO_GetITStatus
SDIO_ClearITPendingBit
